{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Employee } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\nimport Fuse from 'fuse.js';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { registerBreadcrumbStore } from '../../lib/breadcrumb-generator'; // ‚úÖ NEW\r\nimport { type SystemId } from '../../lib/id-types';\r\nimport { createInMemoryRepository } from '../../repositories/in-memory-repository';\r\nimport { \r\n  createHistoryEntry, \r\n  getCurrentUserInfo,\r\n  appendHistoryEntry \r\n} from '../../lib/activity-history-helper';\r\n\r\ntype EmployeePersistenceAdapter = {\r\n  create: (payload: Omit<Employee, 'systemId'>) => Promise<Employee>;\r\n  update: (systemId: SystemId, payload: Partial<Employee>) => Promise<Employee>;\r\n  softDelete: (systemId: SystemId) => Promise<void>;\r\n  restore: (systemId: SystemId) => Promise<Employee | undefined>;\r\n  hardDelete: (systemId: SystemId) => Promise<void>;\r\n};\r\n\r\nconst baseStore = createCrudStore<Employee>([], 'employees', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId, // ‚úÖ Track who creates/updates\r\n  apiEndpoint: '/api/employees',\r\n});\r\n\r\n// ‚úÖ Wrap add method to include activity history\r\nconst originalAdd = baseStore.getState().add;\r\nconst wrappedAdd = (item: Omit<Employee, 'systemId'>): Employee => {\r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntry = createHistoryEntry(\r\n    'created',\r\n    `${userInfo.name} ƒë√£ t·∫°o h·ªì s∆° nh√¢n vi√™n ${item.fullName} (${item.id})`,\r\n    userInfo\r\n  );\r\n  \r\n  const newEmployee = originalAdd({\r\n    ...item,\r\n    activityHistory: [historyEntry],\r\n  });\r\n  \r\n  return newEmployee;\r\n};\r\n\r\n// ‚úÖ Wrap update method to include activity history\r\nconst originalUpdate = baseStore.getState().update;\r\nconst wrappedUpdate = (systemId: SystemId, updates: Partial<Employee>): void => {\r\n  const currentEmployee = baseStore.getState().data.find(e => e.systemId === systemId);\r\n  if (!currentEmployee) return;\r\n  \r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntries: HistoryEntry[] = [];\r\n  \r\n  // Track important field changes\r\n  const trackedFields: { key: keyof Employee; label: string }[] = [\r\n    { key: 'fullName', label: 'h·ªç t√™n' },\r\n    { key: 'jobTitle', label: 'ch·ª©c danh' },\r\n    { key: 'department', label: 'ph√≤ng ban' },\r\n    { key: 'employmentStatus', label: 'tr·∫°ng th√°i l√†m vi·ªác' },\r\n    { key: 'employeeType', label: 'lo·∫°i nh√¢n vi√™n' },\r\n    { key: 'baseSalary', label: 'l∆∞∆°ng c∆° b·∫£n' },\r\n    { key: 'phone', label: 's·ªë ƒëi·ªán tho·∫°i' },\r\n    { key: 'workEmail', label: 'email c√¥ng vi·ªác' },\r\n    { key: 'role', label: 'vai tr√≤' },\r\n  ];\r\n  \r\n  trackedFields.forEach(({ key, label }) => {\r\n    if (updates[key] !== undefined && updates[key] !== currentEmployee[key]) {\r\n      const oldValue = currentEmployee[key];\r\n      const newValue = updates[key];\r\n      \r\n      // Format values for display\r\n      let oldDisplay = oldValue;\r\n      let newDisplay = newValue;\r\n      \r\n      if (key === 'baseSalary') {\r\n        oldDisplay = new Intl.NumberFormat('vi-VN').format(oldValue as number) + 'ƒë';\r\n        newDisplay = new Intl.NumberFormat('vi-VN').format(newValue as number) + 'ƒë';\r\n      }\r\n      \r\n      historyEntries.push(createHistoryEntry(\r\n        'updated',\r\n        `${userInfo.name} ƒë√£ c·∫≠p nh·∫≠t ${label}: \"${oldDisplay || '(tr·ªëng)'}\" ‚Üí \"${newDisplay}\"`,\r\n        userInfo,\r\n        { field: key, oldValue, newValue }\r\n      ));\r\n    }\r\n  });\r\n  \r\n  // If status changed specifically\r\n  if (updates.employmentStatus && updates.employmentStatus !== currentEmployee.employmentStatus) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'status_changed',\r\n      `${userInfo.name} ƒë√£ thay ƒë·ªïi tr·∫°ng th√°i l√†m vi·ªác t·ª´ \"${currentEmployee.employmentStatus}\" th√†nh \"${updates.employmentStatus}\"`,\r\n      userInfo,\r\n      { field: 'employmentStatus', oldValue: currentEmployee.employmentStatus, newValue: updates.employmentStatus }\r\n    ));\r\n  }\r\n  \r\n  // If no specific changes tracked, add generic update entry\r\n  if (historyEntries.length === 0) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'updated',\r\n      `${userInfo.name} ƒë√£ c·∫≠p nh·∫≠t th√¥ng tin nh√¢n vi√™n`,\r\n      userInfo\r\n    ));\r\n  }\r\n  \r\n  const updatedHistory = appendHistoryEntry(currentEmployee.activityHistory, ...historyEntries);\r\n  \r\n  originalUpdate(systemId, {\r\n    ...updates,\r\n    activityHistory: updatedHistory,\r\n  });\r\n};\r\n\r\n// ‚úÖ Override base store methods\r\nbaseStore.setState({\r\n  add: wrappedAdd,\r\n  update: wrappedUpdate,\r\n});\r\n\r\nexport const employeeRepository = createInMemoryRepository<Employee>(() => baseStore.getState());\r\n\r\n// ‚úÖ API-backed persistence adapter - syncs to PostgreSQL\r\nconst API_ENDPOINT = '/api/employees';\r\n\r\nconst persistence: EmployeePersistenceAdapter = {\r\n  create: async (payload) => {\r\n    // First create locally for immediate UI update\r\n    const localResult = await employeeRepository.create(payload);\r\n    \r\n    // Then sync to API (background)\r\n    try {\r\n      const response = await fetch(API_ENDPOINT, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ ...payload, systemId: localResult.systemId }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Create sync failed, data saved locally');\r\n      } else {\r\n        console.log('[Employee API] Created:', localResult.systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Create sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  update: async (systemId, payload) => {\r\n    // First update locally\r\n    const localResult = await employeeRepository.update(systemId, payload);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'PATCH',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Update sync failed');\r\n      } else {\r\n        console.log('[Employee API] Updated:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Update sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  softDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.softDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: false }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Soft delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Soft deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Soft delete sync error:', e);\r\n    }\r\n  },\r\n  restore: async (systemId) => {\r\n    // First restore locally\r\n    const localResult = await employeeRepository.restore(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}/restore`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Restore sync failed');\r\n      } else {\r\n        console.log('[Employee API] Restored:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Restore sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  hardDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.hardDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: true }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Hard delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Hard deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Hard delete sync error:', e);\r\n    }\r\n  },\r\n};\r\n\r\n// ‚úÖ Register for breadcrumb auto-generation\r\nregisterBreadcrumbStore('employees', () => baseStore.getState());\r\n\r\n// Define enhanced interface\r\ninterface EmployeeStoreState extends CrudState<Employee> {\r\n  searchEmployees: (query: string, page: number, limit?: number) => Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>;\r\n  permanentDelete: (systemId: SystemId) => Promise<void>;\r\n  persistence: EmployeePersistenceAdapter;\r\n}\r\n\r\ntype EmployeeStoreHook = (() => EmployeeStoreState) & {\r\n  getState: () => EmployeeStoreState;\r\n  persistence: EmployeePersistenceAdapter;\r\n};\r\n\r\n// Augmented methods\r\nconst augmentedMethods = {\r\n    // FIX: Changed `page: number = 1` to `page: number` to make it a required parameter, matching Combobox prop type.\r\n    // ‚úÖ CRITICAL FIX: Create fresh Fuse instance on each search to avoid stale data\r\n    searchEmployees: async (query: string, page: number, limit: number = 20) => {\r\n        return new Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>(resolve => {\r\n            setTimeout(() => {\r\n                const allEmployees = baseStore.getState().data;\r\n                \r\n                // ‚úÖ Create fresh Fuse instance with current data\r\n                const fuse = new Fuse(allEmployees, {\r\n                    keys: ['fullName', 'id', 'phone', 'personalEmail', 'workEmail'],\r\n                    threshold: 0.3,\r\n                });\r\n                \r\n                const results = query ? fuse.search(query).map(r => r.item) : allEmployees;\r\n                \r\n                const start = (page - 1) * limit;\r\n                const end = start + limit;\r\n                const paginatedItems = results.slice(start, end);\r\n\r\n                resolve({\r\n                    items: paginatedItems.map(e => ({ value: e.systemId, label: e.fullName })),\r\n                    hasNextPage: end < results.length,\r\n                });\r\n            }, 300);\r\n        });\r\n    },\r\n    permanentDelete: async (systemId: SystemId) => {\r\n        await persistence.hardDelete(systemId);\r\n    }\r\n};\r\n\r\nconst useEmployeeStoreHook = (): EmployeeStoreState => {\r\n  const state = baseStore();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods, // This includes permanentDelete\r\n    persistence,\r\n  };\r\n};\r\n\r\nexport const useEmployeeStore = useEmployeeStoreHook as EmployeeStoreHook;\r\n\r\n// Export getState for non-hook usage\r\nuseEmployeeStore.getState = (): EmployeeStoreState => {\r\n  const state = baseStore.getState();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods,\r\n    persistence,\r\n  };\r\n};\r\n\r\nuseEmployeeStore.persistence = persistence;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/employee-comp-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { useEmployeeSettingsStore } from '../settings/employees/employee-settings-store';\r\nimport type { SalaryComponent, WorkShift } from '../settings/employees/types';\r\n\r\nexport type PayrollBankAccount = {\r\n  accountNumber?: string | undefined;\r\n  bankName?: string | undefined;\r\n  bankBranch?: string | undefined;\r\n  accountHolder?: string | undefined;\r\n};\r\n\r\nexport type EmployeePayrollProfile = {\r\n  employeeSystemId: SystemId;\r\n  workShiftSystemId?: WorkShift['systemId'] | undefined;\r\n  salaryComponentSystemIds: SalaryComponent['systemId'][];\r\n  payrollBankAccount?: PayrollBankAccount | undefined;\r\n  paymentMethod: 'bank_transfer' | 'cash';\r\n  createdAt: string;\r\n  createdBy?: SystemId | undefined;\r\n  updatedAt: string;\r\n  updatedBy?: SystemId | undefined;\r\n};\r\n\r\nexport type ResolvedPayrollProfile = EmployeePayrollProfile & {\r\n  usesDefaultComponents: boolean;\r\n};\r\n\r\nexport type EmployeePayrollProfileInput = {\r\n  workShiftSystemId?: WorkShift['systemId'] | undefined;\r\n  salaryComponentSystemIds?: SalaryComponent['systemId'][] | undefined;\r\n  payrollBankAccount?: PayrollBankAccount | undefined;\r\n  paymentMethod?: EmployeePayrollProfile['paymentMethod'] | undefined;\r\n};\r\n\r\ntype EmployeeCompState = {\r\n  profiles: Record<SystemId, EmployeePayrollProfile>;\r\n  initialized: boolean;\r\n  assignComponents: (employeeSystemId: SystemId, payload: EmployeePayrollProfileInput) => void;\r\n  removeProfile: (employeeSystemId: SystemId) => void;\r\n  getPayrollProfile: (employeeSystemId: SystemId) => ResolvedPayrollProfile;\r\n  loadFromAPI: () => Promise<void>;\r\n};\r\n\r\nconst getDefaultComponentIds = (): SystemId[] =>\r\n  useEmployeeSettingsStore.getState().getSalaryComponents().map((component) => component.systemId);\r\n\r\nconst getValidShiftId = (shiftId?: string | SystemId): SystemId | undefined => {\r\n  if (!shiftId) return undefined;\r\n  const normalized = asSystemId(shiftId as string);\r\n  const shiftExists = useEmployeeSettingsStore\r\n    .getState()\r\n    .settings.workShifts.some((shift) => shift.systemId === normalized);\r\n  return shiftExists ? normalized : undefined;\r\n};\r\n\r\nconst sanitizeComponentIds = (componentIds?: Array<string | SystemId>): SystemId[] => {\r\n  const available = new Set(getDefaultComponentIds());\r\n  if (!componentIds?.length) {\r\n    return Array.from(available);\r\n  }\r\n  return componentIds\r\n    .map((id) => asSystemId(id as string))\r\n    .filter((id) => available.has(id));\r\n};\r\n\r\nconst buildDefaultProfile = (employeeSystemId: SystemId): ResolvedPayrollProfile => ({\r\n  employeeSystemId,\r\n  workShiftSystemId: undefined,\r\n  salaryComponentSystemIds: getDefaultComponentIds(),\r\n  payrollBankAccount: undefined,\r\n  paymentMethod: 'bank_transfer',\r\n  createdAt: '',\r\n  updatedAt: '',\r\n  usesDefaultComponents: true,\r\n});\r\n\r\n// API sync helper\r\nasync function syncToAPI(\r\n  action: 'create' | 'update' | 'delete', \r\n  employeeSystemId: SystemId, \r\n  data?: Partial<EmployeePayrollProfile>\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' \r\n      ? '/api/employee-payroll-profiles'\r\n      : `/api/employee-payroll-profiles/${employeeSystemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify({ employeeSystemId, ...data }) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Employee Comp API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useEmployeeCompStore = create<EmployeeCompState>()(\r\n  (set, get) => ({\r\n      profiles: {},\r\n      initialized: false,\r\n      assignComponents: (employeeSystemId, payload) => {\r\n        const now = new Date().toISOString();\r\n        const currentUser = getCurrentUserSystemId();\r\n        const existing = get().profiles[employeeSystemId];\r\n        const salaryComponentSystemIds = sanitizeComponentIds(\r\n          payload.salaryComponentSystemIds ?? existing?.salaryComponentSystemIds\r\n        );\r\n\r\n        const profileData: EmployeePayrollProfile = {\r\n          employeeSystemId,\r\n          workShiftSystemId: getValidShiftId(\r\n            payload.workShiftSystemId ?? existing?.workShiftSystemId\r\n          ) as SystemId,\r\n          salaryComponentSystemIds,\r\n          payrollBankAccount: payload.payrollBankAccount ?? existing?.payrollBankAccount,\r\n          paymentMethod: payload.paymentMethod ?? existing?.paymentMethod ?? 'bank_transfer',\r\n          createdAt: existing?.createdAt ?? now,\r\n          createdBy: existing?.createdBy ?? currentUser as SystemId,\r\n          updatedAt: now,\r\n          updatedBy: currentUser as SystemId,\r\n        };\r\n\r\n        set(({ profiles }) => ({\r\n          profiles: {\r\n            ...profiles,\r\n            [employeeSystemId]: profileData,\r\n          },\r\n        }));\r\n        \r\n        // Sync to API\r\n        syncToAPI(existing ? 'update' : 'create', employeeSystemId, profileData).catch(console.error);\r\n      },\r\n      removeProfile: (employeeSystemId) => {\r\n        set(({ profiles }) => {\r\n          const nextProfiles = { ...profiles };\r\n          delete nextProfiles[employeeSystemId];\r\n          return { profiles: nextProfiles };\r\n        });\r\n        \r\n        // Sync to API\r\n        syncToAPI('delete', employeeSystemId).catch(console.error);\r\n      },\r\n      getPayrollProfile: (employeeSystemId) => {\r\n        const profile = get().profiles[employeeSystemId];\r\n        if (!profile) {\r\n          return buildDefaultProfile(employeeSystemId);\r\n        }\r\n        return {\r\n          ...profile,\r\n          usesDefaultComponents: false,\r\n        };\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Payroll profiles are 1-per-employee, typically manageable size\r\n          const response = await fetch('/api/employee-payroll-profiles?limit=100');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const profilesList = json.data || json.profiles || [];\r\n            const profiles: Record<SystemId, EmployeePayrollProfile> = {};\r\n            for (const profile of profilesList) {\r\n              profiles[asSystemId(profile.employeeSystemId)] = {\r\n                ...profile,\r\n                employeeSystemId: asSystemId(profile.employeeSystemId),\r\n              };\r\n            }\r\n            set({ profiles, initialized: true });\r\n          }\r\n        } catch (error) {\r\n          console.error('[Employee Comp Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 450, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/document-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { FileUploadAPI, type ServerFile, type StagingFile } from '../../lib/file-upload-api';\r\n\r\n// Re-export types for easier importing\r\nexport type { ServerFile, StagingFile } from '../../lib/file-upload-api';\r\n\r\nexport type EmployeeDocument = {\r\n  id: string;\r\n  employeeSystemId: string;\r\n  documentType: string; // 'legal', 'work-process', 'termination', 'decisions', 'kpi', 'requests'\r\n  documentName: string; // e.g., \"S∆° y·∫øu l√Ω l·ªãch\", \"H·ª£p ƒë·ªìng lao ƒë·ªông\"\r\n  files: ServerFile[]; // Permanent files only\r\n  createdAt: string;\r\n  updatedAt: string;\r\n};\r\n\r\n// Staging documents (temporary, in-memory only)\r\nexport type StagingDocument = {\r\n  documentType: string;\r\n  documentName: string;\r\n  files: StagingFile[];\r\n  sessionId: string;\r\n};\r\n\r\ntype DocumentStore = {\r\n  documents: EmployeeDocument[];\r\n  stagingDocuments: Record<string, StagingDocument>; // Key: `${documentType}-${documentName}`\r\n  loadedEmployees: Set<string>; // Track which employees have been loaded\r\n  initialized: boolean;\r\n  \r\n  // Staging operations (for new employees)\r\n  updateStagingDocument: (documentType: string, documentName: string, files: StagingFile[], sessionId: string) => void;\r\n  getStagingDocument: (documentType: string, documentName: string) => StagingDocument | undefined;\r\n  clearStagingDocuments: () => void;\r\n  confirmAllStagingDocuments: (\r\n    employeeSystemId: string,\r\n    employeeData?: {\r\n      name?: string;\r\n      department?: string;\r\n      [key: string]: any;\r\n    }\r\n  ) => Promise<void>;\r\n  \r\n  // Upload files th√¥ng qua API (existing employees)\r\n  uploadFiles: (\r\n    employeeSystemId: string,\r\n    documentType: string,\r\n    documentName: string,\r\n    files: File[]\r\n  ) => Promise<void>;\r\n  \r\n  // Get documents (t·ª´ server n·∫øu c·∫ßn)\r\n  getDocuments: (employeeSystemId: string, documentType?: string) => EmployeeDocument[];\r\n  refreshDocuments: (employeeSystemId: string, force?: boolean) => Promise<void>;\r\n  \r\n  // Get single document\r\n  getDocument: (id: string) => EmployeeDocument | undefined;\r\n  \r\n  // Update files cho document (sau khi upload)\r\n  updateDocumentFiles: (\r\n    employeeSystemId: string, \r\n    documentType: string, \r\n    documentName: string, \r\n    files: ServerFile[]\r\n  ) => void;\r\n  \r\n  // Delete document (v√† files tr√™n server)\r\n  deleteDocument: (id: string) => Promise<void>;\r\n  deleteEmployeeDocuments: (employeeSystemId: string) => Promise<void>;\r\n  \r\n  // Storage info\r\n  getStorageInfo: () => Promise<{ totalFiles: number; totalSizeMB: number }>;\r\n  \r\n  // API sync\r\n  loadFromAPI: () => Promise<void>;\r\n};\r\n\r\nexport const useDocumentStore = create<DocumentStore>()(\r\n  (set, get) => ({\r\n      documents: [],\r\n      stagingDocuments: {},\r\n      loadedEmployees: new Set<string>(),\r\n      initialized: false,\r\n      \r\n      // Staging operations\r\n      updateStagingDocument: (documentType, documentName, files, sessionId) => {\r\n        const key = `${documentType}-${documentName}`;\r\n        set(state => ({\r\n          stagingDocuments: {\r\n            ...state.stagingDocuments,\r\n            [key]: {\r\n              documentType,\r\n              documentName,\r\n              files,\r\n              sessionId\r\n            }\r\n          }\r\n        }));\r\n      },\r\n      \r\n      getStagingDocument: (documentType, documentName) => {\r\n        const key = `${documentType}-${documentName}`;\r\n        return get().stagingDocuments[key];\r\n      },\r\n      \r\n      clearStagingDocuments: () => {\r\n        set({ stagingDocuments: {} });\r\n      },\r\n      \r\n      confirmAllStagingDocuments: async (employeeSystemId, employeeData) => {\r\n        const stagingDocs = get().stagingDocuments;\r\n        \r\n        try {\r\n          for (const [key, stagingDoc] of Object.entries(stagingDocs)) {\r\n            if (stagingDoc.files.length > 0) {\r\n              // Confirm staging files ‚Üí permanent v·ªõi smart filename\r\n              const confirmedFiles = await FileUploadAPI.confirmStagingFiles(\r\n                stagingDoc.sessionId,\r\n                employeeSystemId,\r\n                stagingDoc.documentType,\r\n                stagingDoc.documentName,\r\n                employeeData // G·ª≠i employee data ƒë·ªÉ t·∫°o smart filename\r\n              );\r\n              \r\n              // Update local documents v·ªõi confirmed files\r\n              get().updateDocumentFiles(\r\n                employeeSystemId,\r\n                stagingDoc.documentType,\r\n                stagingDoc.documentName,\r\n                confirmedFiles\r\n              );\r\n            }\r\n          }\r\n          \r\n          // Clear staging sau khi confirm\r\n          get().clearStagingDocuments();\r\n          \r\n        } catch (error) {\r\n\r\n          throw error;\r\n        }\r\n      },\r\n      \r\n      // Upload files l√™n server (for existing employees)\r\n      uploadFiles: async (employeeSystemId, documentType, documentName, files) => {\r\n        try {\r\n          const uploadedFiles = await FileUploadAPI.uploadFiles(\r\n            employeeSystemId,\r\n            documentType,\r\n            documentName,\r\n            files\r\n          );\r\n          \r\n          // C·∫≠p nh·∫≠t local store v·ªõi files ƒë√£ upload\r\n          get().updateDocumentFiles(employeeSystemId, documentType, documentName, uploadedFiles);\r\n        } catch (error) {\r\n\r\n          throw error;\r\n        }\r\n      },\r\n      \r\n      // Refresh documents t·ª´ server\r\n      refreshDocuments: async (employeeSystemId, force = false) => {\r\n        const state = get();\r\n        \r\n        // ‚úÖ OPTIMIZATION: Check cache FIRST - return immediately if already loaded (unless forced)\r\n        if (!force && state.loadedEmployees.has(employeeSystemId)) {\r\n\r\n          return;\r\n        }\r\n        \r\n        if (force) {\r\n\r\n          // Clear cache for this employee\r\n          set(state => {\r\n            const newLoadedEmployees = new Set(state.loadedEmployees);\r\n            newLoadedEmployees.delete(employeeSystemId);\r\n            return {\r\n              loadedEmployees: newLoadedEmployees,\r\n              // Also clear old documents for this employee\r\n              documents: state.documents.filter(doc => doc.employeeSystemId !== employeeSystemId)\r\n            };\r\n          });\r\n        } else {\r\n\r\n        }\r\n        \r\n        try {\r\n          const serverFiles = await FileUploadAPI.getFiles(employeeSystemId);\r\n          \r\n          // If no files, just mark as loaded and return\r\n          if (serverFiles.length === 0) {\r\n\r\n            set(state => ({\r\n              loadedEmployees: new Set([...state.loadedEmployees, employeeSystemId])\r\n            }));\r\n            return;\r\n          }\r\n          \r\n          // Group files theo documentType v√† documentName\r\n          const documentsMap = new Map<string, EmployeeDocument>();\r\n          \r\n          serverFiles.forEach(file => {\r\n            const key = `${file.documentType}-${file.documentName}`;\r\n            \r\n            if (documentsMap.has(key)) {\r\n              documentsMap.get(key)!.files.push(file);\r\n            } else {\r\n              documentsMap.set(key, {\r\n                id: `doc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n                employeeSystemId: file.employeeId,\r\n                documentType: file.documentType,\r\n                documentName: file.documentName,\r\n                files: [file],\r\n                createdAt: file.uploadedAt,\r\n                updatedAt: file.confirmedAt || file.uploadedAt,\r\n              });\r\n            }\r\n          });\r\n          \r\n          // C·∫≠p nh·∫≠t store v·ªõi documents t·ª´ server\r\n          const serverDocuments = Array.from(documentsMap.values());\r\n          set(state => ({\r\n            documents: [\r\n              ...state.documents.filter(d => d.employeeSystemId !== employeeSystemId),\r\n              ...serverDocuments\r\n            ],\r\n            loadedEmployees: new Set([...state.loadedEmployees, employeeSystemId])\r\n          }));\r\n        } catch (error) {\r\n\r\n          throw error;\r\n        }\r\n      },\r\n      \r\n      getDocuments: (employeeSystemId: string, documentType?: string) => {\r\n        const docs = get().documents.filter(d => d.employeeSystemId === employeeSystemId);\r\n        if (documentType) {\r\n          return docs.filter(d => d.documentType === documentType);\r\n        }\r\n        return docs;\r\n      },\r\n      \r\n      getDocument: (id: string) => {\r\n        return get().documents.find(d => d.id === id);\r\n      },\r\n      \r\n      updateDocumentFiles: (employeeSystemId, documentType, documentName, files) => {\r\n        const existing = get().documents.find(\r\n          d => d.employeeSystemId === employeeSystemId && \r\n               d.documentType === documentType && \r\n               d.documentName === documentName\r\n        );\r\n        \r\n        if (existing) {\r\n          set(state => ({\r\n            documents: state.documents.map(d =>\r\n              d.id === existing.id\r\n                ? { ...d, files, updatedAt: new Date().toISOString() }\r\n                : d\r\n            ),\r\n          }));\r\n        } else {\r\n          const newDoc: EmployeeDocument = {\r\n            id: `doc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n            employeeSystemId,\r\n            documentType,\r\n            documentName,\r\n            files,\r\n            createdAt: new Date().toISOString(),\r\n            updatedAt: new Date().toISOString(),\r\n          };\r\n          set(state => ({ documents: [...state.documents, newDoc] }));\r\n        }\r\n      },\r\n      \r\n      deleteDocument: async (id: string) => {\r\n        const doc = get().getDocument(id);\r\n        if (doc) {\r\n          // X√≥a t·∫•t c·∫£ files tr√™n server\r\n          try {\r\n            for (const file of doc.files) {\r\n              await FileUploadAPI.deleteFile(file.id);\r\n            }\r\n          } catch (error) {\r\n\r\n          }\r\n          \r\n          // X√≥a document kh·ªèi local store\r\n          set(state => ({\r\n            documents: state.documents.filter(d => d.id !== id),\r\n          }));\r\n        }\r\n      },\r\n      \r\n      deleteEmployeeDocuments: async (employeeSystemId: string) => {\r\n        const docs = get().getDocuments(employeeSystemId);\r\n        \r\n        // X√≥a t·∫•t c·∫£ files tr√™n server\r\n        try {\r\n          for (const doc of docs) {\r\n            for (const file of doc.files) {\r\n              await FileUploadAPI.deleteFile(file.id);\r\n            }\r\n          }\r\n        } catch (error) {\r\n\r\n        }\r\n        \r\n        // X√≥a kh·ªèi local store\r\n        set(state => ({\r\n          documents: state.documents.filter(d => d.employeeSystemId !== employeeSystemId),\r\n        }));\r\n      },\r\n      \r\n      getStorageInfo: async () => {\r\n        try {\r\n          const stats = await FileUploadAPI.getStorageInfo();\r\n          return {\r\n            totalFiles: stats.totalFiles,\r\n            totalSizeMB: stats.totalSizeMB\r\n          };\r\n        } catch (error) {\r\n\r\n          return { totalFiles: 0, totalSizeMB: 0 };\r\n        }\r\n      },\r\n      \r\n      // Load documents t·ª´ database\r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Use React Query hooks for paginated document lists\r\n          const response = await fetch('/api/employee-documents?limit=100');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const documents = json.data || json.documents || [];\r\n            set({ \r\n              documents, \r\n              initialized: true,\r\n              loadedEmployees: new Set(documents.map((d: EmployeeDocument) => d.employeeSystemId))\r\n            });\r\n          }\r\n        } catch (error) {\r\n          console.error('[Document Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 688, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/employee-documents.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { formatDate } from '@/lib/date-utils';\r\nimport { getBaseUrl, getFileUrl } from '../../lib/api-config';\r\nimport { useDocumentStore } from './document-store';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '../../components/ui/card';\r\nimport { Button } from '../../components/ui/button';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Input } from '../../components/ui/input';\r\nimport { ProgressiveImage } from '../../components/ui/progressive-image';\r\nimport { Dialog, DialogContent, DialogTitle } from '../../components/ui/dialog';\r\nimport { VisuallyHidden } from '@radix-ui/react-visually-hidden';\r\nimport { \r\n  Download, \r\n  Eye, \r\n  File, \r\n  FileText, \r\n  Image,\r\n  Calendar,\r\n  FolderOpen,\r\n  Search,\r\n  Copy,\r\n  Archive,\r\n  X\r\n} from 'lucide-react';\r\nimport type { EmployeeDocument, ServerFile } from './document-store';\r\nimport JSZip from 'jszip';\r\nimport { saveAs } from 'file-saver';\r\n\r\nconst formatFileSize = (bytes: number) => {\r\n  if (bytes === 0) return '0 Bytes';\r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n};\r\n\r\nconst getFileIcon = (type: string) => {\r\n  if (type.startsWith('image/')) return Image;\r\n  if (type === 'application/pdf') return FileText;\r\n  return File;\r\n};\r\n\r\nconst documentTypeLabels: Record<string, string> = {\r\n  'legal': 'Gi·∫•y t·ªù ph√°p l√Ω',\r\n  'work-process': 'H·ªì s∆° c√¥ng vi·ªác',\r\n  'termination': 'H·ªì s∆° ngh·ªâ vi·ªác',\r\n  'decisions': 'Quy·∫øt ƒë·ªãnh',\r\n  'kpi': 'ƒê√°nh gi√° KPI',\r\n  'requests': 'ƒê∆°n t·ª´'\r\n};\r\n\r\ninterface EmployeeDocumentsProps {\r\n  employeeSystemId: string;\r\n}\r\n\r\nexport function EmployeeDocuments({ employeeSystemId }: EmployeeDocumentsProps) {\r\n  const { documents, refreshDocuments, loadedEmployees } = useDocumentStore();\r\n  const [searchQuery, setSearchQuery] = React.useState('');\r\n  const [isLoading, setIsLoading] = React.useState(false);\r\n  const [error, setError] = React.useState<string | null>(null);\r\n  \r\n  // Preview modal state - React-based instead of DOM manipulation (fixes memory leak)\r\n  const [previewFile, setPreviewFile] = React.useState<ServerFile | null>(null);\r\n  const [isPreviewOpen, setIsPreviewOpen] = React.useState(false);\r\n  \r\n  // Check if data is already cached\r\n  const isCached = loadedEmployees.has(employeeSystemId);\r\n\r\n  // Get documents for this employee\r\n  const employeeDocuments = React.useMemo(() => {\r\n    const filtered = documents.filter(doc => doc.employeeSystemId === employeeSystemId);\r\n    \r\n    if (!searchQuery) return filtered;\r\n    \r\n    return filtered.filter(doc => \r\n      doc.documentName.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      doc.files.some(file => file.name.toLowerCase().includes(searchQuery.toLowerCase()))\r\n    );\r\n  }, [documents, employeeSystemId, searchQuery]);\r\n\r\n  // Group documents by type\r\n  const documentsByType = React.useMemo(() => {\r\n    const grouped: Record<string, EmployeeDocument[]> = {};\r\n    employeeDocuments.forEach(doc => {\r\n      if (!grouped[doc.documentType]) {\r\n        grouped[doc.documentType] = [];\r\n      }\r\n      grouped[doc.documentType].push(doc);\r\n    });\r\n    return grouped;\r\n  }, [employeeDocuments]);\r\n\r\n  // Group documents by name within each type (for grid layout)\r\n  const documentsByName = React.useMemo(() => {\r\n    const result: Record<string, Record<string, EmployeeDocument>> = {\r\n      'legal': {},\r\n      'work-process': {},\r\n      'termination': {}\r\n    };\r\n    \r\n    employeeDocuments.forEach(doc => {\r\n      if (result[doc.documentType]) {\r\n        result[doc.documentType][doc.documentName] = doc;\r\n      }\r\n    });\r\n    \r\n    return result;\r\n  }, [employeeDocuments]);\r\n\r\n  // Load documents only once (store handles cache)\r\n  React.useEffect(() => {\r\n    if (employeeSystemId) {\r\n      const { loadedEmployees } = useDocumentStore.getState();\r\n      \r\n      // Skip loading if already in cache\r\n      if (loadedEmployees.has(employeeSystemId)) {\r\n        console.log('‚úÖ Documents already cached for:', employeeSystemId);\r\n        return;\r\n      }\r\n      \r\n      console.log('üîÑ Loading documents for:', employeeSystemId);\r\n      setIsLoading(true);\r\n      setError(null);\r\n      refreshDocuments(employeeSystemId)\r\n        .catch((err) => {\r\n          console.error('Failed to load documents:', err);\r\n          setError('Kh√¥ng th·ªÉ t·∫£i t√†i li·ªáu. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi server.');\r\n        })\r\n        .finally(() => setIsLoading(false));\r\n    }\r\n  }, [employeeSystemId, refreshDocuments]);\r\n\r\n  const handleDownload = async (file: ServerFile) => {\r\n    try {\r\n      const downloadUrl = getFileUrl(file.url);\r\n      \r\n      // Fetch file as blob to force download\r\n      const response = await fetch(downloadUrl);\r\n      const blob = await response.blob();\r\n      \r\n      // Create download link\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = file.originalName || file.name || file.filename;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n\r\n      // Cleanup\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (error) {\r\n      console.error('Download failed:', error);\r\n      alert('Kh√¥ng th·ªÉ t·∫£i file. Vui l√≤ng th·ª≠ l·∫°i.');\r\n    }\r\n  };\r\n\r\n  const handleCopy = async (text: string) => {\r\n    try {\r\n      await navigator.clipboard.writeText(text);\r\n      // Toast notification would be nice here\r\n      console.log('Copied to clipboard:', text);\r\n    } catch (err) {\r\n      console.error('Failed to copy:', err);\r\n    }\r\n  };\r\n\r\n  const handleDownloadAll = async (documentType: string, docs: EmployeeDocument[]) => {\r\n    try {\r\n      const zip = new JSZip();\r\n      const baseUrl = getBaseUrl();\r\n      \r\n      // Create folder for each document\r\n      for (const doc of docs) {\r\n        const folderName = doc.documentName.replace(/[^a-zA-Z0-9]/g, '_');\r\n        const folder = zip.folder(folderName);\r\n        \r\n        if (folder) {\r\n          // Download each file and add to ZIP\r\n          for (const file of doc.files) {\r\n            try {\r\n              const downloadUrl = getFileUrl(file.url);\r\n              const response = await fetch(downloadUrl);\r\n              const blob = await response.blob();\r\n              folder.file(file.originalName || file.name, blob);\r\n            } catch (error) {\r\n              console.error('Failed to download file:', file.name, error);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Generate ZIP and download\r\n      const content = await zip.generateAsync({ type: 'blob' });\r\n      const typeLabel = documentTypeLabels[documentType] || documentType;\r\n      saveAs(content, `${typeLabel}_${new Date().toISOString().split('T')[0]}.zip`);\r\n      \r\n      console.log('Downloaded all files as ZIP');\r\n    } catch (error) {\r\n      console.error('Failed to create ZIP:', error);\r\n      alert('Kh√¥ng th·ªÉ t·∫£i xu·ªëng t·∫•t c·∫£ files. Vui l√≤ng th·ª≠ l·∫°i.');\r\n    }\r\n  };\r\n\r\n  const handlePreview = (file: ServerFile) => {\r\n    // Use React state instead of DOM manipulation to prevent memory leaks\r\n    setPreviewFile(file);\r\n    setIsPreviewOpen(true);\r\n  };\r\n  \r\n  const handleClosePreview = () => {\r\n    setIsPreviewOpen(false);\r\n    setPreviewFile(null);\r\n  };\r\n\r\n  if (isLoading && !isCached) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center p-8\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent\"></div>\r\n            <p className=\"text-sm text-muted-foreground\">ƒêang t·∫£i t√†i li·ªáu...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n  \r\n  if (error) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-8 text-center\">\r\n          <div className=\"text-destructive mb-4\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-12 w-12 mx-auto mb-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n            </svg>\r\n            <h3 className=\"text-h5 font-medium mb-2\">Kh√¥ng th·ªÉ t·∫£i t√†i li·ªáu</h3>\r\n            <p className=\"text-sm text-muted-foreground mb-4\">{error}</p>\r\n            <Button \r\n              variant=\"outline\" \r\n              size=\"sm\"\r\n              onClick={() => {\r\n                setError(null);\r\n                setIsLoading(true);\r\n                refreshDocuments(employeeSystemId).finally(() => setIsLoading(false));\r\n              }}\r\n            >\r\n              Th·ª≠ l·∫°i\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (Object.keys(documentsByType).length === 0) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-8 text-center\">\r\n          <FolderOpen className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n          <h3 className=\"text-h5 font-medium mb-2\">Ch∆∞a c√≥ t√†i li·ªáu</h3>\r\n          <p className=\"text-muted-foreground\">\r\n            Nh√¢n vi√™n n√†y ch∆∞a c√≥ t√†i li·ªáu n√†o ƒë∆∞·ª£c upload.\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Search Box */}\r\n      {/* Header with Search */}\r\n      <div className=\"flex flex-col sm:flex-row justify-between gap-4 mb-6\">\r\n        <h3 className=\"text-h4 font-semibold flex items-center gap-2\">\r\n          <FolderOpen className=\"h-5 w-5\" />\r\n          T√†i li·ªáu nh√¢n vi√™n\r\n        </h3>\r\n        <div className=\"relative w-full sm:w-72\">\r\n          <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n          <Input\r\n            placeholder=\"T√¨m ki·∫øm t√†i li·ªáu...\"\r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            className=\"pl-9\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {isLoading ? (\r\n        <div className=\"flex items-center justify-center p-8\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n          <span className=\"ml-2 text-muted-foreground\">ƒêang t·∫£i t√†i li·ªáu...</span>\r\n        </div>\r\n      ) : employeeDocuments.length === 0 ? (\r\n        <Card>\r\n          <CardContent className=\"py-8\">\r\n            <div className=\"text-center text-muted-foreground\">\r\n              <FolderOpen className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\r\n              {searchQuery ? 'Kh√¥ng t√¨m th·∫•y t√†i li·ªáu ph√π h·ª£p' : 'Ch∆∞a c√≥ t√†i li·ªáu n√†o'}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      ) : (\r\n        <div className=\"space-y-6\">\r\n          {/* 1. T√†i li·ªáu ph√°p l√Ω */}\r\n          {Object.keys(documentsByName['legal']).length > 0 && (\r\n            <Card className=\"border-l-4 border-l-blue-500\">\r\n              <CardHeader className=\"pb-3\">\r\n                <CardTitle className=\"text-h6 text-primary\">1. T√†i li·ªáu ph√°p l√Ω</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {Object.entries(documentsByName['legal']).map(([docName, doc]) => (\r\n                    <div key={doc.id} className=\"space-y-3 p-3 border rounded-lg bg-muted/30\">\r\n                      <h5 className=\"text-sm font-medium text-foreground\">{docName}</h5>\r\n                      <div className=\"grid grid-cols-3 gap-2\">\r\n                        {doc.files.map((file) => {\r\n                          const FileIcon = getFileIcon(file.type);\r\n                          const isImage = file.type.startsWith('image/');\r\n                          \r\n                          return (\r\n                            <div \r\n                              key={file.id} \r\n                              className=\"border rounded-lg p-2 bg-background hover:bg-muted/50 transition-colors\"\r\n                            >\r\n                              <div className=\"flex flex-col gap-2\">\r\n                                <div className=\"w-full aspect-square rounded bg-muted flex items-center justify-center overflow-hidden\">\r\n                                  {isImage ? (\r\n                                    <img \r\n                                      src={getFileUrl(file.url)} \r\n                                      alt={file.name}\r\n                                      className=\"w-full h-full object-cover cursor-pointer\"\r\n                                      onClick={() => handlePreview(file)}\r\n                                      onError={(e) => {\r\n                                        e.currentTarget.style.display = 'none';\r\n                                        e.currentTarget.nextElementSibling?.classList.remove('hidden');\r\n                                      }}\r\n                                    />\r\n                                  ) : null}\r\n                                  <FileIcon className={`w-12 h-12 text-muted-foreground ${isImage ? 'hidden' : ''}`} />\r\n                                </div>\r\n                                <div className=\"space-y-0.5\">\r\n                                  <p className=\"font-medium text-xs truncate\" title={file.name}>\r\n                                    {file.originalName || file.name}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-muted-foreground\">\r\n                                    {formatFileSize(file.size)}\r\n                                  </p>\r\n                                </div>\r\n                                <div className=\"flex gap-1\">\r\n                                  <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handleDownload(file)}>\r\n                                    <Download className=\"h-3.5 w-3.5\" />\r\n                                  </Button>\r\n                                  {isImage && (\r\n                                    <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handlePreview(file)}>\r\n                                      <Eye className=\"h-3.5 w-3.5\" />\r\n                                    </Button>\r\n                                  )}\r\n                                  <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handleCopy(file.originalName || file.name)}>\r\n                                    <Copy className=\"h-3.5 w-3.5\" />\r\n                                  </Button>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* 2. T√†i li·ªáu trong qu√° tr√¨nh l√†m vi·ªác */}\r\n          {Object.keys(documentsByName['work-process']).length > 0 && (\r\n            <Card className=\"border-l-4 border-l-green-500\">\r\n              <CardHeader className=\"pb-3\">\r\n                <CardTitle className=\"text-h6 text-primary\">2. T√†i li·ªáu trong qu√° tr√¨nh l√†m vi·ªác</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {Object.entries(documentsByName['work-process']).map(([docName, doc]) => (\r\n                    <div key={doc.id} className=\"space-y-3 p-3 border rounded-lg bg-muted/30\">\r\n                      <h5 className=\"text-sm font-medium text-foreground\">{docName}</h5>\r\n                      <div className=\"grid grid-cols-3 gap-2\">\r\n                        {doc.files.map((file) => {\r\n                          const FileIcon = getFileIcon(file.type);\r\n                          const isImage = file.type.startsWith('image/');\r\n                          \r\n                          return (\r\n                            <div \r\n                              key={file.id} \r\n                              className=\"border rounded-lg p-2 bg-background hover:bg-muted/50 transition-colors\"\r\n                            >\r\n                              <div className=\"flex flex-col gap-2\">\r\n                                <div className=\"w-full aspect-square rounded bg-muted flex items-center justify-center overflow-hidden\">\r\n                                  {isImage ? (\r\n                                    <img \r\n                                      src={getFileUrl(file.url)} \r\n                                      alt={file.name}\r\n                                      className=\"w-full h-full object-cover cursor-pointer\"\r\n                                      onClick={() => handlePreview(file)}\r\n                                      onError={(e) => {\r\n                                        e.currentTarget.style.display = 'none';\r\n                                        e.currentTarget.nextElementSibling?.classList.remove('hidden');\r\n                                      }}\r\n                                    />\r\n                                  ) : null}\r\n                                  <FileIcon className={`w-12 h-12 text-muted-foreground ${isImage ? 'hidden' : ''}`} />\r\n                                </div>\r\n                                <div className=\"space-y-0.5\">\r\n                                  <p className=\"font-medium text-xs truncate\" title={file.name}>\r\n                                    {file.originalName || file.name}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-muted-foreground\">\r\n                                    {formatFileSize(file.size)}\r\n                                  </p>\r\n                                </div>\r\n                                <div className=\"flex gap-1\">\r\n                                  <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handleDownload(file)}>\r\n                                    <Download className=\"h-3.5 w-3.5\" />\r\n                                  </Button>\r\n                                  {isImage && (\r\n                                    <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handlePreview(file)}>\r\n                                      <Eye className=\"h-3.5 w-3.5\" />\r\n                                    </Button>\r\n                                  )}\r\n                                  <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handleCopy(file.originalName || file.name)}>\r\n                                    <Copy className=\"h-3.5 w-3.5\" />\r\n                                  </Button>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* 3. T√†i li·ªáu khi ngh·ªâ vi·ªác */}\r\n          {Object.keys(documentsByName['termination']).length > 0 && (\r\n            <Card className=\"border-l-4 border-l-red-500\">\r\n              <CardHeader className=\"pb-3\">\r\n                <CardTitle className=\"text-h6 text-primary\">3. T√†i li·ªáu khi ngh·ªâ vi·ªác</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {Object.entries(documentsByName['termination']).map(([docName, doc]) => (\r\n                    <div key={doc.id} className=\"space-y-3 p-3 border rounded-lg bg-muted/30\">\r\n                      <h5 className=\"text-sm font-medium text-foreground\">{docName}</h5>\r\n                      <div className=\"grid grid-cols-3 gap-2\">\r\n                        {doc.files.map((file) => {\r\n                          const FileIcon = getFileIcon(file.type);\r\n                          const isImage = file.type.startsWith('image/');\r\n                          \r\n                          return (\r\n                            <div \r\n                              key={file.id} \r\n                              className=\"border rounded-lg p-2 bg-background hover:bg-muted/50 transition-colors\"\r\n                            >\r\n                              <div className=\"flex flex-col gap-2\">\r\n                                <div className=\"w-full aspect-square rounded bg-muted flex items-center justify-center overflow-hidden\">\r\n                                  {isImage ? (\r\n                                    <img \r\n                                      src={getFileUrl(file.url)} \r\n                                      alt={file.name}\r\n                                      className=\"w-full h-full object-cover cursor-pointer\"\r\n                                      onClick={() => handlePreview(file)}\r\n                                      onError={(e) => {\r\n                                        e.currentTarget.style.display = 'none';\r\n                                        e.currentTarget.nextElementSibling?.classList.remove('hidden');\r\n                                      }}\r\n                                    />\r\n                                  ) : null}\r\n                                  <FileIcon className={`w-12 h-12 text-muted-foreground ${isImage ? 'hidden' : ''}`} />\r\n                                </div>\r\n                                <div className=\"space-y-0.5\">\r\n                                  <p className=\"font-medium text-xs truncate\" title={file.name}>\r\n                                    {file.originalName || file.name}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-muted-foreground\">\r\n                                    {formatFileSize(file.size)}\r\n                                  </p>\r\n                                </div>\r\n                                <div className=\"flex gap-1\">\r\n                                  <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handleDownload(file)}>\r\n                                    <Download className=\"h-3.5 w-3.5\" />\r\n                                  </Button>\r\n                                  {isImage && (\r\n                                    <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handlePreview(file)}>\r\n                                      <Eye className=\"h-3.5 w-3.5\" />\r\n                                    </Button>\r\n                                  )}\r\n                                  <Button size=\"sm\" variant=\"ghost\" className=\"flex-1 h-7 px-1\" onClick={() => handleCopy(file.originalName || file.name)}>\r\n                                    <Copy className=\"h-3.5 w-3.5\" />\r\n                                  </Button>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </div>\r\n      )}\r\n      \r\n      {/* Image Preview Modal - React-based to prevent memory leaks */}\r\n      <Dialog open={isPreviewOpen} onOpenChange={setIsPreviewOpen}>\r\n        <DialogContent \r\n          className=\"max-w-[90vw] max-h-[90vh] p-0 overflow-hidden bg-black/95 border-0\"\r\n          onClick={handleClosePreview}\r\n        >\r\n          <VisuallyHidden>\r\n            <DialogTitle>\r\n              {previewFile?.originalName || previewFile?.name || 'Xem tr∆∞·ªõc ·∫£nh'}\r\n            </DialogTitle>\r\n          </VisuallyHidden>\r\n          \r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            className=\"absolute top-4 right-4 z-10 bg-white hover:bg-gray-100 rounded-full w-10 h-10 shadow-lg\"\r\n            onClick={handleClosePreview}\r\n          >\r\n            <X className=\"h-6 w-6\" />\r\n          </Button>\r\n          \r\n          {previewFile && (\r\n            <div \r\n              className=\"flex items-center justify-center w-full h-full min-h-[50vh]\"\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <img\r\n                src={getFileUrl(previewFile.url)}\r\n                alt={previewFile.originalName || previewFile.name}\r\n                className=\"max-w-full max-h-[85vh] object-contain rounded-lg\"\r\n              />\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1829, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/api/employees-api.ts"],"sourcesContent":["/**\r\n * Employees API - Isolated API functions\r\n * \r\n * ‚ö†Ô∏è IMPORTANT: This file should ONLY contain:\r\n * - Fetch functions\r\n * - Type imports from ../types\r\n * - NO store imports\r\n * - NO cross-feature imports\r\n */\r\n\r\nimport type { Employee } from '../types';\r\n\r\nconst API_BASE = '/api/employees';\r\n\r\nexport interface EmployeesParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  departmentId?: string;\r\n  branchId?: string;\r\n  jobTitleId?: string;\r\n  status?: string;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface PaginatedResponse<T> {\r\n  data: T[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface CreateEmployeeInput {\r\n  fullName: string;\r\n  email?: string;\r\n  phone?: string;\r\n  departmentId?: string;\r\n  branchId?: string;\r\n  jobTitleId?: string;\r\n  hireDate?: string;\r\n  // Optional fields for updates\r\n  isDeleted?: boolean;\r\n  employmentStatus?: string;\r\n}\r\n\r\nexport interface UpdateEmployeeInput extends Partial<CreateEmployeeInput> {\r\n  systemId: string;\r\n}\r\n\r\n/**\r\n * Fetch paginated employees list\r\n */\r\nexport async function fetchEmployees(params: EmployeesParams = {}): Promise<PaginatedResponse<Employee>> {\r\n  const { page = 1, limit = 50, ...rest } = params;\r\n  \r\n  const searchParams = new URLSearchParams({\r\n    page: String(page),\r\n    limit: String(limit),\r\n  });\r\n  \r\n  // Add optional params\r\n  Object.entries(rest).forEach(([key, value]) => {\r\n    if (value != null && value !== '') {\r\n      searchParams.set(key, String(value));\r\n    }\r\n  });\r\n  \r\n  const res = await fetch(`${API_BASE}?${searchParams}`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employees: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Fetch single employee by ID\r\n */\r\nexport async function fetchEmployee(id: string): Promise<Employee> {\r\n  const res = await fetch(`${API_BASE}/${id}`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employee ${id}: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Create new employee\r\n */\r\nexport async function createEmployee(data: CreateEmployeeInput): Promise<Employee> {\r\n  const res = await fetch(API_BASE, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    credentials: 'include',\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({}));\r\n    throw new Error(error.message || `Failed to create employee: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Update existing employee\r\n */\r\nexport async function updateEmployee({ systemId, ...data }: UpdateEmployeeInput): Promise<Employee> {\r\n  const res = await fetch(`${API_BASE}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    credentials: 'include',\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({}));\r\n    throw new Error(error.message || `Failed to update employee: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Delete employee (soft delete)\r\n */\r\nexport async function deleteEmployee(id: string): Promise<void> {\r\n  const res = await fetch(`${API_BASE}/${id}`, {\r\n    method: 'DELETE',\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({}));\r\n    throw new Error(error.message || `Failed to delete employee: ${res.statusText}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Search employees for autocomplete\r\n */\r\nexport async function searchEmployees(query: string, limit = 20): Promise<Employee[]> {\r\n  const res = await fetch(`${API_BASE}?search=${encodeURIComponent(query)}&limit=${limit}`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to search employees: ${res.statusText}`);\r\n  }\r\n  \r\n  const json = await res.json();\r\n  return json.data || [];\r\n}\r\n\r\n/**\r\n * Fetch employees by department\r\n */\r\nexport async function fetchEmployeesByDepartment(departmentId: string): Promise<Employee[]> {\r\n  const res = await fetch(`${API_BASE}?departmentId=${departmentId}&limit=100`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employees by department: ${res.statusText}`);\r\n  }\r\n  \r\n  const json = await res.json();\r\n  return json.data || [];\r\n}\r\n\r\n/**\r\n * Fetch employees by branch\r\n */\r\nexport async function fetchEmployeesByBranch(branchId: string): Promise<Employee[]> {\r\n  const res = await fetch(`${API_BASE}?branchId=${branchId}&limit=100`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employees by branch: ${res.statusText}`);\r\n  }\r\n  \r\n  const json = await res.json();\r\n  return json.data || [];\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1959, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/hooks/use-all-employees.ts"],"sourcesContent":["/**\r\n * useAllEmployees - Convenience hook for components needing all employees as flat array\r\n * \r\n * Use case: Dropdowns, selects, comboboxes that need all employees for selection\r\n * \r\n * ‚ö†Ô∏è For paginated views, use useEmployees() instead\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useEmployees } from './use-employees';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n/**\r\n * Returns all employees as a flat array\r\n * Compatible with legacy store pattern: { data: employees }\r\n */\r\nexport function useAllEmployees() {\r\n  const query = useEmployees({ limit: 30 });\r\n  \r\n  return {\r\n    data: query.data?.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns employees formatted as options for Select/Combobox\r\n */\r\nexport function useEmployeeOptions() {\r\n  const { data, isLoading } = useAllEmployees();\r\n  \r\n  const options = data.map(e => ({\r\n    value: e.systemId,\r\n    label: e.fullName,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Helper hook to find an employee by ID from cached data\r\n * Replaces legacy findById() method\r\n */\r\nexport function useEmployeeFinder() {\r\n  const { data } = useAllEmployees();\r\n  \r\n  const findById = React.useCallback(\r\n    (systemId: SystemId | string | undefined) => {\r\n      if (!systemId) return undefined;\r\n      return data.find(e => e.systemId === systemId);\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { findById };\r\n}\r\n\r\n/**\r\n * Helper hook for searching employees (for Combobox async search)\r\n * Returns a search function that filters cached employees\r\n */\r\nexport function useEmployeeSearcher() {\r\n  const { data } = useAllEmployees();\r\n  \r\n  const searchEmployees = React.useCallback(\r\n    async (query: string, _page = 0, limit = 100) => {\r\n      const lowerQuery = query.toLowerCase();\r\n      const filtered = data.filter(e => \r\n        e.fullName?.toLowerCase().includes(lowerQuery) ||\r\n        e.id?.toLowerCase().includes(lowerQuery) ||\r\n        e.phone?.includes(query)\r\n      );\r\n      \r\n      return {\r\n        items: filtered.slice(0, limit).map(e => ({\r\n          value: e.systemId,\r\n          label: e.fullName || e.id || 'N/A',\r\n        })),\r\n        total: filtered.length,\r\n      };\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { searchEmployees };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;CAMC,GAED;AACA;;;AAOO,SAAS;IACd,MAAM,QAAQ,IAAA,kLAAY,EAAC;QAAE,OAAO;IAAG;IAEvC,OAAO;QACL,MAAM,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC5B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,QAAQ;QACnB,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;AAMO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,oNAAiB,CAChC,CAAC;QACC,IAAI,CAAC,UAAU,OAAO;QACtB,OAAO,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;IACvC,GACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAS;AACpB;AAMO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,kBAAkB,oNAAiB,CACvC,OAAO,OAAe,QAAQ,CAAC,EAAE,QAAQ,GAAG;QAC1C,MAAM,aAAa,MAAM,WAAW;QACpC,MAAM,WAAW,KAAK,MAAM,CAAC,CAAA,IAC3B,EAAE,QAAQ,EAAE,cAAc,SAAS,eACnC,EAAE,EAAE,EAAE,cAAc,SAAS,eAC7B,EAAE,KAAK,EAAE,SAAS;QAGpB,OAAO;YACL,OAAO,SAAS,KAAK,CAAC,GAAG,OAAO,GAAG,CAAC,CAAA,IAAK,CAAC;oBACxC,OAAO,EAAE,QAAQ;oBACjB,OAAO,EAAE,QAAQ,IAAI,EAAE,EAAE,IAAI;gBAC/B,CAAC;YACD,OAAO,SAAS,MAAM;QACxB;IACF,GACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAgB;AAC3B"}},
    {"offset": {"line": 2036, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/hooks/use-employees.ts"],"sourcesContent":["/**\r\n * useEmployees - React Query hooks for employees\r\n * \r\n * ‚ö†Ô∏è IMPORTANT: Direct import pattern\r\n * - Import this file directly: import { useEmployees } from '@/features/employees/hooks/use-employees'\r\n * - NEVER import from '@/features/employees' or '@/features/employees/store'\r\n * \r\n * This hook is ISOLATED - it only depends on:\r\n * - @tanstack/react-query\r\n * - Local API functions\r\n * - Local types\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchEmployees,\r\n  fetchEmployee,\r\n  createEmployee,\r\n  updateEmployee,\r\n  deleteEmployee,\r\n  searchEmployees,\r\n  fetchEmployeesByDepartment,\r\n  fetchEmployeesByBranch,\r\n  type EmployeesParams,\r\n  type CreateEmployeeInput,\r\n  type UpdateEmployeeInput,\r\n} from '../api/employees-api';\r\n\r\n// Query keys - exported for invalidation\r\nexport const employeeKeys = {\r\n  all: ['employees'] as const,\r\n  lists: () => [...employeeKeys.all, 'list'] as const,\r\n  list: (params: EmployeesParams) => [...employeeKeys.lists(), params] as const,\r\n  details: () => [...employeeKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...employeeKeys.details(), id] as const,\r\n  search: (query: string) => [...employeeKeys.all, 'search', query] as const,\r\n  byDepartment: (id: string) => [...employeeKeys.all, 'department', id] as const,\r\n  byBranch: (id: string) => [...employeeKeys.all, 'branch', id] as const,\r\n};\r\n\r\n/**\r\n * Hook for fetching paginated employees list\r\n * \r\n * @example\r\n * ```tsx\r\n * function EmployeesPage() {\r\n *   const [page, setPage] = useState(1);\r\n *   const { data, isLoading } = useEmployees({ page, limit: 50 });\r\n *   \r\n *   return (\r\n *     <DataTable \r\n *       data={data?.data || []} \r\n *       pagination={data?.pagination}\r\n *       onPageChange={setPage}\r\n *     />\r\n *   );\r\n * }\r\n * ```\r\n */\r\nexport function useEmployees(params: EmployeesParams = {}) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.list(params),\r\n    queryFn: () => fetchEmployees(params),\r\n    staleTime: 60_000, // 1 minute - employees don't change frequently\r\n    gcTime: 10 * 60 * 1000, // 10 minutes\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for fetching single employee by ID\r\n */\r\nexport function useEmployee(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.detail(id!),\r\n    queryFn: () => fetchEmployee(id!),\r\n    enabled: !!id,\r\n    staleTime: 60_000,\r\n    gcTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for searching employees (autocomplete)\r\n */\r\nexport function useEmployeeSearch(query: string, limit = 20) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.search(query),\r\n    queryFn: () => searchEmployees(query, limit),\r\n    enabled: query.length >= 2,\r\n    staleTime: 30_000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for fetching employees by department\r\n */\r\nexport function useEmployeesByDepartment(departmentId: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.byDepartment(departmentId!),\r\n    queryFn: () => fetchEmployeesByDepartment(departmentId!),\r\n    enabled: !!departmentId,\r\n    staleTime: 60_000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for fetching employees by branch\r\n */\r\nexport function useEmployeesByBranch(branchId: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.byBranch(branchId!),\r\n    queryFn: () => fetchEmployeesByBranch(branchId!),\r\n    enabled: !!branchId,\r\n    staleTime: 60_000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for employee mutations (create/update/delete)\r\n */\r\ninterface UseEmployeeMutationsOptions {\r\n  onCreateSuccess?: (employee: unknown) => void;\r\n  onUpdateSuccess?: (employee: unknown) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useEmployeeMutations(options: UseEmployeeMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createEmployee,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.lists() });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: updateEmployee,\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.lists() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: deleteEmployee,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return {\r\n    create,\r\n    update,\r\n    remove,\r\n    isCreating: create.isPending,\r\n    isUpdating: update.isPending,\r\n    isDeleting: remove.isPending,\r\n    isMutating: create.isPending || update.isPending || remove.isPending,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for getting active employees\r\n */\r\nexport function useActiveEmployees(params: Omit<EmployeesParams, 'status'> = {}) {\r\n  return useEmployees({ ...params, status: 'active' });\r\n}\r\n\r\n/**\r\n * Prefetch employee for faster navigation\r\n */\r\nexport function usePrefetchEmployee() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return (id: string) => {\r\n    queryClient.prefetchQuery({\r\n      queryKey: employeeKeys.detail(id),\r\n      queryFn: () => fetchEmployee(id),\r\n      staleTime: 60_000,\r\n    });\r\n  };\r\n}\r\n\r\n// Re-export from use-all-employees for backward compatibility\r\nexport { useAllEmployees, useEmployeeOptions, useEmployeeFinder, useEmployeeSearcher } from './use-all-employees';\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2220, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/employee-account-tab.tsx"],"sourcesContent":["import * as React from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../components/ui/card';\nimport { Button } from '../../components/ui/button';\nimport { Input } from '../../components/ui/input';\nimport { Label } from '../../components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../components/ui/select';\nimport { Badge } from '../../components/ui/badge';\nimport { Eye, EyeOff, RefreshCw, Copy, ShieldAlert } from 'lucide-react';\nimport type { Employee } from './types';\nimport type { EmployeeRole } from './roles';\nimport { useEmployeeMutations } from './hooks/use-employees';\nimport { useAuth } from '../../contexts/auth-context';\nimport { toast } from 'sonner';\nimport { hashPassword, validatePasswordStrength, sanitizeInput } from '../../lib/security-utils';\n\ninterface EmployeeAccountTabProps {\n  employee: Employee;\n}\n\nconst getRoleLabel = (role: EmployeeRole): string => {\n  switch (role) {\n    case 'Admin': return 'Qu·∫£n tr·ªã vi√™n';\n    case 'Manager': return 'Qu·∫£n l√Ω';\n    case 'Sales': return 'Kinh doanh';\n    case 'Warehouse': return 'Kho';\n    default: return role;\n  }\n};\n\nconst getRoleDescription = (role: EmployeeRole): string => {\n  switch (role) {\n    case 'Admin': return 'To√†n quy·ªÅn h·ªá th·ªëng';\n    case 'Manager': return 'Qu·∫£n l√Ω ph√≤ng ban';\n    case 'Sales': return 'Nh√¢n vi√™n kinh doanh';\n    case 'Warehouse': return 'Nh√¢n vi√™n kho';\n    default: return '';\n  }\n};\n\nconst getRoleBadgeVariant = (role: EmployeeRole) => {\n  switch (role) {\n    case 'Admin': return 'destructive' as const;\n    case 'Manager': return 'default' as const;\n    case 'Sales': return 'secondary' as const;\n    case 'Warehouse': return 'outline' as const;\n    default: return 'secondary' as const;\n  }\n};\n\n// H√†m t·∫°o m·∫≠t kh·∫©u ng·∫´u nhi√™n\nconst generatePassword = (length: number = 12): string => {\n  const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n  const lowercase = 'abcdefghijklmnopqrstuvwxyz';\n  const numbers = '0123456789';\n  const symbols = '!@#$%^&*';\n  const allChars = uppercase + lowercase + numbers + symbols;\n  \n  let password = '';\n  // ƒê·∫£m b·∫£o c√≥ √≠t nh·∫•t 1 k√Ω t·ª± m·ªói lo·∫°i\n  password += uppercase[Math.floor(Math.random() * uppercase.length)];\n  password += lowercase[Math.floor(Math.random() * lowercase.length)];\n  password += numbers[Math.floor(Math.random() * numbers.length)];\n  password += symbols[Math.floor(Math.random() * symbols.length)];\n  \n  // Th√™m c√°c k√Ω t·ª± ng·∫´u nhi√™n c√≤n l·∫°i\n  for (let i = password.length; i < length; i++) {\n    password += allChars[Math.floor(Math.random() * allChars.length)];\n  }\n  \n  // Tr·ªôn ng·∫´u nhi√™n\n  return password.split('').sort(() => Math.random() - 0.5).join('');\n};\n\nexport function EmployeeAccountTab({ employee }: EmployeeAccountTabProps) {\n  const { update } = useEmployeeMutations();\n  const { user: currentUser } = useAuth();\n  const [showPassword, setShowPassword] = React.useState(false);\n  const [password, setPassword] = React.useState('');\n  const [confirmPassword, setConfirmPassword] = React.useState('');\n  const [selectedRole, setSelectedRole] = React.useState<EmployeeRole>(employee.role);\n\n  // Check if current user can change roles (only Admin can)\n  const canChangeRole = currentUser?.role === 'admin';\n  // Check if trying to edit own account\n  const isOwnAccount = currentUser?.employeeId === employee.systemId;\n\n  const handleGeneratePassword = () => {\n    const newPassword = generatePassword(12);\n    setPassword(newPassword);\n    setConfirmPassword(newPassword);\n    setShowPassword(true);\n    toast.success('ƒê√£ t·∫°o m·∫≠t kh·∫©u ng·∫´u nhi√™n');\n  };\n\n  const handleCopyPassword = async () => {\n    if (!password) {\n      toast.error('Ch∆∞a c√≥ m·∫≠t kh·∫©u ƒë·ªÉ copy');\n      return;\n    }\n    \n    try {\n      await navigator.clipboard.writeText(password);\n      toast.success('ƒê√£ copy m·∫≠t kh·∫©u v√†o clipboard');\n    } catch (err) {\n      toast.error('Kh√¥ng th·ªÉ copy m·∫≠t kh·∫©u');\n    }\n  };\n\n  const handleSave = async () => {\n    if (password || confirmPassword) {\n      // Use centralized password validation\n      const validation = validatePasswordStrength(password);\n      if (!validation.isValid) {\n        toast.error(validation.errors[0]);\n        return;\n      }\n      if (password !== confirmPassword) {\n        toast.error('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp');\n        return;\n      }\n    }\n\n    const updates: Partial<Employee> = {\n      role: selectedRole,\n    };\n\n    if (password) {\n      // Hash password before storing (client-side protection)\n      // Real hashing should be done server-side with bcrypt\n      updates.password = await hashPassword(password);\n    }\n\n    update.mutate(\n      { systemId: employee.systemId, ...employee, ...updates },\n      { onSuccess: () => toast.success('ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin ƒëƒÉng nh·∫≠p') }\n    );\n    \n    setPassword('');\n    setConfirmPassword('');\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-h5\">\n            Th√¥ng tin ƒëƒÉng nh·∫≠p\n          </CardTitle>\n          <CardDescription>\n            C·∫•u h√¨nh t√†i kho·∫£n v√† quy·ªÅn truy c·∫≠p h·ªá th·ªëng cho nh√¢n vi√™n\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div className=\"space-y-2\">\n            <Label>Email ƒëƒÉng nh·∫≠p</Label>\n            <Input \n              value={employee.workEmail} \n              disabled \n              className=\"bg-muted\"\n            />\n            <p className=\"text-xs text-muted-foreground\">\n              Email c√¥ng vi·ªác ƒë∆∞·ª£c s·ª≠ d·ª•ng l√†m t√™n ƒëƒÉng nh·∫≠p\n            </p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Vai tr√≤ hi·ªán t·∫°i</Label>\n            <div>\n              <Badge variant={getRoleBadgeVariant(employee.role)} className=\"text-sm\">\n                {getRoleLabel(employee.role)}\n              </Badge>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"role\">Thay ƒë·ªïi vai tr√≤</Label>\n            {canChangeRole ? (\n              <>\n                <Select value={selectedRole} onValueChange={(value) => setSelectedRole(value as EmployeeRole)}>\n                  <SelectTrigger id=\"role\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Sales\">\n                      <div className=\"flex flex-col items-start py-1\">\n                        <span className=\"font-medium\">{getRoleLabel('Sales')}</span>\n                        <span className=\"text-xs text-muted-foreground\">{getRoleDescription('Sales')}</span>\n                      </div>\n                    </SelectItem>\n                    <SelectItem value=\"Warehouse\">\n                      <div className=\"flex flex-col items-start py-1\">\n                        <span className=\"font-medium\">{getRoleLabel('Warehouse')}</span>\n                        <span className=\"text-xs text-muted-foreground\">{getRoleDescription('Warehouse')}</span>\n                      </div>\n                    </SelectItem>\n                    <SelectItem value=\"Manager\">\n                      <div className=\"flex flex-col items-start py-1\">\n                        <span className=\"font-medium\">{getRoleLabel('Manager')}</span>\n                        <span className=\"text-xs text-muted-foreground\">{getRoleDescription('Manager')}</span>\n                      </div>\n                    </SelectItem>\n                    <SelectItem value=\"Admin\">\n                      <div className=\"flex flex-col items-start py-1\">\n                        <span className=\"font-medium\">{getRoleLabel('Admin')}</span>\n                        <span className=\"text-xs text-muted-foreground\">{getRoleDescription('Admin')}</span>\n                      </div>\n                    </SelectItem>\n                  </SelectContent>\n                </Select>\n                <p className=\"text-xs text-muted-foreground\">\n                  Vai tr√≤ x√°c ƒë·ªãnh quy·ªÅn truy c·∫≠p c√°c ch·ª©c nƒÉng trong h·ªá th·ªëng\n                </p>\n              </>\n            ) : (\n              <div className=\"rounded-lg border border-amber-200 p-3 bg-amber-50 dark:bg-amber-950/20\">\n                <div className=\"flex items-center gap-2 text-amber-800 dark:text-amber-200\">\n                  <ShieldAlert className=\"h-4 w-4\" />\n                  <p className=\"text-sm\">\n                    Ch·ªâ Admin m·ªõi c√≥ quy·ªÅn thay ƒë·ªïi vai tr√≤ nh√¢n vi√™n.\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-h5\">\n            ƒê·ªïi m·∫≠t kh·∫©u\n          </CardTitle>\n          <CardDescription>\n            {employee.password ? 'C·∫≠p nh·∫≠t m·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p' : 'Thi·∫øt l·∫≠p m·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p m·ªõi'}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {employee.password ? (\n            <div className=\"rounded-lg border p-3 bg-muted/50\">\n              <p className=\"text-sm text-muted-foreground\">\n                 M·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c thi·∫øt l·∫≠p. ƒê·ªÉ thay ƒë·ªïi, nh·∫≠p m·∫≠t kh·∫©u m·ªõi b√™n d∆∞·ªõi.\n              </p>\n            </div>\n          ) : (\n            <div className=\"rounded-lg border border-orange-200 p-3 bg-orange-50 dark:bg-orange-950/20\">\n              <p className=\"text-sm text-orange-800 dark:text-orange-200\">\n                 Ch∆∞a c√≥ m·∫≠t kh·∫©u. Nh√¢n vi√™n ch∆∞a th·ªÉ ƒëƒÉng nh·∫≠p h·ªá th·ªëng.\n              </p>\n            </div>\n          )}\n\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between\">\n              <Label htmlFor=\"password\">M·∫≠t kh·∫©u m·ªõi</Label>\n              <div className=\"flex gap-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleGeneratePassword}\n                >\n                  T·∫°o t·ª± ƒë·ªông\n                </Button>\n                {password && (\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleCopyPassword}\n                  >\n                    Copy\n                  </Button>\n                )}\n              </div>\n            </div>\n            <div className=\"relative\">\n              <Input\n                id=\"password\"\n                type={showPassword ? 'text' : 'password'}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"Nh·∫≠p m·∫≠t kh·∫©u m·ªõi (t·ªëi thi·ªÉu 6 k√Ω t·ª±)\"\n              />\n              <Button\n                type=\"button\"\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"absolute right-0 top-0 h-full px-3 hover:bg-transparent\"\n                onClick={() => setShowPassword(!showPassword)}\n              >\n                {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"confirmPassword\">X√°c nh·∫≠n m·∫≠t kh·∫©u</Label>\n            <Input\n              id=\"confirmPassword\"\n              type={showPassword ? 'text' : 'password'}\n              value={confirmPassword}\n              onChange={(e) => setConfirmPassword(e.target.value)}\n              placeholder=\"Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi\"\n            />\n          </div>\n\n          <div className=\"flex justify-end pt-2\">\n            <Button onClick={handleSave}>\n              L∆∞u thay ƒë·ªïi\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card className=\"border-blue-200 bg-blue-50/50 dark:bg-blue-950/20\">\n        <CardContent className=\"pt-6\">\n          <div className=\"space-y-2\">\n            <p className=\"text-sm font-medium text-blue-900 dark:text-blue-100\">\n               L∆∞u √Ω quan tr·ªçng:\n            </p>\n            <ul className=\"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-disc list-inside\">\n              <li>Email c√¥ng vi·ªác ƒë∆∞·ª£c d√πng l√†m t√™n ƒëƒÉng nh·∫≠p</li>\n              <li>M·∫≠t kh·∫©u ph·∫£i c√≥ t·ªëi thi·ªÉu 6 k√Ω t·ª±</li>\n              <li>Vai tr√≤ quy·∫øt ƒë·ªãnh quy·ªÅn truy c·∫≠p c√°c ch·ª©c nƒÉng</li>\n              <li>Ch·ªâ Admin m·ªõi ƒë∆∞·ª£c thay ƒë·ªïi vai tr√≤ nh√¢n vi√™n kh√°c</li>\n            </ul>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2991, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/detail-page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { Printer, FileSpreadsheet, Clock } from 'lucide-react';\r\nimport * as XLSX from 'xlsx';\r\nimport { toast } from 'sonner';\r\nimport { formatDate, formatDateCustom, toISODate, toISODateTime, getMonthsDiff } from '../../lib/date-utils';\r\nimport { useEmployeeStore } from './store';\r\nimport { useBranchStore } from '../settings/branches/store';\r\nimport { usePageHeader } from '../../contexts/page-header-context';\r\nimport { generateDetailBreadcrumb } from '../../lib/breadcrumb-generator'; // ‚úÖ NEW\r\nimport { asSystemId, asBusinessId, type SystemId } from '../../lib/id-types';\r\nimport { useEmployeeCompStore } from './employee-comp-store';\r\nimport { useEmployeeSettingsStore } from '../settings/employees/employee-settings-store';\r\nimport { attendanceSnapshotService } from '../../lib/attendance-snapshot-service';\r\nimport { useAttendanceStore } from '../attendance/store';\r\nimport { usePayrollBatchStore } from '../payroll/payroll-batch-store';\r\nimport type { Payslip, PayrollBatch } from '../../lib/payroll-types';\r\nimport { PayrollStatusBadge } from '../payroll/components/status-badge';\r\nimport { PayslipPrintButton } from '../payroll/components/payslip-print-button';\r\nimport { ROUTES } from '../../lib/router';\r\nimport { useAuth } from '../../contexts/auth-context';\r\nimport { usePrint } from '../../lib/use-print';\r\nimport { useStoreInfoStore } from '../settings/store-info/store-info-store';\r\nimport { useDepartmentStore } from '../settings/departments/store';\r\nimport {\r\n  convertPayslipForPrint,\r\n  mapPayslipToPrintData,\r\n  mapPayslipComponentLineItems,\r\n  createStoreSettings,\r\n} from '../../lib/print/payroll-print-helper';\r\nimport {\r\n  convertAttendanceDetailForPrint,\r\n  mapAttendanceDetailToPrintData,\r\n  mapAttendanceDetailLineItems,\r\n  createStoreSettings as createAttendanceStoreSettings,\r\n} from '../../lib/print/attendance-print-helper';\r\nimport {\r\n  convertPenaltyForPrint,\r\n  mapPenaltyToPrintData,\r\n  createStoreSettings as createPenaltyStoreSettings,\r\n} from '../../lib/print/penalty-print-helper';\r\nimport {\r\n  convertLeaveForPrint,\r\n  mapLeaveToPrintData,\r\n  createStoreSettings as createLeaveStoreSettings,\r\n} from '../../lib/print/leave-print-helper';\r\nimport { DatabaseComments } from '../../components/DatabaseComments';\r\nimport { ActivityHistory, type HistoryEntry } from '../../components/ActivityHistory';\r\nimport type { Employee, EmployeeAddress } from './types';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../components/ui/card';\r\nimport { Button } from '../../components/ui/button';\r\nimport { \r\n  ArrowLeft, \r\n  Edit, \r\n  Mail, \r\n  Phone, \r\n  Calendar,\r\n  Building2,\r\n  Briefcase,\r\n  DollarSign,\r\n  FileText,\r\n  Download,\r\n  Eye,\r\n  File,\r\n  Lock,\r\n  MoreHorizontal,\r\n  ExternalLink\r\n} from 'lucide-react';\r\nimport { InfoItem } from '../../components/ui/info-card';\r\nimport { StatsCard } from '../../components/ui/stats-card';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '../../components/ui/avatar';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../../components/ui/tabs';\r\nimport { RelatedDataTable } from '../../components/data-table/related-data-table';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '../../components/ui/dialog';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '../../components/ui/dropdown-menu';\r\nimport type { ColumnDef } from '../../components/data-table/types';\r\n\r\nimport { usePenaltyStore } from '../settings/penalties/store';\r\nimport { useDocumentStore } from './document-store';\r\nimport { useLeaveStore } from '../leaves/store';\r\nimport { useTaskStore } from '../tasks/store';\r\nimport { EmployeeDocuments } from './employee-documents';\r\nimport { EmployeeAccountTab } from './employee-account-tab';\r\n\r\nimport type { Penalty, PenaltyStatus } from '../settings/penalties/types';\r\nimport type { LeaveRequest, LeaveStatus } from '../leaves/types';\r\n\r\nconst formatCurrency = (value?: number) => {\r\n    if (typeof value !== 'number') return '-';\r\n    return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(value);\r\n};\r\n\r\nconst formatMonthLabel = (monthKey?: string) => {\r\n    if (!monthKey) return '‚Äî';\r\n    const [year, month] = monthKey.split('-');\r\n    return `Th√°ng ${month}/${year}`;\r\n};\r\n\r\nconst formatDateDisplay = (dateString?: string) => {\r\n    if (!dateString) return '-';\r\n    return formatDateCustom(new Date(dateString), \"dd/MM/yyyy\");\r\n};\r\n\r\n/**\r\n * Format EmployeeAddress th√†nh chu·ªói hi·ªÉn th·ªã\r\n * - 3-c·∫•p: \"123 ABC, Qu·∫≠n 7, Ph∆∞·ªùng T√¢n Ph√∫, TP.HCM\" (ƒë·∫ßy ƒë·ªß District + Ward)\r\n * - 2-c·∫•p: \"123 ABC, Ph∆∞·ªùng T√¢n Ph√∫, TP.HCM\" (ch·ªâ Ward, b·ªè District)\r\n */\r\nconst formatAddressDisplay = (addr: EmployeeAddress | null | undefined): string => {\r\n  if (!addr) return '-';\r\n  \r\n  const { street, ward, district, province, inputLevel } = addr;\r\n  \r\n  if (inputLevel === '3-level') {\r\n    // 3-c·∫•p: Hi·ªÉn th·ªã District + Ward\r\n    return [street, district, ward, province].filter(Boolean).join(', ') || '-';\r\n  } else {\r\n    // 2-c·∫•p: Ch·ªâ hi·ªÉn th·ªã Ward (b·ªè District)\r\n    return [street, ward, province].filter(Boolean).join(', ') || '-';\r\n  }\r\n};\r\n\r\nconst penaltyStatusVariants: Record<PenaltyStatus, \"warning\" | \"success\" | \"secondary\"> = {\r\n    \"Ch∆∞a thanh to√°n\": \"warning\", \"ƒê√£ thanh to√°n\": \"success\", \"ƒê√£ h·ªßy\": \"secondary\",\r\n};\r\n\r\n// REMOVED: Internal task status constants\r\n// const internalTaskStatusNames: Record<InternalTaskStatus, string> = { 'To Do': 'C·∫ßn l√†m', 'In Progress': 'ƒêang l√†m', 'Done': 'Ho√†n th√†nh' };\r\n// const internalTaskStatusVariants: Record<InternalTaskStatus, \"default\" | \"secondary\" | \"warning\" | \"success\"> = {\r\n//     'To Do': \"secondary\", 'In Progress': \"warning\", 'Done': \"success\"\r\n// };\r\n\r\nconst leaveStatusVariants: Record<LeaveStatus, \"success\" | \"warning\" | \"destructive\"> = {\r\n    \"Ch·ªù duy·ªát\": \"warning\",\r\n    \"ƒê√£ duy·ªát\": \"success\",\r\n    \"ƒê√£ t·ª´ ch·ªëi\": \"destructive\",\r\n};\r\n\r\nconst employmentStatusBadgeVariants: Record<Employee[\"employmentStatus\"], \"default\" | \"secondary\" | \"destructive\"> = {\r\n    \"ƒêang l√†m vi·ªác\": \"default\",\r\n    \"T·∫°m ngh·ªâ\": \"secondary\",\r\n    \"ƒê√£ ngh·ªâ vi·ªác\": \"destructive\",\r\n};\r\n\r\nconst renderEmploymentStatusBadge = (status?: Employee[\"employmentStatus\"]) => {\r\n    if (!status) return undefined;\r\n    return (\r\n        <Badge variant={employmentStatusBadgeVariants[status] ?? \"secondary\"}>\r\n            {status}\r\n        </Badge>\r\n    );\r\n};\r\n\r\nconst PlaceholderTabContent = ({ title }: { title: string }) => (\r\n    <Card className=\"mt-4\">\r\n        <CardContent className=\"p-0\">\r\n            <div className=\"flex h-40 items-center justify-center rounded-lg border-dashed\">\r\n                <div className=\"flex flex-col items-center gap-1 text-center text-muted-foreground\">\r\n                    <h3 className=\"text-h4 font-semibold tracking-tight\">{title}</h3>\r\n                    <p className=\"text-sm\">Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn.</p>\r\n                </div>\r\n            </div>\r\n        </CardContent>\r\n    </Card>\r\n);\r\n\r\n// Column definitions for tabs (static - no actions)\r\n// taskColumns moved to dynamic inside component\r\n\r\n// Payroll history row type for RelatedDataTable\r\ninterface PayrollHistoryRow {\r\n    systemId: string;\r\n    batchId: string;\r\n    monthLabel: string;\r\n    payDate: string;\r\n    status: 'draft' | 'reviewed' | 'locked' | 'cancelled';\r\n    grossEarnings: number;\r\n    totalInsurance: number;\r\n    personalIncomeTax: number;\r\n    otherDeductions: number;\r\n    totalDeductions: number;\r\n    netPay: number;\r\n    batchSystemId?: string;\r\n    payslipSystemId: string;\r\n    // For print functionality\r\n    slip: Payslip;\r\n    batch?: PayrollBatch;\r\n}\r\n\r\n\r\nexport function EmployeeDetailPage() {\r\n  const { systemId } = useParams<{ systemId: string }>();\r\n  const router = useRouter();\r\n  const { findById } = useEmployeeStore();\r\n  const { data: branches } = useBranchStore();\r\n  const { employee: authEmployee } = useAuth();\r\n    const getPayrollProfile = useEmployeeCompStore((state) => state.getPayrollProfile);\r\n    const { settings } = useEmployeeSettingsStore();\r\n    const { info: storeInfo } = useStoreInfoStore();\r\n    const { data: departments } = useDepartmentStore();\r\n    const { print, printMultiple } = usePrint();\r\n    \r\n    // FIX: Split selectors to avoid object recreation on every render\r\n    const lockedMonths = useAttendanceStore((state) => state.lockedMonths);\r\n    const attendanceData = useAttendanceStore((state) => state.attendanceData);\r\n\r\n    const employee = React.useMemo(() => (systemId ? findById(asSystemId(systemId)) : null), [systemId, findById]);\r\n\r\n\r\n\r\n  // Fetch data for tabs\r\n  const { data: allPenalties } = usePenaltyStore();\r\n  const { data: allTasks } = useTaskStore();\r\n  const { data: allLeaveRequests } = useLeaveStore();\r\n  \r\n  const employeePenalties = React.useMemo(() => allPenalties.filter(p => p.employeeSystemId === employee?.systemId), [allPenalties, employee?.systemId]);\r\n  \r\n  // L·ªçc c√¥ng vi·ªác ƒë∆∞·ª£c giao cho nh√¢n vi√™n n√†y (ki·ªÉm tra trong assignees array)\r\n  const employeeTasks = React.useMemo(() => {\r\n      if (!employee?.systemId) return [];\r\n      return allTasks\r\n        .filter(task => \r\n          task.assignees?.some(a => a.employeeSystemId === employee.systemId) ||\r\n          task.assigneeId === employee.systemId\r\n        )\r\n        .map(task => ({\r\n          systemId: task.systemId,\r\n          title: task.title,\r\n          type: task.priority || 'Trung b√¨nh',\r\n          dueDate: task.dueDate,\r\n          statusVariant: (\r\n            task.status === 'Ho√†n th√†nh' ? 'success' :\r\n            task.status === 'ƒêang th·ª±c hi·ªán' ? 'default' :\r\n            task.status === 'ƒêang ch·ªù' ? 'warning' :\r\n            task.status === 'ƒê√£ h·ªßy' ? 'destructive' : 'secondary'\r\n          ) as 'default' | 'secondary' | 'warning' | 'success' | 'destructive',\r\n          statusName: task.status,\r\n          link: `/tasks/${task.systemId}`,\r\n        }));\r\n  }, [allTasks, employee?.systemId]);\r\n\r\n  const employeeLeaves = React.useMemo(() => \r\n    allLeaveRequests\r\n      .filter(l => l.employeeSystemId === employee?.systemId)\r\n      .sort((a, b) => new Date(b.requestDate).getTime() - new Date(a.requestDate).getTime()),\r\n  [allLeaveRequests, employee?.systemId]);\r\n\r\n  const branchName = React.useMemo(() => {\r\n    if (!employee?.branchSystemId) return 'Ch∆∞a ph√¢n c√¥ng';\r\n    return branches.find(b => b.systemId === employee.branchSystemId)?.name || 'Kh√¥ng t√¨m th·∫•y';\r\n  }, [employee, branches]);\r\n\r\n    const payrollProfile = React.useMemo(() => (employee ? getPayrollProfile(employee.systemId) : null), [employee, getPayrollProfile]);\r\n\r\n    const payrollShift = React.useMemo(() => {\r\n        if (!payrollProfile?.workShiftSystemId) {\r\n            return null;\r\n        }\r\n        return settings.workShifts.find((shift) => shift.systemId === payrollProfile.workShiftSystemId) ?? null;\r\n    }, [payrollProfile?.workShiftSystemId, settings.workShifts]);\r\n\r\n    const payrollComponents = React.useMemo(() => {\r\n        if (!payrollProfile) {\r\n            return [];\r\n        }\r\n        return settings.salaryComponents.filter((component) =>\r\n            payrollProfile.salaryComponentSystemIds.includes(component.systemId)\r\n        );\r\n    }, [payrollProfile, settings.salaryComponents]);\r\n\r\n    const attendanceSnapshot = React.useMemo(() => {\r\n        if (!employee) {\r\n            return null;\r\n        }\r\n        return attendanceSnapshotService.getLatestLockedSnapshot(employee.systemId);\r\n    }, [employee?.systemId, lockedMonths, attendanceData]);\r\n\r\n    // ‚úÖ L·ªãch s·ª≠ ch·∫•m c√¥ng c·ªßa nh√¢n vi√™n - l·∫•y t·∫•t c·∫£ c√°c th√°ng c√≥ d·ªØ li·ªáu\r\n    const attendanceHistory = React.useMemo(() => {\r\n        if (!employee) return [];\r\n        \r\n        const history: Array<{\r\n            systemId: string;\r\n            monthKey: string;\r\n            monthLabel: string;\r\n            workDays: number;\r\n            leaveDays: number;\r\n            absentDays: number;\r\n            lateArrivals: number;\r\n            earlyDepartures: number;\r\n            otHours: number;\r\n            locked: boolean;\r\n        }> = [];\r\n\r\n        // Duy·ªát qua t·∫•t c·∫£ c√°c th√°ng c√≥ d·ªØ li·ªáu\r\n        Object.entries(attendanceData).forEach(([monthKey, rows]) => {\r\n            const employeeRow = rows?.find(r => r.employeeSystemId === employee.systemId);\r\n            if (employeeRow) {\r\n                const [year, month] = monthKey.split('-');\r\n                history.push({\r\n                    systemId: `${monthKey}-${employee.systemId}`,\r\n                    monthKey,\r\n                    monthLabel: `Th√°ng ${month}/${year}`,\r\n                    workDays: employeeRow.workDays ?? 0,\r\n                    leaveDays: employeeRow.leaveDays ?? 0,\r\n                    absentDays: employeeRow.absentDays ?? 0,\r\n                    lateArrivals: employeeRow.lateArrivals ?? 0,\r\n                    earlyDepartures: employeeRow.earlyDepartures ?? 0,\r\n                    otHours: employeeRow.otHours ?? 0,\r\n                    locked: Boolean(lockedMonths[monthKey]),\r\n                });\r\n            }\r\n        });\r\n\r\n        // S·∫Øp x·∫øp theo th√°ng m·ªõi nh·∫•t\r\n        return history.sort((a, b) => b.monthKey.localeCompare(a.monthKey));\r\n    }, [employee?.systemId, attendanceData, lockedMonths]);\r\n\r\n    // ‚úÖ Handler in phi·∫øu ch·∫•m c√¥ng ƒë∆°n l·∫ª\r\n    const handlePrintSingleAttendance = React.useCallback((row: typeof attendanceHistory[number]) => {\r\n        if (!employee) {\r\n            toast.error('Kh√¥ng th·ªÉ in', { description: 'Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu nh√¢n vi√™n.' });\r\n            return;\r\n        }\r\n\r\n        // L·∫•y d·ªØ li·ªáu ch·∫•m c√¥ng c·ªßa th√°ng n√†y\r\n        const monthRows = attendanceData[row.monthKey];\r\n        const employeeRow = monthRows?.find(r => r.employeeSystemId === employee.systemId);\r\n        \r\n        if (!employeeRow) {\r\n            toast.error('Kh√¥ng th·ªÉ in', { description: 'Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu ch·∫•m c√¥ng.' });\r\n            return;\r\n        }\r\n\r\n        const storeSettings = createAttendanceStoreSettings(storeInfo);\r\n        const attendanceForPrint = convertAttendanceDetailForPrint(row.monthKey, employeeRow);\r\n\r\n        print('attendance', {\r\n            data: mapAttendanceDetailToPrintData(attendanceForPrint, storeSettings),\r\n            lineItems: mapAttendanceDetailLineItems(attendanceForPrint.dailyDetails),\r\n        });\r\n\r\n        toast.success('ƒêang in phi·∫øu ch·∫•m c√¥ng...', { description: `${employee.fullName} - ${row.monthLabel}` });\r\n    }, [employee, attendanceData, storeInfo, print]);\r\n\r\n    // ‚úÖ Columns cho b·∫£ng ch·∫•m c√¥ng\r\n    const attendanceColumns: ColumnDef<typeof attendanceHistory[number]>[] = React.useMemo(() => [\r\n        { id: 'monthLabel', accessorKey: 'monthLabel', header: 'K·ª≥ ch·∫•m c√¥ng', size: 130, cell: ({ row }) => <span className=\"font-medium\">{row.monthLabel}</span>, meta: { displayName: 'K·ª≥ ch·∫•m c√¥ng' } },\r\n        { id: 'locked', accessorKey: 'locked', header: 'Tr·∫°ng th√°i', size: 100, cell: ({ row }) => (\r\n            <Badge variant={row.locked ? 'default' : 'outline'} className={row.locked ? 'bg-green-600' : ''}>\r\n                {row.locked ? 'ƒê√£ kh√≥a' : 'Ch∆∞a kh√≥a'}\r\n            </Badge>\r\n        ), meta: { displayName: 'Tr·∫°ng th√°i' } },\r\n        { id: 'workDays', accessorKey: 'workDays', header: () => <span className=\"text-right w-full block\">Ng√†y c√¥ng</span>, size: 90, cell: ({ row }) => <span className=\"text-right block tabular-nums font-medium text-green-600\">{row.workDays}</span>, meta: { displayName: 'Ng√†y c√¥ng' } },\r\n        { id: 'leaveDays', accessorKey: 'leaveDays', header: () => <span className=\"text-right w-full block\">Ngh·ªâ ph√©p</span>, size: 90, cell: ({ row }) => <span className=\"text-right block tabular-nums text-blue-600\">{row.leaveDays}</span>, meta: { displayName: 'Ngh·ªâ ph√©p' } },\r\n        { id: 'absentDays', accessorKey: 'absentDays', header: () => <span className=\"text-right w-full block\">V·∫Øng</span>, size: 80, cell: ({ row }) => <span className={`text-right block tabular-nums ${row.absentDays > 0 ? 'text-destructive font-medium' : 'text-muted-foreground'}`}>{row.absentDays}</span>, meta: { displayName: 'V·∫Øng' } },\r\n        { id: 'lateArrivals', accessorKey: 'lateArrivals', header: () => <span className=\"text-right w-full block\">ƒêi tr·ªÖ</span>, size: 80, cell: ({ row }) => <span className={`text-right block tabular-nums ${row.lateArrivals > 0 ? 'text-orange-600' : 'text-muted-foreground'}`}>{row.lateArrivals}</span>, meta: { displayName: 'ƒêi tr·ªÖ' } },\r\n        { id: 'earlyDepartures', accessorKey: 'earlyDepartures', header: () => <span className=\"text-right w-full block\">V·ªÅ s·ªõm</span>, size: 80, cell: ({ row }) => <span className={`text-right block tabular-nums ${row.earlyDepartures > 0 ? 'text-orange-600' : 'text-muted-foreground'}`}>{row.earlyDepartures}</span>, meta: { displayName: 'V·ªÅ s·ªõm' } },\r\n        { id: 'otHours', accessorKey: 'otHours', header: () => <span className=\"text-right w-full block\">L√†m th√™m</span>, size: 80, cell: ({ row }) => <span className={`text-right block tabular-nums ${row.otHours > 0 ? 'text-purple-600 font-medium' : 'text-muted-foreground'}`}>{row.otHours}h</span>, meta: { displayName: 'Gi·ªù l√†m th√™m' } },\r\n        { \r\n            id: 'actions', \r\n            header: '', \r\n            size: 50,\r\n            cell: ({ row }) => (\r\n                <div onClick={(e) => e.stopPropagation()}>\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                <MoreHorizontal className=\"h-4 w-4\" />\r\n                                <span className=\"sr-only\">M·ªü menu</span>\r\n                            </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuItem onClick={() => {\r\n                                setSelectedAttendance(row);\r\n                                setIsAttendanceDialogOpen(true);\r\n                            }}>\r\n                                <Eye className=\"mr-2 h-4 w-4\" />\r\n                                Xem chi ti·∫øt\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => handlePrintSingleAttendance(row)}>\r\n                                <Printer className=\"mr-2 h-4 w-4\" />\r\n                                In phi·∫øu ch·∫•m c√¥ng\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => router.push(`/attendance?month=${row.monthKey}`)}>\r\n                                <ExternalLink className=\"mr-2 h-4 w-4\" />\r\n                                Xem b·∫£ng ch·∫•m c√¥ng\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </div>\r\n            ), \r\n            meta: { displayName: 'Thao t√°c', sticky: 'right' as const } \r\n        },\r\n    ], [handlePrintSingleAttendance, router]);\r\n\r\n    // ‚úÖ Custom bulk actions cho b·∫£ng ch·∫•m c√¥ng\r\n    const attendanceBulkActions = React.useMemo(() => {\r\n        const handlePrintAttendances = (rows: typeof attendanceHistory) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn k·ª≥ ch·∫•m c√¥ng n√†o');\r\n                return;\r\n            }\r\n\r\n            const storeSettings = createAttendanceStoreSettings(storeInfo);\r\n\r\n            const printOptionsList = rows.map(row => {\r\n                const monthRows = attendanceData[row.monthKey];\r\n                const employeeRow = monthRows?.find(r => r.employeeSystemId === employee?.systemId);\r\n                \r\n                if (!employeeRow) return null;\r\n\r\n                const attendanceForPrint = convertAttendanceDetailForPrint(row.monthKey, employeeRow);\r\n                return {\r\n                    data: mapAttendanceDetailToPrintData(attendanceForPrint, storeSettings),\r\n                    lineItems: mapAttendanceDetailLineItems(attendanceForPrint.dailyDetails),\r\n                };\r\n            }).filter(Boolean) as Array<{ data: any; lineItems: any[] }>;\r\n\r\n            if (printOptionsList.length === 0) {\r\n                toast.error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu ch·∫•m c√¥ng');\r\n                return;\r\n            }\r\n\r\n            printMultiple('attendance', printOptionsList);\r\n            toast.success(`ƒêang in ${printOptionsList.length} phi·∫øu ch·∫•m c√¥ng...`);\r\n        };\r\n\r\n        const handleExportExcel = (rows: typeof attendanceHistory) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn d·ªØ li·ªáu n√†o');\r\n                return;\r\n            }\r\n\r\n            const headers = ['K·ª≥ ch·∫•m c√¥ng', 'Tr·∫°ng th√°i', 'Ng√†y c√¥ng', 'Ngh·ªâ ph√©p', 'V·∫Øng', 'ƒêi tr·ªÖ', 'V·ªÅ s·ªõm', 'Gi·ªù l√†m th√™m'];\r\n            const mappedData = rows.map(row => ({\r\n                'K·ª≥ ch·∫•m c√¥ng': row.monthLabel,\r\n                'Tr·∫°ng th√°i': row.locked ? 'ƒê√£ kh√≥a' : 'Ch∆∞a kh√≥a',\r\n                'Ng√†y c√¥ng': row.workDays,\r\n                'Ngh·ªâ ph√©p': row.leaveDays,\r\n                'V·∫Øng': row.absentDays,\r\n                'ƒêi tr·ªÖ': row.lateArrivals,\r\n                'V·ªÅ s·ªõm': row.earlyDepartures,\r\n                'Gi·ªù l√†m th√™m': row.otHours,\r\n            }));\r\n\r\n            const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, 'ChamCong');\r\n            XLSX.writeFile(wb, `ChamCong_${employee?.id || 'NV'}_selected.xlsx`);\r\n            toast.success(`ƒê√£ xu·∫•t ${rows.length} d√≤ng ra Excel`);\r\n        };\r\n\r\n        return [\r\n            {\r\n                label: 'In phi·∫øu ch·∫•m c√¥ng',\r\n                icon: Printer,\r\n                onSelect: handlePrintAttendances,\r\n            },\r\n            {\r\n                label: 'Xu·∫•t Excel',\r\n                icon: FileSpreadsheet,\r\n                onSelect: handleExportExcel,\r\n            },\r\n        ];\r\n    }, [employee, attendanceData, storeInfo, printMultiple]);\r\n\r\n    // ‚úÖ Custom bulk actions cho tab Phi·∫øu ph·∫°t\r\n    const penaltyBulkActions = React.useMemo(() => {\r\n        const handlePrintPenalties = (rows: Penalty[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn phi·∫øu ph·∫°t n√†o');\r\n                return;\r\n            }\r\n\r\n            const penaltyStoreSettings = createPenaltyStoreSettings(storeInfo);\r\n            const printOptionsList = rows.map(row => {\r\n                const penaltyForPrint = convertPenaltyForPrint(row, { employee });\r\n                return {\r\n                    data: mapPenaltyToPrintData(penaltyForPrint, penaltyStoreSettings),\r\n                    lineItems: [],\r\n                };\r\n            });\r\n\r\n            printMultiple('penalty', printOptionsList);\r\n            toast.success(`ƒêang in ${printOptionsList.length} phi·∫øu ph·∫°t...`);\r\n        };\r\n\r\n        const handleExportExcel = (rows: Penalty[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn phi·∫øu ph·∫°t n√†o');\r\n                return;\r\n            }\r\n\r\n            const headers = ['M√£ phi·∫øu', 'L√Ω do', 'Ng√†y l·∫≠p', 'Tr·∫°ng th√°i', 'S·ªë ti·ªÅn'];\r\n            const mappedData = rows.map(row => ({\r\n                'M√£ phi·∫øu': row.id,\r\n                'L√Ω do': row.reason,\r\n                'Ng√†y l·∫≠p': formatDateDisplay(row.issueDate),\r\n                'Tr·∫°ng th√°i': row.status,\r\n                'S·ªë ti·ªÅn': row.amount,\r\n            }));\r\n\r\n            const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, 'PhieuPhat');\r\n            XLSX.writeFile(wb, `PhieuPhat_${employee?.id || 'NV'}_selected.xlsx`);\r\n            toast.success(`ƒê√£ xu·∫•t ${rows.length} phi·∫øu ph·∫°t ra Excel`);\r\n        };\r\n\r\n        return [\r\n            {\r\n                label: 'In phi·∫øu ph·∫°t',\r\n                icon: Printer,\r\n                onSelect: handlePrintPenalties,\r\n            },\r\n            {\r\n                label: 'Xu·∫•t Excel',\r\n                icon: FileSpreadsheet,\r\n                onSelect: handleExportExcel,\r\n            },\r\n        ];\r\n    }, [employee, storeInfo, printMultiple]);\r\n\r\n    // ‚úÖ Custom bulk actions cho tab L·ªãch s·ª≠ ngh·ªâ ph√©p\r\n    const leaveBulkActions = React.useMemo(() => {\r\n        const handlePrintLeaves = (rows: LeaveRequest[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn ƒë∆°n ngh·ªâ ph√©p n√†o');\r\n                return;\r\n            }\r\n\r\n            const leaveStoreSettings = createLeaveStoreSettings(storeInfo);\r\n            const printOptionsList = rows.map(row => {\r\n                const leaveForPrint = convertLeaveForPrint(row, { employee });\r\n                return {\r\n                    data: mapLeaveToPrintData(leaveForPrint, leaveStoreSettings),\r\n                    lineItems: [],\r\n                };\r\n            });\r\n\r\n            printMultiple('leave', printOptionsList);\r\n            toast.success(`ƒêang in ${printOptionsList.length} ƒë∆°n ngh·ªâ ph√©p...`);\r\n        };\r\n\r\n        const handleExportExcel = (rows: LeaveRequest[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn ƒë∆°n ngh·ªâ ph√©p n√†o');\r\n                return;\r\n            }\r\n\r\n            const headers = ['M√£ ƒë∆°n', 'Lo·∫°i ph√©p', 'T·ª´ ng√†y', 'ƒê·∫øn ng√†y', 'S·ªë ng√†y', 'L√Ω do', 'Tr·∫°ng th√°i'];\r\n            const mappedData = rows.map(row => ({\r\n                'M√£ ƒë∆°n': row.id,\r\n                'Lo·∫°i ph√©p': row.leaveTypeName,\r\n                'T·ª´ ng√†y': formatDateDisplay(row.startDate),\r\n                'ƒê·∫øn ng√†y': formatDateDisplay(row.endDate),\r\n                'S·ªë ng√†y': row.numberOfDays,\r\n                'L√Ω do': row.reason,\r\n                'Tr·∫°ng th√°i': row.status,\r\n            }));\r\n\r\n            const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, 'NghiPhep');\r\n            XLSX.writeFile(wb, `NghiPhep_${employee?.id || 'NV'}_selected.xlsx`);\r\n            toast.success(`ƒê√£ xu·∫•t ${rows.length} ƒë∆°n ngh·ªâ ph√©p ra Excel`);\r\n        };\r\n\r\n        return [\r\n            {\r\n                label: 'In ƒë∆°n ngh·ªâ ph√©p',\r\n                icon: Printer,\r\n                onSelect: handlePrintLeaves,\r\n            },\r\n            {\r\n                label: 'Xu·∫•t Excel',\r\n                icon: FileSpreadsheet,\r\n                onSelect: handleExportExcel,\r\n            },\r\n        ];\r\n    }, [employee, storeInfo, printMultiple]);\r\n\r\n    // ‚úÖ Helper functions cho in ƒë∆°n l·∫ª\r\n    const handlePrintSinglePenalty = React.useCallback((row: Penalty) => {\r\n        const penaltyStoreSettings = createPenaltyStoreSettings(storeInfo);\r\n        const penaltyForPrint = convertPenaltyForPrint(row, { employee });\r\n        print('penalty', {\r\n            data: mapPenaltyToPrintData(penaltyForPrint, penaltyStoreSettings),\r\n            lineItems: [],\r\n        });\r\n    }, [employee, storeInfo, print]);\r\n\r\n    const handlePrintSingleLeave = React.useCallback((row: LeaveRequest) => {\r\n        const leaveStoreSettings = createLeaveStoreSettings(storeInfo);\r\n        const leaveForPrint = convertLeaveForPrint(row, { employee });\r\n        print('leave', {\r\n            data: mapLeaveToPrintData(leaveForPrint, leaveStoreSettings),\r\n            lineItems: [],\r\n        });\r\n    }, [employee, storeInfo, print]);\r\n\r\n    const handleExportSinglePenalty = React.useCallback((row: Penalty) => {\r\n        const headers = ['M√£ phi·∫øu', 'L√Ω do', 'Ng√†y l·∫≠p', 'Tr·∫°ng th√°i', 'S·ªë ti·ªÅn'];\r\n        const mappedData = [{\r\n            'M√£ phi·∫øu': row.id,\r\n            'L√Ω do': row.reason,\r\n            'Ng√†y l·∫≠p': formatDateDisplay(row.issueDate),\r\n            'Tr·∫°ng th√°i': row.status,\r\n            'S·ªë ti·ªÅn': row.amount,\r\n        }];\r\n        const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n        const wb = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(wb, ws, 'PhieuPhat');\r\n        XLSX.writeFile(wb, `PhieuPhat_${row.id}.xlsx`);\r\n        toast.success('ƒê√£ xu·∫•t phi·∫øu ph·∫°t ra Excel');\r\n    }, []);\r\n\r\n    const handleExportSingleLeave = React.useCallback((row: LeaveRequest) => {\r\n        const headers = ['M√£ ƒë∆°n', 'Lo·∫°i ph√©p', 'T·ª´ ng√†y', 'ƒê·∫øn ng√†y', 'S·ªë ng√†y', 'L√Ω do', 'Tr·∫°ng th√°i'];\r\n        const mappedData = [{\r\n            'M√£ ƒë∆°n': row.id,\r\n            'Lo·∫°i ph√©p': row.leaveTypeName,\r\n            'T·ª´ ng√†y': formatDateDisplay(row.startDate),\r\n            'ƒê·∫øn ng√†y': formatDateDisplay(row.endDate),\r\n            'S·ªë ng√†y': row.numberOfDays,\r\n            'L√Ω do': row.reason,\r\n            'Tr·∫°ng th√°i': row.status,\r\n        }];\r\n        const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n        const wb = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(wb, ws, 'NghiPhep');\r\n        XLSX.writeFile(wb, `NghiPhep_${row.id}.xlsx`);\r\n        toast.success('ƒê√£ xu·∫•t ƒë∆°n ngh·ªâ ph√©p ra Excel');\r\n    }, []);\r\n\r\n    // ‚úÖ Dynamic columns cho Phi·∫øu ph·∫°t (c√≥ action column)\r\n    const penaltyColumns: ColumnDef<Penalty>[] = React.useMemo(() => [\r\n        { id: 'id', accessorKey: 'id', header: 'M√£ Phi·∫øu', cell: ({ row }) => <span className=\"font-medium\">{row.id}</span>, meta: { displayName: 'M√£ Phi·∫øu' } },\r\n        { id: 'reason', accessorKey: 'reason', header: 'L√Ω do', cell: ({ row }) => row.reason, meta: { displayName: 'L√Ω do' } },\r\n        { id: 'issueDate', accessorKey: 'issueDate', header: 'Ng√†y', cell: ({ row }) => formatDateDisplay(row.issueDate), meta: { displayName: 'Ng√†y' } },\r\n        { id: 'status', accessorKey: 'status', header: 'Tr·∫°ng th√°i', cell: ({ row }) => <Badge variant={penaltyStatusVariants[row.status]}>{row.status}</Badge>, meta: { displayName: 'Tr·∫°ng th√°i' } },\r\n        { id: 'amount', accessorKey: 'amount', header: 'S·ªë ti·ªÅn', cell: ({ row }) => <span className=\"text-destructive font-semibold\">{formatCurrency(row.amount)}</span>, meta: { displayName: 'S·ªë ti·ªÅn' } },\r\n        { \r\n            id: 'actions', \r\n            header: () => <div className=\"text-center\">Thao t√°c</div>, \r\n            cell: ({ row }) => (\r\n                <div className=\"flex items-center justify-center\">\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\r\n                                <MoreHorizontal className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuItem onClick={() => handlePrintSinglePenalty(row)}>\r\n                                <Printer className=\"mr-2 h-4 w-4\" />\r\n                                In phi·∫øu ph·∫°t\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => handleExportSinglePenalty(row)}>\r\n                                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\r\n                                Xu·∫•t Excel\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => router.push(`/penalties/${row.systemId}`)}>\r\n                                <Eye className=\"mr-2 h-4 w-4\" />\r\n                                Xem chi ti·∫øt\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </div>\r\n            ), \r\n            meta: { displayName: 'Thao t√°c', sticky: 'right' as const } \r\n        },\r\n    ], [handlePrintSinglePenalty, handleExportSinglePenalty, router]);\r\n\r\n    // ‚úÖ Dynamic columns cho L·ªãch s·ª≠ ngh·ªâ ph√©p (c√≥ action column)\r\n    const leaveColumns: ColumnDef<LeaveRequest>[] = React.useMemo(() => [\r\n        { id: 'id', accessorKey: 'id', header: 'M√£ ƒë∆°n', cell: ({ row }) => <span className=\"font-medium\">{row.id}</span>, meta: { displayName: 'M√£ ƒë∆°n' } },\r\n        { id: 'leaveTypeName', accessorKey: 'leaveTypeName', header: 'Lo·∫°i ph√©p', cell: ({ row }) => row.leaveTypeName, meta: { displayName: 'Lo·∫°i ph√©p' } },\r\n        { id: 'dateRange', header: 'Th·ªùi gian', cell: ({ row }) => `${formatDateDisplay(row.startDate)} - ${formatDateDisplay(row.endDate)}`, meta: { displayName: 'Th·ªùi gian' } },\r\n        { id: 'numberOfDays', accessorKey: 'numberOfDays', header: 'S·ªë ng√†y', cell: ({ row }) => row.numberOfDays, meta: { displayName: 'S·ªë ng√†y' } },\r\n        { id: 'reason', accessorKey: 'reason', header: 'L√Ω do', cell: ({ row }) => <span className=\"truncate max-w-[200px] block\">{row.reason}</span>, meta: { displayName: 'L√Ω do' } },\r\n        { id: 'status', accessorKey: 'status', header: 'Tr·∫°ng th√°i', cell: ({ row }) => <Badge variant={leaveStatusVariants[row.status]}>{row.status}</Badge>, meta: { displayName: 'Tr·∫°ng th√°i' } },\r\n        { \r\n            id: 'actions', \r\n            header: () => <div className=\"text-center\">Thao t√°c</div>, \r\n            cell: ({ row }) => (\r\n                <div className=\"flex items-center justify-center\">\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\r\n                                <MoreHorizontal className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuItem onClick={() => handlePrintSingleLeave(row)}>\r\n                                <Printer className=\"mr-2 h-4 w-4\" />\r\n                                In ƒë∆°n ngh·ªâ ph√©p\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => handleExportSingleLeave(row)}>\r\n                                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\r\n                                Xu·∫•t Excel\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => router.push(`/leaves/${row.systemId}`)}>\r\n                                <Eye className=\"mr-2 h-4 w-4\" />\r\n                                Xem chi ti·∫øt\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </div>\r\n            ), \r\n            meta: { displayName: 'Thao t√°c', sticky: 'right' as const } \r\n        },\r\n    ], [handlePrintSingleLeave, handleExportSingleLeave, router]);\r\n\r\n    // ‚úÖ Task row type for RelatedDataTable\r\n    type TaskRow = {\r\n        systemId: string;\r\n        title: string;\r\n        type: string;\r\n        dueDate?: string;\r\n        statusVariant: \"default\" | \"secondary\" | \"warning\" | \"success\" | \"destructive\";\r\n        statusName: string;\r\n        link: string;\r\n    };\r\n\r\n    // ‚úÖ Bulk actions cho tab C√¥ng vi·ªác\r\n    const taskBulkActions = React.useMemo(() => {\r\n        const handleExportExcel = (rows: TaskRow[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn c√¥ng vi·ªác n√†o');\r\n                return;\r\n            }\r\n\r\n            const headers = ['C√¥ng vi·ªác', 'ƒê·ªô ∆∞u ti√™n', 'H·∫°n ch√≥t', 'Tr·∫°ng th√°i'];\r\n            const mappedData = rows.map(row => ({\r\n                'C√¥ng vi·ªác': row.title,\r\n                'ƒê·ªô ∆∞u ti√™n': row.type,\r\n                'H·∫°n ch√≥t': formatDateDisplay(row.dueDate),\r\n                'Tr·∫°ng th√°i': row.statusName,\r\n            }));\r\n\r\n            const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, 'CongViec');\r\n            XLSX.writeFile(wb, `CongViec_${employee?.id || 'NV'}_selected.xlsx`);\r\n            toast.success(`ƒê√£ xu·∫•t ${rows.length} c√¥ng vi·ªác ra Excel`);\r\n        };\r\n\r\n        return [\r\n            {\r\n                label: 'Xu·∫•t Excel',\r\n                icon: FileSpreadsheet,\r\n                onSelect: handleExportExcel,\r\n            },\r\n        ];\r\n    }, [employee]);\r\n\r\n    // ‚úÖ Helper export single task\r\n    const handleExportSingleTask = React.useCallback((row: TaskRow) => {\r\n        const headers = ['C√¥ng vi·ªác', 'ƒê·ªô ∆∞u ti√™n', 'H·∫°n ch√≥t', 'Tr·∫°ng th√°i'];\r\n        const mappedData = [{\r\n            'C√¥ng vi·ªác': row.title,\r\n            'ƒê·ªô ∆∞u ti√™n': row.type,\r\n            'H·∫°n ch√≥t': formatDateDisplay(row.dueDate),\r\n            'Tr·∫°ng th√°i': row.statusName,\r\n        }];\r\n        const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n        const wb = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(wb, ws, 'CongViec');\r\n        XLSX.writeFile(wb, `CongViec_${row.systemId}.xlsx`);\r\n        toast.success('ƒê√£ xu·∫•t c√¥ng vi·ªác ra Excel');\r\n    }, []);\r\n\r\n    // ‚úÖ Dynamic columns cho C√¥ng vi·ªác (c√≥ action column)\r\n    const taskColumns: ColumnDef<TaskRow>[] = React.useMemo(() => [\r\n        { id: 'title', accessorKey: 'title', header: 'C√¥ng vi·ªác', cell: ({ row }) => <span className=\"font-medium\">{row.title}</span>, meta: { displayName: 'C√¥ng vi·ªác' } },\r\n        { id: 'type', accessorKey: 'type', header: 'ƒê·ªô ∆∞u ti√™n', cell: ({ row }) => row.type, meta: { displayName: 'ƒê·ªô ∆∞u ti√™n' } },\r\n        { id: 'dueDate', accessorKey: 'dueDate', header: 'H·∫°n ch√≥t', cell: ({ row }) => formatDateDisplay(row.dueDate), meta: { displayName: 'H·∫°n ch√≥t' } },\r\n        { id: 'status', accessorKey: 'statusName', header: 'Tr·∫°ng th√°i', cell: ({ row }) => <Badge variant={row.statusVariant}>{row.statusName}</Badge>, meta: { displayName: 'Tr·∫°ng th√°i' } },\r\n        { \r\n            id: 'actions', \r\n            header: () => <div className=\"text-center\">Thao t√°c</div>, \r\n            cell: ({ row }) => (\r\n                <div className=\"flex items-center justify-center\">\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\r\n                                <MoreHorizontal className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuItem onClick={() => handleExportSingleTask(row)}>\r\n                                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\r\n                                Xu·∫•t Excel\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => router.push(row.link)}>\r\n                                <Eye className=\"mr-2 h-4 w-4\" />\r\n                                Xem chi ti·∫øt\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </div>\r\n            ), \r\n            meta: { displayName: 'Thao t√°c', sticky: 'right' as const } \r\n        },\r\n    ], [handleExportSingleTask, router]);\r\n\r\n    const { batches: payrollBatches, payslips: payrollPayslips } = usePayrollBatchStore();\r\n    const payrollHistory = React.useMemo(() => {\r\n        if (!employee) return [] as Array<{ slip: typeof payrollPayslips[number]; batch?: typeof payrollBatches[number] }>;\r\n        return payrollPayslips\r\n            .filter((slip) => slip.employeeSystemId === employee.systemId)\r\n            .map((slip) => ({\r\n                slip,\r\n                batch: payrollBatches.find((batch) => batch.systemId === slip.batchSystemId),\r\n            }))\r\n            .sort((a, b) => {\r\n                const dateA = new Date(a.batch?.payrollDate ?? a.slip.createdAt).getTime();\r\n                const dateB = new Date(b.batch?.payrollDate ?? b.slip.createdAt).getTime();\r\n                return dateB - dateA;\r\n            });\r\n    }, [employee, payrollPayslips, payrollBatches]);\r\n\r\n    const latestPayslip = payrollHistory[0];\r\n    const displayedPayrollHistory = payrollHistory.slice(0, 5);\r\n\r\n    // State for payslip detail dialog\r\n    const [selectedPayslip, setSelectedPayslip] = React.useState<typeof payrollHistory[number] | null>(null);\r\n    const [isPayslipDialogOpen, setIsPayslipDialogOpen] = React.useState(false);\r\n\r\n    // State for attendance detail dialog\r\n    const [selectedAttendance, setSelectedAttendance] = React.useState<typeof attendanceHistory[number] | null>(null);\r\n    const [isAttendanceDialogOpen, setIsAttendanceDialogOpen] = React.useState(false);\r\n\r\n    // Transform payroll history for RelatedDataTable\r\n    const payrollHistoryTableData: PayrollHistoryRow[] = React.useMemo(() => \r\n        displayedPayrollHistory.map(({ slip, batch }) => ({\r\n            systemId: slip.systemId,\r\n            batchId: batch?.id ?? '‚Äî',\r\n            monthLabel: formatMonthLabel(batch?.payPeriod.monthKey ?? slip.periodMonthKey),\r\n            payDate: formatDate(batch?.payrollDate || slip.createdAt) || '‚Äî',\r\n            status: batch?.status ?? 'draft',\r\n            grossEarnings: slip.totals.grossEarnings ?? slip.totals.earnings ?? 0,\r\n            totalInsurance: slip.totals.totalEmployeeInsurance ?? 0,\r\n            personalIncomeTax: slip.totals.personalIncomeTax ?? 0,\r\n            otherDeductions: (slip.totals.penaltyDeductions ?? 0) + (slip.totals.otherDeductions ?? 0),\r\n            totalDeductions: slip.totals.deductions ?? 0,\r\n            netPay: slip.totals.netPay,\r\n            batchSystemId: batch?.systemId,\r\n            payslipSystemId: slip.systemId,\r\n            slip,\r\n            batch,\r\n        })),\r\n    [displayedPayrollHistory]);\r\n\r\n    // Handle print payslip\r\n    // ‚úÖ Handler in phi·∫øu l∆∞∆°ng ƒë∆°n l·∫ª - s·ª≠ d·ª•ng 4-layer print system\r\n    const handlePrintSinglePayslip = React.useCallback((row: PayrollHistoryRow) => {\r\n        if (!row.slip || !employee) {\r\n            toast.error('Kh√¥ng th·ªÉ in', { description: 'Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu phi·∫øu l∆∞∆°ng.' });\r\n            return;\r\n        }\r\n\r\n        const storeSettings = createStoreSettings(storeInfo);\r\n        const payslipForPrint = convertPayslipForPrint(\r\n            row.slip,\r\n            row.batch || {\r\n                systemId: '',\r\n                id: row.batchId,\r\n                title: `B·∫£ng l∆∞∆°ng ${row.monthLabel}`,\r\n                status: row.status,\r\n                payPeriod: { monthKey: row.slip.periodMonthKey },\r\n                payrollDate: row.payDate,\r\n            },\r\n            {\r\n                employee: {\r\n                    fullName: employee.fullName,\r\n                    id: employee.id,\r\n                    department: employee.department,\r\n                    position: employee.positionName,\r\n                },\r\n                departmentName: employee.department,\r\n            }\r\n        );\r\n\r\n        print('payslip', {\r\n            data: mapPayslipToPrintData(payslipForPrint, storeSettings),\r\n            lineItems: mapPayslipComponentLineItems(payslipForPrint.components || []),\r\n        });\r\n\r\n        toast.success('ƒêang in phi·∫øu l∆∞∆°ng...', { description: `${employee.fullName} - ${row.monthLabel}` });\r\n    }, [employee, storeInfo, print]);\r\n\r\n    // Payroll columns for RelatedDataTable\r\n    const payrollColumns: ColumnDef<PayrollHistoryRow>[] = React.useMemo(() => [\r\n        { id: 'batchId', accessorKey: 'batchId', header: 'M√£ BL', size: 95, cell: ({ row }) => (\r\n            <Link \r\n                href={row.batchSystemId ? ROUTES.PAYROLL.DETAIL.replace(':systemId', row.batchSystemId) : '#'}\r\n                className=\"font-mono text-xs text-primary hover:underline\"\r\n                onClick={(e) => e.stopPropagation()}\r\n            >\r\n                {row.batchId}\r\n            </Link>\r\n        ), meta: { displayName: 'M√£ BL' } },\r\n        { id: 'monthLabel', accessorKey: 'monthLabel', header: 'K·ª≥ l∆∞∆°ng', size: 110, cell: ({ row }) => <span className=\"whitespace-nowrap\">{row.monthLabel}</span>, meta: { displayName: 'K·ª≥ l∆∞∆°ng' } },\r\n        { id: 'payDate', accessorKey: 'payDate', header: 'Ng√†y tr·∫£', size: 100, cell: ({ row }) => <span className=\"whitespace-nowrap\">{row.payDate}</span>, meta: { displayName: 'Ng√†y tr·∫£' } },\r\n        { id: 'status', accessorKey: 'status', header: 'Tr·∫°ng th√°i', size: 90, cell: ({ row }) => <PayrollStatusBadge status={row.status} />, meta: { displayName: 'Tr·∫°ng th√°i' } },\r\n        { id: 'grossEarnings', accessorKey: 'grossEarnings', header: () => <span className=\"text-right w-full block\">T·ªïng TN</span>, size: 115, cell: ({ row }) => <span className=\"text-right block tabular-nums\">{formatCurrency(row.grossEarnings)}</span>, meta: { displayName: 'T·ªïng thu nh·∫≠p' } },\r\n        { id: 'totalInsurance', accessorKey: 'totalInsurance', header: () => <span className=\"text-right w-full block\">B·∫£o hi·ªÉm</span>, size: 100, cell: ({ row }) => <span className=\"text-right block tabular-nums text-orange-600\">{row.totalInsurance > 0 ? `-${formatCurrency(row.totalInsurance)}` : '‚Äî'}</span>, meta: { displayName: 'B·∫£o hi·ªÉm' } },\r\n        { id: 'personalIncomeTax', accessorKey: 'personalIncomeTax', header: () => <span className=\"text-right w-full block\">Thu·∫ø TNCN</span>, size: 100, cell: ({ row }) => <span className=\"text-right block tabular-nums text-purple-600\">{row.personalIncomeTax > 0 ? `-${formatCurrency(row.personalIncomeTax)}` : '‚Äî'}</span>, meta: { displayName: 'Thu·∫ø TNCN' } },\r\n        { id: 'otherDeductions', accessorKey: 'otherDeductions', header: () => <span className=\"text-right w-full block\">Kh√°c</span>, size: 90, cell: ({ row }) => <span className=\"text-right block tabular-nums text-gray-600\">{row.otherDeductions > 0 ? `-${formatCurrency(row.otherDeductions)}` : '‚Äî'}</span>, meta: { displayName: 'Kh·∫•u tr·ª´ kh√°c' } },\r\n        { id: 'totalDeductions', accessorKey: 'totalDeductions', header: () => <span className=\"text-right w-full block\">T·ªïng tr·ª´</span>, size: 110, cell: ({ row }) => <span className=\"text-right block tabular-nums text-destructive font-medium\">{formatCurrency(row.totalDeductions)}</span>, meta: { displayName: 'T·ªïng kh·∫•u tr·ª´' } },\r\n        { id: 'netPay', accessorKey: 'netPay', header: () => <span className=\"text-right w-full block\">Th·ª±c lƒ©nh</span>, size: 120, cell: ({ row }) => <span className=\"text-right block tabular-nums font-bold text-green-600\">{formatCurrency(row.netPay)}</span>, meta: { displayName: 'Th·ª±c lƒ©nh' } },\r\n        { \r\n            id: 'actions', \r\n            header: '', \r\n            size: 50,\r\n            cell: ({ row }) => (\r\n                <div onClick={(e) => e.stopPropagation()}>\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                <MoreHorizontal className=\"h-4 w-4\" />\r\n                                <span className=\"sr-only\">M·ªü menu</span>\r\n                            </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuItem onClick={() => {\r\n                                setSelectedPayslip({ slip: row.slip, batch: row.batch });\r\n                                setIsPayslipDialogOpen(true);\r\n                            }}>\r\n                                <Eye className=\"mr-2 h-4 w-4\" />\r\n                                Xem chi ti·∫øt\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => handlePrintSinglePayslip(row)}>\r\n                                <Printer className=\"mr-2 h-4 w-4\" />\r\n                                In phi·∫øu l∆∞∆°ng\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => {\r\n                                if (row.batchSystemId) {\r\n                                    router.push(ROUTES.PAYROLL.DETAIL.replace(':systemId', row.batchSystemId));\r\n                                }\r\n                            }}>\r\n                                <ExternalLink className=\"mr-2 h-4 w-4\" />\r\n                                Xem b·∫£ng l∆∞∆°ng\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </div>\r\n            ), \r\n            meta: { displayName: 'Thao t√°c', sticky: 'right' as const } \r\n        },\r\n    ], [router, handlePrintSinglePayslip]);\r\n\r\n    const handlePayrollRowClick = React.useCallback((row: PayrollHistoryRow) => {\r\n        const historyItem = displayedPayrollHistory.find(h => h.slip.systemId === row.systemId);\r\n        if (historyItem) {\r\n            setSelectedPayslip(historyItem);\r\n            setIsPayslipDialogOpen(true);\r\n        }\r\n    }, [displayedPayrollHistory]);\r\n\r\n    const handleViewPayroll = React.useCallback(\r\n        (batchSystemId?: string) => {\r\n            if (!batchSystemId) return;\r\n            router.push(ROUTES.PAYROLL.DETAIL.replace(':systemId', batchSystemId));\r\n        },\r\n        [router]\r\n    );\r\n\r\n    // ‚úÖ Custom bulk actions for payroll table - s·ª≠ d·ª•ng 4-layer print system\r\n    const payrollBulkActions = React.useMemo(() => {\r\n        const handlePrintPayslips = (rows: PayrollHistoryRow[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn phi·∫øu l∆∞∆°ng n√†o');\r\n                return;\r\n            }\r\n\r\n            const storeSettings = createStoreSettings(storeInfo);\r\n\r\n            // In nhi·ªÅu phi·∫øu l∆∞∆°ng c√πng l√∫c\r\n            const printOptionsList = rows.map(row => {\r\n                const payslipForPrint = convertPayslipForPrint(\r\n                    row.slip,\r\n                    row.batch || {\r\n                        systemId: '',\r\n                        id: row.batchId,\r\n                        title: `B·∫£ng l∆∞∆°ng ${row.monthLabel}`,\r\n                        status: row.status,\r\n                        payPeriod: { monthKey: row.slip.periodMonthKey },\r\n                        payrollDate: row.payDate,\r\n                    },\r\n                    {\r\n                        employee: employee ? {\r\n                            fullName: employee.fullName,\r\n                            id: employee.id,\r\n                            department: employee.department,\r\n                            position: employee.positionName,\r\n                        } : undefined,\r\n                        departmentName: employee?.department,\r\n                    }\r\n                );\r\n\r\n                return {\r\n                    data: mapPayslipToPrintData(payslipForPrint, storeSettings),\r\n                    lineItems: mapPayslipComponentLineItems(payslipForPrint.components || []),\r\n                };\r\n            });\r\n\r\n            // S·ª≠ d·ª•ng printMultiple ƒë·ªÉ in nhi·ªÅu phi·∫øu c√πng l√∫c\r\n            printMultiple('payslip', printOptionsList);\r\n            toast.success(`ƒêang in ${rows.length} phi·∫øu l∆∞∆°ng...`);\r\n        };\r\n\r\n        const handleExportExcel = (rows: PayrollHistoryRow[]) => {\r\n            if (rows.length === 0) {\r\n                toast.error('Ch∆∞a ch·ªçn d·ªØ li·ªáu n√†o');\r\n                return;\r\n            }\r\n\r\n            const headers = ['M√£ BL', 'K·ª≥ l∆∞∆°ng', 'Ng√†y tr·∫£', 'Tr·∫°ng th√°i', 'T·ªïng TN', 'B·∫£o hi·ªÉm', 'Thu·∫ø TNCN', 'Kh·∫•u tr·ª´ kh√°c', 'T·ªïng tr·ª´', 'Th·ª±c lƒ©nh'];\r\n            const mappedData = rows.map(row => ({\r\n                'M√£ BL': row.batchId,\r\n                'K·ª≥ l∆∞∆°ng': row.monthLabel,\r\n                'Ng√†y tr·∫£': row.payDate,\r\n                'Tr·∫°ng th√°i': row.status,\r\n                'T·ªïng TN': row.grossEarnings,\r\n                'B·∫£o hi·ªÉm': row.totalInsurance,\r\n                'Thu·∫ø TNCN': row.personalIncomeTax,\r\n                'Kh·∫•u tr·ª´ kh√°c': row.otherDeductions,\r\n                'T·ªïng tr·ª´': row.totalDeductions,\r\n                'Th·ª±c lƒ©nh': row.netPay,\r\n            }));\r\n\r\n            const ws = XLSX.utils.json_to_sheet(mappedData, { header: headers });\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, 'L∆∞∆°ng');\r\n            XLSX.writeFile(wb, `Luong_${employee?.id || 'NV'}_selected.xlsx`);\r\n            toast.success(`ƒê√£ xu·∫•t ${rows.length} d√≤ng ra Excel`);\r\n        };\r\n\r\n        return [\r\n            {\r\n                label: 'In phi·∫øu l∆∞∆°ng',\r\n                icon: Printer,\r\n                onSelect: handlePrintPayslips,\r\n            },\r\n            {\r\n                label: 'Xu·∫•t Excel',\r\n                icon: FileSpreadsheet,\r\n                onSelect: handleExportExcel,\r\n            },\r\n        ];\r\n    }, [employee, storeInfo, printMultiple]);\r\n\r\n    // Actions for detail page\r\n    const headerActions = React.useMemo(() => [\r\n        <Button key=\"back\" variant=\"outline\" size=\"sm\" className=\"h-9\" onClick={() => router.push('/employees')}>\r\n            <ArrowLeft className=\"mr-2 h-4 w-4\" />\r\n            Quay l·∫°i\r\n        </Button>,\r\n        <Button key=\"edit\" size=\"sm\" className=\"h-9\" onClick={() => router.push(`/employees/${systemId}/edit`)}>\r\n            <Edit className=\"mr-2 h-4 w-4\" />\r\n            Ch·ªânh s·ª≠a\r\n        </Button>\r\n    ], [router, systemId]);\r\n\r\n  // ‚úÖ Auto-generate breadcrumb\r\n  const breadcrumb = React.useMemo(() => {\r\n    if (!employee) return [\r\n      { label: 'Trang ch·ªß', href: '/', isCurrent: false },\r\n      { label: 'Nh√¢n vi√™n', href: '/employees', isCurrent: false },\r\n      { label: 'Chi ti·∫øt', href: '', isCurrent: true }\r\n    ];\r\n    return [\r\n      { label: 'Trang ch·ªß', href: '/', isCurrent: false },\r\n      { label: 'Nh√¢n vi√™n', href: '/employees', isCurrent: false },\r\n            { label: employee.fullName, href: '', isCurrent: true }\r\n    ];\r\n  }, [employee]);\r\n\r\n    const headerBadge = React.useMemo(() => renderEmploymentStatusBadge(employee?.employmentStatus), [employee?.employmentStatus]);\r\n\r\n  usePageHeader({\r\n        title: employee?.fullName || 'Chi ti·∫øt Nh√¢n vi√™n',\r\n        badge: headerBadge,\r\n    actions: headerActions,\r\n        breadcrumb\r\n  });\r\n\r\n  if (!employee) {\r\n    return (\r\n      <div className=\"flex h-full items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-h3 font-bold\">Kh√¥ng t√¨m th·∫•y nh√¢n vi√™n</h2>\r\n          <p className=\"text-muted-foreground mt-2\">Nh√¢n vi√™n b·∫°n ƒëang t√¨m ki·∫øm kh√¥ng t·ªìn t·∫°i.</p>\r\n          <Button onClick={() => router.push('/employees')} className=\"mt-4\" size=\"sm\">\r\n            <ArrowLeft className=\"mr-2 h-4 w-4\" />\r\n            Quay v·ªÅ danh s√°ch\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const getInitials = (name: string) => {\r\n    return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\r\n  };\r\n\r\n  const calculateWorkDuration = () => {\r\n    if (!employee.hireDate) return '0 th√°ng';\r\n    const months = getMonthsDiff(employee.hireDate, new Date());\r\n    const years = Math.floor(months / 12);\r\n    const remainingMonths = months % 12;\r\n    if (years > 0) {\r\n      return `${years} nƒÉm ${remainingMonths > 0 ? `${remainingMonths} th√°ng` : ''}`;\r\n    }\r\n    return `${months} th√°ng`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full h-full\">\r\n      <div className=\"space-y-6\">\r\n        {/* Profile Card */}\r\n        <Card>\r\n            <CardContent className=\"pt-6\">\r\n                <div className=\"flex flex-col sm:flex-row gap-6\">\r\n                    <Avatar className=\"h-20 w-20\">\r\n                        <AvatarImage src={employee.avatarUrl} alt={employee.fullName} />\r\n                        <AvatarFallback>{getInitials(employee.fullName)}</AvatarFallback>\r\n                    </Avatar>\r\n                    <div className=\"flex-1 space-y-3\">\r\n                        <div className=\"grid gap-1\">\r\n                            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                                <Mail className=\"h-4 w-4\" />\r\n                                <span>{employee.workEmail || '‚Äî'}</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                                <Phone className=\"h-4 w-4\" />\r\n                                <span>{employee.phone || '‚Äî'}</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                                <Building2 className=\"h-4 w-4\" />\r\n                                {employee.branchSystemId ? (\r\n                                    <Link \r\n                                        href={`/branches/${employee.branchSystemId}`}\r\n                                        className=\"hover:underline text-primary\"\r\n                                    >\r\n                                        {branchName}\r\n                                    </Link>\r\n                                ) : (\r\n                                    <span>{branchName}</span>\r\n                                )}\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                                <Calendar className=\"h-4 w-4\" />\r\n                                <span>L√†m vi·ªác {calculateWorkDuration()}</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            <Badge variant={employee.employmentStatus === \"ƒêang l√†m vi·ªác\" ? \"default\" : employee.employmentStatus === \"T·∫°m ngh·ªâ\" ? \"secondary\" : \"destructive\"}>\r\n                                {employee.employmentStatus}\r\n                            </Badge>\r\n                            <Badge variant=\"outline\">{employee.employeeType}</Badge>\r\n                            <Badge variant=\"outline\">{employee.id}</Badge>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n\r\n        {/* Stats */}\r\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n            <StatsCard\r\n                title=\"L∆∞∆°ng c∆° b·∫£n\"\r\n                value={formatCurrency(employee.baseSalary)}\r\n                icon={DollarSign}\r\n                description=\"/ th√°ng\"\r\n            />\r\n            <StatsCard\r\n                title=\"Ng√†y ph√©p c√≤n l·∫°i\"\r\n                value={12 - (employee.leaveTaken || 0)}\r\n                icon={Calendar}\r\n                description={`ƒê√£ d√πng ${employee.leaveTaken || 0}/12 ng√†y`}\r\n            />\r\n            <StatsCard\r\n                title=\"C√¥ng vi·ªác\"\r\n                value={employeeTasks.length}\r\n                icon={Briefcase}\r\n                description={`${employeeTasks.filter((t: any) => t.statusName !== 'Ho√†n th√†nh').length} ƒëang l√†m`}\r\n            />\r\n        </div>\r\n\r\n        <Tabs defaultValue=\"personal\">\r\n            <div className=\"w-full overflow-x-auto overflow-y-hidden mb-4 pb-1\" style={{ WebkitOverflowScrolling: 'touch', scrollbarWidth: 'thin' }}>\r\n                <TabsList className=\"inline-flex w-auto gap-1 p-1 h-auto justify-start\">\r\n                    <TabsTrigger value=\"personal\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">Th√¥ng tin c√° nh√¢n</TabsTrigger>\r\n                    <TabsTrigger value=\"addresses\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">ƒê·ªãa ch·ªâ</TabsTrigger>\r\n                    <TabsTrigger value=\"work\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">Th√¥ng tin c√¥ng vi·ªác</TabsTrigger>\r\n                    <TabsTrigger value=\"account\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">Th√¥ng tin ƒëƒÉng nh·∫≠p</TabsTrigger>\r\n                    <TabsTrigger value=\"documents\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">T√†i li·ªáu</TabsTrigger>\r\n                    <TabsTrigger value=\"penalties\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">Phi·∫øu ph·∫°t</TabsTrigger>\r\n                    <TabsTrigger value=\"leaves\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">L·ªãch s·ª≠ ngh·ªâ ph√©p</TabsTrigger>\r\n                    <TabsTrigger value=\"kpi\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">KPI</TabsTrigger>\r\n                    <TabsTrigger value=\"tasks\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">C√¥ng vi·ªác</TabsTrigger>\r\n                    <TabsTrigger value=\"payroll\" className=\"flex-shrink-0 px-3 py-2 text-sm font-normal whitespace-nowrap\">L∆∞∆°ng & ch·∫•m c√¥ng</TabsTrigger>\r\n                </TabsList>\r\n            </div>\r\n\r\n            <TabsContent value=\"personal\" className=\"space-y-4\">\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                    {/* Personal Information */}\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">Th√¥ng tin c√° nh√¢n</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4\">\r\n                            <InfoItem label=\"Gi·ªõi t√≠nh\" value={employee.gender} />\r\n                            <InfoItem label=\"Ng√†y sinh\" value={formatDate(employee.dob)} />\r\n                            <InfoItem label=\"N∆°i sinh\" value={employee.placeOfBirth} />\r\n                            <InfoItem label=\"T√¨nh tr·∫°ng h√¥n nh√¢n\" value={employee.maritalStatus} />\r\n                            <InfoItem label=\"S·ªë ƒëi·ªán tho·∫°i\" value={employee.phone} />\r\n                            <InfoItem label=\"Email c√° nh√¢n\" value={employee.personalEmail} />\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Identification & Bank */}\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">ƒê·ªãnh danh & Ng√¢n h√†ng</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4\">\r\n                            <InfoItem label=\"S·ªë CCCD\" value={employee.nationalId} />\r\n                            <InfoItem label=\"Ng√†y c·∫•p\" value={formatDate(employee.nationalIdIssueDate)} />\r\n                            <InfoItem label=\"N∆°i c·∫•p\" value={employee.nationalIdIssuePlace} />\r\n                            <InfoItem label=\"M√£ s·ªë thu·∫ø\" value={employee.personalTaxId} />\r\n                            <InfoItem label=\"S·ªë s·ªï BHXH\" value={employee.socialInsuranceNumber} />\r\n                            <InfoItem label=\"Ng√¢n h√†ng\" value={employee.bankName} />\r\n                            <InfoItem label=\"Chi nh√°nh\" value={employee.bankBranch} />\r\n                            <InfoItem label=\"S·ªë t√†i kho·∫£n\" value={employee.bankAccountNumber} />\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Emergency Contact */}\r\n                    <Card className=\"md:col-span-2\">\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">Li√™n h·ªá kh·∫©n c·∫•p</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4 md:grid-cols-2\">\r\n                            <InfoItem label=\"T√™n ng∆∞·ªùi th√¢n\" value={employee.emergencyContactName} />\r\n                            <InfoItem label=\"SƒêT ng∆∞·ªùi th√¢n\" value={employee.emergencyContactPhone} />\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"addresses\" className=\"space-y-4\">\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">ƒê·ªãa ch·ªâ th∆∞·ªùng tr√∫</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4\">\r\n                             {employee.permanentAddress ? (\r\n                                <>\r\n                                    <InfoItem label=\"S·ªë nh√†, ƒë∆∞·ªùng\" value={employee.permanentAddress.street} />\r\n                                    <InfoItem label=\"Ph∆∞·ªùng/X√£\" value={employee.permanentAddress.ward} />\r\n                                    {employee.permanentAddress.inputLevel === '3-level' && (\r\n                                        <InfoItem label=\"Qu·∫≠n/Huy·ªán\" value={employee.permanentAddress.district} />\r\n                                    )}\r\n                                    <InfoItem label=\"T·ªânh/Th√†nh ph·ªë\" value={employee.permanentAddress.province} />\r\n                                    <InfoItem label=\"ƒê·∫ßy ƒë·ªß\" value={formatAddressDisplay(employee.permanentAddress)} />\r\n                                </>\r\n                             ) : (\r\n                                 <p className=\"text-sm text-muted-foreground\">Ch∆∞a c·∫≠p nh·∫≠t</p>\r\n                             )}\r\n                        </CardContent>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">ƒê·ªãa ch·ªâ t·∫°m tr√∫</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4\">\r\n                             {employee.temporaryAddress ? (\r\n                                <>\r\n                                    <InfoItem label=\"S·ªë nh√†, ƒë∆∞·ªùng\" value={employee.temporaryAddress.street} />\r\n                                    <InfoItem label=\"Ph∆∞·ªùng/X√£\" value={employee.temporaryAddress.ward} />\r\n                                    {employee.temporaryAddress.inputLevel === '3-level' && (\r\n                                        <InfoItem label=\"Qu·∫≠n/Huy·ªán\" value={employee.temporaryAddress.district} />\r\n                                    )}\r\n                                    <InfoItem label=\"T·ªânh/Th√†nh ph·ªë\" value={employee.temporaryAddress.province} />\r\n                                    <InfoItem label=\"ƒê·∫ßy ƒë·ªß\" value={formatAddressDisplay(employee.temporaryAddress)} />\r\n                                </>\r\n                             ) : (\r\n                                 <p className=\"text-sm text-muted-foreground\">Ch∆∞a c·∫≠p nh·∫≠t</p>\r\n                             )}\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"work\" className=\"space-y-4\">\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                    {/* Work Information */}\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">Th√¥ng tin c√¥ng vi·ªác</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4\">\r\n                            <InfoItem label=\"Email c√¥ng vi·ªác\" value={employee.workEmail} />\r\n                            <InfoItem label=\"Chi nh√°nh\">\r\n                                {employee.branchSystemId ? (\r\n                                    <Link \r\n                                        href={`/branches/${employee.branchSystemId}`}\r\n                                        className=\"hover:underline text-primary\"\r\n                                    >\r\n                                        {branchName}\r\n                                    </Link>\r\n                                ) : (\r\n                                    <span>{branchName}</span>\r\n                                )}\r\n                            </InfoItem>\r\n                            <InfoItem label=\"Ph√≤ng ban\" value={employee.department} />\r\n                            <InfoItem label=\"Ch·ª©c danh\" value={employee.jobTitle} />\r\n                            <InfoItem label=\"S·ªë h·ª£p ƒë·ªìng\" value={employee.contractNumber} />\r\n                            <InfoItem label=\"Ng√†y k√Ω Hƒê\" value={formatDate(employee.contractStartDate)} />\r\n                            <InfoItem label=\"Ng√†y h·∫øt h·∫°n Hƒê\" value={formatDate(employee.contractEndDate)} />\r\n                            <InfoItem label=\"Ng√†y v√†o l√†m\" value={formatDate(employee.hireDate)} />\r\n                            <InfoItem label=\"Lo·∫°i nh√¢n vi√™n\" value={employee.employeeType} />\r\n                            <InfoItem label=\"Tr·∫°ng th√°i\">\r\n                                <Badge variant={employee.employmentStatus === \"ƒêang l√†m vi·ªác\" ? \"default\" : employee.employmentStatus === \"T·∫°m ngh·ªâ\" ? \"secondary\" : \"destructive\"}>\r\n                                    {employee.employmentStatus}\r\n                                </Badge>\r\n                            </InfoItem>\r\n                            {employee.terminationDate && (\r\n                                <InfoItem label=\"Ng√†y ngh·ªâ vi·ªác\" value={formatDate(employee.terminationDate)} />\r\n                            )}\r\n                            {employee.reasonForLeaving && (\r\n                                <InfoItem label=\"L√Ω do ngh·ªâ vi·ªác\" value={employee.reasonForLeaving} />\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Salary & Allowances */}\r\n                    <Card>\r\n                        <CardHeader>\r\n                            <CardTitle className=\"text-h6\">L∆∞∆°ng & Ph·ª• c·∫•p</CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"grid gap-4\">\r\n                            <InfoItem label=\"L∆∞∆°ng c∆° b·∫£n\" value={formatCurrency(employee.baseSalary)} />\r\n                            <InfoItem label=\"L∆∞∆°ng ƒë√≥ng BHXH\" value={formatCurrency(employee.socialInsuranceSalary)} />\r\n                            <InfoItem label=\"Ph·ª• c·∫•p ch·ª©c v·ª•\" value={formatCurrency(employee.positionAllowance)} />\r\n                            <InfoItem label=\"Ph·ª• c·∫•p ƒÉn tr∆∞a\" value={formatCurrency(employee.mealAllowance)} />\r\n                            <InfoItem label=\"Ph·ª• c·∫•p kh√°c\" value={formatCurrency(employee.otherAllowances)} />\r\n                            <InfoItem label=\"Ph√©p ƒë√£ ngh·ªâ\" value={`${employee.leaveTaken || 0} / 12 ng√†y`} />\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"account\" className=\"space-y-4\">\r\n                <EmployeeAccountTab employee={employee} />\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"documents\" className=\"space-y-4\">\r\n                <EmployeeDocuments employeeSystemId={employee.systemId || employee.id} />\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"penalties\" className=\"space-y-4\">\r\n                <Card>\r\n                    <CardContent className=\"p-4\">\r\n                        <RelatedDataTable \r\n                            data={employeePenalties} \r\n                            columns={penaltyColumns} \r\n                            searchKeys={['reason', 'id']} \r\n                            searchPlaceholder=\"T√¨m theo l√Ω do...\" \r\n                            dateFilterColumn=\"issueDate\" \r\n                            dateFilterTitle=\"Ng√†y l·∫≠p phi·∫øu\" \r\n                            exportFileName={`Lich_su_phat_${employee.id}`} \r\n                            onRowClick={(row) => router.push(`/penalties/${row.systemId}`)} \r\n                            showCheckbox\r\n                            customBulkActions={penaltyBulkActions}\r\n                        />\r\n                    </CardContent>\r\n                </Card>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"leaves\" className=\"space-y-4\">\r\n                <Card>\r\n                    <CardContent className=\"p-4\">\r\n                        <RelatedDataTable \r\n                            data={employeeLeaves} \r\n                            columns={leaveColumns} \r\n                            searchKeys={['id', 'leaveTypeName', 'reason']} \r\n                            searchPlaceholder=\"T√¨m theo m√£ ƒë∆°n, lo·∫°i ph√©p...\" \r\n                            dateFilterColumn=\"startDate\" \r\n                            dateFilterTitle=\"Ng√†y b·∫Øt ƒë·∫ßu\" \r\n                            exportFileName={`Lich_su_nghi_phep_${employee.id}`} \r\n                            onRowClick={(row) => router.push(`/leaves/${row.systemId}`)} \r\n                            showCheckbox\r\n                            customBulkActions={leaveBulkActions}\r\n                        />\r\n                    </CardContent>\r\n                </Card>\r\n            </TabsContent>\r\n            \r\n            <TabsContent value=\"kpi\" className=\"space-y-4\">\r\n                <PlaceholderTabContent title=\"ƒê√°nh gi√° KPI\" />\r\n            </TabsContent>\r\n\r\n                        <TabsContent value=\"tasks\" className=\"space-y-4\">\r\n                                <Card>\r\n                                        <CardContent className=\"p-4\">\r\n                                                <RelatedDataTable \r\n                                                        data={employeeTasks} \r\n                                                        columns={taskColumns} \r\n                                                        searchKeys={['title', 'type']} \r\n                                                        searchPlaceholder=\"T√¨m c√¥ng vi·ªác...\" \r\n                                                        dateFilterColumn=\"dueDate\" \r\n                                                        dateFilterTitle=\"H·∫°n ch√≥t\" \r\n                                                        exportFileName={`Cong_viec_${employee.id}`} \r\n                                                        onRowClick={(row) => router.push(row.link)} \r\n                                                        showCheckbox\r\n                                                        customBulkActions={taskBulkActions}\r\n                                                />\r\n                                        </CardContent>\r\n                                </Card>\r\n                        </TabsContent>\r\n\r\n                        <TabsContent value=\"payroll\" className=\"space-y-4\">\r\n                                {/* B·∫£ng l∆∞∆°ng g·∫ßn ƒë√¢y - ƒê·∫∂T L√äN ƒê·∫¶U */}\r\n                                <Card>\r\n                                    <CardHeader>\r\n                                        <CardTitle className=\"text-h6\">B·∫£ng l∆∞∆°ng g·∫ßn ƒë√¢y</CardTitle>\r\n                                        <CardDescription>\r\n                                            Hi·ªÉn th·ªã t·ªëi ƒëa 5 k·ª≥ g·∫ßn nh·∫•t m√† nh√¢n vi√™n tham gia. Click v√†o d√≤ng ƒë·ªÉ xem chi ti·∫øt.\r\n                                        </CardDescription>\r\n                                    </CardHeader>\r\n                                    <CardContent>\r\n                                        {payrollHistoryTableData.length === 0 ? (\r\n                                            <div className=\"flex h-32 items-center justify-center rounded-lg border border-dashed\">\r\n                                                <p className=\"text-sm text-muted-foreground\">\r\n                                                    Nh√¢n vi√™n ch∆∞a c√≥ phi·∫øu l∆∞∆°ng n√†o ƒë∆∞·ª£c t·∫°o.\r\n                                                </p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <RelatedDataTable\r\n                                                data={payrollHistoryTableData}\r\n                                                columns={payrollColumns}\r\n                                                searchKeys={['batchId', 'monthLabel']}\r\n                                                searchPlaceholder=\"T√¨m b·∫£ng l∆∞∆°ng...\"\r\n                                                exportFileName={`Luong_${employee.id}`}\r\n                                                onRowClick={handlePayrollRowClick}\r\n                                                showCheckbox\r\n                                                defaultSorting={{ id: 'payDate', desc: true }}\r\n                                                customBulkActions={payrollBulkActions}\r\n                                            />\r\n                                        )}\r\n                                    </CardContent>\r\n                                </Card>\r\n\r\n                                {/* L·ªãch s·ª≠ ch·∫•m c√¥ng */}\r\n                                <Card>\r\n                                    <CardHeader>\r\n                                        <CardTitle className=\"text-h6\">L·ªãch s·ª≠ ch·∫•m c√¥ng</CardTitle>\r\n                                        <CardDescription>\r\n                                            Hi·ªÉn th·ªã d·ªØ li·ªáu ch·∫•m c√¥ng theo t·ª´ng th√°ng. Click v√†o d√≤ng ƒë·ªÉ xem chi ti·∫øt.\r\n                                        </CardDescription>\r\n                                    </CardHeader>\r\n                                    <CardContent>\r\n                                        {attendanceHistory.length === 0 ? (\r\n                                            <div className=\"flex h-32 items-center justify-center rounded-lg border border-dashed\">\r\n                                                <p className=\"text-sm text-muted-foreground\">\r\n                                                    Ch∆∞a c√≥ d·ªØ li·ªáu ch·∫•m c√¥ng cho nh√¢n vi√™n n√†y.\r\n                                                </p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <RelatedDataTable\r\n                                                data={attendanceHistory}\r\n                                                columns={attendanceColumns}\r\n                                                searchKeys={['monthLabel']}\r\n                                                searchPlaceholder=\"T√¨m theo th√°ng...\"\r\n                                                exportFileName={`ChamCong_${employee.id}`}\r\n                                                onRowClick={(row) => {\r\n                                                    setSelectedAttendance(row);\r\n                                                    setIsAttendanceDialogOpen(true);\r\n                                                }}\r\n                                                showCheckbox\r\n                                                defaultSorting={{ id: 'monthKey', desc: true }}\r\n                                                customBulkActions={attendanceBulkActions}\r\n                                            />\r\n                                        )}\r\n                                    </CardContent>\r\n                                </Card>\r\n\r\n                                {/* Th√†nh ph·∫ßn l∆∞∆°ng & Th√¥ng tin tr·∫£ l∆∞∆°ng */}\r\n                                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                                    <Card>\r\n                                        <CardHeader>\r\n                                            <CardTitle className=\"text-h6\">Th√†nh ph·∫ßn l∆∞∆°ng ƒëang √°p d·ª•ng</CardTitle>\r\n                                            <CardDescription>\r\n                                                {payrollProfile?.usesDefaultComponents\r\n                                                    ? 'ƒêang d√πng c·∫•u h√¨nh m·∫∑c ƒë·ªãnh t·ª´ C√†i ƒë·∫∑t > Nh√¢n vi√™n'\r\n                                                    : 'ƒê∆∞·ª£c c·∫•u h√¨nh ri√™ng cho nh√¢n vi√™n n√†y'}\r\n                                            </CardDescription>\r\n                                        </CardHeader>\r\n                                        <CardContent className=\"space-y-4\">\r\n                                            {payrollComponents.length === 0 && (\r\n                                                <p className=\"text-sm text-muted-foreground\">Ch∆∞a thi·∫øt l·∫≠p th√†nh ph·∫ßn l∆∞∆°ng.</p>\r\n                                            )}\r\n                                            \r\n                                            {/* Kho·∫£n thu nh·∫≠p */}\r\n                                            {payrollComponents.filter(c => c.category === 'earning').length > 0 && (\r\n                                                <div className=\"space-y-2\">\r\n                                                    <h4 className=\"text-sm font-semibold text-green-700 flex items-center gap-2\">\r\n                                                        <DollarSign className=\"h-4 w-4\" /> Thu nh·∫≠p\r\n                                                    </h4>\r\n                                                    {payrollComponents.filter(c => c.category === 'earning').map((component) => (\r\n                                                        <div\r\n                                                            key={component.systemId}\r\n                                                            className=\"flex items-center justify-between rounded-lg border border-green-200 bg-green-50/50 p-3\"\r\n                                                        >\r\n                                                            <div>\r\n                                                                <p className=\"font-medium\">{component.name}</p>\r\n                                                                <p className=\"text-sm text-muted-foreground\">\r\n                                                                    {component.type === 'fixed'\r\n                                                                        ? formatCurrency(component.amount)\r\n                                                                        : component.formula || 'Theo c√¥ng th·ª©c'}\r\n                                                                </p>\r\n                                                            </div>\r\n                                                            <div className=\"flex gap-1\">\r\n                                                                <Badge variant={component.taxable ? 'default' : 'secondary'} className=\"text-xs\">\r\n                                                                    {component.taxable ? 'T√≠nh thu·∫ø' : 'Kh√¥ng thu·∫ø'}\r\n                                                                </Badge>\r\n                                                                {component.partOfSocialInsurance && (\r\n                                                                    <Badge variant=\"outline\" className=\"text-xs\">ƒê√≥ng BH</Badge>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {/* Kho·∫£n kh·∫•u tr·ª´ */}\r\n                                            {payrollComponents.filter(c => c.category === 'deduction').length > 0 && (\r\n                                                <div className=\"space-y-2\">\r\n                                                    <h4 className=\"text-sm font-semibold text-red-700 flex items-center gap-2\">\r\n                                                        <FileText className=\"h-4 w-4\" /> Kh·∫•u tr·ª´\r\n                                                    </h4>\r\n                                                    {payrollComponents.filter(c => c.category === 'deduction').map((component) => (\r\n                                                        <div\r\n                                                            key={component.systemId}\r\n                                                            className=\"flex items-center justify-between rounded-lg border border-red-200 bg-red-50/50 p-3\"\r\n                                                        >\r\n                                                            <div>\r\n                                                                <p className=\"font-medium\">{component.name}</p>\r\n                                                                <p className=\"text-sm text-muted-foreground\">\r\n                                                                    {component.type === 'fixed'\r\n                                                                        ? formatCurrency(component.amount)\r\n                                                                        : component.formula || 'Theo c√¥ng th·ª©c'}\r\n                                                                </p>\r\n                                                            </div>\r\n                                                            <Badge variant=\"destructive\" className=\"text-xs\">\r\n                                                                Kh·∫•u tr·ª´\r\n                                                            </Badge>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {/* Kho·∫£n ƒë√≥ng g√≥p */}\r\n                                            {payrollComponents.filter(c => c.category === 'contribution').length > 0 && (\r\n                                                <div className=\"space-y-2\">\r\n                                                    <h4 className=\"text-sm font-semibold text-blue-700 flex items-center gap-2\">\r\n                                                        <Building2 className=\"h-4 w-4\" /> ƒê√≥ng g√≥p\r\n                                                    </h4>\r\n                                                    {payrollComponents.filter(c => c.category === 'contribution').map((component) => (\r\n                                                        <div\r\n                                                            key={component.systemId}\r\n                                                            className=\"flex items-center justify-between rounded-lg border border-blue-200 bg-blue-50/50 p-3\"\r\n                                                        >\r\n                                                            <div>\r\n                                                                <p className=\"font-medium\">{component.name}</p>\r\n                                                                <p className=\"text-sm text-muted-foreground\">\r\n                                                                    {component.type === 'fixed'\r\n                                                                        ? formatCurrency(component.amount)\r\n                                                                        : component.formula || 'Theo c√¥ng th·ª©c'}\r\n                                                                </p>\r\n                                                            </div>\r\n                                                            <Badge variant=\"secondary\" className=\"text-xs\">\r\n                                                                ƒê√≥ng g√≥p\r\n                                                            </Badge>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n\r\n                                    <Card>\r\n                                        <CardHeader className=\"space-y-1\">\r\n                                            <CardTitle className=\"text-h6\">Th√¥ng tin tr·∫£ l∆∞∆°ng</CardTitle>\r\n                                            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                                                <Lock className=\"h-4 w-4\" />\r\n                                                <span>H√¨nh th·ª©c: {payrollProfile?.paymentMethod === 'cash' ? 'Ti·ªÅn m·∫∑t' : 'Chuy·ªÉn kho·∫£n'}</span>\r\n                                            </div>\r\n                                        </CardHeader>\r\n                                        <CardContent className=\"space-y-2 text-sm\">\r\n                                            {payrollProfile?.paymentMethod === 'cash' ? (\r\n                                                <p className=\"text-muted-foreground\">Tr·∫£ l∆∞∆°ng tr·ª±c ti·∫øp, kh√¥ng c·∫ßn t√†i kho·∫£n ng√¢n h√†ng.</p>\r\n                                            ) : (\r\n                                                <>\r\n                                                    <InfoItem label=\"S·ªë t√†i kho·∫£n\" value={payrollProfile?.payrollBankAccount?.accountNumber || employee.bankAccountNumber || '‚Äî'} />\r\n                                                    <InfoItem label=\"Ng√¢n h√†ng\" value={payrollProfile?.payrollBankAccount?.bankName || employee.bankName || '‚Äî'} />\r\n                                                    <InfoItem label=\"Chi nh√°nh\" value={payrollProfile?.payrollBankAccount?.bankBranch || employee.bankBranch || '‚Äî'} />\r\n                                                </>\r\n                                            )}\r\n                                            {payrollShift ? (\r\n                                                <InfoItem\r\n                                                    label=\"Ca m·∫∑c ƒë·ªãnh\"\r\n                                                    value={`${payrollShift.name} (${payrollShift.startTime} - ${payrollShift.endTime})`}\r\n                                                />\r\n                                            ) : (\r\n                                                <InfoItem label=\"Ca m·∫∑c ƒë·ªãnh\" value=\"Theo c√†i ƒë·∫∑t chung\" />\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                </div>\r\n                        </TabsContent>\r\n\r\n        {/* Payslip Detail Dialog */}\r\n        <Dialog open={isPayslipDialogOpen} onOpenChange={setIsPayslipDialogOpen}>\r\n            <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Chi ti·∫øt phi·∫øu l∆∞∆°ng</DialogTitle>\r\n                    <DialogDescription>\r\n                        {selectedPayslip?.batch?.id ?? 'Phi·∫øu l∆∞∆°ng'} - {formatMonthLabel(selectedPayslip?.batch?.payPeriod.monthKey ?? selectedPayslip?.slip.periodMonthKey)}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n                {selectedPayslip && (\r\n                    <div className=\"space-y-4\">\r\n                        {/* Th√¥ng tin chung */}\r\n                        <div className=\"grid grid-cols-2 gap-x-6 gap-y-2 text-sm border rounded-lg p-4 bg-muted/30\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">M√£ b·∫£ng l∆∞∆°ng:</span>\r\n                                <span className=\"font-medium\">{selectedPayslip.batch?.id ?? '‚Äî'}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">Tr·∫°ng th√°i:</span>\r\n                                {selectedPayslip.batch ? <PayrollStatusBadge status={selectedPayslip.batch.status} /> : <Badge variant=\"outline\">Ch∆∞a x√°c ƒë·ªãnh</Badge>}\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">K·ª≥ l∆∞∆°ng:</span>\r\n                                <span className=\"font-medium\">{formatMonthLabel(selectedPayslip.batch?.payPeriod.monthKey ?? selectedPayslip.slip.periodMonthKey)}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">Ng√†y tr·∫£ l∆∞∆°ng:</span>\r\n                                <span className=\"font-medium\">{formatDate(selectedPayslip.batch?.payrollDate || selectedPayslip.slip.createdAt) || '‚Äî'}</span>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        {/* Chi ti·∫øt c√°c th√†nh ph·∫ßn l∆∞∆°ng */}\r\n                        <div className=\"space-y-3\">\r\n                            {/* C√°c kho·∫£n thu nh·∫≠p */}\r\n                            <div className=\"rounded-lg border p-4\">\r\n                                <h4 className=\"font-medium text-green-700 mb-3 flex items-center gap-2\">\r\n                                    <DollarSign className=\"h-4 w-4\" />\r\n                                    C√°c kho·∫£n thu nh·∫≠p\r\n                                </h4>\r\n                                <div className=\"space-y-2 text-sm\">\r\n                                    {selectedPayslip.slip.components && selectedPayslip.slip.components\r\n                                        .filter(c => c.category === 'earning')\r\n                                        .map((comp, idx) => (\r\n                                            <div key={idx} className=\"flex justify-between py-1 border-b border-dashed last:border-0\">\r\n                                                <span className=\"text-muted-foreground\">{comp.label}</span>\r\n                                                <span className=\"font-medium tabular-nums text-green-600\">{formatCurrency(comp.amount)}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    {/* N·∫øu kh√¥ng c√≥ components chi ti·∫øt, hi·ªÉn th·ªã t·ªïng thu nh·∫≠p */}\r\n                                    {(!selectedPayslip.slip.components || selectedPayslip.slip.components.filter(c => c.category === 'earning').length === 0) && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">Thu nh·∫≠p g·ªôp</span>\r\n                                            <span className=\"font-medium tabular-nums text-green-600\">{formatCurrency(selectedPayslip.slip.totals.grossEarnings)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    <div className=\"flex justify-between pt-2 font-semibold border-t\">\r\n                                        <span>T·ªïng thu nh·∫≠p</span>\r\n                                        <span className=\"tabular-nums text-green-600\">{formatCurrency(selectedPayslip.slip.totals.grossEarnings)}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* C√°c kho·∫£n kh·∫•u tr·ª´ */}\r\n                            <div className=\"rounded-lg border p-4\">\r\n                                <h4 className=\"font-medium text-red-700 mb-3 flex items-center gap-2\">\r\n                                    <FileText className=\"h-4 w-4\" />\r\n                                    C√°c kho·∫£n kh·∫•u tr·ª´\r\n                                </h4>\r\n                                <div className=\"space-y-2 text-sm\">\r\n                                    {selectedPayslip.slip.components && selectedPayslip.slip.components\r\n                                        .filter(c => c.category === 'deduction')\r\n                                        .map((comp, idx) => (\r\n                                            <div key={idx} className=\"flex justify-between py-1 border-b border-dashed last:border-0\">\r\n                                                <span className=\"text-muted-foreground\">{comp.label}</span>\r\n                                                <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(comp.amount)}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    {/* B·∫£o hi·ªÉm chi ti·∫øt */}\r\n                                    {selectedPayslip.slip.totals.employeeSocialInsurance > 0 && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">BHXH (8%)</span>\r\n                                            <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.employeeSocialInsurance)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    {selectedPayslip.slip.totals.employeeHealthInsurance > 0 && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">BHYT (1.5%)</span>\r\n                                            <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.employeeHealthInsurance)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    {selectedPayslip.slip.totals.employeeUnemploymentInsurance > 0 && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">BHTN (1%)</span>\r\n                                            <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.employeeUnemploymentInsurance)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    {/* Thu·∫ø TNCN */}\r\n                                    {selectedPayslip.slip.totals.personalIncomeTax > 0 && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">Thu·∫ø TNCN</span>\r\n                                            <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.personalIncomeTax)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    {/* Kh·∫•u tr·ª´ ph·∫°t */}\r\n                                    {selectedPayslip.slip.totals.penaltyDeductions > 0 && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">Kh·∫•u tr·ª´ ph·∫°t</span>\r\n                                            <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.penaltyDeductions)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    {/* Kh·∫•u tr·ª´ kh√°c */}\r\n                                    {selectedPayslip.slip.totals.otherDeductions > 0 && (\r\n                                        <div className=\"flex justify-between py-1 border-b border-dashed\">\r\n                                            <span className=\"text-muted-foreground\">Kh·∫•u tr·ª´ kh√°c</span>\r\n                                            <span className=\"font-medium tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.otherDeductions)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    <div className=\"flex justify-between pt-2 font-semibold border-t\">\r\n                                        <span>T·ªïng kh·∫•u tr·ª´</span>\r\n                                        <span className=\"tabular-nums text-red-600\">-{formatCurrency(selectedPayslip.slip.totals.deductions)}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Th√¥ng tin b·ªï sung */}\r\n                            <div className=\"rounded-lg border p-4 bg-muted/20\">\r\n                                <h4 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                                    <FileText className=\"h-4 w-4\" />\r\n                                    Th√¥ng tin chi ti·∫øt\r\n                                </h4>\r\n                                <div className=\"grid grid-cols-2 gap-x-6 gap-y-2 text-sm\">\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-muted-foreground\">M·ª©c ƒë√≥ng BHXH:</span>\r\n                                        <span className=\"tabular-nums\">{formatCurrency(selectedPayslip.slip.totals.socialInsuranceBase)}</span>\r\n                                    </div>\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-muted-foreground\">Thu nh·∫≠p ch·ªãu thu·∫ø:</span>\r\n                                        <span className=\"tabular-nums\">{formatCurrency(selectedPayslip.slip.totals.taxableIncome)}</span>\r\n                                    </div>\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-muted-foreground\">Gi·∫£m tr·ª´ b·∫£n th√¢n:</span>\r\n                                        <span className=\"tabular-nums\">{formatCurrency(selectedPayslip.slip.totals.personalDeduction)}</span>\r\n                                    </div>\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-muted-foreground\">Gi·∫£m tr·ª´ NPT ({selectedPayslip.slip.totals.numberOfDependents}):</span>\r\n                                        <span className=\"tabular-nums\">{formatCurrency(selectedPayslip.slip.totals.dependentDeduction)}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* ƒê√≥ng g√≥p (n·∫øu c√≥) */}\r\n                            {selectedPayslip.slip.components && selectedPayslip.slip.components.filter(c => c.category === 'contribution').length > 0 && (\r\n                                <div className=\"rounded-lg border p-4\">\r\n                                    <h4 className=\"font-medium text-blue-700 mb-3 flex items-center gap-2\">\r\n                                        <Building2 className=\"h-4 w-4\" />\r\n                                        C√°c kho·∫£n ƒë√≥ng g√≥p\r\n                                    </h4>\r\n                                    <div className=\"space-y-2 text-sm\">\r\n                                        {selectedPayslip.slip.components\r\n                                            .filter(c => c.category === 'contribution')\r\n                                            .map((comp, idx) => (\r\n                                                <div key={idx} className=\"flex justify-between py-1 border-b border-dashed last:border-0\">\r\n                                                    <span className=\"text-muted-foreground\">{comp.label}</span>\r\n                                                    <span className=\"font-medium tabular-nums\">{formatCurrency(comp.amount)}</span>\r\n                                                </div>\r\n                                            ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* T·ªïng k·∫øt */}\r\n                        <div className=\"rounded-lg border-2 border-primary/30 p-4 bg-primary/5\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <span className=\"text-lg font-semibold\">TH·ª∞C Lƒ®NH</span>\r\n                                <span className=\"text-2xl font-bold text-primary tabular-nums\">{formatCurrency(selectedPayslip.slip.totals.netPay)}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex justify-between gap-2 pt-2\">\r\n                            <PayslipPrintButton\r\n                                payslipData={selectedPayslip.slip}\r\n                                batchData={selectedPayslip.batch}\r\n                                variant=\"outline\"\r\n                                className=\"flex-1\"\r\n                            />\r\n                            <Button \r\n                                variant=\"default\" \r\n                                className=\"flex-1\"\r\n                                onClick={() => {\r\n                                    setIsPayslipDialogOpen(false);\r\n                                    if (selectedPayslip.batch?.systemId) {\r\n                                        handleViewPayroll(selectedPayslip.batch.systemId);\r\n                                    }\r\n                                }}\r\n                            >\r\n                                Xem b·∫£ng l∆∞∆°ng\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </DialogContent>\r\n        </Dialog>\r\n\r\n        {/* Attendance Detail Dialog */}\r\n        <Dialog open={isAttendanceDialogOpen} onOpenChange={setIsAttendanceDialogOpen}>\r\n            <DialogContent className=\"max-w-lg\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"flex items-center gap-2\">\r\n                        <Clock className=\"h-5 w-5\" />\r\n                        Chi ti·∫øt ch·∫•m c√¥ng\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        {selectedAttendance?.monthLabel} - {selectedAttendance?.locked ? 'ƒê√£ kh√≥a' : 'Ch∆∞a kh√≥a'}\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n                {selectedAttendance && (\r\n                    <div className=\"space-y-4\">\r\n                        {/* Th√¥ng tin chung */}\r\n                        <div className=\"grid grid-cols-2 gap-4 text-sm border rounded-lg p-4 bg-muted/30\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">Nh√¢n vi√™n:</span>\r\n                                <span className=\"font-medium\">{employee.fullName}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">M√£ NV:</span>\r\n                                <span className=\"font-mono\">{employee.id}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">K·ª≥ ch·∫•m c√¥ng:</span>\r\n                                <span className=\"font-medium\">{selectedAttendance.monthLabel}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-muted-foreground\">Tr·∫°ng th√°i:</span>\r\n                                <Badge variant={selectedAttendance.locked ? 'default' : 'outline'} className={selectedAttendance.locked ? 'bg-green-600' : ''}>\r\n                                    {selectedAttendance.locked ? 'ƒê√£ kh√≥a' : 'Ch∆∞a kh√≥a'}\r\n                                </Badge>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Th·ªëng k√™ chi ti·∫øt */}\r\n                        <div className=\"grid grid-cols-3 gap-3\">\r\n                            <div className=\"text-center p-3 rounded-lg bg-green-50 dark:bg-green-950 border\">\r\n                                <p className=\"text-2xl font-bold text-green-600\">{selectedAttendance.workDays}</p>\r\n                                <p className=\"text-xs text-muted-foreground\">Ng√†y c√¥ng</p>\r\n                            </div>\r\n                            <div className=\"text-center p-3 rounded-lg bg-blue-50 dark:bg-blue-950 border\">\r\n                                <p className=\"text-2xl font-bold text-blue-600\">{selectedAttendance.leaveDays}</p>\r\n                                <p className=\"text-xs text-muted-foreground\">Ngh·ªâ ph√©p</p>\r\n                            </div>\r\n                            <div className=\"text-center p-3 rounded-lg bg-red-50 dark:bg-red-950 border\">\r\n                                <p className=\"text-2xl font-bold text-destructive\">{selectedAttendance.absentDays}</p>\r\n                                <p className=\"text-xs text-muted-foreground\">V·∫Øng</p>\r\n                            </div>\r\n                            <div className=\"text-center p-3 rounded-lg bg-orange-50 dark:bg-orange-950 border\">\r\n                                <p className=\"text-2xl font-bold text-orange-600\">{selectedAttendance.lateArrivals}</p>\r\n                                <p className=\"text-xs text-muted-foreground\">ƒêi tr·ªÖ</p>\r\n                            </div>\r\n                            <div className=\"text-center p-3 rounded-lg bg-orange-50 dark:bg-orange-950 border\">\r\n                                <p className=\"text-2xl font-bold text-orange-600\">{selectedAttendance.earlyDepartures}</p>\r\n                                <p className=\"text-xs text-muted-foreground\">V·ªÅ s·ªõm</p>\r\n                            </div>\r\n                            <div className=\"text-center p-3 rounded-lg bg-purple-50 dark:bg-purple-950 border\">\r\n                                <p className=\"text-2xl font-bold text-purple-600\">{selectedAttendance.otHours}</p>\r\n                                <p className=\"text-xs text-muted-foreground\">Gi·ªù l√†m th√™m</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"flex justify-between gap-2 pt-2\">\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                className=\"flex-1\"\r\n                                onClick={() => handlePrintSingleAttendance(selectedAttendance)}\r\n                            >\r\n                                <Printer className=\"mr-2 h-4 w-4\" />\r\n                                In phi·∫øu\r\n                            </Button>\r\n                            <Button \r\n                                variant=\"default\" \r\n                                className=\"flex-1\"\r\n                                onClick={() => {\r\n                                    setIsAttendanceDialogOpen(false);\r\n                                    router.push(`/attendance?month=${selectedAttendance.monthKey}`);\r\n                                }}\r\n                            >\r\n                                <ExternalLink className=\"mr-2 h-4 w-4\" />\r\n                                Xem b·∫£ng ch·∫•m c√¥ng\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </DialogContent>\r\n        </Dialog>\r\n\r\n        </Tabs>\r\n\r\n        {/* Comments */}\r\n        <DatabaseComments\r\n          entityType=\"employee\"\r\n          entityId={employee.systemId}\r\n        />\r\n\r\n        {/* Activity History */}\r\n        <ActivityHistory\r\n          history={employee.activityHistory || []}\r\n          title=\"L·ªãch s·ª≠ ho·∫°t ƒë·ªông\"\r\n          emptyMessage=\"Ch∆∞a c√≥ l·ªãch s·ª≠ ho·∫°t ƒë·ªông\"\r\n          groupByDate\r\n          maxHeight=\"400px\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAMA;AAAA;AAMA;AAAA;AAKA;AAAA;AAKA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBA;AACA;AACA;AACA;AACA;AACA;AACA;AAOA;AAQA;AAEA;AACA;AACA;AACA;AAjGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA,MAAM,iBAAiB,CAAC;IACpB,IAAI,OAAO,UAAU,UAAU,OAAO;IACtC,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QAAE,OAAO;QAAY,UAAU;IAAM,GAAG,MAAM,CAAC;AACzF;AAEA,MAAM,mBAAmB,CAAC;IACtB,IAAI,CAAC,UAAU,OAAO;IACtB,MAAM,CAAC,MAAM,MAAM,GAAG,SAAS,KAAK,CAAC;IACrC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,MAAM;AACnC;AAEA,MAAM,oBAAoB,CAAC;IACvB,IAAI,CAAC,YAAY,OAAO;IACxB,OAAO,IAAA,wIAAgB,EAAC,IAAI,KAAK,aAAa;AAClD;AAEA;;;;CAIC,GACD,MAAM,uBAAuB,CAAC;IAC5B,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAE,GAAG;IAEzD,IAAI,eAAe,WAAW;QAC5B,kCAAkC;QAClC,OAAO;YAAC;YAAQ;YAAU;YAAM;SAAS,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,SAAS;IAC1E,OAAO;QACL,yCAAyC;QACzC,OAAO;YAAC;YAAQ;YAAM;SAAS,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,SAAS;IAChE;AACF;AAEA,MAAM,wBAAoF;IACtF,mBAAmB;IAAW,iBAAiB;IAAW,UAAU;AACxE;AAEA,0CAA0C;AAC1C,+IAA+I;AAC/I,oHAAoH;AACpH,wEAAwE;AACxE,KAAK;AAEL,MAAM,sBAAkF;IACpF,aAAa;IACb,YAAY;IACZ,cAAc;AAClB;AAEA,MAAM,gCAA+G;IACjH,iBAAiB;IACjB,YAAY;IACZ,gBAAgB;AACpB;AAEA,MAAM,8BAA8B,CAAC;IACjC,IAAI,CAAC,QAAQ,OAAO;IACpB,qBACI,8OAAC,mIAAK;QAAC,SAAS,6BAA6B,CAAC,OAAO,IAAI;kBACpD;;;;;;AAGb;AAEA,MAAM,wBAAwB,CAAC,EAAE,KAAK,EAAqB,iBACvD,8OAAC,iIAAI;QAAC,WAAU;kBACZ,cAAA,8OAAC,wIAAW;YAAC,WAAU;sBACnB,cAAA,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,8OAAC;4BAAE,WAAU;sCAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BpC,SAAS;IACd,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,+IAAS;IAC9B,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,kJAAgB;IACrC,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,IAAA,2JAAc;IACzC,MAAM,EAAE,UAAU,YAAY,EAAE,GAAG,IAAA,uIAAO;IACxC,MAAM,oBAAoB,IAAA,0KAAoB,EAAC,CAAC,QAAU,MAAM,iBAAiB;IACjF,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,8LAAwB;IAC7C,MAAM,EAAE,MAAM,SAAS,EAAE,GAAG,IAAA,oLAAiB;IAC7C,MAAM,EAAE,MAAM,WAAW,EAAE,GAAG,IAAA,kKAAkB;IAChD,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG,IAAA,+HAAQ;IAEzC,kEAAkE;IAClE,MAAM,eAAe,IAAA,qJAAkB,EAAC,CAAC,QAAU,MAAM,YAAY;IACrE,MAAM,iBAAiB,IAAA,qJAAkB,EAAC,CAAC,QAAU,MAAM,cAAc;IAEzE,MAAM,WAAW,gNAAa,CAAC,IAAO,WAAW,SAAS,IAAA,gIAAU,EAAC,aAAa,MAAO;QAAC;QAAU;KAAS;IAI/G,sBAAsB;IACtB,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,IAAA,6JAAe;IAC9C,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,IAAA,0IAAY;IACvC,MAAM,EAAE,MAAM,gBAAgB,EAAE,GAAG,IAAA,4IAAa;IAEhD,MAAM,oBAAoB,gNAAa,CAAC,IAAM,aAAa,MAAM,CAAC,CAAA,IAAK,EAAE,gBAAgB,KAAK,UAAU,WAAW;QAAC;QAAc,UAAU;KAAS;IAErJ,6EAA6E;IAC7E,MAAM,gBAAgB,gNAAa,CAAC;QAChC,IAAI,CAAC,UAAU,UAAU,OAAO,EAAE;QAClC,OAAO,SACJ,MAAM,CAAC,CAAA,OACN,KAAK,SAAS,EAAE,KAAK,CAAA,IAAK,EAAE,gBAAgB,KAAK,SAAS,QAAQ,KAClE,KAAK,UAAU,KAAK,SAAS,QAAQ,EAEtC,GAAG,CAAC,CAAA,OAAQ,CAAC;gBACZ,UAAU,KAAK,QAAQ;gBACvB,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,QAAQ,IAAI;gBACvB,SAAS,KAAK,OAAO;gBACrB,eACE,KAAK,MAAM,KAAK,eAAe,YAC/B,KAAK,MAAM,KAAK,mBAAmB,YACnC,KAAK,MAAM,KAAK,aAAa,YAC7B,KAAK,MAAM,KAAK,WAAW,gBAAgB;gBAE7C,YAAY,KAAK,MAAM;gBACvB,MAAM,CAAC,OAAO,EAAE,KAAK,QAAQ,EAAE;YACjC,CAAC;IACP,GAAG;QAAC;QAAU,UAAU;KAAS;IAEjC,MAAM,iBAAiB,gNAAa,CAAC,IACnC,iBACG,MAAM,CAAC,CAAA,IAAK,EAAE,gBAAgB,KAAK,UAAU,UAC7C,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,WAAW,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,WAAW,EAAE,OAAO,KACvF;QAAC;QAAkB,UAAU;KAAS;IAEtC,MAAM,aAAa,gNAAa,CAAC;QAC/B,IAAI,CAAC,UAAU,gBAAgB,OAAO;QACtC,OAAO,SAAS,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,SAAS,cAAc,GAAG,QAAQ;IAC7E,GAAG;QAAC;QAAU;KAAS;IAErB,MAAM,iBAAiB,gNAAa,CAAC,IAAO,WAAW,kBAAkB,SAAS,QAAQ,IAAI,MAAO;QAAC;QAAU;KAAkB;IAElI,MAAM,eAAe,gNAAa,CAAC;QAC/B,IAAI,CAAC,gBAAgB,mBAAmB;YACpC,OAAO;QACX;QACA,OAAO,SAAS,UAAU,CAAC,IAAI,CAAC,CAAC,QAAU,MAAM,QAAQ,KAAK,eAAe,iBAAiB,KAAK;IACvG,GAAG;QAAC,gBAAgB;QAAmB,SAAS,UAAU;KAAC;IAE3D,MAAM,oBAAoB,gNAAa,CAAC;QACpC,IAAI,CAAC,gBAAgB;YACjB,OAAO,EAAE;QACb;QACA,OAAO,SAAS,gBAAgB,CAAC,MAAM,CAAC,CAAC,YACrC,eAAe,wBAAwB,CAAC,QAAQ,CAAC,UAAU,QAAQ;IAE3E,GAAG;QAAC;QAAgB,SAAS,gBAAgB;KAAC;IAE9C,MAAM,qBAAqB,gNAAa,CAAC;QACrC,IAAI,CAAC,UAAU;YACX,OAAO;QACX;QACA,OAAO,qKAAyB,CAAC,uBAAuB,CAAC,SAAS,QAAQ;IAC9E,GAAG;QAAC,UAAU;QAAU;QAAc;KAAe;IAErD,sEAAsE;IACtE,MAAM,oBAAoB,gNAAa,CAAC;QACpC,IAAI,CAAC,UAAU,OAAO,EAAE;QAExB,MAAM,UAWD,EAAE;QAEP,wCAAwC;QACxC,OAAO,OAAO,CAAC,gBAAgB,OAAO,CAAC,CAAC,CAAC,UAAU,KAAK;YACpD,MAAM,cAAc,MAAM,KAAK,CAAA,IAAK,EAAE,gBAAgB,KAAK,SAAS,QAAQ;YAC5E,IAAI,aAAa;gBACb,MAAM,CAAC,MAAM,MAAM,GAAG,SAAS,KAAK,CAAC;gBACrC,QAAQ,IAAI,CAAC;oBACT,UAAU,GAAG,SAAS,CAAC,EAAE,SAAS,QAAQ,EAAE;oBAC5C;oBACA,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,MAAM;oBACpC,UAAU,YAAY,QAAQ,IAAI;oBAClC,WAAW,YAAY,SAAS,IAAI;oBACpC,YAAY,YAAY,UAAU,IAAI;oBACtC,cAAc,YAAY,YAAY,IAAI;oBAC1C,iBAAiB,YAAY,eAAe,IAAI;oBAChD,SAAS,YAAY,OAAO,IAAI;oBAChC,QAAQ,QAAQ,YAAY,CAAC,SAAS;gBAC1C;YACJ;QACJ;QAEA,8BAA8B;QAC9B,OAAO,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,QAAQ,CAAC,aAAa,CAAC,EAAE,QAAQ;IACrE,GAAG;QAAC,UAAU;QAAU;QAAgB;KAAa;IAErD,sCAAsC;IACtC,MAAM,8BAA8B,oNAAiB,CAAC,CAAC;QACnD,IAAI,CAAC,UAAU;YACX,iJAAK,CAAC,KAAK,CAAC,gBAAgB;gBAAE,aAAa;YAAoC;YAC/E;QACJ;QAEA,sCAAsC;QACtC,MAAM,YAAY,cAAc,CAAC,IAAI,QAAQ,CAAC;QAC9C,MAAM,cAAc,WAAW,KAAK,CAAA,IAAK,EAAE,gBAAgB,KAAK,SAAS,QAAQ;QAEjF,IAAI,CAAC,aAAa;YACd,iJAAK,CAAC,KAAK,CAAC,gBAAgB;gBAAE,aAAa;YAAoC;YAC/E;QACJ;QAEA,MAAM,gBAAgB,IAAA,oLAA6B,EAAC;QACpD,MAAM,qBAAqB,IAAA,gMAA+B,EAAC,IAAI,QAAQ,EAAE;QAEzE,MAAM,cAAc;YAChB,MAAM,IAAA,iLAA8B,EAAC,oBAAoB;YACzD,WAAW,IAAA,+KAA4B,EAAC,mBAAmB,YAAY;QAC3E;QAEA,iJAAK,CAAC,OAAO,CAAC,8BAA8B;YAAE,aAAa,GAAG,SAAS,QAAQ,CAAC,GAAG,EAAE,IAAI,UAAU,EAAE;QAAC;IAC1G,GAAG;QAAC;QAAU;QAAgB;QAAW;KAAM;IAE/C,+BAA+B;IAC/B,MAAM,oBAAmE,gNAAa,CAAC,IAAM;YACzF;gBAAE,IAAI;gBAAc,aAAa;gBAAc,QAAQ;gBAAgB,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAe,IAAI,UAAU;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAe;YAAE;YAClM;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAc,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAClF,8OAAC,mIAAK;wBAAC,SAAS,IAAI,MAAM,GAAG,YAAY;wBAAW,WAAW,IAAI,MAAM,GAAG,iBAAiB;kCACxF,IAAI,MAAM,GAAG,YAAY;;;;;;gBAE/B,MAAM;oBAAE,aAAa;gBAAa;YAAE;YACvC;gBAAE,IAAI;gBAAY,aAAa;gBAAY,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAkB,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAA4D,IAAI,QAAQ;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAY;YAAE;YACvR;gBAAE,IAAI;gBAAa,aAAa;gBAAa,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAkB,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAA+C,IAAI,SAAS;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAY;YAAE;YAC7Q;gBAAE,IAAI;gBAAc,aAAa;gBAAc,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAa,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAW,CAAC,8BAA8B,EAAE,IAAI,UAAU,GAAG,IAAI,iCAAiC,yBAAyB;kCAAG,IAAI,UAAU;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAO;YAAE;YAC3U;gBAAE,IAAI;gBAAgB,aAAa;gBAAgB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAe,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAW,CAAC,8BAA8B,EAAE,IAAI,YAAY,GAAG,IAAI,oBAAoB,yBAAyB;kCAAG,IAAI,YAAY;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAS;YAAE;YAC1U;gBAAE,IAAI;gBAAmB,aAAa;gBAAmB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAe,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAW,CAAC,8BAA8B,EAAE,IAAI,eAAe,GAAG,IAAI,oBAAoB,yBAAyB;kCAAG,IAAI,eAAe;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAS;YAAE;YACtV;gBAAE,IAAI;gBAAW,aAAa;gBAAW,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAiB,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAW,CAAC,8BAA8B,EAAE,IAAI,OAAO,GAAG,IAAI,gCAAgC,yBAAyB;;4BAAG,IAAI,OAAO;4BAAC;;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAe;YAAE;YAC3U;gBACI,IAAI;gBACJ,QAAQ;gBACR,MAAM;gBACN,MAAM,CAAC,EAAE,GAAG,EAAE,iBACV,8OAAC;wBAAI,SAAS,CAAC,IAAM,EAAE,eAAe;kCAClC,cAAA,8OAAC,qJAAY;;8CACT,8OAAC,4JAAmB;oCAAC,OAAO;8CACxB,cAAA,8OAAC,qIAAM;wCAAC,SAAQ;wCAAQ,MAAK;wCAAO,WAAU;;0DAC1C,8OAAC,kOAAc;gDAAC,WAAU;;;;;;0DAC1B,8OAAC;gDAAK,WAAU;0DAAU;;;;;;;;;;;;;;;;;8CAGlC,8OAAC,4JAAmB;oCAAC,OAAM;;sDACvB,8OAAC,yJAAgB;4CAAC,SAAS;gDACvB,sBAAsB;gDACtB,0BAA0B;4CAC9B;;8DACI,8OAAC,uMAAG;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGpC,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,4BAA4B;;8DACzD,8OAAC,mNAAO;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGxC,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,OAAO,IAAI,CAAC,CAAC,kBAAkB,EAAE,IAAI,QAAQ,EAAE;;8DAC5E,8OAAC,sOAAY;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;;;;;;;;;;;;;;;;;gBAO7D,MAAM;oBAAE,aAAa;oBAAY,QAAQ;gBAAiB;YAC9D;SACH,EAAE;QAAC;QAA6B;KAAO;IAExC,2CAA2C;IAC3C,MAAM,wBAAwB,gNAAa,CAAC;QACxC,MAAM,yBAAyB,CAAC;YAC5B,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,gBAAgB,IAAA,oLAA6B,EAAC;YAEpD,MAAM,mBAAmB,KAAK,GAAG,CAAC,CAAA;gBAC9B,MAAM,YAAY,cAAc,CAAC,IAAI,QAAQ,CAAC;gBAC9C,MAAM,cAAc,WAAW,KAAK,CAAA,IAAK,EAAE,gBAAgB,KAAK,UAAU;gBAE1E,IAAI,CAAC,aAAa,OAAO;gBAEzB,MAAM,qBAAqB,IAAA,gMAA+B,EAAC,IAAI,QAAQ,EAAE;gBACzE,OAAO;oBACH,MAAM,IAAA,iLAA8B,EAAC,oBAAoB;oBACzD,WAAW,IAAA,+KAA4B,EAAC,mBAAmB,YAAY;gBAC3E;YACJ,GAAG,MAAM,CAAC;YAEV,IAAI,iBAAiB,MAAM,KAAK,GAAG;gBAC/B,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,cAAc,cAAc;YAC5B,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,iBAAiB,MAAM,CAAC,mBAAmB,CAAC;QACzE;QAEA,MAAM,oBAAoB,CAAC;YACvB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,UAAU;gBAAC;gBAAgB;gBAAc;gBAAa;gBAAa;gBAAQ;gBAAU;gBAAU;aAAe;YACpH,MAAM,aAAa,KAAK,GAAG,CAAC,CAAA,MAAO,CAAC;oBAChC,gBAAgB,IAAI,UAAU;oBAC9B,cAAc,IAAI,MAAM,GAAG,YAAY;oBACvC,aAAa,IAAI,QAAQ;oBACzB,aAAa,IAAI,SAAS;oBAC1B,QAAQ,IAAI,UAAU;oBACtB,UAAU,IAAI,YAAY;oBAC1B,UAAU,IAAI,eAAe;oBAC7B,gBAAgB,IAAI,OAAO;gBAC/B,CAAC;YAED,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;gBAAE,QAAQ;YAAQ;YAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;YAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;YACrC,0IAAc,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,MAAM,KAAK,cAAc,CAAC;YACnE,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,CAAC,cAAc,CAAC;QACxD;QAEA,OAAO;YACH;gBACI,OAAO;gBACP,MAAM,mNAAO;gBACb,UAAU;YACd;YACA;gBACI,OAAO;gBACP,MAAM,+OAAe;gBACrB,UAAU;YACd;SACH;IACL,GAAG;QAAC;QAAU;QAAgB;QAAW;KAAc;IAEvD,2CAA2C;IAC3C,MAAM,qBAAqB,gNAAa,CAAC;QACrC,MAAM,uBAAuB,CAAC;YAC1B,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,uBAAuB,IAAA,iLAA0B,EAAC;YACxD,MAAM,mBAAmB,KAAK,GAAG,CAAC,CAAA;gBAC9B,MAAM,kBAAkB,IAAA,oLAAsB,EAAC,KAAK;oBAAE;gBAAS;gBAC/D,OAAO;oBACH,MAAM,IAAA,qKAAqB,EAAC,iBAAiB;oBAC7C,WAAW,EAAE;gBACjB;YACJ;YAEA,cAAc,WAAW;YACzB,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,iBAAiB,MAAM,CAAC,cAAc,CAAC;QACpE;QAEA,MAAM,oBAAoB,CAAC;YACvB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,UAAU;gBAAC;gBAAY;gBAAS;gBAAY;gBAAc;aAAU;YAC1E,MAAM,aAAa,KAAK,GAAG,CAAC,CAAA,MAAO,CAAC;oBAChC,YAAY,IAAI,EAAE;oBAClB,SAAS,IAAI,MAAM;oBACnB,YAAY,kBAAkB,IAAI,SAAS;oBAC3C,cAAc,IAAI,MAAM;oBACxB,WAAW,IAAI,MAAM;gBACzB,CAAC;YAED,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;gBAAE,QAAQ;YAAQ;YAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;YAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;YACrC,0IAAc,CAAC,IAAI,CAAC,UAAU,EAAE,UAAU,MAAM,KAAK,cAAc,CAAC;YACpE,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,CAAC,oBAAoB,CAAC;QAC9D;QAEA,OAAO;YACH;gBACI,OAAO;gBACP,MAAM,mNAAO;gBACb,UAAU;YACd;YACA;gBACI,OAAO;gBACP,MAAM,+OAAe;gBACrB,UAAU;YACd;SACH;IACL,GAAG;QAAC;QAAU;QAAW;KAAc;IAEvC,kDAAkD;IAClD,MAAM,mBAAmB,gNAAa,CAAC;QACnC,MAAM,oBAAoB,CAAC;YACvB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,qBAAqB,IAAA,+KAAwB,EAAC;YACpD,MAAM,mBAAmB,KAAK,GAAG,CAAC,CAAA;gBAC9B,MAAM,gBAAgB,IAAA,gLAAoB,EAAC,KAAK;oBAAE;gBAAS;gBAC3D,OAAO;oBACH,MAAM,IAAA,iKAAmB,EAAC,eAAe;oBACzC,WAAW,EAAE;gBACjB;YACJ;YAEA,cAAc,SAAS;YACvB,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,iBAAiB,MAAM,CAAC,iBAAiB,CAAC;QACvE;QAEA,MAAM,oBAAoB,CAAC;YACvB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,UAAU;gBAAC;gBAAU;gBAAa;gBAAW;gBAAY;gBAAW;gBAAS;aAAa;YAChG,MAAM,aAAa,KAAK,GAAG,CAAC,CAAA,MAAO,CAAC;oBAChC,UAAU,IAAI,EAAE;oBAChB,aAAa,IAAI,aAAa;oBAC9B,WAAW,kBAAkB,IAAI,SAAS;oBAC1C,YAAY,kBAAkB,IAAI,OAAO;oBACzC,WAAW,IAAI,YAAY;oBAC3B,SAAS,IAAI,MAAM;oBACnB,cAAc,IAAI,MAAM;gBAC5B,CAAC;YAED,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;gBAAE,QAAQ;YAAQ;YAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;YAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;YACrC,0IAAc,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,MAAM,KAAK,cAAc,CAAC;YACnE,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,CAAC,uBAAuB,CAAC;QACjE;QAEA,OAAO;YACH;gBACI,OAAO;gBACP,MAAM,mNAAO;gBACb,UAAU;YACd;YACA;gBACI,OAAO;gBACP,MAAM,+OAAe;gBACrB,UAAU;YACd;SACH;IACL,GAAG;QAAC;QAAU;QAAW;KAAc;IAEvC,mCAAmC;IACnC,MAAM,2BAA2B,oNAAiB,CAAC,CAAC;QAChD,MAAM,uBAAuB,IAAA,iLAA0B,EAAC;QACxD,MAAM,kBAAkB,IAAA,oLAAsB,EAAC,KAAK;YAAE;QAAS;QAC/D,MAAM,WAAW;YACb,MAAM,IAAA,qKAAqB,EAAC,iBAAiB;YAC7C,WAAW,EAAE;QACjB;IACJ,GAAG;QAAC;QAAU;QAAW;KAAM;IAE/B,MAAM,yBAAyB,oNAAiB,CAAC,CAAC;QAC9C,MAAM,qBAAqB,IAAA,+KAAwB,EAAC;QACpD,MAAM,gBAAgB,IAAA,gLAAoB,EAAC,KAAK;YAAE;QAAS;QAC3D,MAAM,SAAS;YACX,MAAM,IAAA,iKAAmB,EAAC,eAAe;YACzC,WAAW,EAAE;QACjB;IACJ,GAAG;QAAC;QAAU;QAAW;KAAM;IAE/B,MAAM,4BAA4B,oNAAiB,CAAC,CAAC;QACjD,MAAM,UAAU;YAAC;YAAY;YAAS;YAAY;YAAc;SAAU;QAC1E,MAAM,aAAa;YAAC;gBAChB,YAAY,IAAI,EAAE;gBAClB,SAAS,IAAI,MAAM;gBACnB,YAAY,kBAAkB,IAAI,SAAS;gBAC3C,cAAc,IAAI,MAAM;gBACxB,WAAW,IAAI,MAAM;YACzB;SAAE;QACF,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;YAAE,QAAQ;QAAQ;QAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;QAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;QACrC,0IAAc,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC;QAC7C,iJAAK,CAAC,OAAO,CAAC;IAClB,GAAG,EAAE;IAEL,MAAM,0BAA0B,oNAAiB,CAAC,CAAC;QAC/C,MAAM,UAAU;YAAC;YAAU;YAAa;YAAW;YAAY;YAAW;YAAS;SAAa;QAChG,MAAM,aAAa;YAAC;gBAChB,UAAU,IAAI,EAAE;gBAChB,aAAa,IAAI,aAAa;gBAC9B,WAAW,kBAAkB,IAAI,SAAS;gBAC1C,YAAY,kBAAkB,IAAI,OAAO;gBACzC,WAAW,IAAI,YAAY;gBAC3B,SAAS,IAAI,MAAM;gBACnB,cAAc,IAAI,MAAM;YAC5B;SAAE;QACF,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;YAAE,QAAQ;QAAQ;QAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;QAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;QACrC,0IAAc,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC;QAC5C,iJAAK,CAAC,OAAO,CAAC;IAClB,GAAG,EAAE;IAEL,sDAAsD;IACtD,MAAM,iBAAuC,gNAAa,CAAC,IAAM;YAC7D;gBAAE,IAAI;gBAAM,aAAa;gBAAM,QAAQ;gBAAY,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAe,IAAI,EAAE;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAW;YAAE;YACvJ;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAS,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,MAAM;gBAAE,MAAM;oBAAE,aAAa;gBAAQ;YAAE;YACtH;gBAAE,IAAI;gBAAa,aAAa;gBAAa,QAAQ;gBAAQ,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,kBAAkB,IAAI,SAAS;gBAAG,MAAM;oBAAE,aAAa;gBAAO;YAAE;YAChJ;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAc,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC,mIAAK;wBAAC,SAAS,qBAAqB,CAAC,IAAI,MAAM,CAAC;kCAAG,IAAI,MAAM;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAa;YAAE;YAC7L;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAW,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAkC,eAAe,IAAI,MAAM;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAU;YAAE;YACpM;gBACI,IAAI;gBACJ,QAAQ,kBAAM,8OAAC;wBAAI,WAAU;kCAAc;;;;;;gBAC3C,MAAM,CAAC,EAAE,GAAG,EAAE,iBACV,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC,qJAAY;;8CACT,8OAAC,4JAAmB;oCAAC,OAAO;8CACxB,cAAA,8OAAC,qIAAM;wCAAC,SAAQ;wCAAQ,MAAK;wCAAK,WAAU;kDACxC,cAAA,8OAAC,kOAAc;4CAAC,WAAU;;;;;;;;;;;;;;;;8CAGlC,8OAAC,4JAAmB;oCAAC,OAAM;;sDACvB,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,yBAAyB;;8DACtD,8OAAC,mNAAO;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGxC,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,0BAA0B;;8DACvD,8OAAC,+OAAe;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGhD,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,OAAO,IAAI,CAAC,CAAC,WAAW,EAAE,IAAI,QAAQ,EAAE;;8DACrE,8OAAC,uMAAG;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;;;;;;;;;;;;;;;;;gBAOpD,MAAM;oBAAE,aAAa;oBAAY,QAAQ;gBAAiB;YAC9D;SACH,EAAE;QAAC;QAA0B;QAA2B;KAAO;IAEhE,6DAA6D;IAC7D,MAAM,eAA0C,gNAAa,CAAC,IAAM;YAChE;gBAAE,IAAI;gBAAM,aAAa;gBAAM,QAAQ;gBAAU,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAe,IAAI,EAAE;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAS;YAAE;YACnJ;gBAAE,IAAI;gBAAiB,aAAa;gBAAiB,QAAQ;gBAAa,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,aAAa;gBAAE,MAAM;oBAAE,aAAa;gBAAY;YAAE;YACnJ;gBAAE,IAAI;gBAAa,QAAQ;gBAAa,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,GAAG,kBAAkB,IAAI,SAAS,EAAE,GAAG,EAAE,kBAAkB,IAAI,OAAO,GAAG;gBAAE,MAAM;oBAAE,aAAa;gBAAY;YAAE;YACzK;gBAAE,IAAI;gBAAgB,aAAa;gBAAgB,QAAQ;gBAAW,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,YAAY;gBAAE,MAAM;oBAAE,aAAa;gBAAU;YAAE;YAC5I;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAS,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAgC,IAAI,MAAM;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAQ;YAAE;YAC9K;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAc,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC,mIAAK;wBAAC,SAAS,mBAAmB,CAAC,IAAI,MAAM,CAAC;kCAAG,IAAI,MAAM;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAa;YAAE;YAC3L;gBACI,IAAI;gBACJ,QAAQ,kBAAM,8OAAC;wBAAI,WAAU;kCAAc;;;;;;gBAC3C,MAAM,CAAC,EAAE,GAAG,EAAE,iBACV,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC,qJAAY;;8CACT,8OAAC,4JAAmB;oCAAC,OAAO;8CACxB,cAAA,8OAAC,qIAAM;wCAAC,SAAQ;wCAAQ,MAAK;wCAAK,WAAU;kDACxC,cAAA,8OAAC,kOAAc;4CAAC,WAAU;;;;;;;;;;;;;;;;8CAGlC,8OAAC,4JAAmB;oCAAC,OAAM;;sDACvB,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,uBAAuB;;8DACpD,8OAAC,mNAAO;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGxC,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,wBAAwB;;8DACrD,8OAAC,+OAAe;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGhD,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,OAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,IAAI,QAAQ,EAAE;;8DAClE,8OAAC,uMAAG;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;;;;;;;;;;;;;;;;;gBAOpD,MAAM;oBAAE,aAAa;oBAAY,QAAQ;gBAAiB;YAC9D;SACH,EAAE;QAAC;QAAwB;QAAyB;KAAO;IAa5D,mCAAmC;IACnC,MAAM,kBAAkB,gNAAa,CAAC;QAClC,MAAM,oBAAoB,CAAC;YACvB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,UAAU;gBAAC;gBAAa;gBAAc;gBAAY;aAAa;YACrE,MAAM,aAAa,KAAK,GAAG,CAAC,CAAA,MAAO,CAAC;oBAChC,aAAa,IAAI,KAAK;oBACtB,cAAc,IAAI,IAAI;oBACtB,YAAY,kBAAkB,IAAI,OAAO;oBACzC,cAAc,IAAI,UAAU;gBAChC,CAAC;YAED,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;gBAAE,QAAQ;YAAQ;YAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;YAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;YACrC,0IAAc,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,MAAM,KAAK,cAAc,CAAC;YACnE,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,CAAC,mBAAmB,CAAC;QAC7D;QAEA,OAAO;YACH;gBACI,OAAO;gBACP,MAAM,+OAAe;gBACrB,UAAU;YACd;SACH;IACL,GAAG;QAAC;KAAS;IAEb,8BAA8B;IAC9B,MAAM,yBAAyB,oNAAiB,CAAC,CAAC;QAC9C,MAAM,UAAU;YAAC;YAAa;YAAc;YAAY;SAAa;QACrE,MAAM,aAAa;YAAC;gBAChB,aAAa,IAAI,KAAK;gBACtB,cAAc,IAAI,IAAI;gBACtB,YAAY,kBAAkB,IAAI,OAAO;gBACzC,cAAc,IAAI,UAAU;YAChC;SAAE;QACF,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;YAAE,QAAQ;QAAQ;QAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;QAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;QACrC,0IAAc,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,QAAQ,CAAC,KAAK,CAAC;QAClD,iJAAK,CAAC,OAAO,CAAC;IAClB,GAAG,EAAE;IAEL,qDAAqD;IACrD,MAAM,cAAoC,gNAAa,CAAC,IAAM;YAC1D;gBAAE,IAAI;gBAAS,aAAa;gBAAS,QAAQ;gBAAa,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAe,IAAI,KAAK;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAY;YAAE;YAClK;gBAAE,IAAI;gBAAQ,aAAa;gBAAQ,QAAQ;gBAAc,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,IAAI;gBAAE,MAAM;oBAAE,aAAa;gBAAa;YAAE;YAC1H;gBAAE,IAAI;gBAAW,aAAa;gBAAW,QAAQ;gBAAY,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,kBAAkB,IAAI,OAAO;gBAAG,MAAM;oBAAE,aAAa;gBAAW;YAAE;YAClJ;gBAAE,IAAI;gBAAU,aAAa;gBAAc,QAAQ;gBAAc,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC,mIAAK;wBAAC,SAAS,IAAI,aAAa;kCAAG,IAAI,UAAU;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAa;YAAE;YACrL;gBACI,IAAI;gBACJ,QAAQ,kBAAM,8OAAC;wBAAI,WAAU;kCAAc;;;;;;gBAC3C,MAAM,CAAC,EAAE,GAAG,EAAE,iBACV,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC,qJAAY;;8CACT,8OAAC,4JAAmB;oCAAC,OAAO;8CACxB,cAAA,8OAAC,qIAAM;wCAAC,SAAQ;wCAAQ,MAAK;wCAAK,WAAU;kDACxC,cAAA,8OAAC,kOAAc;4CAAC,WAAU;;;;;;;;;;;;;;;;8CAGlC,8OAAC,4JAAmB;oCAAC,OAAM;;sDACvB,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,uBAAuB;;8DACpD,8OAAC,+OAAe;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGhD,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,OAAO,IAAI,CAAC,IAAI,IAAI;;8DACjD,8OAAC,uMAAG;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;;;;;;;;;;;;;;;;;gBAOpD,MAAM;oBAAE,aAAa;oBAAY,QAAQ;gBAAiB;YAC9D;SACH,EAAE;QAAC;QAAwB;KAAO;IAEnC,MAAM,EAAE,SAAS,cAAc,EAAE,UAAU,eAAe,EAAE,GAAG,IAAA,wKAAoB;IACnF,MAAM,iBAAiB,gNAAa,CAAC;QACjC,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,OAAO,gBACF,MAAM,CAAC,CAAC,OAAS,KAAK,gBAAgB,KAAK,SAAS,QAAQ,EAC5D,GAAG,CAAC,CAAC,OAAS,CAAC;gBACZ;gBACA,OAAO,eAAe,IAAI,CAAC,CAAC,QAAU,MAAM,QAAQ,KAAK,KAAK,aAAa;YAC/E,CAAC,GACA,IAAI,CAAC,CAAC,GAAG;YACN,MAAM,QAAQ,IAAI,KAAK,EAAE,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,SAAS,EAAE,OAAO;YACxE,MAAM,QAAQ,IAAI,KAAK,EAAE,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,SAAS,EAAE,OAAO;YACxE,OAAO,QAAQ;QACnB;IACR,GAAG;QAAC;QAAU;QAAiB;KAAe;IAE9C,MAAM,gBAAgB,cAAc,CAAC,EAAE;IACvC,MAAM,0BAA0B,eAAe,KAAK,CAAC,GAAG;IAExD,kCAAkC;IAClC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,iNAAc,CAAuC;IACnG,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,iNAAc,CAAC;IAErE,qCAAqC;IACrC,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,iNAAc,CAA0C;IAC5G,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,iNAAc,CAAC;IAE3E,iDAAiD;IACjD,MAAM,0BAA+C,gNAAa,CAAC,IAC/D,wBAAwB,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,GAAK,CAAC;gBAC9C,UAAU,KAAK,QAAQ;gBACvB,SAAS,OAAO,MAAM;gBACtB,YAAY,iBAAiB,OAAO,UAAU,YAAY,KAAK,cAAc;gBAC7E,SAAS,IAAA,kIAAU,EAAC,OAAO,eAAe,KAAK,SAAS,KAAK;gBAC7D,QAAQ,OAAO,UAAU;gBACzB,eAAe,KAAK,MAAM,CAAC,aAAa,IAAI,KAAK,MAAM,CAAC,QAAQ,IAAI;gBACpE,gBAAgB,KAAK,MAAM,CAAC,sBAAsB,IAAI;gBACtD,mBAAmB,KAAK,MAAM,CAAC,iBAAiB,IAAI;gBACpD,iBAAiB,CAAC,KAAK,MAAM,CAAC,iBAAiB,IAAI,CAAC,IAAI,CAAC,KAAK,MAAM,CAAC,eAAe,IAAI,CAAC;gBACzF,iBAAiB,KAAK,MAAM,CAAC,UAAU,IAAI;gBAC3C,QAAQ,KAAK,MAAM,CAAC,MAAM;gBAC1B,eAAe,OAAO;gBACtB,iBAAiB,KAAK,QAAQ;gBAC9B;gBACA;YACJ,CAAC,IACL;QAAC;KAAwB;IAEzB,uBAAuB;IACvB,iEAAiE;IACjE,MAAM,2BAA2B,oNAAiB,CAAC,CAAC;QAChD,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,UAAU;YACxB,iJAAK,CAAC,KAAK,CAAC,gBAAgB;gBAAE,aAAa;YAAsC;YACjF;QACJ;QAEA,MAAM,gBAAgB,IAAA,iLAAmB,EAAC;QAC1C,MAAM,kBAAkB,IAAA,oLAAsB,EAC1C,IAAI,IAAI,EACR,IAAI,KAAK,IAAI;YACT,UAAU;YACV,IAAI,IAAI,OAAO;YACf,OAAO,CAAC,WAAW,EAAE,IAAI,UAAU,EAAE;YACrC,QAAQ,IAAI,MAAM;YAClB,WAAW;gBAAE,UAAU,IAAI,IAAI,CAAC,cAAc;YAAC;YAC/C,aAAa,IAAI,OAAO;QAC5B,GACA;YACI,UAAU;gBACN,UAAU,SAAS,QAAQ;gBAC3B,IAAI,SAAS,EAAE;gBACf,YAAY,SAAS,UAAU;gBAC/B,UAAU,SAAS,YAAY;YACnC;YACA,gBAAgB,SAAS,UAAU;QACvC;QAGJ,MAAM,WAAW;YACb,MAAM,IAAA,qKAAqB,EAAC,iBAAiB;YAC7C,WAAW,IAAA,4KAA4B,EAAC,gBAAgB,UAAU,IAAI,EAAE;QAC5E;QAEA,iJAAK,CAAC,OAAO,CAAC,0BAA0B;YAAE,aAAa,GAAG,SAAS,QAAQ,CAAC,GAAG,EAAE,IAAI,UAAU,EAAE;QAAC;IACtG,GAAG;QAAC;QAAU;QAAW;KAAM;IAE/B,uCAAuC;IACvC,MAAM,iBAAiD,gNAAa,CAAC,IAAM;YACvE;gBAAE,IAAI;gBAAW,aAAa;gBAAW,QAAQ;gBAAS,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAC9E,8OAAC,uKAAI;wBACD,MAAM,IAAI,aAAa,GAAG,uHAAM,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa,IAAI,aAAa,IAAI;wBAC1F,WAAU;wBACV,SAAS,CAAC,IAAM,EAAE,eAAe;kCAEhC,IAAI,OAAO;;;;;;gBAEjB,MAAM;oBAAE,aAAa;gBAAQ;YAAE;YAClC;gBAAE,IAAI;gBAAc,aAAa;gBAAc,QAAQ;gBAAY,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAqB,IAAI,UAAU;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAW;YAAE;YAChM;gBAAE,IAAI;gBAAW,aAAa;gBAAW,QAAQ;gBAAY,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAqB,IAAI,OAAO;;;;;;gBAAU,MAAM;oBAAE,aAAa;gBAAW;YAAE;YACvL;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ;gBAAc,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC,2KAAkB;wBAAC,QAAQ,IAAI,MAAM;;;;;;gBAAM,MAAM;oBAAE,aAAa;gBAAa;YAAE;YAC1K;gBAAE,IAAI;gBAAiB,aAAa;gBAAiB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAgB,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAiC,eAAe,IAAI,aAAa;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAgB;YAAE;YAC9R;gBAAE,IAAI;gBAAkB,aAAa;gBAAkB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAiB,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAiD,IAAI,cAAc,GAAG,IAAI,CAAC,CAAC,EAAE,eAAe,IAAI,cAAc,GAAG,GAAG;;;;;;gBAAa,MAAM;oBAAE,aAAa;gBAAW;YAAE;YAClV;gBAAE,IAAI;gBAAqB,aAAa;gBAAqB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAkB,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAAiD,IAAI,iBAAiB,GAAG,IAAI,CAAC,CAAC,EAAE,eAAe,IAAI,iBAAiB,GAAG,GAAG;;;;;;gBAAa,MAAM;oBAAE,aAAa;gBAAY;YAAE;YAChW;gBAAE,IAAI;gBAAmB,aAAa;gBAAmB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAa,MAAM;gBAAI,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAA+C,IAAI,eAAe,GAAG,IAAI,CAAC,CAAC,EAAE,eAAe,IAAI,eAAe,GAAG,GAAG;;;;;;gBAAa,MAAM;oBAAE,aAAa;gBAAgB;YAAE;YACpV;gBAAE,IAAI;gBAAmB,aAAa;gBAAmB,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAiB,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAA8D,eAAe,IAAI,eAAe;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAgB;YAAE;YAClU;gBAAE,IAAI;gBAAU,aAAa;gBAAU,QAAQ,kBAAM,8OAAC;wBAAK,WAAU;kCAA0B;;;;;;gBAAkB,MAAM;gBAAK,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,8OAAC;wBAAK,WAAU;kCAA0D,eAAe,IAAI,MAAM;;;;;;gBAAW,MAAM;oBAAE,aAAa;gBAAY;YAAE;YAChS;gBACI,IAAI;gBACJ,QAAQ;gBACR,MAAM;gBACN,MAAM,CAAC,EAAE,GAAG,EAAE,iBACV,8OAAC;wBAAI,SAAS,CAAC,IAAM,EAAE,eAAe;kCAClC,cAAA,8OAAC,qJAAY;;8CACT,8OAAC,4JAAmB;oCAAC,OAAO;8CACxB,cAAA,8OAAC,qIAAM;wCAAC,SAAQ;wCAAQ,MAAK;wCAAO,WAAU;;0DAC1C,8OAAC,kOAAc;gDAAC,WAAU;;;;;;0DAC1B,8OAAC;gDAAK,WAAU;0DAAU;;;;;;;;;;;;;;;;;8CAGlC,8OAAC,4JAAmB;oCAAC,OAAM;;sDACvB,8OAAC,yJAAgB;4CAAC,SAAS;gDACvB,mBAAmB;oDAAE,MAAM,IAAI,IAAI;oDAAE,OAAO,IAAI,KAAK;gDAAC;gDACtD,uBAAuB;4CAC3B;;8DACI,8OAAC,uMAAG;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGpC,8OAAC,yJAAgB;4CAAC,SAAS,IAAM,yBAAyB;;8DACtD,8OAAC,mNAAO;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGxC,8OAAC,yJAAgB;4CAAC,SAAS;gDACvB,IAAI,IAAI,aAAa,EAAE;oDACnB,OAAO,IAAI,CAAC,uHAAM,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa,IAAI,aAAa;gDAC5E;4CACJ;;8DACI,8OAAC,sOAAY;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;;;;;;;;;;;;;;;;;gBAO7D,MAAM;oBAAE,aAAa;oBAAY,QAAQ;gBAAiB;YAC9D;SACH,EAAE;QAAC;QAAQ;KAAyB;IAErC,MAAM,wBAAwB,oNAAiB,CAAC,CAAC;QAC7C,MAAM,cAAc,wBAAwB,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,CAAC,QAAQ,KAAK,IAAI,QAAQ;QACtF,IAAI,aAAa;YACb,mBAAmB;YACnB,uBAAuB;QAC3B;IACJ,GAAG;QAAC;KAAwB;IAE5B,MAAM,oBAAoB,oNAAiB,CACvC,CAAC;QACG,IAAI,CAAC,eAAe;QACpB,OAAO,IAAI,CAAC,uHAAM,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa;IAC3D,GACA;QAAC;KAAO;IAGZ,yEAAyE;IACzE,MAAM,qBAAqB,gNAAa,CAAC;QACrC,MAAM,sBAAsB,CAAC;YACzB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,gBAAgB,IAAA,iLAAmB,EAAC;YAE1C,gCAAgC;YAChC,MAAM,mBAAmB,KAAK,GAAG,CAAC,CAAA;gBAC9B,MAAM,kBAAkB,IAAA,oLAAsB,EAC1C,IAAI,IAAI,EACR,IAAI,KAAK,IAAI;oBACT,UAAU;oBACV,IAAI,IAAI,OAAO;oBACf,OAAO,CAAC,WAAW,EAAE,IAAI,UAAU,EAAE;oBACrC,QAAQ,IAAI,MAAM;oBAClB,WAAW;wBAAE,UAAU,IAAI,IAAI,CAAC,cAAc;oBAAC;oBAC/C,aAAa,IAAI,OAAO;gBAC5B,GACA;oBACI,UAAU,WAAW;wBACjB,UAAU,SAAS,QAAQ;wBAC3B,IAAI,SAAS,EAAE;wBACf,YAAY,SAAS,UAAU;wBAC/B,UAAU,SAAS,YAAY;oBACnC,IAAI;oBACJ,gBAAgB,UAAU;gBAC9B;gBAGJ,OAAO;oBACH,MAAM,IAAA,qKAAqB,EAAC,iBAAiB;oBAC7C,WAAW,IAAA,4KAA4B,EAAC,gBAAgB,UAAU,IAAI,EAAE;gBAC5E;YACJ;YAEA,mDAAmD;YACnD,cAAc,WAAW;YACzB,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,CAAC,eAAe,CAAC;QACzD;QAEA,MAAM,oBAAoB,CAAC;YACvB,IAAI,KAAK,MAAM,KAAK,GAAG;gBACnB,iJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,UAAU;gBAAC;gBAAS;gBAAY;gBAAY;gBAAc;gBAAW;gBAAY;gBAAa;gBAAiB;gBAAY;aAAY;YAC7I,MAAM,aAAa,KAAK,GAAG,CAAC,CAAA,MAAO,CAAC;oBAChC,SAAS,IAAI,OAAO;oBACpB,YAAY,IAAI,UAAU;oBAC1B,YAAY,IAAI,OAAO;oBACvB,cAAc,IAAI,MAAM;oBACxB,WAAW,IAAI,aAAa;oBAC5B,YAAY,IAAI,cAAc;oBAC9B,aAAa,IAAI,iBAAiB;oBAClC,iBAAiB,IAAI,eAAe;oBACpC,YAAY,IAAI,eAAe;oBAC/B,aAAa,IAAI,MAAM;gBAC3B,CAAC;YAED,MAAM,KAAK,sIAAU,CAAC,aAAa,CAAC,YAAY;gBAAE,QAAQ;YAAQ;YAClE,MAAM,KAAK,sIAAU,CAAC,QAAQ;YAC9B,sIAAU,CAAC,iBAAiB,CAAC,IAAI,IAAI;YACrC,0IAAc,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,MAAM,KAAK,cAAc,CAAC;YAChE,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,CAAC,cAAc,CAAC;QACxD;QAEA,OAAO;YACH;gBACI,OAAO;gBACP,MAAM,mNAAO;gBACb,UAAU;YACd;YACA;gBACI,OAAO;gBACP,MAAM,+OAAe;gBACrB,UAAU;YACd;SACH;IACL,GAAG;QAAC;QAAU;QAAW;KAAc;IAEvC,0BAA0B;IAC1B,MAAM,gBAAgB,gNAAa,CAAC,IAAM;0BACtC,8OAAC,qIAAM;gBAAY,SAAQ;gBAAU,MAAK;gBAAK,WAAU;gBAAM,SAAS,IAAM,OAAO,IAAI,CAAC;;kCACtF,8OAAC,6NAAS;wBAAC,WAAU;;;;;;oBAAiB;;eAD9B;;;;;0BAIZ,8OAAC,qIAAM;gBAAY,MAAK;gBAAK,WAAU;gBAAM,SAAS,IAAM,OAAO,IAAI,CAAC,CAAC,WAAW,EAAE,SAAS,KAAK,CAAC;;kCACjG,8OAAC,mNAAI;wBAAC,WAAU;;;;;;oBAAiB;;eADzB;;;;;SAIf,EAAE;QAAC;QAAQ;KAAS;IAEvB,6BAA6B;IAC7B,MAAM,aAAa,gNAAa,CAAC;QAC/B,IAAI,CAAC,UAAU,OAAO;YACpB;gBAAE,OAAO;gBAAa,MAAM;gBAAK,WAAW;YAAM;YAClD;gBAAE,OAAO;gBAAa,MAAM;gBAAc,WAAW;YAAM;YAC3D;gBAAE,OAAO;gBAAY,MAAM;gBAAI,WAAW;YAAK;SAChD;QACD,OAAO;YACL;gBAAE,OAAO;gBAAa,MAAM;gBAAK,WAAW;YAAM;YAClD;gBAAE,OAAO;gBAAa,MAAM;gBAAc,WAAW;YAAM;YACrD;gBAAE,OAAO,SAAS,QAAQ;gBAAE,MAAM;gBAAI,WAAW;YAAK;SAC7D;IACH,GAAG;QAAC;KAAS;IAEX,MAAM,cAAc,gNAAa,CAAC,IAAM,4BAA4B,UAAU,mBAAmB;QAAC,UAAU;KAAiB;IAE/H,IAAA,uJAAa,EAAC;QACR,OAAO,UAAU,YAAY;QAC7B,OAAO;QACX,SAAS;QACL;IACN;IAEA,IAAI,CAAC,UAAU;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAoB;;;;;;kCAClC,8OAAC;wBAAE,WAAU;kCAA6B;;;;;;kCAC1C,8OAAC,qIAAM;wBAAC,SAAS,IAAM,OAAO,IAAI,CAAC;wBAAe,WAAU;wBAAO,MAAK;;0CACtE,8OAAC,6NAAS;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;;;;;;;;;;;;IAMhD;IAEA,MAAM,cAAc,CAAC;QACnB,OAAO,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,WAAW,GAAG,KAAK,CAAC,GAAG;IACxE;IAEA,MAAM,wBAAwB;QAC5B,IAAI,CAAC,SAAS,QAAQ,EAAE,OAAO;QAC/B,MAAM,SAAS,IAAA,qIAAa,EAAC,SAAS,QAAQ,EAAE,IAAI;QACpD,MAAM,QAAQ,KAAK,KAAK,CAAC,SAAS;QAClC,MAAM,kBAAkB,SAAS;QACjC,IAAI,QAAQ,GAAG;YACb,OAAO,GAAG,MAAM,KAAK,EAAE,kBAAkB,IAAI,GAAG,gBAAgB,MAAM,CAAC,GAAG,IAAI;QAChF;QACA,OAAO,GAAG,OAAO,MAAM,CAAC;IAC1B;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC,iIAAI;8BACD,cAAA,8OAAC,wIAAW;wBAAC,WAAU;kCACnB,cAAA,8OAAC;4BAAI,WAAU;;8CACX,8OAAC,qIAAM;oCAAC,WAAU;;sDACd,8OAAC,0IAAW;4CAAC,KAAK,SAAS,SAAS;4CAAE,KAAK,SAAS,QAAQ;;;;;;sDAC5D,8OAAC,6IAAc;sDAAE,YAAY,SAAS,QAAQ;;;;;;;;;;;;8CAElD,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;oDAAI,WAAU;;sEACX,8OAAC,0MAAI;4DAAC,WAAU;;;;;;sEAChB,8OAAC;sEAAM,SAAS,SAAS,IAAI;;;;;;;;;;;;8DAEjC,8OAAC;oDAAI,WAAU;;sEACX,8OAAC,6MAAK;4DAAC,WAAU;;;;;;sEACjB,8OAAC;sEAAM,SAAS,KAAK,IAAI;;;;;;;;;;;;8DAE7B,8OAAC;oDAAI,WAAU;;sEACX,8OAAC,6NAAS;4DAAC,WAAU;;;;;;wDACpB,SAAS,cAAc,iBACpB,8OAAC,uKAAI;4DACD,MAAM,CAAC,UAAU,EAAE,SAAS,cAAc,EAAE;4DAC5C,WAAU;sEAET;;;;;iFAGL,8OAAC;sEAAM;;;;;;;;;;;;8DAGf,8OAAC;oDAAI,WAAU;;sEACX,8OAAC,sNAAQ;4DAAC,WAAU;;;;;;sEACpB,8OAAC;;gEAAK;gEAAU;;;;;;;;;;;;;;;;;;;sDAGxB,8OAAC;4CAAI,WAAU;;8DACX,8OAAC,mIAAK;oDAAC,SAAS,SAAS,gBAAgB,KAAK,kBAAkB,YAAY,SAAS,gBAAgB,KAAK,aAAa,cAAc;8DAChI,SAAS,gBAAgB;;;;;;8DAE9B,8OAAC,mIAAK;oDAAC,SAAQ;8DAAW,SAAS,YAAY;;;;;;8DAC/C,8OAAC,mIAAK;oDAAC,SAAQ;8DAAW,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAQzD,8OAAC;oBAAI,WAAU;;sCACX,8OAAC,+IAAS;4BACN,OAAM;4BACN,OAAO,eAAe,SAAS,UAAU;4BACzC,MAAM,gOAAU;4BAChB,aAAY;;;;;;sCAEhB,8OAAC,+IAAS;4BACN,OAAM;4BACN,OAAO,KAAK,CAAC,SAAS,UAAU,IAAI,CAAC;4BACrC,MAAM,sNAAQ;4BACd,aAAa,CAAC,QAAQ,EAAE,SAAS,UAAU,IAAI,EAAE,QAAQ,CAAC;;;;;;sCAE9D,8OAAC,+IAAS;4BACN,OAAM;4BACN,OAAO,cAAc,MAAM;4BAC3B,MAAM,yNAAS;4BACf,aAAa,GAAG,cAAc,MAAM,CAAC,CAAC,IAAW,EAAE,UAAU,KAAK,cAAc,MAAM,CAAC,SAAS,CAAC;;;;;;;;;;;;8BAIzG,8OAAC,iIAAI;oBAAC,cAAa;;sCACf,8OAAC;4BAAI,WAAU;4BAAqD,OAAO;gCAAE,yBAAyB;gCAAS,gBAAgB;4BAAO;sCAClI,cAAA,8OAAC,qIAAQ;gCAAC,WAAU;;kDAChB,8OAAC,wIAAW;wCAAC,OAAM;wCAAW,WAAU;kDAAgE;;;;;;kDACxG,8OAAC,wIAAW;wCAAC,OAAM;wCAAY,WAAU;kDAAgE;;;;;;kDACzG,8OAAC,wIAAW;wCAAC,OAAM;wCAAO,WAAU;kDAAgE;;;;;;kDACpG,8OAAC,wIAAW;wCAAC,OAAM;wCAAU,WAAU;kDAAgE;;;;;;kDACvG,8OAAC,wIAAW;wCAAC,OAAM;wCAAY,WAAU;kDAAgE;;;;;;kDACzG,8OAAC,wIAAW;wCAAC,OAAM;wCAAY,WAAU;kDAAgE;;;;;;kDACzG,8OAAC,wIAAW;wCAAC,OAAM;wCAAS,WAAU;kDAAgE;;;;;;kDACtG,8OAAC,wIAAW;wCAAC,OAAM;wCAAM,WAAU;kDAAgE;;;;;;kDACnG,8OAAC,wIAAW;wCAAC,OAAM;wCAAQ,WAAU;kDAAgE;;;;;;kDACrG,8OAAC,wIAAW;wCAAC,OAAM;wCAAU,WAAU;kDAAgE;;;;;;;;;;;;;;;;;sCAI/G,8OAAC,wIAAW;4BAAC,OAAM;4BAAW,WAAU;sCACpC,cAAA,8OAAC;gCAAI,WAAU;;kDAEX,8OAAC,iIAAI;;0DACD,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;;kEACnB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAY,OAAO,SAAS,MAAM;;;;;;kEAClD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAY,OAAO,IAAA,kIAAU,EAAC,SAAS,GAAG;;;;;;kEAC1D,8OAAC,6IAAQ;wDAAC,OAAM;wDAAW,OAAO,SAAS,YAAY;;;;;;kEACvD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAsB,OAAO,SAAS,aAAa;;;;;;kEACnE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAgB,OAAO,SAAS,KAAK;;;;;;kEACrD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAgB,OAAO,SAAS,aAAa;;;;;;;;;;;;;;;;;;kDAKrE,8OAAC,iIAAI;;0DACD,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;;kEACnB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAU,OAAO,SAAS,UAAU;;;;;;kEACpD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAW,OAAO,IAAA,kIAAU,EAAC,SAAS,mBAAmB;;;;;;kEACzE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAU,OAAO,SAAS,oBAAoB;;;;;;kEAC9D,8OAAC,6IAAQ;wDAAC,OAAM;wDAAa,OAAO,SAAS,aAAa;;;;;;kEAC1D,8OAAC,6IAAQ;wDAAC,OAAM;wDAAa,OAAO,SAAS,qBAAqB;;;;;;kEAClE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAY,OAAO,SAAS,QAAQ;;;;;;kEACpD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAY,OAAO,SAAS,UAAU;;;;;;kEACtD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAe,OAAO,SAAS,iBAAiB;;;;;;;;;;;;;;;;;;kDAKxE,8OAAC,iIAAI;wCAAC,WAAU;;0DACZ,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;;kEACnB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAiB,OAAO,SAAS,oBAAoB;;;;;;kEACrE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAiB,OAAO,SAAS,qBAAqB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAMtF,8OAAC,wIAAW;4BAAC,OAAM;4BAAY,WAAU;sCACrC,cAAA,8OAAC;gCAAI,WAAU;;kDACX,8OAAC,iIAAI;;0DACD,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;0DACjB,SAAS,gBAAgB,iBACvB;;sEACI,8OAAC,6IAAQ;4DAAC,OAAM;4DAAgB,OAAO,SAAS,gBAAgB,CAAC,MAAM;;;;;;sEACvE,8OAAC,6IAAQ;4DAAC,OAAM;4DAAY,OAAO,SAAS,gBAAgB,CAAC,IAAI;;;;;;wDAChE,SAAS,gBAAgB,CAAC,UAAU,KAAK,2BACtC,8OAAC,6IAAQ;4DAAC,OAAM;4DAAa,OAAO,SAAS,gBAAgB,CAAC,QAAQ;;;;;;sEAE1E,8OAAC,6IAAQ;4DAAC,OAAM;4DAAiB,OAAO,SAAS,gBAAgB,CAAC,QAAQ;;;;;;sEAC1E,8OAAC,6IAAQ;4DAAC,OAAM;4DAAS,OAAO,qBAAqB,SAAS,gBAAgB;;;;;;;iFAGjF,8OAAC;oDAAE,WAAU;8DAAgC;;;;;;;;;;;;;;;;;kDAI1D,8OAAC,iIAAI;;0DACD,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;0DACjB,SAAS,gBAAgB,iBACvB;;sEACI,8OAAC,6IAAQ;4DAAC,OAAM;4DAAgB,OAAO,SAAS,gBAAgB,CAAC,MAAM;;;;;;sEACvE,8OAAC,6IAAQ;4DAAC,OAAM;4DAAY,OAAO,SAAS,gBAAgB,CAAC,IAAI;;;;;;wDAChE,SAAS,gBAAgB,CAAC,UAAU,KAAK,2BACtC,8OAAC,6IAAQ;4DAAC,OAAM;4DAAa,OAAO,SAAS,gBAAgB,CAAC,QAAQ;;;;;;sEAE1E,8OAAC,6IAAQ;4DAAC,OAAM;4DAAiB,OAAO,SAAS,gBAAgB,CAAC,QAAQ;;;;;;sEAC1E,8OAAC,6IAAQ;4DAAC,OAAM;4DAAS,OAAO,qBAAqB,SAAS,gBAAgB;;;;;;;iFAGjF,8OAAC;oDAAE,WAAU;8DAAgC;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAOlE,8OAAC,wIAAW;4BAAC,OAAM;4BAAO,WAAU;sCAChC,cAAA,8OAAC;gCAAI,WAAU;;kDAEX,8OAAC,iIAAI;;0DACD,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;;kEACnB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAkB,OAAO,SAAS,SAAS;;;;;;kEAC3D,8OAAC,6IAAQ;wDAAC,OAAM;kEACX,SAAS,cAAc,iBACpB,8OAAC,uKAAI;4DACD,MAAM,CAAC,UAAU,EAAE,SAAS,cAAc,EAAE;4DAC5C,WAAU;sEAET;;;;;iFAGL,8OAAC;sEAAM;;;;;;;;;;;kEAGf,8OAAC,6IAAQ;wDAAC,OAAM;wDAAY,OAAO,SAAS,UAAU;;;;;;kEACtD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAY,OAAO,SAAS,QAAQ;;;;;;kEACpD,8OAAC,6IAAQ;wDAAC,OAAM;wDAAc,OAAO,SAAS,cAAc;;;;;;kEAC5D,8OAAC,6IAAQ;wDAAC,OAAM;wDAAa,OAAO,IAAA,kIAAU,EAAC,SAAS,iBAAiB;;;;;;kEACzE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAkB,OAAO,IAAA,kIAAU,EAAC,SAAS,eAAe;;;;;;kEAC5E,8OAAC,6IAAQ;wDAAC,OAAM;wDAAe,OAAO,IAAA,kIAAU,EAAC,SAAS,QAAQ;;;;;;kEAClE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAiB,OAAO,SAAS,YAAY;;;;;;kEAC7D,8OAAC,6IAAQ;wDAAC,OAAM;kEACZ,cAAA,8OAAC,mIAAK;4DAAC,SAAS,SAAS,gBAAgB,KAAK,kBAAkB,YAAY,SAAS,gBAAgB,KAAK,aAAa,cAAc;sEAChI,SAAS,gBAAgB;;;;;;;;;;;oDAGjC,SAAS,eAAe,kBACrB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAiB,OAAO,IAAA,kIAAU,EAAC,SAAS,eAAe;;;;;;oDAE9E,SAAS,gBAAgB,kBACtB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAkB,OAAO,SAAS,gBAAgB;;;;;;;;;;;;;;;;;;kDAM9E,8OAAC,iIAAI;;0DACD,8OAAC,uIAAU;0DACP,cAAA,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;;;;;;0DAEnC,8OAAC,wIAAW;gDAAC,WAAU;;kEACnB,8OAAC,6IAAQ;wDAAC,OAAM;wDAAe,OAAO,eAAe,SAAS,UAAU;;;;;;kEACxE,8OAAC,6IAAQ;wDAAC,OAAM;wDAAkB,OAAO,eAAe,SAAS,qBAAqB;;;;;;kEACtF,8OAAC,6IAAQ;wDAAC,OAAM;wDAAkB,OAAO,eAAe,SAAS,iBAAiB;;;;;;kEAClF,8OAAC,6IAAQ;wDAAC,OAAM;wDAAkB,OAAO,eAAe,SAAS,aAAa;;;;;;kEAC9E,8OAAC,6IAAQ;wDAAC,OAAM;wDAAe,OAAO,eAAe,SAAS,eAAe;;;;;;kEAC7E,8OAAC,6IAAQ;wDAAC,OAAM;wDAAe,OAAO,GAAG,SAAS,UAAU,IAAI,EAAE,UAAU,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAM7F,8OAAC,wIAAW;4BAAC,OAAM;4BAAU,WAAU;sCACnC,cAAA,8OAAC,0KAAkB;gCAAC,UAAU;;;;;;;;;;;sCAGlC,8OAAC,wIAAW;4BAAC,OAAM;4BAAY,WAAU;sCACrC,cAAA,8OAAC,oKAAiB;gCAAC,kBAAkB,SAAS,QAAQ,IAAI,SAAS,EAAE;;;;;;;;;;;sCAGzE,8OAAC,wIAAW;4BAAC,OAAM;4BAAY,WAAU;sCACrC,cAAA,8OAAC,iIAAI;0CACD,cAAA,8OAAC,wIAAW;oCAAC,WAAU;8CACnB,cAAA,8OAAC,4KAAgB;wCACb,MAAM;wCACN,SAAS;wCACT,YAAY;4CAAC;4CAAU;yCAAK;wCAC5B,mBAAkB;wCAClB,kBAAiB;wCACjB,iBAAgB;wCAChB,gBAAgB,CAAC,aAAa,EAAE,SAAS,EAAE,EAAE;wCAC7C,YAAY,CAAC,MAAQ,OAAO,IAAI,CAAC,CAAC,WAAW,EAAE,IAAI,QAAQ,EAAE;wCAC7D,YAAY;wCACZ,mBAAmB;;;;;;;;;;;;;;;;;;;;;sCAMnC,8OAAC,wIAAW;4BAAC,OAAM;4BAAS,WAAU;sCAClC,cAAA,8OAAC,iIAAI;0CACD,cAAA,8OAAC,wIAAW;oCAAC,WAAU;8CACnB,cAAA,8OAAC,4KAAgB;wCACb,MAAM;wCACN,SAAS;wCACT,YAAY;4CAAC;4CAAM;4CAAiB;yCAAS;wCAC7C,mBAAkB;wCAClB,kBAAiB;wCACjB,iBAAgB;wCAChB,gBAAgB,CAAC,kBAAkB,EAAE,SAAS,EAAE,EAAE;wCAClD,YAAY,CAAC,MAAQ,OAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,IAAI,QAAQ,EAAE;wCAC1D,YAAY;wCACZ,mBAAmB;;;;;;;;;;;;;;;;;;;;;sCAMnC,8OAAC,wIAAW;4BAAC,OAAM;4BAAM,WAAU;sCAC/B,cAAA,8OAAC;gCAAsB,OAAM;;;;;;;;;;;sCAGrB,8OAAC,wIAAW;4BAAC,OAAM;4BAAQ,WAAU;sCAC7B,cAAA,8OAAC,iIAAI;0CACG,cAAA,8OAAC,wIAAW;oCAAC,WAAU;8CACf,cAAA,8OAAC,4KAAgB;wCACT,MAAM;wCACN,SAAS;wCACT,YAAY;4CAAC;4CAAS;yCAAO;wCAC7B,mBAAkB;wCAClB,kBAAiB;wCACjB,iBAAgB;wCAChB,gBAAgB,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;wCAC1C,YAAY,CAAC,MAAQ,OAAO,IAAI,CAAC,IAAI,IAAI;wCACzC,YAAY;wCACZ,mBAAmB;;;;;;;;;;;;;;;;;;;;;sCAMnD,8OAAC,wIAAW;4BAAC,OAAM;4BAAU,WAAU;;8CAE/B,8OAAC,iIAAI;;sDACD,8OAAC,uIAAU;;8DACP,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;8DAC/B,8OAAC,4IAAe;8DAAC;;;;;;;;;;;;sDAIrB,8OAAC,wIAAW;sDACP,wBAAwB,MAAM,KAAK,kBAChC,8OAAC;gDAAI,WAAU;0DACX,cAAA,8OAAC;oDAAE,WAAU;8DAAgC;;;;;;;;;;qEAKjD,8OAAC,4KAAgB;gDACb,MAAM;gDACN,SAAS;gDACT,YAAY;oDAAC;oDAAW;iDAAa;gDACrC,mBAAkB;gDAClB,gBAAgB,CAAC,MAAM,EAAE,SAAS,EAAE,EAAE;gDACtC,YAAY;gDACZ,YAAY;gDACZ,gBAAgB;oDAAE,IAAI;oDAAW,MAAM;gDAAK;gDAC5C,mBAAmB;;;;;;;;;;;;;;;;;8CAOnC,8OAAC,iIAAI;;sDACD,8OAAC,uIAAU;;8DACP,8OAAC,sIAAS;oDAAC,WAAU;8DAAU;;;;;;8DAC/B,8OAAC,4IAAe;8DAAC;;;;;;;;;;;;sDAIrB,8OAAC,wIAAW;sDACP,kBAAkB,MAAM,KAAK,kBAC1B,8OAAC;gDAAI,WAAU;0DACX,cAAA,8OAAC;oDAAE,WAAU;8DAAgC;;;;;;;;;;qEAKjD,8OAAC,4KAAgB;gDACb,MAAM;gDACN,SAAS;gDACT,YAAY;oDAAC;iDAAa;gDAC1B,mBAAkB;gDAClB,gBAAgB,CAAC,SAAS,EAAE,SAAS,EAAE,EAAE;gDACzC,YAAY,CAAC;oDACT,sBAAsB;oDACtB,0BAA0B;gDAC9B;gDACA,YAAY;gDACZ,gBAAgB;oDAAE,IAAI;oDAAY,MAAM;gDAAK;gDAC7C,mBAAmB;;;;;;;;;;;;;;;;;8CAOnC,8OAAC;oCAAI,WAAU;;sDACX,8OAAC,iIAAI;;8DACD,8OAAC,uIAAU;;sEACP,8OAAC,sIAAS;4DAAC,WAAU;sEAAU;;;;;;sEAC/B,8OAAC,4IAAe;sEACX,gBAAgB,wBACX,uDACA;;;;;;;;;;;;8DAGd,8OAAC,wIAAW;oDAAC,WAAU;;wDAClB,kBAAkB,MAAM,KAAK,mBAC1B,8OAAC;4DAAE,WAAU;sEAAgC;;;;;;wDAIhD,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW,MAAM,GAAG,mBAC9D,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAG,WAAU;;sFACV,8OAAC,gOAAU;4EAAC,WAAU;;;;;;wEAAY;;;;;;;gEAErC,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW,GAAG,CAAC,CAAC,0BAC1D,8OAAC;wEAEG,WAAU;;0FAEV,8OAAC;;kGACG,8OAAC;wFAAE,WAAU;kGAAe,UAAU,IAAI;;;;;;kGAC1C,8OAAC;wFAAE,WAAU;kGACR,UAAU,IAAI,KAAK,UACd,eAAe,UAAU,MAAM,IAC/B,UAAU,OAAO,IAAI;;;;;;;;;;;;0FAGnC,8OAAC;gFAAI,WAAU;;kGACX,8OAAC,mIAAK;wFAAC,SAAS,UAAU,OAAO,GAAG,YAAY;wFAAa,WAAU;kGAClE,UAAU,OAAO,GAAG,cAAc;;;;;;oFAEtC,UAAU,qBAAqB,kBAC5B,8OAAC,mIAAK;wFAAC,SAAQ;wFAAU,WAAU;kGAAU;;;;;;;;;;;;;uEAhBhD,UAAU,QAAQ;;;;;;;;;;;wDAyBtC,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,aAAa,MAAM,GAAG,mBAChE,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAG,WAAU;;sFACV,8OAAC,0NAAQ;4EAAC,WAAU;;;;;;wEAAY;;;;;;;gEAEnC,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,aAAa,GAAG,CAAC,CAAC,0BAC5D,8OAAC;wEAEG,WAAU;;0FAEV,8OAAC;;kGACG,8OAAC;wFAAE,WAAU;kGAAe,UAAU,IAAI;;;;;;kGAC1C,8OAAC;wFAAE,WAAU;kGACR,UAAU,IAAI,KAAK,UACd,eAAe,UAAU,MAAM,IAC/B,UAAU,OAAO,IAAI;;;;;;;;;;;;0FAGnC,8OAAC,mIAAK;gFAAC,SAAQ;gFAAc,WAAU;0FAAU;;;;;;;uEAX5C,UAAU,QAAQ;;;;;;;;;;;wDAoBtC,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,gBAAgB,MAAM,GAAG,mBACnE,8OAAC;4DAAI,WAAU;;8EACX,8OAAC;oEAAG,WAAU;;sFACV,8OAAC,6NAAS;4EAAC,WAAU;;;;;;wEAAY;;;;;;;gEAEpC,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,gBAAgB,GAAG,CAAC,CAAC,0BAC/D,8OAAC;wEAEG,WAAU;;0FAEV,8OAAC;;kGACG,8OAAC;wFAAE,WAAU;kGAAe,UAAU,IAAI;;;;;;kGAC1C,8OAAC;wFAAE,WAAU;kGACR,UAAU,IAAI,KAAK,UACd,eAAe,UAAU,MAAM,IAC/B,UAAU,OAAO,IAAI;;;;;;;;;;;;0FAGnC,8OAAC,mIAAK;gFAAC,SAAQ;gFAAY,WAAU;0FAAU;;;;;;;uEAX1C,UAAU,QAAQ;;;;;;;;;;;;;;;;;;;;;;;sDAqB/C,8OAAC,iIAAI;;8DACD,8OAAC,uIAAU;oDAAC,WAAU;;sEAClB,8OAAC,sIAAS;4DAAC,WAAU;sEAAU;;;;;;sEAC/B,8OAAC;4DAAI,WAAU;;8EACX,8OAAC,0MAAI;oEAAC,WAAU;;;;;;8EAChB,8OAAC;;wEAAK;wEAAY,gBAAgB,kBAAkB,SAAS,aAAa;;;;;;;;;;;;;;;;;;;8DAGlF,8OAAC,wIAAW;oDAAC,WAAU;;wDAClB,gBAAgB,kBAAkB,uBAC/B,8OAAC;4DAAE,WAAU;sEAAwB;;;;;iFAErC;;8EACI,8OAAC,6IAAQ;oEAAC,OAAM;oEAAe,OAAO,gBAAgB,oBAAoB,iBAAiB,SAAS,iBAAiB,IAAI;;;;;;8EACzH,8OAAC,6IAAQ;oEAAC,OAAM;oEAAY,OAAO,gBAAgB,oBAAoB,YAAY,SAAS,QAAQ,IAAI;;;;;;8EACxG,8OAAC,6IAAQ;oEAAC,OAAM;oEAAY,OAAO,gBAAgB,oBAAoB,cAAc,SAAS,UAAU,IAAI;;;;;;;;wDAGnH,6BACG,8OAAC,6IAAQ;4DACL,OAAM;4DACN,OAAO,GAAG,aAAa,IAAI,CAAC,EAAE,EAAE,aAAa,SAAS,CAAC,GAAG,EAAE,aAAa,OAAO,CAAC,CAAC,CAAC;;;;;iFAGvF,8OAAC,6IAAQ;4DAAC,OAAM;4DAAc,OAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAQ5E,8OAAC,qIAAM;4BAAC,MAAM;4BAAqB,cAAc;sCAC7C,cAAA,8OAAC,4IAAa;gCAAC,WAAU;;kDACrB,8OAAC,2IAAY;;0DACT,8OAAC,0IAAW;0DAAC;;;;;;0DACb,8OAAC,gJAAiB;;oDACb,iBAAiB,OAAO,MAAM;oDAAc;oDAAI,iBAAiB,iBAAiB,OAAO,UAAU,YAAY,iBAAiB,KAAK;;;;;;;;;;;;;oCAG7I,iCACG,8OAAC;wCAAI,WAAU;;0DAEX,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC;gEAAK,WAAU;0EAAe,gBAAgB,KAAK,EAAE,MAAM;;;;;;;;;;;;kEAEhE,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;4DACvC,gBAAgB,KAAK,iBAAG,8OAAC,2KAAkB;gEAAC,QAAQ,gBAAgB,KAAK,CAAC,MAAM;;;;;qFAAO,8OAAC,mIAAK;gEAAC,SAAQ;0EAAU;;;;;;;;;;;;kEAErH,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC;gEAAK,WAAU;0EAAe,iBAAiB,gBAAgB,KAAK,EAAE,UAAU,YAAY,gBAAgB,IAAI,CAAC,cAAc;;;;;;;;;;;;kEAEpI,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC;gEAAK,WAAU;0EAAe,IAAA,kIAAU,EAAC,gBAAgB,KAAK,EAAE,eAAe,gBAAgB,IAAI,CAAC,SAAS,KAAK;;;;;;;;;;;;;;;;;;0DAK3H,8OAAC;gDAAI,WAAU;;kEAEX,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAG,WAAU;;kFACV,8OAAC,gOAAU;wEAAC,WAAU;;;;;;oEAAY;;;;;;;0EAGtC,8OAAC;gEAAI,WAAU;;oEACV,gBAAgB,IAAI,CAAC,UAAU,IAAI,gBAAgB,IAAI,CAAC,UAAU,CAC9D,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAC3B,GAAG,CAAC,CAAC,MAAM,oBACR,8OAAC;4EAAc,WAAU;;8FACrB,8OAAC;oFAAK,WAAU;8FAAyB,KAAK,KAAK;;;;;;8FACnD,8OAAC;oFAAK,WAAU;8FAA2C,eAAe,KAAK,MAAM;;;;;;;2EAF/E;;;;;oEAMjB,CAAC,CAAC,gBAAgB,IAAI,CAAC,UAAU,IAAI,gBAAgB,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW,MAAM,KAAK,CAAC,mBACpH,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;0FAA2C,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,aAAa;;;;;;;;;;;;kFAG3H,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;0FAAK;;;;;;0FACN,8OAAC;gFAAK,WAAU;0FAA+B,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,aAAa;;;;;;;;;;;;;;;;;;;;;;;;kEAMnH,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAG,WAAU;;kFACV,8OAAC,0NAAQ;wEAAC,WAAU;;;;;;oEAAY;;;;;;;0EAGpC,8OAAC;gEAAI,WAAU;;oEACV,gBAAgB,IAAI,CAAC,UAAU,IAAI,gBAAgB,IAAI,CAAC,UAAU,CAC9D,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,aAC3B,GAAG,CAAC,CAAC,MAAM,oBACR,8OAAC;4EAAc,WAAU;;8FACrB,8OAAC;oFAAK,WAAU;8FAAyB,KAAK,KAAK;;;;;;8FACnD,8OAAC;oFAAK,WAAU;;wFAAwC;wFAAE,eAAe,KAAK,MAAM;;;;;;;;2EAF9E;;;;;oEAMjB,gBAAgB,IAAI,CAAC,MAAM,CAAC,uBAAuB,GAAG,mBACnD,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;;oFAAwC;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,uBAAuB;;;;;;;;;;;;;oEAGnI,gBAAgB,IAAI,CAAC,MAAM,CAAC,uBAAuB,GAAG,mBACnD,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;;oFAAwC;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,uBAAuB;;;;;;;;;;;;;oEAGnI,gBAAgB,IAAI,CAAC,MAAM,CAAC,6BAA6B,GAAG,mBACzD,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;;oFAAwC;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,6BAA6B;;;;;;;;;;;;;oEAIzI,gBAAgB,IAAI,CAAC,MAAM,CAAC,iBAAiB,GAAG,mBAC7C,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;;oFAAwC;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,iBAAiB;;;;;;;;;;;;;oEAI7H,gBAAgB,IAAI,CAAC,MAAM,CAAC,iBAAiB,GAAG,mBAC7C,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;;oFAAwC;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,iBAAiB;;;;;;;;;;;;;oEAI7H,gBAAgB,IAAI,CAAC,MAAM,CAAC,eAAe,GAAG,mBAC3C,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;;oFAAwC;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,eAAe;;;;;;;;;;;;;kFAG5H,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;0FAAK;;;;;;0FACN,8OAAC;gFAAK,WAAU;;oFAA4B;oFAAE,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;kEAM/G,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAG,WAAU;;kFACV,8OAAC,0NAAQ;wEAAC,WAAU;;;;;;oEAAY;;;;;;;0EAGpC,8OAAC;gEAAI,WAAU;;kFACX,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;0FAAgB,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,mBAAmB;;;;;;;;;;;;kFAElG,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;0FAAgB,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,aAAa;;;;;;;;;;;;kFAE5F,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;0FAAwB;;;;;;0FACxC,8OAAC;gFAAK,WAAU;0FAAgB,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,iBAAiB;;;;;;;;;;;;kFAEhG,8OAAC;wEAAI,WAAU;;0FACX,8OAAC;gFAAK,WAAU;;oFAAwB;oFAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,kBAAkB;oFAAC;;;;;;;0FACtG,8OAAC;gFAAK,WAAU;0FAAgB,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;;oDAMxG,gBAAgB,IAAI,CAAC,UAAU,IAAI,gBAAgB,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,gBAAgB,MAAM,GAAG,mBACpH,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAG,WAAU;;kFACV,8OAAC,6NAAS;wEAAC,WAAU;;;;;;oEAAY;;;;;;;0EAGrC,8OAAC;gEAAI,WAAU;0EACV,gBAAgB,IAAI,CAAC,UAAU,CAC3B,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,gBAC3B,GAAG,CAAC,CAAC,MAAM,oBACR,8OAAC;wEAAc,WAAU;;0FACrB,8OAAC;gFAAK,WAAU;0FAAyB,KAAK,KAAK;;;;;;0FACnD,8OAAC;gFAAK,WAAU;0FAA4B,eAAe,KAAK,MAAM;;;;;;;uEAFhE;;;;;;;;;;;;;;;;;;;;;;0DAWlC,8OAAC;gDAAI,WAAU;0DACX,cAAA,8OAAC;oDAAI,WAAU;;sEACX,8OAAC;4DAAK,WAAU;sEAAwB;;;;;;sEACxC,8OAAC;4DAAK,WAAU;sEAAgD,eAAe,gBAAgB,IAAI,CAAC,MAAM,CAAC,MAAM;;;;;;;;;;;;;;;;;0DAIzH,8OAAC;gDAAI,WAAU;;kEACX,8OAAC,sLAAkB;wDACf,aAAa,gBAAgB,IAAI;wDACjC,WAAW,gBAAgB,KAAK;wDAChC,SAAQ;wDACR,WAAU;;;;;;kEAEd,8OAAC,qIAAM;wDACH,SAAQ;wDACR,WAAU;wDACV,SAAS;4DACL,uBAAuB;4DACvB,IAAI,gBAAgB,KAAK,EAAE,UAAU;gEACjC,kBAAkB,gBAAgB,KAAK,CAAC,QAAQ;4DACpD;wDACJ;kEACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAUrB,8OAAC,qIAAM;4BAAC,MAAM;4BAAwB,cAAc;sCAChD,cAAA,8OAAC,4IAAa;gCAAC,WAAU;;kDACrB,8OAAC,2IAAY;;0DACT,8OAAC,0IAAW;gDAAC,WAAU;;kEACnB,8OAAC,6MAAK;wDAAC,WAAU;;;;;;oDAAY;;;;;;;0DAGjC,8OAAC,gJAAiB;;oDACb,oBAAoB;oDAAW;oDAAI,oBAAoB,SAAS,YAAY;;;;;;;;;;;;;oCAGpF,oCACG,8OAAC;wCAAI,WAAU;;0DAEX,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC;gEAAK,WAAU;0EAAe,SAAS,QAAQ;;;;;;;;;;;;kEAEpD,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC;gEAAK,WAAU;0EAAa,SAAS,EAAE;;;;;;;;;;;;kEAE5C,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC;gEAAK,WAAU;0EAAe,mBAAmB,UAAU;;;;;;;;;;;;kEAEhE,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAK,WAAU;0EAAwB;;;;;;0EACxC,8OAAC,mIAAK;gEAAC,SAAS,mBAAmB,MAAM,GAAG,YAAY;gEAAW,WAAW,mBAAmB,MAAM,GAAG,iBAAiB;0EACtH,mBAAmB,MAAM,GAAG,YAAY;;;;;;;;;;;;;;;;;;0DAMrD,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAqC,mBAAmB,QAAQ;;;;;;0EAC7E,8OAAC;gEAAE,WAAU;0EAAgC;;;;;;;;;;;;kEAEjD,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAoC,mBAAmB,SAAS;;;;;;0EAC7E,8OAAC;gEAAE,WAAU;0EAAgC;;;;;;;;;;;;kEAEjD,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAuC,mBAAmB,UAAU;;;;;;0EACjF,8OAAC;gEAAE,WAAU;0EAAgC;;;;;;;;;;;;kEAEjD,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAsC,mBAAmB,YAAY;;;;;;0EAClF,8OAAC;gEAAE,WAAU;0EAAgC;;;;;;;;;;;;kEAEjD,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAsC,mBAAmB,eAAe;;;;;;0EACrF,8OAAC;gEAAE,WAAU;0EAAgC;;;;;;;;;;;;kEAEjD,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAsC,mBAAmB,OAAO;;;;;;0EAC7E,8OAAC;gEAAE,WAAU;0EAAgC;;;;;;;;;;;;;;;;;;0DAKrD,8OAAC;gDAAI,WAAU;;kEACX,8OAAC,qIAAM;wDACH,SAAQ;wDACR,WAAU;wDACV,SAAS,IAAM,4BAA4B;;0EAE3C,8OAAC,mNAAO;gEAAC,WAAU;;;;;;4DAAiB;;;;;;;kEAGxC,8OAAC,qIAAM;wDACH,SAAQ;wDACR,WAAU;wDACV,SAAS;4DACL,0BAA0B;4DAC1B,OAAO,IAAI,CAAC,CAAC,kBAAkB,EAAE,mBAAmB,QAAQ,EAAE;wDAClE;;0EAEA,8OAAC,sOAAY;gEAAC,WAAU;;;;;;4DAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAYjE,8OAAC,mJAAgB;oBACf,YAAW;oBACX,UAAU,SAAS,QAAQ;;;;;;8BAI7B,8OAAC,iJAAe;oBACd,SAAS,SAAS,eAAe,IAAI,EAAE;oBACvC,OAAM;oBACN,cAAa;oBACb,WAAW;oBACX,WAAU;;;;;;;;;;;;;;;;;AAKpB"}}]
}