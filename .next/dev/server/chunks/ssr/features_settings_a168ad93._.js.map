{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/customers/api/customer-settings-api.ts"],"sourcesContent":["/**\r\n * Customer Settings API Layer\r\n * Handles customer types, groups, sources, payment terms, credit ratings, lifecycle stages\r\n */\r\n\r\nimport type {\r\n  CustomerType,\r\n  CustomerGroup,\r\n  CustomerSource,\r\n  PaymentTerm,\r\n  CreditRating,\r\n  LifecycleStage,\r\n  CustomerSlaSetting,\r\n} from '../types';\r\n\r\nconst BASE_URL = '/api/settings/customers';\r\n\r\n// ============== Customer Types ==============\r\nexport async function fetchCustomerTypes(): Promise<CustomerType[]> {\r\n  const res = await fetch(`${BASE_URL}/types`);\r\n  if (!res.ok) throw new Error('Failed to fetch customer types');\r\n  return res.json();\r\n}\r\n\r\nexport async function createCustomerType(data: Partial<CustomerType>): Promise<CustomerType> {\r\n  const res = await fetch(`${BASE_URL}/types`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateCustomerType(systemId: string, data: Partial<CustomerType>): Promise<CustomerType> {\r\n  const res = await fetch(`${BASE_URL}/types/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteCustomerType(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/types/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// ============== Customer Groups ==============\r\nexport async function fetchCustomerGroups(): Promise<CustomerGroup[]> {\r\n  const res = await fetch(`${BASE_URL}/groups`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createCustomerGroup(data: Partial<CustomerGroup>): Promise<CustomerGroup> {\r\n  const res = await fetch(`${BASE_URL}/groups`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateCustomerGroup(systemId: string, data: Partial<CustomerGroup>): Promise<CustomerGroup> {\r\n  const res = await fetch(`${BASE_URL}/groups/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteCustomerGroup(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/groups/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// ============== Customer Sources ==============\r\nexport async function fetchCustomerSources(): Promise<CustomerSource[]> {\r\n  const res = await fetch(`${BASE_URL}/sources`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createCustomerSource(data: Partial<CustomerSource>): Promise<CustomerSource> {\r\n  const res = await fetch(`${BASE_URL}/sources`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateCustomerSource(systemId: string, data: Partial<CustomerSource>): Promise<CustomerSource> {\r\n  const res = await fetch(`${BASE_URL}/sources/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteCustomerSource(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/sources/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// ============== Payment Terms ==============\r\nexport async function fetchPaymentTerms(): Promise<PaymentTerm[]> {\r\n  const res = await fetch(`${BASE_URL}/payment-terms`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createPaymentTerm(data: Partial<PaymentTerm>): Promise<PaymentTerm> {\r\n  const res = await fetch(`${BASE_URL}/payment-terms`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updatePaymentTerm(systemId: string, data: Partial<PaymentTerm>): Promise<PaymentTerm> {\r\n  const res = await fetch(`${BASE_URL}/payment-terms/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deletePaymentTerm(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/payment-terms/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// ============== Credit Ratings ==============\r\nexport async function fetchCreditRatings(): Promise<CreditRating[]> {\r\n  const res = await fetch(`${BASE_URL}/credit-ratings`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createCreditRating(data: Partial<CreditRating>): Promise<CreditRating> {\r\n  const res = await fetch(`${BASE_URL}/credit-ratings`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateCreditRating(systemId: string, data: Partial<CreditRating>): Promise<CreditRating> {\r\n  const res = await fetch(`${BASE_URL}/credit-ratings/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteCreditRating(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/credit-ratings/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// ============== Lifecycle Stages ==============\r\nexport async function fetchLifecycleStages(): Promise<LifecycleStage[]> {\r\n  const res = await fetch(`${BASE_URL}/lifecycle-stages`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createLifecycleStage(data: Partial<LifecycleStage>): Promise<LifecycleStage> {\r\n  const res = await fetch(`${BASE_URL}/lifecycle-stages`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateLifecycleStage(systemId: string, data: Partial<LifecycleStage>): Promise<LifecycleStage> {\r\n  const res = await fetch(`${BASE_URL}/lifecycle-stages/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteLifecycleStage(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/lifecycle-stages/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// ============== SLA Settings ==============\r\nexport async function fetchCustomerSlaSettings(): Promise<CustomerSlaSetting[]> {\r\n  const res = await fetch(`${BASE_URL}/sla-settings`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateCustomerSlaSetting(systemId: string, data: Partial<CustomerSlaSetting>): Promise<CustomerSlaSetting> {\r\n  const res = await fetch(`${BASE_URL}/sla-settings/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYD,MAAM,WAAW;AAGV,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,MAAM,CAAC;IAC3C,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,mBAAmB,IAA2B;IAClE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,MAAM,CAAC,EAAE;QAC3C,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,mBAAmB,QAAgB,EAAE,IAA2B;IACpF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,OAAO,EAAE,UAAU,EAAE;QACvD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,mBAAmB,QAAgB;IACvD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,OAAO,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC5E,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,OAAO,CAAC;IAC5C,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,oBAAoB,IAA4B;IACpE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,OAAO,CAAC,EAAE;QAC5C,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,oBAAoB,QAAgB,EAAE,IAA4B;IACtF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,QAAQ,EAAE,UAAU,EAAE;QACxD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,oBAAoB,QAAgB;IACxD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,QAAQ,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC7E,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,QAAQ,CAAC;IAC7C,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,qBAAqB,IAA6B;IACtE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,QAAQ,CAAC,EAAE;QAC7C,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,qBAAqB,QAAgB,EAAE,IAA6B;IACxF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,SAAS,EAAE,UAAU,EAAE;QACzD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,qBAAqB,QAAgB;IACzD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,SAAS,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC9E,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,cAAc,CAAC;IACnD,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,kBAAkB,IAA0B;IAChE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,cAAc,CAAC,EAAE;QACnD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,kBAAkB,QAAgB,EAAE,IAA0B;IAClF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,eAAe,EAAE,UAAU,EAAE;QAC/D,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,eAAe,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IACpF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,eAAe,CAAC;IACpD,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,mBAAmB,IAA2B;IAClE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,eAAe,CAAC,EAAE;QACpD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,mBAAmB,QAAgB,EAAE,IAA2B;IACpF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,gBAAgB,EAAE,UAAU,EAAE;QAChE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,mBAAmB,QAAgB;IACvD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,gBAAgB,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IACrF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,iBAAiB,CAAC;IACtD,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,qBAAqB,IAA6B;IACtE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,iBAAiB,CAAC,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,qBAAqB,QAAgB,EAAE,IAA6B;IACxF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,kBAAkB,EAAE,UAAU,EAAE;QAClE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,qBAAqB,QAAgB;IACzD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,kBAAkB,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IACvF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,aAAa,CAAC;IAClD,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,yBAAyB,QAAgB,EAAE,IAAiC;IAChG,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,cAAc,EAAE,UAAU,EAAE;QAC9D,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/customers/hooks/use-customer-settings.ts"],"sourcesContent":["/**\r\n * Customer Settings React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport * as api from '../api/customer-settings-api';\r\nimport type { CustomerType, CustomerGroup, CustomerSource, PaymentTerm, CreditRating, LifecycleStage, CustomerSlaSetting } from '../types';\r\n\r\nexport const customerSettingsKeys = {\r\n  all: ['customer-settings'] as const,\r\n  types: () => [...customerSettingsKeys.all, 'types'] as const,\r\n  groups: () => [...customerSettingsKeys.all, 'groups'] as const,\r\n  sources: () => [...customerSettingsKeys.all, 'sources'] as const,\r\n  paymentTerms: () => [...customerSettingsKeys.all, 'payment-terms'] as const,\r\n  creditRatings: () => [...customerSettingsKeys.all, 'credit-ratings'] as const,\r\n  lifecycleStages: () => [...customerSettingsKeys.all, 'lifecycle-stages'] as const,\r\n  slaSettings: () => [...customerSettingsKeys.all, 'sla-settings'] as const,\r\n};\r\n\r\n// Customer Types\r\nexport function useCustomerTypes() {\r\n  return useQuery({ queryKey: customerSettingsKeys.types(), queryFn: api.fetchCustomerTypes, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useCustomerTypeMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.types() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createCustomerType, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<CustomerType> }) => api.updateCustomerType(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteCustomerType, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Customer Groups\r\nexport function useCustomerGroups() {\r\n  return useQuery({ queryKey: customerSettingsKeys.groups(), queryFn: api.fetchCustomerGroups, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useCustomerGroupMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.groups() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createCustomerGroup, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<CustomerGroup> }) => api.updateCustomerGroup(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteCustomerGroup, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Customer Sources\r\nexport function useCustomerSources() {\r\n  return useQuery({ queryKey: customerSettingsKeys.sources(), queryFn: api.fetchCustomerSources, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useCustomerSourceMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.sources() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createCustomerSource, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<CustomerSource> }) => api.updateCustomerSource(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteCustomerSource, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Payment Terms\r\nexport function usePaymentTerms() {\r\n  return useQuery({ queryKey: customerSettingsKeys.paymentTerms(), queryFn: api.fetchPaymentTerms, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function usePaymentTermMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.paymentTerms() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createPaymentTerm, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<PaymentTerm> }) => api.updatePaymentTerm(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deletePaymentTerm, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Credit Ratings\r\nexport function useCreditRatings() {\r\n  return useQuery({ queryKey: customerSettingsKeys.creditRatings(), queryFn: api.fetchCreditRatings, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useCreditRatingMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.creditRatings() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createCreditRating, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<CreditRating> }) => api.updateCreditRating(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteCreditRating, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Lifecycle Stages\r\nexport function useLifecycleStages() {\r\n  return useQuery({ queryKey: customerSettingsKeys.lifecycleStages(), queryFn: api.fetchLifecycleStages, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useLifecycleStageMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.lifecycleStages() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createLifecycleStage, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<LifecycleStage> }) => api.updateLifecycleStage(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteLifecycleStage, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// SLA Settings\r\nexport function useCustomerSlaSettings() {\r\n  return useQuery({ queryKey: customerSettingsKeys.slaSettings(), queryFn: api.fetchCustomerSlaSettings, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useCustomerSlaSettingMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: customerSettingsKeys.slaSettings() });\r\n  return {\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<CustomerSlaSetting> }) => api.updateCustomerSlaSetting(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 595, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/customers/hooks/use-all-customer-settings.ts"],"sourcesContent":["/**\r\n * Convenience hooks for customer settings - flat array access\r\n */\r\n\r\nimport { useCallback } from 'react';\r\nimport { \r\n  useCustomerTypes, \r\n  useCustomerGroups, \r\n  useCustomerSources \r\n} from './use-customer-settings';\r\nimport type { CustomerType, CustomerGroup, CustomerSource } from '../types';\r\n\r\n/**\r\n * Returns all customer types as a flat array\r\n */\r\nexport function useAllCustomerTypes() {\r\n  const query = useCustomerTypes();\r\n  \r\n  return {\r\n    data: query.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns customer types formatted as options\r\n */\r\nexport function useCustomerTypeOptions() {\r\n  const { data, isLoading } = useAllCustomerTypes();\r\n  \r\n  const options = data.map(t => ({\r\n    value: t.systemId,\r\n    label: t.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Hook for finding customer type by systemId\r\n */\r\nexport function useCustomerTypeFinder() {\r\n  const { data } = useAllCustomerTypes();\r\n  \r\n  const findById = useCallback((systemId: string): CustomerType | undefined => {\r\n    return data.find(t => t.systemId === systemId);\r\n  }, [data]);\r\n  \r\n  return { findById };\r\n}\r\n\r\n/**\r\n * Returns all customer groups as a flat array\r\n */\r\nexport function useAllCustomerGroups() {\r\n  const query = useCustomerGroups();\r\n  \r\n  return {\r\n    data: query.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns customer groups formatted as options\r\n */\r\nexport function useCustomerGroupOptions() {\r\n  const { data, isLoading } = useAllCustomerGroups();\r\n  \r\n  const options = data.map(g => ({\r\n    value: g.systemId,\r\n    label: g.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Returns all customer sources as a flat array\r\n */\r\nexport function useAllCustomerSources() {\r\n  const query = useCustomerSources();\r\n  \r\n  return {\r\n    data: query.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns customer sources formatted as options\r\n */\r\nexport function useCustomerSourceOptions() {\r\n  const { data, isLoading } = useAllCustomerSources();\r\n  \r\n  const options = data.map(s => ({\r\n    value: s.systemId,\r\n    label: s.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Hook for finding customer group by systemId\r\n */\r\nexport function useCustomerGroupFinder() {\r\n  const { data } = useAllCustomerGroups();\r\n  \r\n  const findById = useCallback((systemId: string): CustomerGroup | undefined => {\r\n    return data.find(g => g.systemId === systemId);\r\n  }, [data]);\r\n  \r\n  return { findById };\r\n}\r\n\r\n/**\r\n * Hook for finding customer source by systemId\r\n */\r\nexport function useCustomerSourceFinder() {\r\n  const { data } = useAllCustomerSources();\r\n  \r\n  const findById = useCallback((systemId: string): CustomerSource | undefined => {\r\n    return data.find(s => s.systemId === systemId);\r\n  }, [data]);\r\n  \r\n  return { findById };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;CAEC,GAED;AACA;;;AAUO,SAAS;IACd,MAAM,QAAQ,IAAA,6LAAgB;IAE9B,OAAO;QACL,MAAM,MAAM,IAAI,IAAI,EAAE;QACtB,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,IAAA,oNAAW,EAAC,CAAC;QAC5B,OAAO,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;IACvC,GAAG;QAAC;KAAK;IAET,OAAO;QAAE;IAAS;AACpB;AAKO,SAAS;IACd,MAAM,QAAQ,IAAA,8LAAiB;IAE/B,OAAO;QACL,MAAM,MAAM,IAAI,IAAI,EAAE;QACtB,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;AAKO,SAAS;IACd,MAAM,QAAQ,IAAA,+LAAkB;IAEhC,OAAO;QACL,MAAM,MAAM,IAAI,IAAI,EAAE;QACtB,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,IAAA,oNAAW,EAAC,CAAC;QAC5B,OAAO,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;IACvC,GAAG;QAAC;KAAK;IAET,OAAO;QAAE;IAAS;AACpB;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,IAAA,oNAAW,EAAC,CAAC;QAC5B,OAAO,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;IACvC,GAAG;QAAC;KAAK;IAET,OAAO;QAAE;IAAS;AACpB"}},
    {"offset": {"line": 718, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/customers/sla-settings-data.ts"],"sourcesContent":["import { asSystemId, asBusinessId } from '../../../lib/id-types';\r\nimport type { CustomerSlaSetting } from './types';\r\nimport { buildSeedAuditFields } from '@/lib/seed-audit';\r\n\r\n// Đơn giản hóa: Mỗi loại SLA chỉ có 1 record, user edit trực tiếp số ngày\r\nexport const defaultCustomerSlaSettings: CustomerSlaSetting[] = [\r\n  // Follow-up SLA - Nhắc liên hệ định kỳ\r\n  {\r\n    systemId: asSystemId('CUSTSLA0000001'),\r\n    id: asBusinessId('SLA-FOLLOWUP'),\r\n    name: 'Liên hệ định kỳ',\r\n    description: 'Nhắc nhở liên hệ khách hàng sau một thời gian không tương tác',\r\n    slaType: 'follow-up',\r\n    targetDays: 14,      // Mục tiêu: liên hệ trong vòng 14 ngày\r\n    warningDays: 3,      // Cảnh báo khi còn 3 ngày\r\n    criticalDays: 7,     // Nghiêm trọng khi quá hạn 7 ngày\r\n    color: '#2196F3',    // Blue\r\n    isActive: true,\r\n    ...buildSeedAuditFields({ createdAt: '2024-01-01T08:00:00Z' }),\r\n  },\r\n\r\n  // Re-engagement SLA - Kích hoạt lại khách hàng không hoạt động\r\n  {\r\n    systemId: asSystemId('CUSTSLA0000002'),\r\n    id: asBusinessId('SLA-REENGAGEMENT'),\r\n    name: 'Kích hoạt lại',\r\n    description: 'Khách hàng không mua hàng cần được kích hoạt lại',\r\n    slaType: 're-engagement',\r\n    targetDays: 60,      // Mục tiêu: kích hoạt trong vòng 60 ngày\r\n    warningDays: 10,     // Cảnh báo khi còn 10 ngày\r\n    criticalDays: 14,    // Nghiêm trọng khi quá hạn 14 ngày\r\n    color: '#FF9800',    // Orange\r\n    isActive: true,\r\n    ...buildSeedAuditFields({ createdAt: '2024-01-02T08:00:00Z' }),\r\n  },\r\n\r\n  // Debt Payment SLA - Nhắc thanh toán công nợ\r\n  {\r\n    systemId: asSystemId('CUSTSLA0000003'),\r\n    id: asBusinessId('SLA-DEBT'),\r\n    name: 'Nhắc công nợ',\r\n    description: 'Nhắc thanh toán công nợ quá hạn',\r\n    slaType: 'debt-payment',\r\n    targetDays: 7,       // Mục tiêu: thanh toán trong vòng 7 ngày sau hạn\r\n    warningDays: 2,      // Cảnh báo khi còn 2 ngày\r\n    criticalDays: 7,     // Nghiêm trọng khi quá hạn 7 ngày\r\n    color: '#E91E63',    // Pink\r\n    isActive: true,\r\n    ...buildSeedAuditFields({ createdAt: '2024-01-03T08:00:00Z' }),\r\n  },\r\n];\r\n\r\n// Helper to get SLA labels\r\nexport const SLA_TYPE_LABELS: Record<string, string> = {\r\n  'follow-up': 'Liên hệ định kỳ',\r\n  're-engagement': 'Kích hoạt lại',\r\n  'debt-payment': 'Nhắc công nợ',\r\n};\r\n\r\n// Helper to get SLA descriptions\r\nexport const SLA_TYPE_DESCRIPTIONS: Record<string, string> = {\r\n  'follow-up': 'Nhắc nhở liên hệ khách hàng theo chu kỳ định kỳ',\r\n  're-engagement': 'Kích hoạt khách hàng không hoạt động trong thời gian dài',\r\n  'debt-payment': 'Nhắc thanh toán công nợ quá hạn',\r\n};\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AAEA;;;AAGO,MAAM,6BAAmD;IAC9D,uCAAuC;IACvC;QACE,UAAU,IAAA,gIAAU,EAAC;QACrB,IAAI,IAAA,kIAAY,EAAC;QACjB,MAAM;QACN,aAAa;QACb,SAAS;QACT,YAAY;QACZ,aAAa;QACb,cAAc;QACd,OAAO;QACP,UAAU;QACV,GAAG,IAAA,4IAAoB,EAAC;YAAE,WAAW;QAAuB,EAAE;IAChE;IAEA,+DAA+D;IAC/D;QACE,UAAU,IAAA,gIAAU,EAAC;QACrB,IAAI,IAAA,kIAAY,EAAC;QACjB,MAAM;QACN,aAAa;QACb,SAAS;QACT,YAAY;QACZ,aAAa;QACb,cAAc;QACd,OAAO;QACP,UAAU;QACV,GAAG,IAAA,4IAAoB,EAAC;YAAE,WAAW;QAAuB,EAAE;IAChE;IAEA,6CAA6C;IAC7C;QACE,UAAU,IAAA,gIAAU,EAAC;QACrB,IAAI,IAAA,kIAAY,EAAC;QACjB,MAAM;QACN,aAAa;QACb,SAAS;QACT,YAAY;QACZ,aAAa;QACb,cAAc;QACd,OAAO;QACP,UAAU;QACV,GAAG,IAAA,4IAAoB,EAAC;YAAE,WAAW;QAAuB,EAAE;IAChE;CACD;AAGM,MAAM,kBAA0C;IACrD,aAAa;IACb,iBAAiB;IACjB,gBAAgB;AAClB;AAGO,MAAM,wBAAgD;IAC3D,aAAa;IACb,iBAAiB;IACjB,gBAAgB;AAClB"}},
    {"offset": {"line": 794, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/customers/sla-settings-store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\nimport type { CustomerSlaSetting, CustomerSlaType } from './types';\r\nimport { defaultCustomerSlaSettings } from './sla-settings-data';\r\n\r\nexport const useCustomerSlaStore = createCrudStore<CustomerSlaSetting>(\r\n  defaultCustomerSlaSettings, 'sla-settings',\r\n  {\r\n    apiEndpoint: '/api/settings/customers?type=sla-setting',\r\n  }\r\n);\r\n\r\n// Helper function to get SLA by type (simplified - only 1 per type)\r\nexport function getSlaBySlaType(slaType: CustomerSlaType): CustomerSlaSetting | undefined {\r\n  return useCustomerSlaStore.getState().data.find(\r\n    (sla) => sla.slaType === slaType && sla.isActive\r\n  );\r\n}\r\n\r\n// Helper to load all active SLA settings\r\nexport function loadCustomerSlaSettings() {\r\n  return useCustomerSlaStore.getState().data.filter((sla) => sla.isActive);\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AAEA;;;AAEO,MAAM,sBAAsB,IAAA,0IAAe,EAChD,0LAA0B,EAAE,gBAC5B;IACE,aAAa;AACf;AAIK,SAAS,gBAAgB,OAAwB;IACtD,OAAO,oBAAoB,QAAQ,GAAG,IAAI,CAAC,IAAI,CAC7C,CAAC,MAAQ,IAAI,OAAO,KAAK,WAAW,IAAI,QAAQ;AAEpD;AAGO,SAAS;IACd,OAAO,oBAAoB,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,MAAQ,IAAI,QAAQ;AACzE"}},
    {"offset": {"line": 819, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/api/branches-api.ts"],"sourcesContent":["/**\r\n * Branches API functions\r\n * \r\n * ⚠️ Direct import: import { fetchBranches } from '@/features/settings/branches/api/branches-api'\r\n */\r\n\r\nimport type { BranchModel as Branch } from '@/generated/prisma/models/Branch';\r\n\r\nconst BASE_URL = '/api/branches';\r\n\r\nexport interface BranchesParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  isDefault?: boolean;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface BranchesResponse {\r\n  data: Branch[];\r\n  total: number;\r\n  page: number;\r\n  pageSize: number;\r\n}\r\n\r\nexport async function fetchBranches(params: BranchesParams = {}): Promise<BranchesResponse> {\r\n  const searchParams = new URLSearchParams();\r\n  \r\n  if (params.page) searchParams.set('page', String(params.page));\r\n  if (params.limit) searchParams.set('limit', String(params.limit));\r\n  if (params.search) searchParams.set('search', params.search);\r\n  if (params.isDefault !== undefined) searchParams.set('isDefault', String(params.isDefault));\r\n  if (params.sortBy) searchParams.set('sortBy', params.sortBy);\r\n  if (params.sortOrder) searchParams.set('sortOrder', params.sortOrder);\r\n  \r\n  const url = searchParams.toString() ? `${BASE_URL}?${searchParams}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branches: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function fetchBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branch: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function createBranch(data: Omit<Branch, 'systemId' | 'createdAt' | 'updatedAt'>): Promise<Branch> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to create branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function updateBranch(systemId: string, data: Partial<Branch>): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PUT',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to update branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function deleteBranch(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to delete branch: ${response.statusText}`);\r\n  }\r\n}\r\n\r\nexport async function setDefaultBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to set default branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport type { Branch };\r\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;;;;AAID,MAAM,WAAW;AAkBV,eAAe,cAAc,SAAyB,CAAC,CAAC;IAC7D,MAAM,eAAe,IAAI;IAEzB,IAAI,OAAO,IAAI,EAAE,aAAa,GAAG,CAAC,QAAQ,OAAO,OAAO,IAAI;IAC5D,IAAI,OAAO,KAAK,EAAE,aAAa,GAAG,CAAC,SAAS,OAAO,OAAO,KAAK;IAC/D,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,KAAK,WAAW,aAAa,GAAG,CAAC,aAAa,OAAO,OAAO,SAAS;IACzF,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,EAAE,aAAa,GAAG,CAAC,aAAa,OAAO,SAAS;IAEpE,MAAM,MAAM,aAAa,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,cAAc,GAAG;IACtE,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,SAAS,UAAU,EAAE;IACpE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,YAAY,QAAgB;IAChD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IAEtD,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,wBAAwB,EAAE,SAAS,UAAU,EAAE;IAClE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,IAA0D;IAC3F,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB,EAAE,IAAqB;IACxE,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,SAAS,UAAU,EAAE;IACnE;AACF;AAEO,eAAe,iBAAiB,QAAgB;IACrD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;IAChD;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 913, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-branches.ts"],"sourcesContent":["/**\r\n * useBranches - React Query hooks\r\n * \r\n * ⚠️ Direct import: import { useBranches } from '@/features/settings/branches/hooks/use-branches'\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchBranches,\r\n  fetchBranch,\r\n  createBranch,\r\n  updateBranch,\r\n  deleteBranch,\r\n  setDefaultBranch,\r\n  type BranchesParams,\r\n  type Branch,\r\n} from '../api/branches-api';\r\n\r\nexport const branchKeys = {\r\n  all: ['branches'] as const,\r\n  lists: () => [...branchKeys.all, 'list'] as const,\r\n  list: (params: BranchesParams) => [...branchKeys.lists(), params] as const,\r\n  details: () => [...branchKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...branchKeys.details(), id] as const,\r\n};\r\n\r\nexport function useBranches(params: BranchesParams = {}) {\r\n  return useQuery({\r\n    queryKey: branchKeys.list(params),\r\n    queryFn: () => fetchBranches(params),\r\n    staleTime: 10 * 60 * 1000, // Branches rarely change\r\n    gcTime: 60 * 60 * 1000,\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\nexport function useBranch(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: branchKeys.detail(id!),\r\n    queryFn: () => fetchBranch(id!),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\ninterface UseBranchMutationsOptions {\r\n  onCreateSuccess?: (branch: Branch) => void;\r\n  onUpdateSuccess?: (branch: Branch) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onSetDefaultSuccess?: (branch: Branch) => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useBranchMutations(options: UseBranchMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: Partial<Branch> }) => \r\n      updateBranch(systemId, data),\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.lists() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: deleteBranch,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const makeDefault = useMutation({\r\n    mutationFn: setDefaultBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onSetDefaultSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return { create, update, remove, makeDefault };\r\n}\r\n\r\nexport function useAllBranches() {\r\n  return useBranches({ limit: 100 });\r\n}\r\n\r\nexport function useDefaultBranch() {\r\n  const { data, ...rest } = useBranches({ isDefault: true, limit: 1 });\r\n  return {\r\n    ...rest,\r\n    data: data?.data?.[0] ?? null,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;CAIC,GAED;AAAA;AAAA;AAAA;AACA;;;AAWO,MAAM,aAAa;IACxB,KAAK;QAAC;KAAW;IACjB,OAAO,IAAM;eAAI,WAAW,GAAG;YAAE;SAAO;IACxC,MAAM,CAAC,SAA2B;eAAI,WAAW,KAAK;YAAI;SAAO;IACjE,SAAS,IAAM;eAAI,WAAW,GAAG;YAAE;SAAS;IAC5C,QAAQ,CAAC,KAAe;eAAI,WAAW,OAAO;YAAI;SAAG;AACvD;AAEO,SAAS,YAAY,SAAyB,CAAC,CAAC;IACrD,OAAO,IAAA,uLAAQ,EAAC;QACd,UAAU,WAAW,IAAI,CAAC;QAC1B,SAAS,IAAM,IAAA,2KAAa,EAAC;QAC7B,WAAW,KAAK,KAAK;QACrB,QAAQ,KAAK,KAAK;QAClB,iBAAiB,2LAAgB;IACnC;AACF;AAEO,SAAS,UAAU,EAA6B;IACrD,OAAO,IAAA,uLAAQ,EAAC;QACd,UAAU,WAAW,MAAM,CAAC;QAC5B,SAAS,IAAM,IAAA,yKAAW,EAAC;QAC3B,SAAS,CAAC,CAAC;QACX,WAAW,KAAK,KAAK;IACvB;AACF;AAUO,SAAS,mBAAmB,UAAqC,CAAC,CAAC;IACxE,MAAM,cAAc,IAAA,wMAAc;IAElC,MAAM,SAAS,IAAA,6LAAW,EAAC;QACzB,YAAY,0KAAY;QACxB,WAAW,CAAC;YACV,YAAY,iBAAiB,CAAC;gBAAE,UAAU,WAAW,GAAG;YAAC;YACzD,QAAQ,eAAe,GAAG;QAC5B;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,6LAAW,EAAC;QACzB,YAAY,CAAC,EAAE,QAAQ,EAAE,IAAI,EAA+C,GAC1E,IAAA,0KAAY,EAAC,UAAU;QACzB,WAAW,CAAC,MAAM;YAChB,YAAY,iBAAiB,CAAC;gBAAE,UAAU,WAAW,MAAM,CAAC,UAAU,QAAQ;YAAE;YAChF,YAAY,iBAAiB,CAAC;gBAAE,UAAU,WAAW,KAAK;YAAG;YAC7D,QAAQ,eAAe,GAAG;QAC5B;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,6LAAW,EAAC;QACzB,YAAY,0KAAY;QACxB,WAAW;YACT,YAAY,iBAAiB,CAAC;gBAAE,UAAU,WAAW,GAAG;YAAC;YACzD,QAAQ,eAAe;QACzB;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,cAAc,IAAA,6LAAW,EAAC;QAC9B,YAAY,8KAAgB;QAC5B,WAAW,CAAC;YACV,YAAY,iBAAiB,CAAC;gBAAE,UAAU,WAAW,GAAG;YAAC;YACzD,QAAQ,mBAAmB,GAAG;QAChC;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QAAE;QAAQ;QAAQ;QAAQ;IAAY;AAC/C;AAEO,SAAS;IACd,OAAO,YAAY;QAAE,OAAO;IAAI;AAClC;AAEO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,GAAG,YAAY;QAAE,WAAW;QAAM,OAAO;IAAE;IAClE,OAAO;QACL,GAAG,IAAI;QACP,MAAM,MAAM,MAAM,CAAC,EAAE,IAAI;IAC3B;AACF"}},
    {"offset": {"line": 1047, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-all-branches.ts"],"sourcesContent":["/**\r\n * useAllBranches - Convenience hook for components needing all branches as flat array\r\n * \r\n * Use case: Dropdowns, selects that need branch options\r\n * \r\n * ⚠️ For paginated views, use useBranches() instead\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useBranches } from './use-branches';\r\nimport type { Branch } from '../types';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n/**\r\n * Returns all branches as a flat array\r\n * Compatible with legacy store pattern: { data: branches }\r\n * \r\n * Note: API returns string systemIds, but we cast to Branch[] for internal use\r\n */\r\nexport function useAllBranches() {\r\n  const query = useBranches({ limit: 100 });\r\n  \r\n  return {\r\n    // Cast to Branch[] - API returns string systemId, but we trust the data structure\r\n    data: (query.data?.data || []) as unknown as Branch[],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns branches formatted as options for Select/Combobox\r\n */\r\nexport function useBranchOptions() {\r\n  const { data, isLoading } = useAllBranches();\r\n  \r\n  const options = data.map(b => ({\r\n    value: b.systemId,\r\n    label: b.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Returns the default branch\r\n */\r\nexport function useDefaultBranch() {\r\n  const { data, isLoading } = useAllBranches();\r\n  const defaultBranch = data.find(b => b.isDefault) || data[0];\r\n  \r\n  return { defaultBranch, isLoading };\r\n}\r\n\r\n/**\r\n * Helper hook to find a branch by ID from cached data\r\n * Replaces legacy findById() method\r\n */\r\nexport function useBranchFinder() {\r\n  const { data } = useAllBranches();\r\n  \r\n  const findById = React.useCallback(\r\n    (systemId: SystemId | string | undefined) => {\r\n      if (!systemId) return undefined;\r\n      return data.find(b => b.systemId === systemId);\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { findById };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;CAMC,GAED;AACA;;;AAUO,SAAS;IACd,MAAM,QAAQ,IAAA,2KAAW,EAAC;QAAE,OAAO;IAAI;IAEvC,OAAO;QACL,kFAAkF;QAClF,MAAO,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC7B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAC5B,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,IAAI,CAAC,EAAE;IAE5D,OAAO;QAAE;QAAe;IAAU;AACpC;AAMO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,oNAAiB,CAChC,CAAC;QACC,IAAI,CAAC,UAAU,OAAO;QACtB,OAAO,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;IACvC,GACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAS;AACpB"}},
    {"offset": {"line": 1114, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Branch } from './types';\r\nimport { SystemId } from '../../../lib/id-types';\r\n\r\nexport interface BranchStoreState extends CrudState<Branch> {\r\n  setDefault: (systemId: SystemId) => void;\r\n}\r\n\r\nconst baseStore = createCrudStore<Branch>([], 'branches', {\r\n  apiEndpoint: '/api/branches',\r\n});\r\n\r\nconst setDefault = (systemId: SystemId) => {\r\n  baseStore.setState(state => ({\r\n    data: state.data.map(branch => ({\r\n      ...branch,\r\n      isDefault: branch.systemId === systemId,\r\n    })),\r\n  }));\r\n};\r\n\r\nconst originalAdd = baseStore.getState().add;\r\nconst originalUpdate = baseStore.getState().update;\r\n\r\nbaseStore.setState({\r\n  add: (item: Omit<Branch, 'systemId'>) => {\r\n    const result = originalAdd(item);\r\n    if ((item as Branch).isDefault) {\r\n      setDefault(result.systemId);\r\n    }\r\n    return result;\r\n  },\r\n  update: (systemId: SystemId, updatedItem: Branch) => {\r\n    originalUpdate(systemId, updatedItem);\r\n    if (updatedItem.isDefault) {\r\n      setDefault(systemId);\r\n    }\r\n  },\r\n} as Partial<BranchStoreState>);\r\n\r\nconst enhanceState = (state: CrudState<Branch>): BranchStoreState => ({\r\n  ...state,\r\n  setDefault,\r\n});\r\n\r\ntype BranchStoreHook = (() => BranchStoreState) & {\r\n  getState: () => BranchStoreState;\r\n};\r\n\r\nconst useBranchStoreBase = (() => enhanceState(baseStore())) as BranchStoreHook;\r\n\r\nuseBranchStoreBase.getState = () => enhanceState(baseStore.getState());\r\n\r\nexport const useBranchStore = useBranchStoreBase;\r\n"],"names":[],"mappings":";;;;AAAA;;AASA,MAAM,YAAY,IAAA,0IAAe,EAAS,EAAE,EAAE,YAAY;IACxD,aAAa;AACf;AAEA,MAAM,aAAa,CAAC;IAClB,UAAU,QAAQ,CAAC,CAAA,QAAS,CAAC;YAC3B,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,SAAU,CAAC;oBAC9B,GAAG,MAAM;oBACT,WAAW,OAAO,QAAQ,KAAK;gBACjC,CAAC;QACH,CAAC;AACH;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAC5C,MAAM,iBAAiB,UAAU,QAAQ,GAAG,MAAM;AAElD,UAAU,QAAQ,CAAC;IACjB,KAAK,CAAC;QACJ,MAAM,SAAS,YAAY;QAC3B,IAAI,AAAC,KAAgB,SAAS,EAAE;YAC9B,WAAW,OAAO,QAAQ;QAC5B;QACA,OAAO;IACT;IACA,QAAQ,CAAC,UAAoB;QAC3B,eAAe,UAAU;QACzB,IAAI,YAAY,SAAS,EAAE;YACzB,WAAW;QACb;IACF;AACF;AAEA,MAAM,eAAe,CAAC,QAA+C,CAAC;QACpE,GAAG,KAAK;QACR;IACF,CAAC;AAMD,MAAM,qBAAsB,IAAM,aAAa;AAE/C,mBAAmB,QAAQ,GAAG,IAAM,aAAa,UAAU,QAAQ;AAE5D,MAAM,iBAAiB"}},
    {"offset": {"line": 1159, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pricing/store.ts"],"sourcesContent":["import type { SystemId } from '@/lib/id-types';\r\nimport type { UseBoundStore, StoreApi } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PricingPolicy } from './types';\r\nimport { createCrudStore, type CrudState } from '../../../lib/store-factory';\r\nimport { getCurrentUserSystemId } from '../../../contexts/auth-context';\r\n\r\ntype PricingPolicyStore = CrudState<PricingPolicy> & {\r\n  setDefault: (systemId: SystemId) => void;\r\n  getActive: () => PricingPolicy[];\r\n  getInactive: () => PricingPolicy[];\r\n};\r\n\r\nconst baseStore = createCrudStore<PricingPolicy>([], 'pricing-settings', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId,\r\n  apiEndpoint: '/api/settings/data?type=pricing-policy',\r\n}) as UseBoundStore<StoreApi<PricingPolicyStore>>;\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nconst setDefaultAction = (systemId: SystemId) => {\r\n  baseStore.setState((current) => {\r\n    const target = current.data.find((policy) => policy.systemId === systemId);\r\n    if (!target) return current;\r\n\r\n    const updatedData = current.data.map((policy) => (\r\n      policy.type === target.type\r\n        ? { ...policy, isDefault: policy.systemId === systemId }\r\n        : policy\r\n    ));\r\n\r\n    return { ...current, data: updatedData };\r\n  });\r\n};\r\n\r\nconst enhancedAdd: typeof originalAdd = (item) => {\r\n  const newItem = originalAdd(item);\r\n  const storeData = baseStore.getState().data;\r\n  const hasDefaultForType = storeData\r\n    .filter((policy) => policy.type === newItem.type)\r\n    .some((policy) => policy.isDefault);\r\n\r\n  if (item.isDefault) {\r\n    setDefaultAction(newItem.systemId);\r\n  } else if (!hasDefaultForType) {\r\n    setDefaultAction(newItem.systemId);\r\n  }\r\n\r\n  return newItem;\r\n};\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: enhancedAdd,\r\n  setDefault: setDefaultAction,\r\n  getActive: () => baseStore.getState().data.filter((policy) => policy.isActive),\r\n  getInactive: () => baseStore.getState().data.filter((policy) => !policy.isActive),\r\n}));\r\n\r\nexport const usePricingPolicyStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAIA;AACA;;;AAQA,MAAM,YAAY,IAAA,0IAAe,EAAgB,EAAE,EAAE,oBAAoB;IACvE,iBAAiB;IACjB,gBAAgB,sJAAsB;IACtC,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,MAAM,mBAAmB,CAAC;IACxB,UAAU,QAAQ,CAAC,CAAC;QAClB,MAAM,SAAS,QAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,SAAW,OAAO,QAAQ,KAAK;QACjE,IAAI,CAAC,QAAQ,OAAO;QAEpB,MAAM,cAAc,QAAQ,IAAI,CAAC,GAAG,CAAC,CAAC,SACpC,OAAO,IAAI,KAAK,OAAO,IAAI,GACvB;gBAAE,GAAG,MAAM;gBAAE,WAAW,OAAO,QAAQ,KAAK;YAAS,IACrD;QAGN,OAAO;YAAE,GAAG,OAAO;YAAE,MAAM;QAAY;IACzC;AACF;AAEA,MAAM,cAAkC,CAAC;IACvC,MAAM,UAAU,YAAY;IAC5B,MAAM,YAAY,UAAU,QAAQ,GAAG,IAAI;IAC3C,MAAM,oBAAoB,UACvB,MAAM,CAAC,CAAC,SAAW,OAAO,IAAI,KAAK,QAAQ,IAAI,EAC/C,IAAI,CAAC,CAAC,SAAW,OAAO,SAAS;IAEpC,IAAI,KAAK,SAAS,EAAE;QAClB,iBAAiB,QAAQ,QAAQ;IACnC,OAAO,IAAI,CAAC,mBAAmB;QAC7B,iBAAiB,QAAQ,QAAQ;IACnC;IAEA,OAAO;AACT;AAEA,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK;QACL,YAAY;QACZ,WAAW,IAAM,UAAU,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,SAAW,OAAO,QAAQ;QAC7E,aAAa,IAAM,UAAU,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,SAAW,CAAC,OAAO,QAAQ;IAClF,CAAC;AAEM,MAAM,wBAAwB"}},
    {"offset": {"line": 1210, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/product-type-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId } from '@/lib/id-types';\r\nimport type { ProductType } from './types';\r\n\r\nconst generateId = () => crypto.randomUUID();\r\n\r\n// API sync helper\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: Partial<ProductType>): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/settings/product-types' : `/api/settings/product-types/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Product Type API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface ProductTypeState {\r\n  data: ProductType[];\r\n  initialized: boolean;\r\n  add: (productType: Omit<ProductType, 'systemId'>) => ProductType;\r\n  update: (systemId: SystemId, updates: Partial<ProductType>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => ProductType | undefined;\r\n  getActive: () => ProductType[];\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst rawData = [\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT001',\r\n    name: 'Hàng hóa',\r\n    description: 'Sản phẩm vật lý có tồn kho',\r\n    isDefault: true,\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT002',\r\n    name: 'Dịch vụ',\r\n    description: 'Dịch vụ không có tồn kho',\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT003',\r\n    name: 'Digital',\r\n    description: 'Sản phẩm số (ebook, khóa học online...)',\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n] as const;\r\n\r\nconst initialData: ProductType[] = rawData.map((item) => ({\r\n  ...item,\r\n  systemId: asSystemId(item.systemId),\r\n  id: asBusinessId(item.id),\r\n}));\r\n\r\nexport const useProductTypeStore = create<ProductTypeState>()(\r\n  (set, get) => ({\r\n    data: initialData,\r\n    initialized: false,\r\n    \r\n    add: (productType) => {\r\n      const newProductType: ProductType = {\r\n        ...productType,\r\n        systemId: asSystemId(generateId()),\r\n        createdAt: new Date().toISOString(),\r\n        isDeleted: false,\r\n      };\r\n      set((state) => ({ data: [...state.data, newProductType] }));\r\n      syncToAPI('create', newProductType).catch(console.error);\r\n      return newProductType;\r\n    },\r\n    \r\n    update: (systemId, updates) => {\r\n      set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, ...updates, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      }));\r\n      const updated = get().data.find(i => i.systemId === systemId);\r\n      if (updated) syncToAPI('update', updated).catch(console.error);\r\n    },\r\n    \r\n    remove: (systemId) => {\r\n      set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      }));\r\n      syncToAPI('delete', { systemId }).catch(console.error);\r\n    },\r\n    \r\n    findById: (systemId) => {\r\n      return get().data.find((item) => item.systemId === systemId && !item.isDeleted);\r\n    },\r\n    \r\n    getActive: () => {\r\n      return get().data.filter((item) => !item.isDeleted && item.isActive !== false);\r\n    },\r\n    \r\n    loadFromAPI: async () => {\r\n      if (get().initialized) return;\r\n      try {\r\n        // NOTE: Settings data is typically small, but using limit for consistency\r\n        const response = await fetch('/api/settings/product-types?limit=50');\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const data = json.data || [];\r\n          if (data.length > 0) {\r\n            set({ data: data.map((item: any) => ({\r\n              ...item,\r\n              systemId: asSystemId(item.systemId),\r\n              id: asBusinessId(item.id),\r\n            })), initialized: true });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[Product Type Store] loadFromAPI error:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1349, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/product-category-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId, type BusinessId } from '@/lib/id-types';\r\nimport type { ProductCategory } from './types';\r\n\r\nconst generateSystemId = (counter: number): SystemId => {\r\n  return asSystemId(`CATEGORY${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\nconst generateBusinessId = (counter: number): BusinessId => {\r\n  return asBusinessId(`DM${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\n// Helper to calculate path and level\r\nconst calculatePathAndLevel = (category: ProductCategory, allCategories: ProductCategory[]): { path: string; level: number } => {\r\n  if (!category.parentId) {\r\n    return { path: category.name, level: 0 };\r\n  }\r\n  \r\n  const parent = allCategories.find(c => c.systemId === category.parentId);\r\n  if (!parent) {\r\n    return { path: category.name, level: 0 };\r\n  }\r\n  \r\n  const parentInfo = calculatePathAndLevel(parent, allCategories);\r\n  return {\r\n    path: `${parentInfo.path} > ${category.name}`,\r\n    level: parentInfo.level + 1\r\n  };\r\n};\r\n\r\ninterface ProductCategoryState {\r\n  data: ProductCategory[];\r\n  counter: number;\r\n  initialized: boolean;\r\n  add: (category: Omit<ProductCategory, 'systemId' | 'id' | 'path' | 'level'> & { id?: string }) => ProductCategory;\r\n  update: (systemId: SystemId, updates: Partial<ProductCategory>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => ProductCategory | undefined;\r\n  findByBusinessId: (id: BusinessId) => ProductCategory | undefined;\r\n  getActive: () => ProductCategory[];\r\n  getByParent: (parentId?: SystemId) => ProductCategory[];\r\n  updateSortOrder: (systemId: SystemId, newSortOrder: number) => void;\r\n  moveCategory: (systemId: SystemId, newParentId: SystemId | undefined, newSortOrder: number) => void;\r\n  recalculatePaths: () => void;\r\n  getNextId: () => BusinessId;\r\n  isBusinessIdExists: (id: string) => boolean;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\n// API sync helper\r\nasync function syncCategoryToAPI(category: ProductCategory, action: 'create' | 'update' | 'delete'): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/categories' : `/api/categories/${category.systemId}`;\r\n    const response = await fetch(endpoint, {\r\n      method: action === 'create' ? 'POST' : action === 'delete' ? 'DELETE' : 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(category),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('syncCategoryToAPI error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useProductCategoryStore = create<ProductCategoryState>()(\r\n  (set, get) => ({\r\n    data: [],\r\n    counter: 0,\r\n    initialized: false,\r\n      \r\n    add: (category) => {\r\n        const currentCounter = get().counter;\r\n        const allData = get().data;\r\n        const { id, ...rest } = category;\r\n        \r\n        const businessId = id && id.trim() \r\n          ? asBusinessId(id.trim())\r\n          : generateBusinessId(currentCounter);\r\n        \r\n        const { path, level } = calculatePathAndLevel(\r\n          { ...rest, systemId: 'temp' as SystemId, id: businessId, path: '', level: 0 } as ProductCategory,\r\n          allData\r\n        );\r\n        \r\n        const newCategory: ProductCategory = {\r\n          ...rest,\r\n          systemId: generateSystemId(currentCounter),\r\n          id: businessId,\r\n          path,\r\n          level,\r\n          createdAt: new Date().toISOString(),\r\n          isDeleted: false,\r\n          isActive: category.isActive !== undefined ? category.isActive : true,\r\n        };\r\n        set((state) => ({ \r\n          data: [...state.data, newCategory],\r\n          counter: state.counter + 1,\r\n        }));\r\n        get().recalculatePaths();\r\n        return newCategory;\r\n      },\r\n      \r\n      update: (systemId, updates) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, ...updates, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n        get().recalculatePaths();\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n      },\r\n      \r\n      findById: (systemId) => {\r\n        return get().data.find((item) => item.systemId === systemId && !item.isDeleted);\r\n      },\r\n      \r\n      findByBusinessId: (id) => {\r\n        return get().data.find((item) => item.id === id && !item.isDeleted);\r\n      },\r\n      \r\n      getActive: () => {\r\n        return get().data.filter((item) => !item.isDeleted && item.isActive);\r\n      },\r\n      \r\n      getByParent: (parentId) => {\r\n        return get().data.filter(\r\n          (item) => !item.isDeleted && item.isActive && item.parentId === parentId\r\n        ).sort((a, b) => (a.sortOrder ?? 0) - (b.sortOrder ?? 0));\r\n      },\r\n\r\n      updateSortOrder: (systemId, newSortOrder) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, sortOrder: newSortOrder, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n      },\r\n\r\n      moveCategory: (systemId, newParentId, newSortOrder) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { \r\n                  ...item, \r\n                  parentId: newParentId, \r\n                  sortOrder: newSortOrder,\r\n                  updatedAt: new Date().toISOString() \r\n                }\r\n              : item\r\n          ),\r\n        }));\r\n        get().recalculatePaths();\r\n      },\r\n\r\n      recalculatePaths: () => {\r\n        set((state) => {\r\n          const allData = [...state.data];\r\n          const updated = allData.map(cat => {\r\n            if (cat.isDeleted) return cat;\r\n            const { path, level } = calculatePathAndLevel(cat, allData);\r\n            return { ...cat, path, level };\r\n          });\r\n          return { data: updated };\r\n        });\r\n      },\r\n      \r\n      getNextId: () => generateBusinessId(get().counter),\r\n      \r\n      isBusinessIdExists: (id: string) => get().data.some((item) => String(item.id) === id),\r\n\r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        try {\r\n          const response = await fetch('/api/categories?all=true');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            if (json.data && Array.isArray(json.data)) {\r\n              const categories: ProductCategory[] = json.data.map((item: Record<string, unknown>) => ({\r\n                ...item,\r\n                systemId: asSystemId(item.systemId as string),\r\n                id: asBusinessId(item.id as string),\r\n                parentId: item.parentId ? asSystemId(item.parentId as string) : undefined,\r\n                // Add default values for fields not in database\r\n                isActive: item.isDeleted !== true,\r\n                color: item.color as string || '#6366f1',\r\n                path: '',\r\n                level: 0,\r\n              }));\r\n              set({ \r\n                data: categories, \r\n                counter: categories.length,\r\n                initialized: true,\r\n              });\r\n              get().recalculatePaths();\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('loadFromAPI error:', error);\r\n        }\r\n        set({ initialized: true });\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1547, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { ReceiptType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<ReceiptType>([], 'receipt-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=receipt-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<ReceiptType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const useReceiptTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,0IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,iIAAS,EAAC,IAAA,sIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 1575, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { TargetGroup } from './types';\r\n\r\nexport const useTargetGroupStore = createCrudStore<TargetGroup>([], 'target-groups', {\r\n  apiEndpoint: '/api/settings/data?type=target-group',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,sBAAsB,IAAA,0IAAe,EAAc,EAAE,EAAE,iBAAiB;IACnF,aAAa;AACf"}},
    {"offset": {"line": 1588, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentMethod } from './types';\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\n\r\n// API sync helper\r\nasync function syncToAPI(\r\n  action: 'create' | 'update' | 'delete',\r\n  data: Partial<PaymentMethod>\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create'\r\n      ? '/api/settings/payment-methods'\r\n      : `/api/settings/payment-methods/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Payment Methods API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface PaymentMethodState {\r\n  data: PaymentMethod[];\r\n  initialized: boolean;\r\n  add: (item: Omit<PaymentMethod, 'systemId' | 'isDefault'>) => void;\r\n  update: (systemId: SystemId, updatedPolicy: Omit<PaymentMethod, 'isDefault' | 'systemId'>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  setDefault: (systemId: SystemId) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nexport const usePaymentMethodStore = create<PaymentMethodState>()(\r\n  (set, get) => ({\r\n      data: [],\r\n      initialized: false,\r\n      add: (item) => {\r\n        const newItem: PaymentMethod = { \r\n          ...item, \r\n          systemId: asSystemId(`PM_${Date.now()}`),\r\n          isDefault: get().data.length === 0,\r\n        };\r\n        set((state) => ({ data: [...state.data, newItem] }));\r\n        \r\n        // Sync to API\r\n        syncToAPI('create', newItem).catch(console.error);\r\n      },\r\n      update: (systemId, updatedFields) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => p.systemId === systemId ? { ...p, ...updatedFields } : p),\r\n        }));\r\n        \r\n        // Sync to API\r\n        const updated = get().data.find(p => p.systemId === systemId);\r\n        if (updated) {\r\n          syncToAPI('update', updated).catch(console.error);\r\n        }\r\n      },\r\n      remove: (systemId) => {\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n        set((state) => ({\r\n          data: state.data.filter((p) => p.systemId !== systemId),\r\n        }));\r\n      },\r\n      setDefault: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => ({ ...p, isDefault: p.systemId === systemId })),\r\n        }));\r\n        \r\n        // Sync all to API (update default status)\r\n        const data = get().data;\r\n        for (const item of data) {\r\n          syncToAPI('update', item).catch(console.error);\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Settings data is typically small, but using limit for consistency\r\n          const response = await fetch('/api/settings/payment-methods?limit=30');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const data = json.data || json.methods || [];\r\n            if (data.length > 0) {\r\n              set({ data, initialized: true });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payment Methods Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,kBAAkB;AAClB,eAAe,UACb,MAAsC,EACtC,IAA4B;IAE5B,IAAI;QACF,MAAM,WAAW,WAAW,WACxB,kCACA,CAAC,8BAA8B,EAAE,KAAK,QAAQ,EAAE;QACpD,MAAM,SAAS,WAAW,WAAW,SAAS,WAAW,WAAW,UAAU;QAE9E,MAAM,WAAW,MAAM,MAAM,UAAU;YACrC;YACA,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,WAAW,WAAW,KAAK,SAAS,CAAC,QAAQ;QACrD;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,OAAO,OAAO,CAAC,EAAE;QACxD,OAAO;IACT;AACF;AAYO,MAAM,wBAAwB,IAAA,kJAAM,IACzC,CAAC,KAAK,MAAQ,CAAC;QACX,MAAM,EAAE;QACR,aAAa;QACb,KAAK,CAAC;YACJ,MAAM,UAAyB;gBAC7B,GAAG,IAAI;gBACP,UAAU,IAAA,gIAAU,EAAC,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;gBACvC,WAAW,MAAM,IAAI,CAAC,MAAM,KAAK;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBAAE,MAAM;2BAAI,MAAM,IAAI;wBAAE;qBAAQ;gBAAC,CAAC;YAElD,cAAc;YACd,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;QAClD;QACA,QAAQ,CAAC,UAAU;YACjB,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW;4BAAE,GAAG,CAAC;4BAAE,GAAG,aAAa;wBAAC,IAAI;gBACnF,CAAC;YAED,cAAc;YACd,MAAM,UAAU,MAAM,IAAI,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;YACpD,IAAI,SAAS;gBACX,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;YAClD;QACF;QACA,QAAQ,CAAC;YACP,UAAU,UAAU;gBAAE;YAAS,GAAG,KAAK,CAAC,QAAQ,KAAK;YACrD,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;gBAChD,CAAC;QACH;QACA,YAAY,CAAC;YACX,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;4BAAE,GAAG,CAAC;4BAAE,WAAW,EAAE,QAAQ,KAAK;wBAAS,CAAC;gBACzE,CAAC;YAED,0CAA0C;YAC1C,MAAM,OAAO,MAAM,IAAI;YACvB,KAAK,MAAM,QAAQ,KAAM;gBACvB,UAAU,UAAU,MAAM,KAAK,CAAC,QAAQ,KAAK;YAC/C;QACF;QAEA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YAEvB,IAAI;gBACF,0EAA0E;gBAC1E,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,MAAM,OAAO,KAAK,IAAI,IAAI,KAAK,OAAO,IAAI,EAAE;oBAC5C,IAAI,KAAK,MAAM,GAAG,GAAG;wBACnB,IAAI;4BAAE;4BAAM,aAAa;wBAAK;oBAChC,OAAO;wBACL,IAAI;4BAAE,aAAa;wBAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8CAA8C;YAC9D;QACF;IACF,CAAC"}},
    {"offset": {"line": 1694, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<PaymentType>([], 'payment-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=payment-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<PaymentType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const usePaymentTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,0IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,iIAAS,EAAC,IAAA,sIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 1722, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/shipping/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { ShippingPartner } from './types';\r\nimport Fuse from 'fuse.js';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n// FIX: Replaced import from a non-existent module and replaced it with a mock function.\r\nconst connectPartner = async (partnerId: string, credentials: any): Promise<{ success: boolean; message: string }> => {\r\n    console.log(`Connecting to ${partnerId} with`, credentials);\r\n    // Simulate success for known partners if they have credentials.\r\n    if (credentials && Object.values(credentials).every(v => v)) {\r\n        return { success: true, message: 'Kết nối thành công.' };\r\n    }\r\n    return { success: false, message: 'Thông tin kết nối không hợp lệ.' };\r\n};\r\n\r\ntype ShippingPartnerStoreExtension = {\r\n    searchShippingPartners: (query: string, page: number, limit?: number | undefined) => Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>;\r\n    connect: (systemId: SystemId, credentials: Record<string, any>) => Promise<{ success: boolean; message: string }>;\r\n    disconnect: (systemId: SystemId) => void;\r\n};\r\n\r\nconst baseStore = createCrudStore<ShippingPartner>([], 'shipping-partners', {\r\n  // ⚠️ DEPRECATED: Store này không còn dùng để lưu credentials nữa\r\n  // Credentials giờ được lưu trong database\r\n  apiEndpoint: '/api/settings/data?type=shipping-partner',\r\n});\r\n\r\nconst fuse = new Fuse(baseStore.getState().data, {\r\n    keys: ['name', 'id', 'phone'],\r\n    threshold: 0.3,\r\n});\r\n\r\nconst storeExtension: ShippingPartnerStoreExtension = {\r\n    searchShippingPartners: async (query: string, page: number, limit: number = 20) => {\r\n        return new Promise(resolve => {\r\n            setTimeout(() => {\r\n                const allPartners = baseStore.getState().data;\r\n                const results = query ? fuse.search(query).map(r => r.item) : allPartners;\r\n                \r\n                const start = (page - 1) * limit;\r\n                const end = start + limit;\r\n                const paginatedItems = results.slice(start, end);\r\n\r\n                resolve({\r\n                    items: paginatedItems.map(p => ({ value: p.systemId, label: p.name })),\r\n                    hasNextPage: end < results.length,\r\n                });\r\n            }, 300);\r\n        });\r\n    },\r\n    connect: async (systemId: SystemId, credentials: Record<string, any>) => {\r\n        // ⚠️ DEPRECATED: Không nên dùng hàm này nữa\r\n        // Vui lòng cấu hình trong Settings → Đối tác vận chuyển\r\n        // Credentials sẽ được lưu vào shipping_partners_config\r\n        console.warn('[ShippingPartnerStore] connect() is deprecated. Use shipping_partners_config instead.');\r\n        \r\n        const partner = baseStore.getState().findById(systemId);\r\n        if (!partner) return { success: false, message: 'Không tìm thấy đối tác vận chuyển.' };\r\n        \r\n        console.log('[ShippingPartnerStore] Connecting partner:', { systemId, credentials });\r\n        \r\n        const result = { success: true, message: 'Kết nối thành công.' };\r\n        \r\n        if (result.success) {\r\n            baseStore.setState(state => {\r\n                const newData = state.data.map(p => \r\n                    p.systemId === systemId \r\n                    ? { ...p, isConnected: true, status: 'Đang hợp tác' as const, credentials } \r\n                    : p\r\n                );\r\n                \r\n                console.log('[ShippingPartnerStore] Updated partner:', newData.find(p => p.systemId === systemId));\r\n                \r\n                return { data: newData };\r\n            });\r\n        }\r\n        return result;\r\n    },\r\n    disconnect: (systemId: SystemId) => {\r\n        // ⚠️ DEPRECATED: Không nên dùng hàm này nữa\r\n        console.warn('[ShippingPartnerStore] disconnect() is deprecated. Use shipping_partners_config instead.');\r\n        \r\n        baseStore.setState(state => ({\r\n            data: state.data.map(p => \r\n                p.systemId === systemId \r\n                ? { ...p, isConnected: false, status: 'Ngừng hợp tác', credentials: {}, configuration: {} } \r\n                : p\r\n            )\r\n        }));\r\n    },\r\n};\r\n\r\nbaseStore.setState(storeExtension as any);\r\n\r\ntype ShippingPartnerStoreState = ReturnType<typeof baseStore.getState> & ShippingPartnerStoreExtension;\r\n\r\n// Export with proper Zustand hook typing\r\nexport const useShippingPartnerStore: {\r\n  (): ShippingPartnerStoreState;\r\n  <U>(selector: (state: ShippingPartnerStoreState) => U): U;\r\n  getState: () => ShippingPartnerStoreState;\r\n  setState: typeof baseStore.setState;\r\n  subscribe: typeof baseStore.subscribe;\r\n} = baseStore as any;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAGA,wFAAwF;AACxF,MAAM,iBAAiB,OAAO,WAAmB;IAC7C,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,UAAU,KAAK,CAAC,EAAE;IAC/C,gEAAgE;IAChE,IAAI,eAAe,OAAO,MAAM,CAAC,aAAa,KAAK,CAAC,CAAA,IAAK,IAAI;QACzD,OAAO;YAAE,SAAS;YAAM,SAAS;QAAsB;IAC3D;IACA,OAAO;QAAE,SAAS;QAAO,SAAS;IAAkC;AACxE;AAQA,MAAM,YAAY,IAAA,0IAAe,EAAkB,EAAE,EAAE,qBAAqB;IAC1E,iEAAiE;IACjE,0CAA0C;IAC1C,aAAa;AACf;AAEA,MAAM,OAAO,IAAI,sJAAI,CAAC,UAAU,QAAQ,GAAG,IAAI,EAAE;IAC7C,MAAM;QAAC;QAAQ;QAAM;KAAQ;IAC7B,WAAW;AACf;AAEA,MAAM,iBAAgD;IAClD,wBAAwB,OAAO,OAAe,MAAc,QAAgB,EAAE;QAC1E,OAAO,IAAI,QAAQ,CAAA;YACf,WAAW;gBACP,MAAM,cAAc,UAAU,QAAQ,GAAG,IAAI;gBAC7C,MAAM,UAAU,QAAQ,KAAK,MAAM,CAAC,OAAO,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI,IAAI;gBAE9D,MAAM,QAAQ,CAAC,OAAO,CAAC,IAAI;gBAC3B,MAAM,MAAM,QAAQ;gBACpB,MAAM,iBAAiB,QAAQ,KAAK,CAAC,OAAO;gBAE5C,QAAQ;oBACJ,OAAO,eAAe,GAAG,CAAC,CAAA,IAAK,CAAC;4BAAE,OAAO,EAAE,QAAQ;4BAAE,OAAO,EAAE,IAAI;wBAAC,CAAC;oBACpE,aAAa,MAAM,QAAQ,MAAM;gBACrC;YACJ,GAAG;QACP;IACJ;IACA,SAAS,OAAO,UAAoB;QAChC,4CAA4C;QAC5C,wDAAwD;QACxD,uDAAuD;QACvD,QAAQ,IAAI,CAAC;QAEb,MAAM,UAAU,UAAU,QAAQ,GAAG,QAAQ,CAAC;QAC9C,IAAI,CAAC,SAAS,OAAO;YAAE,SAAS;YAAO,SAAS;QAAqC;QAErF,QAAQ,GAAG,CAAC,8CAA8C;YAAE;YAAU;QAAY;QAElF,MAAM,SAAS;YAAE,SAAS;YAAM,SAAS;QAAsB;QAE/D,IAAI,OAAO,OAAO,EAAE;YAChB,UAAU,QAAQ,CAAC,CAAA;gBACf,MAAM,UAAU,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAC3B,EAAE,QAAQ,KAAK,WACb;wBAAE,GAAG,CAAC;wBAAE,aAAa;wBAAM,QAAQ;wBAAyB;oBAAY,IACxE;gBAGN,QAAQ,GAAG,CAAC,2CAA2C,QAAQ,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;gBAExF,OAAO;oBAAE,MAAM;gBAAQ;YAC3B;QACJ;QACA,OAAO;IACX;IACA,YAAY,CAAC;QACT,4CAA4C;QAC5C,QAAQ,IAAI,CAAC;QAEb,UAAU,QAAQ,CAAC,CAAA,QAAS,CAAC;gBACzB,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IACjB,EAAE,QAAQ,KAAK,WACb;wBAAE,GAAG,CAAC;wBAAE,aAAa;wBAAO,QAAQ;wBAAiB,aAAa,CAAC;wBAAG,eAAe,CAAC;oBAAE,IACxF;YAEV,CAAC;IACL;AACJ;AAEA,UAAU,QAAQ,CAAC;AAKZ,MAAM,0BAMT"}},
    {"offset": {"line": 1831, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/sales/sales-management-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n\r\nexport type PrintCopiesOption = '1' | '2' | '3';\r\n\r\nexport type SalesManagementSettingsValues = {\r\n  allowCancelAfterExport: boolean;\r\n  allowNegativeOrder: boolean;\r\n  allowNegativeApproval: boolean;\r\n  allowNegativePacking: boolean;\r\n  allowNegativeStockOut: boolean;\r\n  printCopies: PrintCopiesOption;\r\n};\r\n\r\ninterface SalesManagementSettingsState extends SalesManagementSettingsValues {\r\n  initialized: boolean;\r\n  updateSetting: <K extends keyof SalesManagementSettingsValues>(key: K, value: SalesManagementSettingsValues[K]) => void;\r\n  reset: () => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst defaultSettings: SalesManagementSettingsValues = {\r\n  allowCancelAfterExport: true,\r\n  allowNegativeOrder: true,\r\n  allowNegativeApproval: true,\r\n  allowNegativePacking: true,\r\n  allowNegativeStockOut: true,\r\n  printCopies: '1',\r\n};\r\n\r\n// API sync helper\r\nasync function syncToAPI(settings: Partial<SalesManagementSettingsValues>): Promise<boolean> {\r\n  try {\r\n    const response = await fetch('/api/settings/sales', {\r\n      method: 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(settings),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('[Sales Management Settings API] sync error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useSalesManagementSettingsStore = create<SalesManagementSettingsState>()(\r\n  (set, get) => ({\r\n    ...defaultSettings,\r\n    initialized: false,\r\n    updateSetting: (key, value) => {\r\n      set((state) => ({ ...state, [key]: value }));\r\n      syncToAPI({ [key]: value }).catch(console.error);\r\n    },\r\n    reset: () => {\r\n      set(() => ({ ...defaultSettings }));\r\n      syncToAPI(defaultSettings).catch(console.error);\r\n    },\r\n    loadFromAPI: async () => {\r\n      if (get().initialized) return;\r\n      try {\r\n        const response = await fetch('/api/settings/sales');\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const data = json.data || json;\r\n          if (data) {\r\n            set({ ...defaultSettings, ...data, initialized: true });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[Sales Management Settings Store] loadFromAPI error:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n\r\nexport const salesManagementDefaultSettings = defaultSettings;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAoBA,MAAM,kBAAiD;IACrD,wBAAwB;IACxB,oBAAoB;IACpB,uBAAuB;IACvB,sBAAsB;IACtB,uBAAuB;IACvB,aAAa;AACf;AAEA,kBAAkB;AAClB,eAAe,UAAU,QAAgD;IACvE,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,uBAAuB;YAClD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACvB;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+CAA+C;QAC7D,OAAO;IACT;AACF;AAEO,MAAM,kCAAkC,IAAA,kJAAM,IACnD,CAAC,KAAK,MAAQ,CAAC;QACb,GAAG,eAAe;QAClB,aAAa;QACb,eAAe,CAAC,KAAK;YACnB,IAAI,CAAC,QAAU,CAAC;oBAAE,GAAG,KAAK;oBAAE,CAAC,IAAI,EAAE;gBAAM,CAAC;YAC1C,UAAU;gBAAE,CAAC,IAAI,EAAE;YAAM,GAAG,KAAK,CAAC,QAAQ,KAAK;QACjD;QACA,OAAO;YACL,IAAI,IAAM,CAAC;oBAAE,GAAG,eAAe;gBAAC,CAAC;YACjC,UAAU,iBAAiB,KAAK,CAAC,QAAQ,KAAK;QAChD;QACA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YACvB,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,MAAM,OAAO,KAAK,IAAI,IAAI;oBAC1B,IAAI,MAAM;wBACR,IAAI;4BAAE,GAAG,eAAe;4BAAE,GAAG,IAAI;4BAAE,aAAa;wBAAK;oBACvD,OAAO;wBACL,IAAI;4BAAE,aAAa;wBAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wDAAwD;YACxE;QACF;IACF,CAAC;AAGI,MAAM,iCAAiC"}}]
}