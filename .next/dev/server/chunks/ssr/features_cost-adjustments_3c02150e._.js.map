{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/cost-adjustments/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId, type BusinessId } from '../../lib/id-types';\r\nimport type { CostAdjustment, CostAdjustmentItem, CostAdjustmentType, CostAdjustmentStatus } from './types';\r\nimport { useProductStore } from '../products/store';\r\nimport type { Product } from '../products/types';\r\n\r\nconst PREFIX = 'DCGV'; // Điều chỉnh giá vốn\r\nconst SEED_AUTHOR = asSystemId('EMP000001');\r\n\r\n// Helper function to create sample data\r\nconst createSampleData = (): CostAdjustment[] => {\r\n  const now = new Date();\r\n  const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n  const twoWeeksAgo = new Date(now.getTime() - 14 * 24 * 60 * 60 * 1000);\r\n  const threeWeeksAgo = new Date(now.getTime() - 21 * 24 * 60 * 60 * 1000);\r\n  const oneMonthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n\r\n  return [\r\n    // Draft - chưa xác nhận\r\n    {\r\n      systemId: asSystemId('COST_ADJ000001'),\r\n      id: asBusinessId('DCGV000001') as BusinessId,\r\n      type: 'manual',\r\n      status: 'draft',\r\n      items: [\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000001'),\r\n          productId: 'SP000001',\r\n          productName: 'Laptop Dell Inspiron 15',\r\n          productImage: 'https://images.unsplash.com/photo-1517430816045-df4b7de11d1d?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 12000000,\r\n          newCostPrice: 12500000,\r\n          adjustmentAmount: 500000,\r\n          adjustmentPercent: 4.17,\r\n          reason: 'Giá nhập tăng từ nhà cung cấp',\r\n        },\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000002'),\r\n          productId: 'SP000002',\r\n          productName: 'Chuột Logitech MX Master 3',\r\n          productImage: 'https://images.unsplash.com/photo-1472851294608-062f824d29cc?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 1500000,\r\n          newCostPrice: 1600000,\r\n          adjustmentAmount: 100000,\r\n          adjustmentPercent: 6.67,\r\n          reason: 'Cập nhật theo giá thị trường',\r\n        },\r\n      ],\r\n      note: 'Điều chỉnh giá vốn theo giá nhập mới từ NCC Dell',\r\n      reason: 'Thay đổi giá từ nhà cung cấp',\r\n      referenceCode: 'PN000015',\r\n      createdDate: oneWeekAgo.toISOString(),\r\n      createdBySystemId: SEED_AUTHOR,\r\n      createdByName: 'Nguyễn Văn A',\r\n      createdAt: oneWeekAgo.toISOString(),\r\n      updatedAt: oneWeekAgo.toISOString(),\r\n      createdBy: SEED_AUTHOR,\r\n      updatedBy: SEED_AUTHOR,\r\n    },\r\n    // Draft - batch điều chỉnh nhiều sản phẩm\r\n    {\r\n      systemId: asSystemId('COST_ADJ000002'),\r\n      id: asBusinessId('DCGV000002') as BusinessId,\r\n      type: 'batch',\r\n      status: 'draft',\r\n      items: [\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000003'),\r\n          productId: 'SP000003',\r\n          productName: 'Điện thoại iPhone 15 Pro',\r\n          productImage: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 25000000,\r\n          newCostPrice: 24000000,\r\n          adjustmentAmount: -1000000,\r\n          adjustmentPercent: -4,\r\n          reason: 'Giảm giá nhập từ Apple',\r\n        },\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000004'),\r\n          productId: 'SP000004',\r\n          productName: 'Tai nghe AirPods Pro',\r\n          productImage: 'https://images.unsplash.com/photo-1590658268037-6bf12165a8df?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 5000000,\r\n          newCostPrice: 4800000,\r\n          adjustmentAmount: -200000,\r\n          adjustmentPercent: -4,\r\n          reason: 'Giảm giá theo chính sách mới',\r\n        },\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000005'),\r\n          productId: 'SP000005',\r\n          productName: 'Bàn phím cơ Keychron K8',\r\n          productImage: 'https://images.unsplash.com/photo-1511467687858-23d96c32e4ae?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 2000000,\r\n          newCostPrice: 1900000,\r\n          adjustmentAmount: -100000,\r\n          adjustmentPercent: -5,\r\n          reason: 'Điều chỉnh theo lô hàng mới',\r\n        },\r\n      ],\r\n      note: 'Điều chỉnh hàng loạt theo chương trình giảm giá Q4/2024',\r\n      reason: 'Chương trình khuyến mãi từ nhà cung cấp',\r\n      createdDate: now.toISOString(),\r\n      createdBySystemId: SEED_AUTHOR,\r\n      createdByName: 'Nguyễn Văn A',\r\n      createdAt: now.toISOString(),\r\n      updatedAt: now.toISOString(),\r\n      createdBy: SEED_AUTHOR,\r\n      updatedBy: SEED_AUTHOR,\r\n    },\r\n    // Confirmed - đã xác nhận\r\n    {\r\n      systemId: asSystemId('COST_ADJ000003'),\r\n      id: asBusinessId('DCGV000003') as BusinessId,\r\n      type: 'import',\r\n      status: 'confirmed',\r\n      items: [\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000006'),\r\n          productId: 'SP000006',\r\n          productName: 'Màn hình LG UltraWide 34\"',\r\n          productImage: 'https://images.unsplash.com/photo-1527443224154-c4a3942d3acf?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 8000000,\r\n          newCostPrice: 8500000,\r\n          adjustmentAmount: 500000,\r\n          adjustmentPercent: 6.25,\r\n          reason: 'Cập nhật từ đơn nhập hàng',\r\n        },\r\n      ],\r\n      note: 'Tự động điều chỉnh từ đơn nhập hàng PN000012',\r\n      reason: 'Đơn nhập hàng mới',\r\n      referenceCode: 'PN000012',\r\n      createdDate: twoWeeksAgo.toISOString(),\r\n      createdBySystemId: SEED_AUTHOR,\r\n      createdByName: 'Nguyễn Văn A',\r\n      confirmedDate: oneWeekAgo.toISOString(),\r\n      confirmedBySystemId: asSystemId('EMP000002'),\r\n      confirmedByName: 'Trần Thị B',\r\n      createdAt: twoWeeksAgo.toISOString(),\r\n      updatedAt: oneWeekAgo.toISOString(),\r\n      createdBy: SEED_AUTHOR,\r\n      updatedBy: asSystemId('EMP000002'),\r\n    },\r\n    // Confirmed - đã xác nhận (từ đơn nhập)\r\n    {\r\n      systemId: asSystemId('COST_ADJ000004'),\r\n      id: asBusinessId('DCGV000004') as BusinessId,\r\n      type: 'manual',\r\n      status: 'confirmed',\r\n      items: [\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000007'),\r\n          productId: 'SP000007',\r\n          productName: 'SSD Samsung 1TB',\r\n          productImage: 'https://images.unsplash.com/photo-1597872200969-2b65d56bd16b?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 2500000,\r\n          newCostPrice: 2200000,\r\n          adjustmentAmount: -300000,\r\n          adjustmentPercent: -12,\r\n          reason: 'Giá SSD giảm mạnh trên thị trường',\r\n        },\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000008'),\r\n          productId: 'SP000008',\r\n          productName: 'RAM Kingston 16GB DDR5',\r\n          productImage: 'https://images.unsplash.com/photo-1562976540-1502c2145186?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 1800000,\r\n          newCostPrice: 1500000,\r\n          adjustmentAmount: -300000,\r\n          adjustmentPercent: -16.67,\r\n          reason: 'Giá RAM giảm',\r\n        },\r\n      ],\r\n      note: 'Điều chỉnh giá theo biến động thị trường linh kiện',\r\n      reason: 'Biến động thị trường',\r\n      createdDate: threeWeeksAgo.toISOString(),\r\n      createdBySystemId: asSystemId('EMP000003'),\r\n      createdByName: 'Lê Văn C',\r\n      confirmedDate: twoWeeksAgo.toISOString(),\r\n      confirmedBySystemId: SEED_AUTHOR,\r\n      confirmedByName: 'Nguyễn Văn A',\r\n      createdAt: threeWeeksAgo.toISOString(),\r\n      updatedAt: twoWeeksAgo.toISOString(),\r\n      createdBy: asSystemId('EMP000003'),\r\n      updatedBy: SEED_AUTHOR,\r\n    },\r\n    // Cancelled - đã hủy\r\n    {\r\n      systemId: asSystemId('COST_ADJ000005'),\r\n      id: asBusinessId('DCGV000005') as BusinessId,\r\n      type: 'manual',\r\n      status: 'cancelled',\r\n      items: [\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000001'),\r\n          productId: 'SP000001',\r\n          productName: 'Laptop Dell Inspiron 15',\r\n          productImage: 'https://images.unsplash.com/photo-1517430816045-df4b7de11d1d?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 12000000,\r\n          newCostPrice: 11000000,\r\n          adjustmentAmount: -1000000,\r\n          adjustmentPercent: -8.33,\r\n          reason: 'Điều chỉnh sai',\r\n        },\r\n      ],\r\n      note: 'Phiếu điều chỉnh bị hủy do nhập sai giá',\r\n      reason: 'Sai thông tin giá',\r\n      createdDate: oneMonthAgo.toISOString(),\r\n      createdBySystemId: asSystemId('EMP000003'),\r\n      createdByName: 'Lê Văn C',\r\n      cancelledDate: threeWeeksAgo.toISOString(),\r\n      cancelledBySystemId: SEED_AUTHOR,\r\n      cancelledByName: 'Nguyễn Văn A',\r\n      cancelReason: 'Nhập sai giá vốn mới, cần tạo phiếu mới',\r\n      createdAt: oneMonthAgo.toISOString(),\r\n      updatedAt: threeWeeksAgo.toISOString(),\r\n      createdBy: asSystemId('EMP000003'),\r\n      updatedBy: SEED_AUTHOR,\r\n    },\r\n    // Confirmed - đã xác nhận (cũ hơn)\r\n    {\r\n      systemId: asSystemId('COST_ADJ000006'),\r\n      id: asBusinessId('DCGV000006') as BusinessId,\r\n      type: 'batch',\r\n      status: 'confirmed',\r\n      items: [\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000009'),\r\n          productId: 'SP000009',\r\n          productName: 'Webcam Logitech C920',\r\n          productImage: 'https://images.unsplash.com/photo-1587826080692-f439cd0b70da?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 1200000,\r\n          newCostPrice: 1350000,\r\n          adjustmentAmount: 150000,\r\n          adjustmentPercent: 12.5,\r\n          reason: 'Tăng giá nhập',\r\n        },\r\n        {\r\n          productSystemId: asSystemId('PRODUCT000010'),\r\n          productId: 'SP000010',\r\n          productName: 'Loa Bluetooth JBL Flip 6',\r\n          productImage: 'https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?auto=format&fit=crop&w=600&q=80',\r\n          oldCostPrice: 2000000,\r\n          newCostPrice: 2100000,\r\n          adjustmentAmount: 100000,\r\n          adjustmentPercent: 5,\r\n          reason: 'Giá nhập tăng',\r\n        },\r\n      ],\r\n      note: 'Điều chỉnh theo đợt kiểm kê cuối tháng',\r\n      reason: 'Kiểm kê định kỳ',\r\n      createdDate: oneMonthAgo.toISOString(),\r\n      createdBySystemId: SEED_AUTHOR,\r\n      createdByName: 'Nguyễn Văn A',\r\n      confirmedDate: threeWeeksAgo.toISOString(),\r\n      confirmedBySystemId: asSystemId('EMP000002'),\r\n      confirmedByName: 'Trần Thị B',\r\n      createdAt: oneMonthAgo.toISOString(),\r\n      updatedAt: threeWeeksAgo.toISOString(),\r\n      createdBy: SEED_AUTHOR,\r\n      updatedBy: asSystemId('EMP000002'),\r\n    },\r\n  ];\r\n};\r\n\r\nconst generateSystemIdFromCounter = (counter: number): SystemId => {\r\n  return asSystemId(`COST_ADJ${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\nexport interface CostAdjustmentStoreState {\r\n  data: CostAdjustment[];\r\n  counter: number;\r\n  \r\n  // CRUD\r\n  getById: (systemId: SystemId) => CostAdjustment | undefined;\r\n  getByBusinessId: (businessId: string) => CostAdjustment | undefined;\r\n  \r\n  // Create\r\n  create: (\r\n    items: Omit<CostAdjustmentItem, 'adjustmentAmount' | 'adjustmentPercent'>[],\r\n    type: CostAdjustmentType,\r\n    createdBySystemId: SystemId,\r\n    createdByName: string,\r\n    options?: {\r\n      customId?: string;\r\n      note?: string;\r\n      reason?: string;\r\n      referenceCode?: string;\r\n      status?: CostAdjustmentStatus;\r\n    }\r\n  ) => CostAdjustment;\r\n  \r\n  // Actions\r\n  confirm: (systemId: SystemId, confirmedBySystemId: SystemId, confirmedByName: string) => boolean;\r\n  cancel: (systemId: SystemId, cancelledBySystemId: SystemId, cancelledByName: string, reason?: string) => boolean;\r\n  \r\n  // Queries\r\n  getAll: () => CostAdjustment[];\r\n  getByStatus: (status: CostAdjustmentStatus) => CostAdjustment[];\r\n  \r\n  // Helpers\r\n  generateNextId: () => string;\r\n  isBusinessIdExists: (businessId: string) => boolean;\r\n}\r\n\r\nexport const useCostAdjustmentStore = create<CostAdjustmentStoreState>()(\r\n  (set, get) => ({\r\n      data: createSampleData(),\r\n      counter: 6, // Start from 6 since we have 6 sample records\r\n      \r\n      getById: (systemId) => get().data.find(item => item.systemId === systemId),\r\n      \r\n      getByBusinessId: (businessId) => get().data.find(item => item.id === businessId),\r\n      \r\n      generateNextId: () => {\r\n        const existing = get().data;\r\n        let maxNum = 0;\r\n        existing.forEach(item => {\r\n          const match = item.id.match(/^DCGV(\\d+)$/);\r\n          if (match) {\r\n            const num = parseInt(match[1], 10);\r\n            if (num > maxNum) maxNum = num;\r\n          }\r\n        });\r\n        return `${PREFIX}${String(maxNum + 1).padStart(6, '0')}`;\r\n      },\r\n      \r\n      isBusinessIdExists: (businessId) => {\r\n        return get().data.some(item => item.id === businessId);\r\n      },\r\n      \r\n      create: (items, type, createdBySystemId, createdByName, options) => {\r\n        const currentCounter = get().counter;\r\n        const systemId = generateSystemIdFromCounter(currentCounter);\r\n        const businessId = options?.customId || get().generateNextId();\r\n        \r\n        // Calculate adjustment amounts\r\n        const processedItems: CostAdjustmentItem[] = items.map(item => ({\r\n          ...item,\r\n          adjustmentAmount: item.newCostPrice - item.oldCostPrice,\r\n          adjustmentPercent: item.oldCostPrice > 0 \r\n            ? ((item.newCostPrice - item.oldCostPrice) / item.oldCostPrice) * 100 \r\n            : 0,\r\n        }));\r\n\r\n        const optionalFields: Partial<CostAdjustment> = {};\r\n        if (options?.note !== undefined) {\r\n          optionalFields.note = options.note;\r\n        }\r\n        if (options?.reason !== undefined) {\r\n          optionalFields.reason = options.reason;\r\n        }\r\n        if (options?.referenceCode !== undefined) {\r\n          optionalFields.referenceCode = options.referenceCode;\r\n        }\r\n        \r\n        const newAdjustment: CostAdjustment = {\r\n          systemId,\r\n          id: businessId as BusinessId,\r\n          type,\r\n          status: options?.status || 'draft',\r\n          items: processedItems,\r\n          createdDate: new Date().toISOString(),\r\n          createdBySystemId,\r\n          createdByName,\r\n          // Audit fields\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString(),\r\n          createdBy: createdBySystemId,\r\n          updatedBy: createdBySystemId,\r\n          ...optionalFields,\r\n        };\r\n        \r\n        set(state => ({\r\n          data: [newAdjustment, ...state.data],\r\n          counter: state.counter + 1,\r\n        }));\r\n        \r\n        return newAdjustment;\r\n      },\r\n      \r\n      confirm: (systemId, confirmedBySystemId, confirmedByName) => {\r\n        const adjustment = get().getById(systemId);\r\n        if (!adjustment || adjustment.status !== 'draft') return false;\r\n        \r\n        // Update product cost prices\r\n        const productStore = useProductStore.getState();\r\n        adjustment.items.forEach(item => {\r\n          const existingProduct = productStore.findById(item.productSystemId);\r\n          if (!existingProduct) return;\r\n          productStore.update(item.productSystemId, {\r\n            ...existingProduct,\r\n            costPrice: item.newCostPrice,\r\n          });\r\n        });\r\n        \r\n        set(state => ({\r\n          data: state.data.map(item => \r\n            item.systemId === systemId\r\n              ? {\r\n                  ...item,\r\n                  status: 'confirmed' as CostAdjustmentStatus,\r\n                  confirmedDate: new Date().toISOString(),\r\n                  confirmedBySystemId,\r\n                  confirmedByName,\r\n                  updatedAt: new Date().toISOString(),\r\n                  updatedBy: confirmedBySystemId,\r\n                }\r\n              : item\r\n          ),\r\n        }));\r\n        \r\n        return true;\r\n      },\r\n      \r\n      cancel: (systemId, cancelledBySystemId, cancelledByName, reason) => {\r\n        const adjustment = get().getById(systemId);\r\n        if (!adjustment || adjustment.status !== 'draft') return false;\r\n        \r\n        set(state => ({\r\n          data: state.data.map(item => \r\n            item.systemId === systemId\r\n              ? {\r\n                  ...item,\r\n                  status: 'cancelled' as CostAdjustmentStatus,\r\n                  cancelledDate: new Date().toISOString(),\r\n                  cancelledBySystemId,\r\n                  cancelledByName,\r\n                  cancelReason: reason ?? '',\r\n                  updatedAt: new Date().toISOString(),\r\n                  updatedBy: cancelledBySystemId,\r\n                }\r\n              : item\r\n          ),\r\n        }));\r\n        \r\n        return true;\r\n      },\r\n      \r\n      getAll: () => get().data.filter(item => item.status !== 'cancelled'),\r\n      \r\n      getByStatus: (status) => get().data.filter(item => item.status === status),\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 388, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/cost-adjustments/columns.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport Link from 'next/link';\r\nimport type { CostAdjustment, CostAdjustmentStatus } from './types';\r\nimport type { ColumnDef } from '../../components/data-table/types';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Button } from '../../components/ui/button';\r\nimport { Checkbox } from '../../components/ui/checkbox';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '../../components/ui/dropdown-menu';\r\nimport { MoreHorizontal, Eye, Printer } from 'lucide-react';\r\nimport { formatDate } from '@/lib/date-utils';\r\n\r\nconst getStatusVariant = (status: CostAdjustmentStatus): 'default' | 'secondary' | 'success' | 'destructive' | 'outline' => {\r\n  switch (status) {\r\n    case 'draft': return 'secondary';\r\n    case 'confirmed': return 'success';\r\n    case 'cancelled': return 'destructive';\r\n    default: return 'outline';\r\n  }\r\n};\r\n\r\nconst getStatusLabel = (status: CostAdjustmentStatus): string => {\r\n  switch (status) {\r\n    case 'draft': return 'Nháp';\r\n    case 'confirmed': return 'Đã xác nhận';\r\n    case 'cancelled': return 'Đã hủy';\r\n    default: return status;\r\n  }\r\n};\r\n\r\nconst formatCurrency = (value: number) => value.toLocaleString('vi-VN') + ' đ';\r\n\r\nexport const getColumns = (\r\n  navigate: (path: string) => void,\r\n  onPrint: (adjustment: CostAdjustment) => void\r\n): ColumnDef<CostAdjustment>[] => [\r\n  {\r\n    id: 'select',\r\n    header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n      <div className=\"flex items-center justify-center\">\r\n        <Checkbox\r\n          checked={isAllPageRowsSelected ? true : isSomePageRowsSelected ? 'indeterminate' : false}\r\n          onCheckedChange={(value) => onToggleAll?.(!!value)}\r\n          aria-label=\"Chọn tất cả\"\r\n          className=\"h-4 w-4\"\r\n        />\r\n      </div>\r\n    ),\r\n    cell: ({ isSelected, onToggleSelect }) => (\r\n      <div className=\"flex items-center justify-center\">\r\n        <Checkbox\r\n          checked={isSelected}\r\n          onCheckedChange={onToggleSelect}\r\n          aria-label=\"Chọn hàng\"\r\n          className=\"h-4 w-4\"\r\n        />\r\n      </div>\r\n    ),\r\n    enableSorting: false,\r\n    size: 50,\r\n    meta: { displayName: 'Chọn' },\r\n  },\r\n  {\r\n    id: 'id',\r\n    accessorKey: 'id',\r\n    header: 'Mã phiếu',\r\n    cell: ({ row }) => (\r\n      <Link\r\n        href={`/cost-adjustments/${(row as any).systemId}`}\r\n        className=\"font-medium text-primary hover:underline\"\r\n      >\r\n        {(row as any).id}\r\n      </Link>\r\n    ),\r\n    meta: { displayName: 'Mã phiếu' },\r\n  },\r\n  {\r\n    id: 'referenceCode',\r\n    accessorKey: 'referenceCode',\r\n    header: 'Mã tham chiếu',\r\n    cell: ({ row }) => (\r\n      <span className=\"text-muted-foreground\">\r\n        {(row as any).referenceCode || '-'}\r\n      </span>\r\n    ),\r\n    meta: { displayName: 'Mã tham chiếu' },\r\n  },\r\n  {\r\n    id: 'createdDate',\r\n    accessorKey: 'createdDate',\r\n    header: 'Ngày tạo',\r\n    cell: ({ row }) => formatDate((row as any).createdDate),\r\n    meta: { displayName: 'Ngày tạo' },\r\n  },\r\n  {\r\n    id: 'createdByName',\r\n    accessorKey: 'createdByName',\r\n    header: 'Người tạo',\r\n    cell: ({ row }) => (row as any).createdByName,\r\n    meta: { displayName: 'Người tạo' },\r\n  },\r\n  {\r\n    id: 'itemCount',\r\n    accessorKey: 'items',\r\n    header: 'Số SP',\r\n    cell: ({ row }) => ((row as any).items?.length || 0),\r\n    meta: { displayName: 'Số sản phẩm' },\r\n  },\r\n  {\r\n    id: 'totalOldValue',\r\n    accessorKey: 'items',\r\n    header: 'Tổng giá vốn cũ',\r\n    cell: ({ row }) => {\r\n      const totalOldValue = (row as any).items?.reduce((sum: number, item: any) => sum + item.oldCostPrice, 0) || 0;\r\n      return <span>{formatCurrency(totalOldValue)}</span>;\r\n    },\r\n    meta: { displayName: 'Tổng giá vốn cũ' },\r\n  },\r\n  {\r\n    id: 'totalNewValue',\r\n    accessorKey: 'items',\r\n    header: 'Tổng giá vốn mới',\r\n    cell: ({ row }) => {\r\n      const totalNewValue = (row as any).items?.reduce((sum: number, item: any) => sum + item.newCostPrice, 0) || 0;\r\n      return <span>{formatCurrency(totalNewValue)}</span>;\r\n    },\r\n    meta: { displayName: 'Tổng giá vốn mới' },\r\n  },\r\n  {\r\n    id: 'totalDifference',\r\n    accessorKey: 'items',\r\n    header: 'Chênh lệch',\r\n    cell: ({ row }) => {\r\n      const totalDifference = (row as any).items?.reduce((sum: number, item: any) => sum + item.adjustmentAmount, 0) || 0;\r\n      const isPositive = totalDifference > 0;\r\n      const isNegative = totalDifference < 0;\r\n      \r\n      return (\r\n        <span className={`font-medium ${isPositive ? 'text-green-600' : isNegative ? 'text-red-600' : ''}`}>\r\n          {isPositive ? '+' : ''}{formatCurrency(totalDifference)}\r\n        </span>\r\n      );\r\n    },\r\n    meta: { displayName: 'Chênh lệch' },\r\n  },\r\n  {\r\n    id: 'reason',\r\n    accessorKey: 'reason',\r\n    header: 'Lý do',\r\n    cell: ({ row }) => (\r\n      <span className=\"text-muted-foreground truncate max-w-[200px] block\">\r\n        {(row as any).reason || '-'}\r\n      </span>\r\n    ),\r\n    meta: { displayName: 'Lý do' },\r\n  },\r\n  {\r\n    id: 'status',\r\n    accessorKey: 'status',\r\n    header: 'Trạng thái',\r\n    cell: ({ row }) => (\r\n      <Badge variant={getStatusVariant((row as any).status)}>\r\n        {getStatusLabel((row as any).status)}\r\n      </Badge>\r\n    ),\r\n    meta: { displayName: 'Trạng thái' },\r\n  },\r\n  {\r\n    id: 'confirmedDate',\r\n    accessorKey: 'confirmedDate',\r\n    header: 'Ngày xác nhận',\r\n    cell: ({ row }) => (row as any).confirmedDate ? formatDate((row as any).confirmedDate) : '-',\r\n    meta: { displayName: 'Ngày xác nhận' },\r\n  },\r\n  {\r\n    id: 'confirmedByName',\r\n    accessorKey: 'confirmedByName',\r\n    header: 'Người xác nhận',\r\n    cell: ({ row }) => (row as any).confirmedByName || '-',\r\n    meta: { displayName: 'Người xác nhận' },\r\n  },\r\n  {\r\n    id: 'note',\r\n    accessorKey: 'note',\r\n    header: 'Ghi chú',\r\n    cell: ({ row }) => (\r\n      <span className=\"text-muted-foreground truncate max-w-[200px] block\">\r\n        {(row as any).note || '-'}\r\n      </span>\r\n    ),\r\n    meta: { displayName: 'Ghi chú' },\r\n  },\r\n  {\r\n    id: 'actions',\r\n    header: 'Hành động',\r\n    cell: ({ row }) => {\r\n      const adjustment = row as CostAdjustment;\r\n      const isDraft = adjustment.status === 'draft';\r\n      \r\n      return (\r\n        <DropdownMenu>\r\n          <DropdownMenuTrigger asChild>\r\n            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\r\n              <MoreHorizontal className=\"h-4 w-4\" />\r\n              <span className=\"sr-only\">Mở menu</span>\r\n            </Button>\r\n          </DropdownMenuTrigger>\r\n          <DropdownMenuContent align=\"end\">\r\n            <DropdownMenuItem onClick={() => navigate(`/cost-adjustments/${adjustment.systemId}`)}>\r\n              <Eye className=\"mr-2 h-4 w-4\" />\r\n              Xem chi tiết\r\n            </DropdownMenuItem>\r\n            {isDraft && (\r\n              <>\r\n                <DropdownMenuItem onClick={() => navigate(`/cost-adjustments/${adjustment.systemId}`)}>\r\n                  Xác nhận\r\n                </DropdownMenuItem>\r\n                <DropdownMenuSeparator />\r\n                <DropdownMenuItem \r\n                  className=\"text-destructive focus:text-destructive\"\r\n                  onClick={() => navigate(`/cost-adjustments/${adjustment.systemId}`)}\r\n                >\r\n                  Hủy phiếu\r\n                </DropdownMenuItem>\r\n              </>\r\n            )}\r\n            <DropdownMenuSeparator />\r\n            <DropdownMenuItem onClick={() => onPrint(adjustment)}>\r\n              <Printer className=\"mr-2 h-4 w-4\" />\r\n              In phiếu\r\n            </DropdownMenuItem>\r\n          </DropdownMenuContent>\r\n        </DropdownMenu>\r\n      );\r\n    },\r\n    meta: { displayName: 'Hành động' },\r\n  },\r\n];\r\n\r\nexport const getStatusOptions = () => [\r\n  { value: 'all', label: 'Tất cả trạng thái' },\r\n  { value: 'draft', label: 'Nháp' },\r\n  { value: 'confirmed', label: 'Đã xác nhận' },\r\n  { value: 'cancelled', label: 'Đã hủy' },\r\n];\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 815, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/cost-adjustments/cost-adjustment-card.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport type { CostAdjustment } from './types';\r\nimport { Card, CardContent, CardTitle } from '../../components/ui/card';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Button } from '../../components/ui/button';\r\nimport { TrendingUp, TrendingDown, Package, Calendar, User, MoreHorizontal, Eye, CheckCircle, XCircle, Printer } from 'lucide-react';\r\nimport { formatDate } from '@/lib/date-utils';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '../../components/ui/dropdown-menu';\r\n\r\nconst getStatusVariant = (status: string): 'default' | 'secondary' | 'success' | 'destructive' | 'outline' => {\r\n  switch (status) {\r\n    case 'draft': return 'secondary';\r\n    case 'confirmed': return 'success';\r\n    case 'cancelled': return 'destructive';\r\n    default: return 'outline';\r\n  }\r\n};\r\n\r\nconst getStatusLabel = (status: string): string => {\r\n  switch (status) {\r\n    case 'draft': return 'Nháp';\r\n    case 'confirmed': return 'Đã xác nhận';\r\n    case 'cancelled': return 'Đã hủy';\r\n    default: return status;\r\n  }\r\n};\r\n\r\nconst formatCurrency = (value: number) => value.toLocaleString('vi-VN') + ' đ';\r\n\r\ninterface CostAdjustmentCardProps {\r\n  adjustment: CostAdjustment;\r\n  onConfirm?: (systemId: string) => void;\r\n  onCancel?: (systemId: string) => void;\r\n}\r\n\r\nexport function CostAdjustmentCard({ adjustment, onConfirm, onCancel }: CostAdjustmentCardProps) {\r\n  const router = useRouter();\r\n  const isDraft = adjustment.status === 'draft';\r\n  \r\n  // Calculate totals\r\n  const totalOldValue = adjustment.items?.reduce((sum, item) => sum + item.oldCostPrice, 0) || 0;\r\n  const totalNewValue = adjustment.items?.reduce((sum, item) => sum + item.newCostPrice, 0) || 0;\r\n  const totalDifference = totalNewValue - totalOldValue;\r\n  const isPositive = totalDifference > 0;\r\n  const isNegative = totalDifference < 0;\r\n\r\n  return (\r\n    <Card className=\"mb-3\">\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"flex items-start justify-between mb-3\">\r\n          <div className=\"flex-1\">\r\n            <div className=\"flex items-center gap-2 mb-1\">\r\n              <CardTitle className=\"font-semibold text-sm text-primary\">{adjustment.id}</CardTitle>\r\n              <Badge variant={getStatusVariant(adjustment.status)}>\r\n                {getStatusLabel(adjustment.status)}\r\n              </Badge>\r\n            </div>\r\n            {adjustment.referenceCode && (\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Mã tham chiếu: {adjustment.referenceCode}\r\n              </p>\r\n            )}\r\n          </div>\r\n          \r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n              <DropdownMenuItem onClick={() => router.push(`/cost-adjustments/${adjustment.systemId}`)}>\r\n                <Eye className=\"mr-2 h-4 w-4\" />\r\n                Xem chi tiết\r\n              </DropdownMenuItem>\r\n              {isDraft && (\r\n                <>\r\n                  <DropdownMenuItem onClick={() => onConfirm?.(adjustment.systemId)}>\r\n                    <CheckCircle className=\"mr-2 h-4 w-4\" />\r\n                    Xác nhận\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem \r\n                    className=\"text-destructive\"\r\n                    onClick={() => onCancel?.(adjustment.systemId)}\r\n                  >\r\n                    <XCircle className=\"mr-2 h-4 w-4\" />\r\n                    Hủy phiếu\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n              <DropdownMenuItem onClick={() => router.push(`/cost-adjustments/${adjustment.systemId}`)}>\r\n                <Printer className=\"mr-2 h-4 w-4\" />\r\n                In phiếu\r\n              </DropdownMenuItem>\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        </div>\r\n\r\n        {/* Price Change Summary */}\r\n        <div className=\"flex items-center gap-2 mb-3 p-2 bg-muted/50 rounded-md\">\r\n          <div className=\"flex-1\">\r\n            <p className=\"text-xs text-muted-foreground\">Giá vốn cũ</p>\r\n            <p className=\"font-medium text-sm\">{formatCurrency(totalOldValue)}</p>\r\n          </div>\r\n          <div className=\"flex items-center\">\r\n            {isPositive ? (\r\n              <TrendingUp className=\"h-4 w-4 text-emerald-600\" />\r\n            ) : isNegative ? (\r\n              <TrendingDown className=\"h-4 w-4 text-destructive\" />\r\n            ) : null}\r\n          </div>\r\n          <div className=\"flex-1 text-right\">\r\n            <p className=\"text-xs text-muted-foreground\">Giá vốn mới</p>\r\n            <p className=\"font-medium text-sm\">{formatCurrency(totalNewValue)}</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Difference */}\r\n        <div className={`text-center p-2 rounded-md mb-3 ${\r\n          isPositive ? 'bg-emerald-500/10 text-emerald-600' : \r\n          isNegative ? 'bg-destructive/10 text-destructive' : \r\n          'bg-gray-50 text-gray-700'\r\n        }`}>\r\n          <span className=\"text-sm font-medium\">\r\n            Chênh lệch: {isPositive ? '+' : ''}{formatCurrency(totalDifference)}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Info Row */}\r\n        <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n          <div className=\"flex items-center gap-1 text-muted-foreground\">\r\n            <Package className=\"h-3.5 w-3.5\" />\r\n            <span>{adjustment.items?.length || 0} sản phẩm</span>\r\n          </div>\r\n          <div className=\"flex items-center gap-1 text-muted-foreground\">\r\n            <Calendar className=\"h-3.5 w-3.5\" />\r\n            <span>{formatDate(adjustment.createdDate)}</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Creator */}\r\n        <div className=\"flex items-center gap-1 mt-2 text-xs text-muted-foreground\">\r\n          <User className=\"h-3 w-3\" />\r\n          <span>{adjustment.createdByName}</span>\r\n        </div>\r\n\r\n        {/* Reason */}\r\n        {adjustment.reason && (\r\n          <p className=\"mt-2 text-xs text-muted-foreground line-clamp-2\">\r\n            Lý do: {adjustment.reason}\r\n          </p>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1262, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/cost-adjustments/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useColumnVisibility, useColumnOrder, usePinnedColumns } from '@/hooks/use-column-visibility';\r\nimport { useCostAdjustmentStore } from './store';\r\nimport { getColumns, getStatusOptions } from './columns';\r\nimport { ResponsiveDataTable } from '../../components/data-table/responsive-data-table';\r\nimport { DataTableFacetedFilter } from '../../components/data-table/data-table-faceted-filter';\r\nimport { DataTableExportDialog } from '../../components/data-table/data-table-export-dialog';\r\nimport { DataTableColumnCustomizer } from '../../components/data-table/data-table-column-toggle';\r\nimport { GenericImportDialogV2 } from '../../components/shared/generic-import-dialog-v2';\r\nimport { GenericExportDialogV2 } from '../../components/shared/generic-export-dialog-v2';\r\nimport { costAdjustmentImportExportConfig, flattenCostAdjustmentsForExport } from '../../lib/import-export/configs/cost-adjustment.config';\r\nimport { usePageHeader } from '../../contexts/page-header-context';\r\nimport { ROUTES } from '../../lib/router';\r\nimport { Button } from '../../components/ui/button';\r\nimport { Plus, XCircle, CheckCircle, Printer, FileSpreadsheet, Download } from 'lucide-react';\r\nimport { PageToolbar } from '../../components/layout/page-toolbar';\r\nimport { PageFilters } from '../../components/layout/page-filters';\r\nimport { useMediaQuery } from '../../lib/use-media-query';\r\nimport { toast } from 'sonner';\r\nimport Fuse from 'fuse.js';\r\nimport { CostAdjustmentCard } from './cost-adjustment-card';\r\nimport type { CostAdjustment, CostAdjustmentStatus } from './types';\r\nimport { formatDate, isValidDate, isDateAfter, isDateBefore, isDateSame, isDateBetween, getStartOfDay, getEndOfDay } from '../../lib/date-utils';\r\nimport { useAuth } from '../../contexts/auth-context';\r\nimport { asSystemId } from '../../lib/id-types';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '../../components/ui/alert-dialog';\r\nimport { SimplePrintOptionsDialog, SimplePrintOptionsResult } from '../../components/shared/simple-print-options-dialog';\r\nimport { usePrint } from '../../lib/use-print';\r\nimport { useBranchStore } from '../settings/branches/store';\r\nimport { convertCostAdjustmentForPrint, mapCostAdjustmentToPrintData, mapCostAdjustmentLineItems } from '../../lib/print/cost-adjustment-print-helper';\r\nimport { useStoreInfoStore } from '../settings/store-info/store-info-store';\r\n\r\nexport function CostAdjustmentListPage() {\r\n  const router = useRouter();\r\n  const { data: adjustments, cancel, confirm } = useCostAdjustmentStore();\r\n  const { employee } = useAuth();\r\n  const isMobile = !useMediaQuery(\"(min-width: 768px)\");\r\n  \r\n  // Print\r\n  const { print, printMultiple } = usePrint();\r\n  const { data: branches, findById: getBranchById } = useBranchStore();\r\n  const { info: storeInfo } = useStoreInfoStore();\r\n  const [printDialogOpen, setPrintDialogOpen] = React.useState(false);\r\n  const [itemsToPrint, setItemsToPrint] = React.useState<CostAdjustment[]>([]);\r\n\r\n  // Single print handler (for dropdown action)\r\n  const handleSinglePrint = React.useCallback((adjustment: CostAdjustment) => {\r\n    const storeSettings = {\r\n      name: storeInfo?.companyName || storeInfo?.brandName || '',\r\n      address: storeInfo?.headquartersAddress || '',\r\n      phone: storeInfo?.hotline || '',\r\n      email: storeInfo?.email || '',\r\n      website: storeInfo?.website,\r\n      taxCode: storeInfo?.taxCode,\r\n      province: storeInfo?.province,\r\n      logo: storeInfo?.logo,\r\n    };\r\n    const printData = convertCostAdjustmentForPrint(adjustment, {\r\n      creatorName: adjustment.createdByName,\r\n    });\r\n    print('cost-adjustment', {\r\n      data: mapCostAdjustmentToPrintData(printData, storeSettings),\r\n      lineItems: mapCostAdjustmentLineItems(printData.items),\r\n    });\r\n  }, [storeInfo, print]);\r\n\r\n  // Columns memoized with callbacks\r\n  const columns = React.useMemo(\r\n    () => getColumns((path: string) => router.push(path), handleSinglePrint),\r\n    [router, handleSinglePrint]\r\n  );\r\n  \r\n  // Confirm dialog state\r\n  const [confirmDialogState, setConfirmDialogState] = React.useState<{\r\n    type: 'bulk-cancel' | 'bulk-confirm';\r\n    items: CostAdjustment[];\r\n  } | null>(null);\r\n  const [isConfirmLoading, setIsConfirmLoading] = React.useState(false);\r\n  \r\n  // Table state\r\n  const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({});\r\n  const [sorting, setSorting] = React.useState<{ id: string, desc: boolean }>({ id: 'createdAt', desc: true });\r\n  const [globalFilter, setGlobalFilter] = React.useState('');\r\n  const [debouncedGlobalFilter, setDebouncedGlobalFilter] = React.useState('');\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 40 });\r\n  const [expanded, setExpanded] = React.useState<Record<string, boolean>>({});\r\n  \r\n  // Filters\r\n  const [statusFilter, setStatusFilter] = React.useState<Set<string>>(new Set());\r\n  const [dateFilter, setDateFilter] = React.useState<[string | undefined, string | undefined] | undefined>();\r\n\r\n  // Import/Export dialogs\r\n  const [showImportDialog, setShowImportDialog] = React.useState(false);\r\n  const [showExportDialog, setShowExportDialog] = React.useState(false);\r\n\r\n  // Column customization state - visibility, order, pinned from hooks (synced to database)\r\n  const [columnVisibility, setColumnVisibility] = useColumnVisibility('cost-adjustments', {});\r\n  const [columnOrder, setColumnOrder] = useColumnOrder('cost-adjustments', []);\r\n  const [pinnedColumns, setPinnedColumns] = usePinnedColumns('cost-adjustments', []);\r\n\r\n  // Debounce search\r\n  React.useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedGlobalFilter(globalFilter);\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [globalFilter]);\r\n\r\n  // Page header\r\n  const headerActions = React.useMemo(() => [\r\n    <Button key=\"add\" className=\"h-9\" onClick={() => router.push('/cost-adjustments/new')}>\r\n      <Plus className=\"mr-2 h-4 w-4\" />\r\n      Tạo phiếu điều chỉnh\r\n    </Button>\r\n  ], [router]);\r\n\r\n  usePageHeader({\r\n    title: 'Danh sách điều chỉnh giá vốn',\r\n    breadcrumb: [\r\n      { label: 'Trang chủ', href: ROUTES.ROOT, isCurrent: false },\r\n      { label: 'Điều chỉnh giá vốn', href: '/cost-adjustments', isCurrent: true },\r\n    ],\r\n    actions: headerActions,\r\n    showBackButton: false,\r\n  });\r\n\r\n  // Column defaults\r\n  const buildDefaultVisibility = React.useCallback(() => {\r\n    const defaultVisibleColumns = new Set([\r\n      'id', 'referenceCode', 'createdDate', 'status', 'itemCount', \r\n      'totalOldValue', 'totalNewValue', 'difference', 'createdByName', 'reason'\r\n    ]);\r\n    const initialVisibility: Record<string, boolean> = {};\r\n    columns.forEach(c => {\r\n      if (!c.id) return;\r\n      if (c.id === 'select' || c.id === 'actions') {\r\n        initialVisibility[c.id] = true;\r\n        return;\r\n      }\r\n      initialVisibility[c.id] = defaultVisibleColumns.has(c.id);\r\n    });\r\n    return initialVisibility;\r\n  }, [columns]);\r\n\r\n  const buildDefaultOrder = React.useCallback(() => (\r\n    columns.map(c => c.id).filter(Boolean) as string[]\r\n  ), [columns]);\r\n\r\n  // Prevent repeated initialization loops for column state\r\n  const hasInitializedVisibility = React.useRef(false);\r\n\r\n  React.useEffect(() => {\r\n    if (columns.length === 0) return;\r\n    if (hasInitializedVisibility.current) return;\r\n    hasInitializedVisibility.current = true;\r\n    // Only set defaults if current state is empty\r\n    if (Object.keys(columnVisibility).length === 0) {\r\n      setColumnVisibility(buildDefaultVisibility());\r\n    }\r\n    if (columnOrder.length === 0) {\r\n      setColumnOrder(buildDefaultOrder());\r\n    }\r\n    if (!pinnedColumns || pinnedColumns.length === 0) {\r\n      setPinnedColumns([]);\r\n    }\r\n  }, [columns, buildDefaultOrder, buildDefaultVisibility, columnVisibility, columnOrder, pinnedColumns, setColumnVisibility, setColumnOrder, setPinnedColumns]);\r\n\r\n  const resetColumnLayout = React.useCallback(() => {\r\n    setColumnVisibility(buildDefaultVisibility());\r\n    setColumnOrder(buildDefaultOrder());\r\n    setPinnedColumns([]);\r\n    // Storage keys are managed by hooks internally\r\n    toast.success('Đã khôi phục bố cục cột mặc định');\r\n  }, [buildDefaultVisibility, buildDefaultOrder, setColumnVisibility, setColumnOrder, setPinnedColumns]);\r\n\r\n  // Fuse search\r\n  const fuseInstance = React.useMemo(() => {\r\n    return new Fuse(adjustments, {\r\n      keys: ['id', 'createdByName', 'reason', 'referenceCode'],\r\n      threshold: 0.3,\r\n      ignoreLocation: true,\r\n    });\r\n  }, [adjustments]);\r\n\r\n  // Filter data\r\n  const filteredData = React.useMemo(() => {\r\n    let filtered = [...adjustments];\r\n\r\n    // Status filter\r\n    if (statusFilter.size > 0) {\r\n      filtered = filtered.filter(a => statusFilter.has(a.status));\r\n    }\r\n\r\n    // Search filter\r\n    if (debouncedGlobalFilter.trim()) {\r\n      fuseInstance.setCollection(filtered);\r\n      filtered = fuseInstance.search(debouncedGlobalFilter.trim()).map(r => r.item);\r\n    }\r\n\r\n    // Date filter\r\n    if (dateFilter && (dateFilter[0] || dateFilter[1])) {\r\n      const [start, end] = dateFilter;\r\n      const startDate = start ? getStartOfDay(start) : null;\r\n      const endDate = end ? getEndOfDay(end) : null;\r\n      \r\n      filtered = filtered.filter(a => {\r\n        const rowDate = new Date(a.createdDate);\r\n        if (!isValidDate(rowDate)) return false;\r\n        if (startDate && !endDate) return isDateAfter(rowDate, startDate) || isDateSame(rowDate, startDate);\r\n        if (!startDate && endDate) return isDateBefore(rowDate, endDate) || isDateSame(rowDate, endDate);\r\n        if (startDate && endDate) return isDateBetween(rowDate, startDate, endDate);\r\n        return true;\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [adjustments, statusFilter, debouncedGlobalFilter, dateFilter, fuseInstance]);\r\n\r\n  // Reset pagination on filter change\r\n  React.useEffect(() => {\r\n    setPagination(p => ({ ...p, pageIndex: 0 }));\r\n  }, [debouncedGlobalFilter, statusFilter, dateFilter]);\r\n\r\n  // Sorting\r\n  const sortedData = React.useMemo(() => {\r\n    const sorted = [...filteredData];\r\n    if (sorting.id) {\r\n      sorted.sort((a, b) => {\r\n        const aValue = (a as any)[sorting.id];\r\n        const bValue = (b as any)[sorting.id];\r\n        if (aValue === null || aValue === undefined) return 1;\r\n        if (bValue === null || bValue === undefined) return -1;\r\n        // Special handling for date columns\r\n        if (sorting.id === 'createdAt' || sorting.id === 'createdDate') {\r\n          const aTime = aValue ? new Date(aValue).getTime() : 0;\r\n          const bTime = bValue ? new Date(bValue).getTime() : 0;\r\n          return sorting.desc ? bTime - aTime : aTime - bTime;\r\n        }\r\n        if (aValue < bValue) return sorting.desc ? 1 : -1;\r\n        if (aValue > bValue) return sorting.desc ? -1 : 1;\r\n        return 0;\r\n      });\r\n    }\r\n    return sorted;\r\n  }, [filteredData, sorting]);\r\n\r\n  // Pagination\r\n  const pageCount = Math.ceil(sortedData.length / pagination.pageSize);\r\n  const paginatedData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    const end = start + pagination.pageSize;\r\n    return sortedData.slice(start, end);\r\n  }, [sortedData, pagination]);\r\n\r\n  // Selection\r\n  const allSelectedRows = React.useMemo(() =>\r\n    adjustments.filter(a => rowSelection[a.systemId]),\r\n  [adjustments, rowSelection]);\r\n\r\n  // Selected adjustments for export\r\n  const selectedAdjustments = React.useMemo(() => {\r\n    return adjustments.filter(a => rowSelection[a.systemId]);\r\n  }, [adjustments, rowSelection]);\r\n\r\n  // Import handler - CostAdjustment requires special handling via create() method\r\n  const handleImport = React.useCallback(async (\r\n    importedAdjustments: Partial<CostAdjustment>[],\r\n    mode: 'insert-only' | 'update-only' | 'upsert',\r\n    _branchId?: string\r\n  ) => {\r\n    let addedCount = 0;\r\n    let skippedCount = 0;\r\n    const errors: Array<{ row: number; message: string }> = [];\r\n    \r\n    const storeState = useCostAdjustmentStore.getState();\r\n    const creatorSystemId = employee?.systemId || asSystemId('SYSTEM');\r\n    const creatorName = employee?.fullName || 'Hệ thống';\r\n    \r\n    importedAdjustments.forEach((adjustment, index) => {\r\n      try {\r\n        // Check if exists by business ID\r\n        const existing = storeState.getByBusinessId(adjustment.id?.toString() || '');\r\n        \r\n        if (existing) {\r\n          // CostAdjustment doesn't support update via import\r\n          skippedCount++;\r\n        } else {\r\n          if (mode === 'insert-only' || mode === 'upsert') {\r\n            // Create new adjustment using store's create method\r\n            if (adjustment.items && adjustment.items.length > 0) {\r\n              storeState.create(\r\n                adjustment.items.map(item => ({\r\n                  productSystemId: item.productSystemId,\r\n                  productId: item.productId,\r\n                  productName: item.productName,\r\n                  productImage: item.productImage,\r\n                  oldCostPrice: item.oldCostPrice,\r\n                  newCostPrice: item.newCostPrice,\r\n                  reason: item.reason,\r\n                })),\r\n                adjustment.type || 'manual',\r\n                creatorSystemId,\r\n                creatorName,\r\n                {\r\n                  customId: adjustment.id?.toString(),\r\n                  note: adjustment.note,\r\n                  reason: adjustment.reason,\r\n                  referenceCode: adjustment.referenceCode,\r\n                  status: adjustment.status || 'draft',\r\n                }\r\n              );\r\n              addedCount++;\r\n            } else {\r\n              errors.push({ row: index + 1, message: 'Phiếu điều chỉnh cần có ít nhất 1 sản phẩm' });\r\n            }\r\n          } else {\r\n            skippedCount++;\r\n          }\r\n        }\r\n      } catch (error) {\r\n        errors.push({ row: index + 1, message: (error as Error).message });\r\n      }\r\n    });\r\n    \r\n    if (addedCount > 0) {\r\n      toast.success(`Đã import: ${addedCount} phiếu điều chỉnh mới`);\r\n    }\r\n    \r\n    return {\r\n      success: addedCount,\r\n      failed: errors.length,\r\n      inserted: addedCount,\r\n      updated: 0,\r\n      skipped: skippedCount,\r\n      errors,\r\n    };\r\n  }, [adjustments, employee]);\r\n\r\n  // Bulk cancel handler\r\n  const handleBulkCancel = React.useCallback(() => {\r\n    if (allSelectedRows.length === 0) return;\r\n    const draftItems = allSelectedRows.filter(item => item.status === 'draft');\r\n    if (draftItems.length === 0) {\r\n      toast.info('Không có phiếu nào có thể hủy', {\r\n        description: 'Chỉ có thể hủy các phiếu đang ở trạng thái Nháp'\r\n      });\r\n      return;\r\n    }\r\n    setConfirmDialogState({ type: 'bulk-cancel', items: draftItems });\r\n  }, [allSelectedRows]);\r\n\r\n  // Bulk confirm handler\r\n  const handleBulkConfirm = React.useCallback(() => {\r\n    if (allSelectedRows.length === 0) return;\r\n    const draftItems = allSelectedRows.filter(item => item.status === 'draft');\r\n    if (draftItems.length === 0) {\r\n      toast.info('Không có phiếu nào có thể xác nhận', {\r\n        description: 'Chỉ có thể xác nhận các phiếu đang ở trạng thái Nháp'\r\n      });\r\n      return;\r\n    }\r\n    setConfirmDialogState({ type: 'bulk-confirm', items: draftItems });\r\n  }, [allSelectedRows]);\r\n\r\n  // Handle confirm action\r\n  const handleConfirmDialogAction = React.useCallback(async () => {\r\n    if (!confirmDialogState || !employee) return;\r\n    setIsConfirmLoading(true);\r\n    \r\n    try {\r\n      const userSystemId = asSystemId(employee.systemId);\r\n      const userName = employee.fullName || 'Người dùng';\r\n      \r\n      if (confirmDialogState.type === 'bulk-cancel') {\r\n        let successCount = 0;\r\n        confirmDialogState.items.forEach(item => {\r\n          if (cancel(asSystemId(item.systemId), userSystemId, userName, 'Hủy hàng loạt')) {\r\n            successCount++;\r\n          }\r\n        });\r\n        if (successCount > 0) {\r\n          toast.success(`Đã hủy ${successCount} phiếu điều chỉnh`);\r\n        }\r\n      }\r\n      \r\n      if (confirmDialogState.type === 'bulk-confirm') {\r\n        let successCount = 0;\r\n        confirmDialogState.items.forEach(item => {\r\n          if (confirm(asSystemId(item.systemId), userSystemId, userName)) {\r\n            successCount++;\r\n          }\r\n        });\r\n        if (successCount > 0) {\r\n          toast.success(`Đã xác nhận ${successCount} phiếu điều chỉnh`);\r\n        }\r\n      }\r\n      \r\n      setRowSelection({});\r\n    } catch (error) {\r\n      toast.error('Không thể hoàn tất hành động');\r\n    } finally {\r\n      setIsConfirmLoading(false);\r\n      setConfirmDialogState(null);\r\n    }\r\n  }, [confirmDialogState, employee, cancel, confirm]);\r\n\r\n  // Bulk print handler\r\n  const handleBulkPrint = React.useCallback(() => {\r\n    if (allSelectedRows.length === 0) return;\r\n    setItemsToPrint(allSelectedRows);\r\n    setPrintDialogOpen(true);\r\n  }, [allSelectedRows]);\r\n\r\n  // Handle print confirm\r\n  const handlePrintConfirm = React.useCallback((result: SimplePrintOptionsResult) => {\r\n    if (itemsToPrint.length === 0) return;\r\n    \r\n    const branch = result.branchSystemId ? getBranchById(result.branchSystemId) : null;\r\n    const storeSettings = {\r\n      name: storeInfo?.companyName || storeInfo?.brandName || '',\r\n      address: storeInfo?.headquartersAddress || '',\r\n      phone: storeInfo?.hotline || '',\r\n      email: storeInfo?.email || '',\r\n      website: storeInfo?.website,\r\n      taxCode: storeInfo?.taxCode,\r\n      province: storeInfo?.province,\r\n      logo: storeInfo?.logo,\r\n    };\r\n\r\n    const printOptionsList = itemsToPrint.map(adjustment => {\r\n      const printData = convertCostAdjustmentForPrint(adjustment, { \r\n        branch,\r\n        creatorName: adjustment.createdByName,\r\n      });\r\n      return {\r\n        data: mapCostAdjustmentToPrintData(printData, storeSettings),\r\n        lineItems: mapCostAdjustmentLineItems(printData.items),\r\n        paperSize: result.paperSize,\r\n      };\r\n    });\r\n\r\n    printMultiple('cost-adjustment', printOptionsList);\r\n    setPrintDialogOpen(false);\r\n    setItemsToPrint([]);\r\n    setRowSelection({});\r\n    toast.success(`Đang in ${itemsToPrint.length} phiếu điều chỉnh giá vốn`);\r\n  }, [itemsToPrint, getBranchById, storeInfo, printMultiple]);\r\n\r\n  // Bulk actions\r\n  const bulkActions = React.useMemo(() => [\r\n    {\r\n      label: 'In phiếu',\r\n      icon: Printer,\r\n      onSelect: handleBulkPrint,\r\n    },\r\n    {\r\n      label: 'Xác nhận',\r\n      icon: CheckCircle,\r\n      onSelect: handleBulkConfirm,\r\n    },\r\n    {\r\n      label: 'Hủy phiếu',\r\n      icon: XCircle,\r\n      onSelect: handleBulkCancel,\r\n      variant: 'destructive' as const,\r\n    },\r\n  ], [handleBulkPrint, handleBulkConfirm, handleBulkCancel]);\r\n\r\n  // Confirm dialog copy\r\n  const confirmDialogCopy = React.useMemo(() => {\r\n    if (!confirmDialogState) return null;\r\n    \r\n    if (confirmDialogState.type === 'bulk-cancel') {\r\n      return {\r\n        title: 'Hủy nhiều phiếu điều chỉnh',\r\n        description: `Bạn sắp hủy ${confirmDialogState.items.length} phiếu điều chỉnh giá vốn. Chỉ các phiếu đang ở trạng thái Nháp mới được hủy.`,\r\n        confirmLabel: `Hủy ${confirmDialogState.items.length} phiếu`,\r\n      };\r\n    }\r\n    \r\n    if (confirmDialogState.type === 'bulk-confirm') {\r\n      return {\r\n        title: 'Xác nhận nhiều phiếu điều chỉnh',\r\n        description: `Bạn sắp xác nhận ${confirmDialogState.items.length} phiếu điều chỉnh giá vốn. Sau khi xác nhận, giá vốn sản phẩm sẽ được cập nhật.`,\r\n        confirmLabel: `Xác nhận ${confirmDialogState.items.length} phiếu`,\r\n      };\r\n    }\r\n    \r\n    return null;\r\n  }, [confirmDialogState]);\r\n\r\n  // Filter options\r\n  const statusOptions = React.useMemo(() => [\r\n    { value: 'draft', label: 'Nháp' },\r\n    { value: 'confirmed', label: 'Đã xác nhận' },\r\n    { value: 'cancelled', label: 'Đã hủy' },\r\n  ], []);\r\n\r\n  // Export config\r\n  const exportConfig = {\r\n    fileName: 'Danh_sach_dieu_chinh_gia_von',\r\n    columns,\r\n  };\r\n\r\n  // Row click handler\r\n  const handleRowClick = (row: CostAdjustment) => {\r\n    router.push(`/cost-adjustments/${row.systemId}`);\r\n  };\r\n\r\n  // Actions for mobile card - navigate to detail page for confirm/cancel\r\n  const handleConfirm = React.useCallback((systemId: string) => {\r\n    router.push(`/cost-adjustments/${systemId}`);\r\n    toast.info('Mở trang chi tiết để xác nhận phiếu');\r\n  }, [router]);\r\n\r\n  const handleCancel = React.useCallback((systemId: string) => {\r\n    router.push(`/cost-adjustments/${systemId}`);\r\n    toast.info('Mở trang chi tiết để hủy phiếu');\r\n  }, [router]);\r\n\r\n  return (\r\n    <div className=\"flex flex-col w-full h-full\">\r\n      {/* PageToolbar - Desktop only */}\r\n      {!isMobile && (\r\n        <PageToolbar\r\n          leftActions={\r\n            <>\r\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setShowImportDialog(true)}>\r\n                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\r\n                Nhập file\r\n              </Button>\r\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setShowExportDialog(true)}>\r\n                <Download className=\"mr-2 h-4 w-4\" />\r\n                Xuất Excel\r\n              </Button>\r\n            </>\r\n          }\r\n          rightActions={\r\n            <DataTableColumnCustomizer\r\n              columns={columns}\r\n              columnVisibility={columnVisibility}\r\n              setColumnVisibility={setColumnVisibility}\r\n              columnOrder={columnOrder}\r\n              setColumnOrder={setColumnOrder}\r\n              pinnedColumns={pinnedColumns}\r\n              setPinnedColumns={setPinnedColumns}\r\n              onResetToDefault={resetColumnLayout}\r\n            />\r\n          }\r\n        />\r\n      )}\r\n\r\n      {/* PageFilters */}\r\n      <PageFilters\r\n        searchValue={globalFilter}\r\n        onSearchChange={setGlobalFilter}\r\n        searchPlaceholder=\"Tìm kiếm phiếu điều chỉnh...\"\r\n      >\r\n        <DataTableFacetedFilter\r\n          title=\"Trạng thái\"\r\n          options={statusOptions}\r\n          selectedValues={statusFilter}\r\n          onSelectedValuesChange={setStatusFilter}\r\n        />\r\n      </PageFilters>\r\n\r\n      {/* Data Table */}\r\n      <div className=\"w-full py-4\">\r\n        <ResponsiveDataTable\r\n          columns={columns}\r\n          data={paginatedData}\r\n          renderMobileCard={(adjustment) => (\r\n            <CostAdjustmentCard \r\n              adjustment={adjustment} \r\n              onConfirm={handleConfirm}\r\n              onCancel={handleCancel}\r\n            />\r\n          )}\r\n          pageCount={pageCount}\r\n          pagination={pagination}\r\n          setPagination={setPagination}\r\n          rowCount={filteredData.length}\r\n          rowSelection={rowSelection}\r\n          setRowSelection={setRowSelection}\r\n          allSelectedRows={allSelectedRows}\r\n          bulkActions={bulkActions}\r\n          showBulkDeleteButton={false}\r\n          expanded={expanded}\r\n          setExpanded={setExpanded}\r\n          sorting={sorting}\r\n          setSorting={setSorting as React.Dispatch<React.SetStateAction<{ id: string; desc: boolean }>>}\r\n          columnVisibility={columnVisibility}\r\n          setColumnVisibility={setColumnVisibility}\r\n          columnOrder={columnOrder}\r\n          setColumnOrder={setColumnOrder}\r\n          pinnedColumns={pinnedColumns}\r\n          setPinnedColumns={setPinnedColumns}\r\n          onRowClick={handleRowClick}\r\n        />\r\n      </div>\r\n\r\n      {/* Confirm Dialog */}\r\n      <AlertDialog open={!!confirmDialogState} onOpenChange={(open) => {\r\n        if (!open && !isConfirmLoading) {\r\n          setConfirmDialogState(null);\r\n        }\r\n      }}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>{confirmDialogCopy?.title}</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              {confirmDialogCopy?.description}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel className=\"h-9\" disabled={isConfirmLoading}>\r\n              Đóng\r\n            </AlertDialogCancel>\r\n            <AlertDialogAction\r\n              className=\"h-9\"\r\n              disabled={isConfirmLoading}\r\n              onClick={handleConfirmDialogAction}\r\n            >\r\n              {isConfirmLoading ? 'Đang xử lý...' : confirmDialogCopy?.confirmLabel ?? 'Đồng ý'}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Print Options Dialog */}\r\n      <SimplePrintOptionsDialog\r\n        open={printDialogOpen}\r\n        onOpenChange={setPrintDialogOpen}\r\n        selectedCount={itemsToPrint.length}\r\n        onConfirm={handlePrintConfirm}\r\n        title=\"In phiếu điều chỉnh giá vốn\"\r\n      />\r\n\r\n      {/* Import Dialog */}\r\n      <GenericImportDialogV2<CostAdjustment>\r\n        open={showImportDialog}\r\n        onOpenChange={setShowImportDialog}\r\n        config={costAdjustmentImportExportConfig}\r\n        branches={branches.map(b => ({ systemId: b.systemId, name: b.name }))}\r\n        existingData={adjustments}\r\n        onImport={handleImport}\r\n        currentUser={{\r\n          name: employee?.fullName || 'Hệ thống',\r\n          systemId: employee?.systemId || asSystemId('SYSTEM'),\r\n        }}\r\n      />\r\n\r\n      {/* Export Dialog */}\r\n      <GenericExportDialogV2<CostAdjustment>\r\n        open={showExportDialog}\r\n        onOpenChange={setShowExportDialog}\r\n        config={costAdjustmentImportExportConfig}\r\n        allData={adjustments}\r\n        filteredData={sortedData}\r\n        currentPageData={paginatedData}\r\n        selectedData={selectedAdjustments}\r\n        currentUser={{\r\n          name: employee?.fullName || 'Hệ thống',\r\n          systemId: employee?.systemId || asSystemId('SYSTEM'),\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}