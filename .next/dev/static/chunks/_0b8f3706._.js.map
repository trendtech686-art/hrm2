{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/id-utils.ts"],"sourcesContent":["/**\r\n * ID Utilities\r\n * Helpers for generating and validating IDs (systemId & business id)\r\n */\r\n\r\nimport { getPrefix, type EntityType } from './smart-prefix';\r\nimport { ID_CONFIG } from './id-config';\r\n\r\n// Re-export EntityType for convenience\r\nexport type { EntityType } from './smart-prefix';\r\n\r\n/**\r\n * Generate SystemId (6 digits, immutable, internal use only)\r\n * Format: SYSTEMID_PREFIX + 6 digits (e.g., \"EMP000001\", \"CUSTOMER000001\", \"ORDER000001\")\r\n * Uses systemIdPrefix from ID_CONFIG (English full words)\r\n */\r\nexport function generateSystemId(entityType: EntityType, counter: number): string {\r\n  const config = ID_CONFIG[entityType];\r\n  if (!config) {\r\n    throw new Error(`No configuration found for entity type: ${entityType}`);\r\n  }\r\n  const prefix = config.systemIdPrefix;\r\n  const digitCount = config.digitCount || 6;\r\n  return `${prefix}${String(counter).padStart(digitCount, '0')}`;\r\n}\r\n\r\n/**\r\n * Generate Business ID (6 digits, user-facing, editable)\r\n * Format: PREFIX + 6 digits (e.g., \"NV000001\", \"KH000001\", \"CTV000001\")\r\n * All entities use same 6-digit format for consistency\r\n * \r\n * @param entityType - Entity type from smart-prefix\r\n * @param counter - Current counter value\r\n * @param customId - Optional custom ID from user input\r\n * @returns Generated ID or validated custom ID\r\n */\r\nexport function generateBusinessId(\r\n  entityType: EntityType, \r\n  counter: number,\r\n  customId?: string\r\n): string {\r\n  // If user provided custom ID, validate and return it\r\n  if (customId && customId.trim()) {\r\n    const sanitized = sanitizeBusinessId(customId);\r\n    if (!sanitized) {\r\n      throw new Error('Mã không hợp lệ! Chỉ được phép sử dụng chữ cái và số.');\r\n    }\r\n    return sanitized;\r\n  }\r\n  \r\n  // Otherwise, auto-generate\r\n  const prefix = getPrefix(entityType);\r\n  return `${prefix}${String(counter).padStart(6, '0')}`;\r\n}\r\n\r\n/**\r\n * Sanitize business ID\r\n * - Remove special characters (keep only letters and numbers)\r\n * - Convert to uppercase\r\n * - Trim whitespace\r\n * \r\n * @param id - Raw user input\r\n * @returns Sanitized ID or null if invalid\r\n */\r\nexport function sanitizeBusinessId(id: string): string | null {\r\n  if (!id || typeof id !== 'string') return null;\r\n  \r\n  // Remove all special characters, keep only alphanumeric\r\n  const cleaned = id.trim().replace(/[^a-zA-Z0-9]/g, '');\r\n  \r\n  if (!cleaned) return null;\r\n  \r\n  // Convert to uppercase for consistency\r\n  return cleaned.toUpperCase();\r\n}\r\n\r\n/**\r\n * Validate business ID uniqueness (case-insensitive)\r\n * \r\n * @param id - ID to check\r\n * @param existingIds - Array of existing IDs in the system\r\n * @param currentId - Current ID (for edit mode, to exclude self)\r\n * @returns true if unique, false if duplicate\r\n */\r\nexport function isBusinessIdUnique(\r\n  id: string,\r\n  existingIds: string[],\r\n  currentId?: string\r\n): boolean {\r\n  if (!id) return false;\r\n  \r\n  const normalizedId = id.toUpperCase();\r\n  const normalizedCurrentId = currentId?.toUpperCase();\r\n  \r\n  return !existingIds.some(existingId => {\r\n    // ✅ Filter out empty/undefined IDs\r\n    if (!existingId || existingId.trim() === '') return false;\r\n    \r\n    const normalizedExisting = existingId.toUpperCase();\r\n    // Skip self-comparison in edit mode\r\n    if (normalizedCurrentId && normalizedExisting === normalizedCurrentId) {\r\n      return false;\r\n    }\r\n    return normalizedExisting === normalizedId;\r\n  });\r\n}\r\n\r\n/**\r\n * Extract counter from system ID\r\n * Used to initialize counter when loading from localStorage\r\n * Supports both 6, 7 and 8 digits\r\n * \r\n * @param systemId - System ID to parse (e.g., \"EMP000001\", \"CUSTOMER000001\", \"WARRANTY0000001\")\r\n * @param prefix - Expected systemIdPrefix (e.g., \"EMP\", \"CUSTOMER\", \"WARRANTY\")\r\n * @returns Counter value or 0 if invalid\r\n */\r\nexport function extractCounterFromSystemId(systemId: string, prefix: string): number {\r\n  if (!systemId || typeof systemId !== 'string') return 0;\r\n  \r\n  // Try different digit counts (most entities use 6 digits, some use 7-8)\r\n  const regex8 = new RegExp(`^${prefix}(\\\\d{8})$`);\r\n  const regex7 = new RegExp(`^${prefix}(\\\\d{7})$`);\r\n  const regex6 = new RegExp(`^${prefix}(\\\\d{6})$`);\r\n  \r\n  const match8 = systemId.match(regex8);\r\n  if (match8) return parseInt(match8[1], 10);\r\n  \r\n  const match7 = systemId.match(regex7);\r\n  if (match7) return parseInt(match7[1], 10);\r\n  \r\n  const match6 = systemId.match(regex6);\r\n  if (match6) return parseInt(match6[1], 10);\r\n  \r\n  return 0;\r\n}\r\n\r\n/**\r\n * Extract counter from business ID\r\n * Used to initialize counter when loading from localStorage\r\n * \r\n * @param businessId - Business ID to parse (e.g., \"NV000001\")\r\n * @param prefix - Expected prefix (e.g., \"NV\")\r\n * @returns Counter value or 0 if invalid\r\n */\r\nexport function extractCounterFromBusinessId(businessId: string, prefix: string): number {\r\n  if (!businessId || typeof businessId !== 'string') return 0;\r\n  const regex = new RegExp(`^${prefix}(\\\\d+)$`);\r\n  const match = businessId.match(regex);\r\n  return match ? parseInt(match[1], 10) : 0;\r\n}\r\n\r\n/**\r\n * Get max counter from array of items (for systemId)\r\n * \r\n * @param items - Array of items with systemId\r\n * @param prefix - Prefix to match\r\n * @returns Maximum counter value\r\n */\r\nexport function getMaxSystemIdCounter<T extends { systemId: string }>(\r\n  items: T[],\r\n  prefix: string\r\n): number {\r\n  if (!items || !Array.isArray(items)) return 0;\r\n  \r\n  let maxCounter = 0;\r\n  \r\n  items.forEach(item => {\r\n    if (!item || !item.systemId) return;\r\n    const counter = extractCounterFromSystemId(item.systemId, prefix);\r\n    if (counter > maxCounter) {\r\n      maxCounter = counter;\r\n    }\r\n  });\r\n  \r\n  return maxCounter;\r\n}\r\n\r\n/**\r\n * Get max counter from array of items (for business id)\r\n * Only counts auto-generated IDs (PREFIX + digits)\r\n * \r\n * @param items - Array of items with id\r\n * @param prefix - Prefix to match\r\n * @returns Maximum counter value\r\n */\r\nexport function getMaxBusinessIdCounter<T extends { id: string }>(\r\n  items: T[],\r\n  prefix: string\r\n): number {\r\n  if (!items || !Array.isArray(items)) return 0;\r\n  \r\n  let maxCounter = 0;\r\n  \r\n  items.forEach(item => {\r\n    if (!item || !item.id) return;\r\n    const counter = extractCounterFromBusinessId(item.id, prefix);\r\n    if (counter > maxCounter) {\r\n      maxCounter = counter;\r\n    }\r\n  });\r\n  \r\n  return maxCounter;\r\n}\r\n\r\n/**\r\n * Format ID for display\r\n * Adds spacing for readability\r\n * \r\n * @param id - ID to format\r\n * @returns Formatted ID (e.g., \"NV-000001\", \"KH-000123\")\r\n */\r\nexport function formatIdForDisplay(id: string): string {\r\n  // Match pattern: PREFIX followed by numbers\r\n  const match = id.match(/^([A-Z]+)(\\d+)$/);\r\n  if (!match) return id;\r\n  \r\n  const [, prefix, numbers] = match;\r\n  return `${prefix}-${numbers}`;\r\n}\r\n\r\n/**\r\n * Validate ID format\r\n * Check if ID follows valid pattern (letters + numbers only)\r\n * \r\n * @param id - ID to validate\r\n * @returns true if valid format\r\n */\r\nexport function isValidIdFormat(id: string): boolean {\r\n  if (!id || typeof id !== 'string') return false;\r\n  \r\n  // Only alphanumeric characters allowed\r\n  const regex = /^[A-Z0-9]+$/i;\r\n  return regex.test(id);\r\n}\r\n\r\n/**\r\n * Generate suggested IDs based on entity type\r\n * Useful for autocomplete or placeholder text\r\n * \r\n * @param entityType - Entity type\r\n * @param counter - Current counter\r\n * @param count - Number of suggestions\r\n * @returns Array of suggested IDs\r\n */\r\nexport function generateSuggestedIds(\r\n  entityType: EntityType,\r\n  counter: number,\r\n  count: number = 3\r\n): string[] {\r\n  const suggestions: string[] = [];\r\n  const prefix = getPrefix(entityType);\r\n  \r\n  for (let i = 0; i < count; i++) {\r\n    suggestions.push(`${prefix}${String(counter + i + 1).padStart(6, '0')}`);\r\n  }\r\n  \r\n  return suggestions;\r\n}\r\n\r\n/**\r\n * ✨ Find next available business ID\r\n * Checks existing IDs and increments counter until finding a unique ID\r\n * \r\n * @param prefix - ID prefix (e.g., 'PT', 'PC', 'NV')\r\n * @param existingIds - Array of existing business IDs\r\n * @param startCounter - Starting counter value\r\n * @param digitCount - Number of digits (default: 6)\r\n * @returns Object with nextId and updatedCounter\r\n */\r\nexport function findNextAvailableBusinessId(\r\n  prefix: string,\r\n  existingIds: string[],\r\n  startCounter: number,\r\n  digitCount: number = 6\r\n): { nextId: string; updatedCounter: number } {\r\n  let counter = startCounter;\r\n  let nextId: string;\r\n  \r\n  // Keep incrementing until we find a unique ID\r\n  do {\r\n    counter++;\r\n    nextId = `${prefix}${String(counter).padStart(digitCount, '0')}`;\r\n  } while (existingIds.some(id => id === nextId));\r\n  \r\n  return {\r\n    nextId,\r\n    updatedCounter: counter\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/id-types.ts"],"sourcesContent":["/**\r\n * Type-safe ID System\r\n * \r\n * Prevents mixing systemId with business ID at compile time\r\n */\r\n\r\n// Branded types for type safety\r\nexport type SystemId = string & { readonly __brand: 'SystemId' };\r\nexport type BusinessId = string & { readonly __brand: 'BusinessId' };\r\n\r\n/**\r\n * Create a SystemId from a string\r\n * Use this when you know for sure it's a systemId\r\n */\r\nexport function asSystemId(id: string): SystemId {\r\n  return id as SystemId;\r\n}\r\n\r\n/**\r\n * Create a BusinessId from a string\r\n * Use this when you know for sure it's a business ID\r\n */\r\nexport function asBusinessId(id: string): BusinessId {\r\n  return id as BusinessId;\r\n}\r\n\r\n/**\r\n * Check if a string is a valid systemId format\r\n */\r\nexport function isSystemIdFormat(id: string): boolean {\r\n  // SystemId: 8 digits + prefix (e.g., NV00000001, VOUCHER00000123)\r\n  return /^[A-Z]+\\d{8}$/.test(id);\r\n}\r\n\r\n/**\r\n * Check if a string is a valid business ID format\r\n */\r\nexport function isBusinessIdFormat(id: string): boolean {\r\n  // Business ID: shorter, variable length (e.g., NV001, PT000001)\r\n  return /^[A-Z]+\\d{3,6}$/.test(id);\r\n}\r\n\r\n/**\r\n * Safely convert unknown ID to proper type\r\n */\r\nexport function parseId(id: string): { type: 'system' | 'business'; value: SystemId | BusinessId } {\r\n  if (isSystemIdFormat(id)) {\r\n    return { type: 'system', value: asSystemId(id) };\r\n  }\r\n  if (isBusinessIdFormat(id)) {\r\n    return { type: 'business', value: asBusinessId(id) };\r\n  }\r\n  throw new Error(`Invalid ID format: ${id}`);\r\n}\r\n\r\n/**\r\n * ID Pair - Always keep systemId and businessId together\r\n */\r\nexport interface IDPair {\r\n  systemId: SystemId;\r\n  businessId: BusinessId;\r\n}\r\n\r\n/**\r\n * Entity with dual IDs\r\n */\r\nexport interface DualIDEntity {\r\n  systemId: SystemId;\r\n  id: BusinessId;\r\n}\r\n\r\n/**\r\n * Store methods with type-safe IDs\r\n */\r\nexport interface TypeSafeStore<T extends DualIDEntity> {\r\n  /** Find by systemId (for queries, relationships) */\r\n  findBySystemId(systemId: SystemId): T | null;\r\n  \r\n  /** Find by business ID (for user input, display) */\r\n  findByBusinessId(businessId: BusinessId): T | null;\r\n  \r\n  /** Update by systemId (always use systemId for updates) */\r\n  updateBySystemId(systemId: SystemId, updates: Partial<T>): void;\r\n  \r\n  /** Delete by systemId (always use systemId for deletes) */\r\n  deleteBySystemId(systemId: SystemId): void;\r\n}\r\n\r\n/**\r\n * Route params with type-safe IDs\r\n */\r\nexport interface RouteParams {\r\n  systemId?: SystemId;\r\n  id?: BusinessId;\r\n}\r\n\r\n/**\r\n * Link builder - always uses systemId\r\n */\r\nexport function buildEntityLink(path: string, entity: DualIDEntity): string {\r\n  return path.replace(':systemId', entity.systemId);\r\n}\r\n\r\n/**\r\n * Display ID - always uses business ID\r\n */\r\nexport function getDisplayId(entity: DualIDEntity): string {\r\n  return entity.id;\r\n}\r\n\r\n/**\r\n * Runtime guard: ensures a string is valid SystemId format and casts it\r\n * Logs warning if format is invalid\r\n */\r\nexport function ensureSystemId(id: string, context?: string): SystemId {\r\n  if (!isSystemIdFormat(id)) {\r\n    console.warn(`[ensureSystemId] Invalid SystemId format: \"${id}\"${context ? ` in ${context}` : ''}`);\r\n  }\r\n  return asSystemId(id);\r\n}\r\n\r\n/**\r\n * Runtime guard: ensures a string is valid BusinessId format and casts it\r\n * Logs warning if format is invalid\r\n */\r\nexport function ensureBusinessId(id: string, context?: string): BusinessId {\r\n  if (!isBusinessIdFormat(id)) {\r\n    console.warn(`[ensureBusinessId] Invalid BusinessId format: \"${id}\"${context ? ` in ${context}` : ''}`);\r\n  }\r\n  return asBusinessId(id);\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,gCAAgC;;;;;;;;;;;;;;;;;;;;;AAQzB,SAAS,WAAW,EAAU;IACnC,OAAO;AACT;AAMO,SAAS,aAAa,EAAU;IACrC,OAAO;AACT;AAKO,SAAS,iBAAiB,EAAU;IACzC,kEAAkE;IAClE,OAAO,gBAAgB,IAAI,CAAC;AAC9B;AAKO,SAAS,mBAAmB,EAAU;IAC3C,gEAAgE;IAChE,OAAO,kBAAkB,IAAI,CAAC;AAChC;AAKO,SAAS,QAAQ,EAAU;IAChC,IAAI,iBAAiB,KAAK;QACxB,OAAO;YAAE,MAAM;YAAU,OAAO,WAAW;QAAI;IACjD;IACA,IAAI,mBAAmB,KAAK;QAC1B,OAAO;YAAE,MAAM;YAAY,OAAO,aAAa;QAAI;IACrD;IACA,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,IAAI;AAC5C;AA8CO,SAAS,gBAAgB,IAAY,EAAE,MAAoB;IAChE,OAAO,KAAK,OAAO,CAAC,aAAa,OAAO,QAAQ;AAClD;AAKO,SAAS,aAAa,MAAoB;IAC/C,OAAO,OAAO,EAAE;AAClB;AAMO,SAAS,eAAe,EAAU,EAAE,OAAgB;IACzD,IAAI,CAAC,iBAAiB,KAAK;QACzB,QAAQ,IAAI,CAAC,CAAC,2CAA2C,EAAE,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI;IACpG;IACA,OAAO,WAAW;AACpB;AAMO,SAAS,iBAAiB,EAAU,EAAE,OAAgB;IAC3D,IAAI,CAAC,mBAAmB,KAAK;QAC3B,QAAQ,IAAI,CAAC,CAAC,+CAA+C,EAAE,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI;IACxG;IACA,OAAO,aAAa;AACtB"}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/employees/employee-settings-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { EmployeeSettings, LeaveType, SalaryComponent, WorkShift } from './types';\r\nimport { getCurrentUserSystemId } from '../../../contexts/auth-context';\r\nimport { generateSystemId, getMaxBusinessIdCounter, getMaxSystemIdCounter, findNextAvailableBusinessId } from '../../../lib/id-utils';\r\nimport { getPrefix, type EntityType } from '../../../lib/smart-prefix';\r\nimport { getEntityConfig } from '../../../lib/id-config';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '@/lib/id-types';\r\n\r\nconst SETTINGS_ENTITY_MAP = {\r\n  workShifts: 'work-shifts',\r\n  leaveTypes: 'leave-types',\r\n  salaryComponents: 'salary-components',\r\n} as const;\r\n\r\ntype SettingsEntityKey = keyof typeof SETTINGS_ENTITY_MAP;\r\ntype SettingsEntityType = (typeof SETTINGS_ENTITY_MAP)[SettingsEntityKey];\r\n\r\ntype CounterState = {\r\n  systemId: number;\r\n  businessId: number;\r\n};\r\n\r\ntype SettingsCounters = Record<SettingsEntityType, CounterState>;\r\n\r\nconst defaultSettings: EmployeeSettings = {\r\n  workStartTime: '08:30',\r\n  workEndTime: '18:00',\r\n  lunchBreakDuration: 90, // 1.5 giờ = 90 phút\r\n  lunchBreakStart: '12:00',\r\n  lunchBreakEnd: '13:30',\r\n  workingDays: [1, 2, 3, 4, 5, 6], // Thứ 2 - Thứ 7 (Mon-Sat)\r\n  workShifts: [\r\n    {\r\n      systemId: asSystemId('WSHIFT000001'),\r\n      id: asBusinessId('CA000001'),\r\n      name: 'Ca hành chính',\r\n      startTime: '08:30',\r\n      endTime: '18:00',\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('WSHIFT000002'),\r\n      id: asBusinessId('CA000002'),\r\n      name: 'Ca tối',\r\n      startTime: '14:00',\r\n      endTime: '22:00',\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n  ],\r\n  otHourlyRate: 25000,  // 25k/giờ làm thêm ngày thường\r\n  otRateWeekend: 1.5,   // Hệ số x1.5 cuối tuần\r\n  otRateHoliday: 3,     // Hệ số x3 ngày lễ\r\n  allowedLateMinutes: 5, // Sau 5 phút mới tính là đi trễ\r\n  latePenaltyTiers: [\r\n    { fromMinutes: 5, toMinutes: 10, amount: 10000 },   // 5-10 phút: 10k\r\n    { fromMinutes: 10, toMinutes: 30, amount: 20000 },  // 10-30 phút: 20k\r\n    { fromMinutes: 30, toMinutes: 60, amount: 50000 },  // 30-60 phút: 50k\r\n    { fromMinutes: 60, toMinutes: null, amount: 100000 }, // >60 phút: 100k\r\n  ],\r\n  earlyLeavePenaltyTiers: [\r\n    { fromMinutes: 5, toMinutes: 10, amount: 10000 },\r\n    { fromMinutes: 10, toMinutes: 30, amount: 20000 },\r\n    { fromMinutes: 30, toMinutes: 60, amount: 50000 },\r\n    { fromMinutes: 60, toMinutes: null, amount: 100000 },\r\n  ],\r\n  leaveTypes: [\r\n    {\r\n      systemId: asSystemId('LEAVETYPE000001'),\r\n      id: asBusinessId('LP000001'),\r\n      name: 'Nghỉ phép năm',\r\n      numberOfDays: 12,\r\n      isPaid: true,\r\n      requiresAttachment: false,\r\n      applicableGender: 'All',\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('LEAVETYPE000002'),\r\n      id: asBusinessId('LP000002'),\r\n      name: 'Nghỉ bệnh',\r\n      numberOfDays: 7,\r\n      isPaid: true,\r\n      requiresAttachment: true,\r\n      applicableGender: 'All',\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n  ],\r\n  baseAnnualLeaveDays: 12,\r\n  annualLeaveSeniorityBonus: {\r\n    years: 5,\r\n    additionalDays: 1,\r\n  },\r\n  allowRollover: false,\r\n  rolloverExpirationDate: '03-31',\r\n  salaryComponents: [\r\n    // =============================================\r\n    // NHÓM THU NHẬP (EARNINGS)\r\n    // =============================================\r\n    {\r\n      systemId: asSystemId('SALCOMP000001'),\r\n      id: asBusinessId('SC000001'),\r\n      name: 'Lương cơ bản',\r\n      description: 'Lương theo ngày công thực tế = Lương HĐ × (Ngày công / Ngày chuẩn)',\r\n      category: 'earning',\r\n      type: 'formula',\r\n      formula: 'baseSalary * (workDays / standardWorkDays)',\r\n      taxable: true,\r\n      partOfSocialInsurance: true,\r\n      isActive: true,\r\n      sortOrder: 1,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000002'),\r\n      id: asBusinessId('SC000002'),\r\n      name: 'Phụ cấp ăn trưa',\r\n      description: 'Phụ cấp theo ngày công thực tế = Ngày công × Mức tiền/ngày (không tính thuế)',\r\n      category: 'earning',\r\n      type: 'formula',\r\n      formula: 'workDays * mealAllowancePerDay',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 2,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000003'),\r\n      id: asBusinessId('SC000003'),\r\n      name: 'Phụ cấp xăng xe',\r\n      description: 'Phụ cấp đi lại, xăng xe hàng tháng',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 500000,\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 3,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000004'),\r\n      id: asBusinessId('SC000004'),\r\n      name: 'Phụ cấp điện thoại',\r\n      description: 'Phụ cấp liên lạc, điện thoại công việc',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 300000,\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 4,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000005'),\r\n      id: asBusinessId('SC000005'),\r\n      name: 'Phụ cấp chức vụ',\r\n      description: 'Phụ cấp trách nhiệm theo chức vụ quản lý',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 2000000,\r\n      taxable: true,\r\n      partOfSocialInsurance: true,\r\n      isActive: true,\r\n      sortOrder: 5,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000006'),\r\n      id: asBusinessId('SC000006'),\r\n      name: 'Phụ cấp thâm niên',\r\n      description: 'Phụ cấp theo số năm làm việc tại công ty',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 500000,\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 6,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000007'),\r\n      id: asBusinessId('SC000007'),\r\n      name: 'Phụ cấp độc hại',\r\n      description: 'Phụ cấp cho công việc trong môi trường độc hại, nguy hiểm',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 1000000,\r\n      taxable: true,\r\n      partOfSocialInsurance: true,\r\n      isActive: false,\r\n      sortOrder: 7,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000008'),\r\n      id: asBusinessId('SC000008'),\r\n      name: 'Thưởng chuyên cần',\r\n      description: 'Thưởng đi làm đầy đủ, không nghỉ phép trong tháng',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 500000,\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 8,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000009'),\r\n      id: asBusinessId('SC000009'),\r\n      name: 'Thưởng KPI',\r\n      description: 'Thưởng hoàn thành chỉ tiêu KPI tháng',\r\n      category: 'earning',\r\n      type: 'formula',\r\n      formula: '[LUONG_CO_BAN] * 0.1',\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 9,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    // =============================================\r\n    // NHÓM LÀM THÊM GIỜ (OT) - Chi tiết theo loại ngày\r\n    // =============================================\r\n    {\r\n      systemId: asSystemId('SALCOMP000010'),\r\n      id: asBusinessId('SC000010'),\r\n      name: 'Làm thêm ngày thường',\r\n      description: 'Tiền làm thêm sau giờ tan làm (18:00) các ngày trong tuần. Công thức: Giờ OT x Tiền/giờ',\r\n      category: 'earning',\r\n      type: 'formula',\r\n      formula: 'otPayWeekday',\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 10,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000020'),\r\n      id: asBusinessId('SC000020'),\r\n      name: 'Làm thêm cuối tuần',\r\n      description: 'Tiền làm thêm thứ 7 & Chủ nhật. Công thức: Giờ OT x Tiền/giờ x Hệ số cuối tuần (1.5)',\r\n      category: 'earning',\r\n      type: 'formula',\r\n      formula: 'otPayWeekend',\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 11,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000021'),\r\n      id: asBusinessId('SC000021'),\r\n      name: 'Làm thêm ngày lễ',\r\n      description: 'Tiền làm thêm các ngày lễ. Công thức: Giờ OT x Tiền/giờ x Hệ số ngày lễ (3)',\r\n      category: 'earning',\r\n      type: 'formula',\r\n      formula: 'otPayHoliday',\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 12,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000011'),\r\n      id: asBusinessId('SC000011'),\r\n      name: 'Hoa hồng bán hàng',\r\n      description: 'Hoa hồng theo doanh số bán hàng (áp dụng cho bộ phận Kinh doanh)',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 0,\r\n      taxable: true,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 13,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    // =============================================\r\n    // NHÓM KHẤU TRỪ (DEDUCTIONS)\r\n    // =============================================\r\n    {\r\n      systemId: asSystemId('SALCOMP000012'),\r\n      id: asBusinessId('SC000012'),\r\n      name: 'Khấu trừ đi trễ',\r\n      description: 'Trừ lương theo số lần/phút đi trễ trong tháng',\r\n      category: 'deduction',\r\n      type: 'fixed',\r\n      amount: 0,\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 20,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000013'),\r\n      id: asBusinessId('SC000013'),\r\n      name: 'Khấu trừ nghỉ không phép',\r\n      description: 'Trừ lương theo số ngày nghỉ không phép',\r\n      category: 'deduction',\r\n      type: 'formula',\r\n      formula: '[NGAY_NGHI_KHONG_PHEP] * ([LUONG_CO_BAN] / [NGAY_CONG_CHUAN])',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 21,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000014'),\r\n      id: asBusinessId('SC000014'),\r\n      name: 'Tạm ứng lương',\r\n      description: 'Khấu trừ khoản tạm ứng lương đã nhận trước',\r\n      category: 'deduction',\r\n      type: 'fixed',\r\n      amount: 0,\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 22,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000015'),\r\n      id: asBusinessId('SC000015'),\r\n      name: 'Khấu trừ công nợ',\r\n      description: 'Khấu trừ các khoản nợ công ty (vay, mượn...)',\r\n      category: 'deduction',\r\n      type: 'fixed',\r\n      amount: 0,\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: false,\r\n      sortOrder: 23,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    // =============================================\r\n    // NHÓM ĐÓNG GÓP (CONTRIBUTIONS) - Tự động tính\r\n    // =============================================\r\n    {\r\n      systemId: asSystemId('SALCOMP000016'),\r\n      id: asBusinessId('SC000016'),\r\n      name: 'BHXH (NV đóng)',\r\n      description: 'Bảo hiểm xã hội phần người lao động đóng (8%)',\r\n      category: 'contribution',\r\n      type: 'formula',\r\n      formula: '[LUONG_DONG_BHXH] * 0.08',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 30,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000017'),\r\n      id: asBusinessId('SC000017'),\r\n      name: 'BHYT (NV đóng)',\r\n      description: 'Bảo hiểm y tế phần người lao động đóng (1.5%)',\r\n      category: 'contribution',\r\n      type: 'formula',\r\n      formula: '[LUONG_DONG_BHXH] * 0.015',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 31,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000018'),\r\n      id: asBusinessId('SC000018'),\r\n      name: 'BHTN (NV đóng)',\r\n      description: 'Bảo hiểm thất nghiệp phần người lao động đóng (1%)',\r\n      category: 'contribution',\r\n      type: 'formula',\r\n      formula: '[LUONG_DONG_BHXH] * 0.01',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 32,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n    {\r\n      systemId: asSystemId('SALCOMP000019'),\r\n      id: asBusinessId('SC000019'),\r\n      name: 'Công đoàn phí',\r\n      description: 'Phí công đoàn hàng tháng (1% lương cơ bản)',\r\n      category: 'contribution',\r\n      type: 'formula',\r\n      formula: '[LUONG_CO_BAN] * 0.01',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: false,\r\n      sortOrder: 33,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n  ],\r\n  payrollCycle: 'monthly',\r\n  payday: 5,\r\n  payrollLockDate: 5,\r\n  \r\n  // =============================================\r\n  // CÀI ĐẶT BẢO HIỂM (Luật BHXH 2024)\r\n  // =============================================\r\n  insuranceRates: {\r\n    socialInsurance: {\r\n      employeeRate: 8,      // BHXH NV đóng 8%\r\n      employerRate: 17.5,   // BHXH DN đóng 17.5%\r\n    },\r\n    healthInsurance: {\r\n      employeeRate: 1.5,    // BHYT NV đóng 1.5%\r\n      employerRate: 3,      // BHYT DN đóng 3%\r\n    },\r\n    unemploymentInsurance: {\r\n      employeeRate: 1,      // BHTN NV đóng 1%\r\n      employerRate: 1,      // BHTN DN đóng 1%\r\n    },\r\n    // Trần đóng BHXH = 20 x lương cơ sở (từ 1/7/2024)\r\n    insuranceSalaryCap: 46800000,   // 20 x 2,340,000\r\n    baseSalaryReference: 2340000,    // Lương cơ sở từ 1/7/2024\r\n  },\r\n  \r\n  // =============================================\r\n  // CÀI ĐẶT THUẾ TNCN (Luật thuế TNCN hiện hành)\r\n  // =============================================\r\n  taxSettings: {\r\n    personalDeduction: 11000000,    // Giảm trừ bản thân 11 triệu/tháng\r\n    dependentDeduction: 4400000,    // Giảm trừ mỗi người phụ thuộc 4.4 triệu/tháng\r\n    // Biểu thuế lũy tiến từng phần (theo thu nhập tính thuế/tháng)\r\n    taxBrackets: [\r\n      { fromAmount: 0, toAmount: 5000000, rate: 5 },\r\n      { fromAmount: 5000000, toAmount: 10000000, rate: 10 },\r\n      { fromAmount: 10000000, toAmount: 18000000, rate: 15 },\r\n      { fromAmount: 18000000, toAmount: 32000000, rate: 20 },\r\n      { fromAmount: 32000000, toAmount: 52000000, rate: 25 },\r\n      { fromAmount: 52000000, toAmount: 80000000, rate: 30 },\r\n      { fromAmount: 80000000, toAmount: null, rate: 35 },\r\n    ],\r\n  },\r\n  \r\n  // =============================================\r\n  // LƯƠNG TỐI THIỂU VÙNG (NĐ 74/2024/NĐ-CP từ 1/7/2024)\r\n  // =============================================\r\n  minimumWage: {\r\n    region1: 4960000,   // Vùng I\r\n    region2: 4410000,   // Vùng II\r\n    region3: 3860000,   // Vùng III\r\n    region4: 3450000,   // Vùng IV\r\n  },\r\n  \r\n  // Số ngày công chuẩn trong tháng\r\n  standardWorkDays: 26,\r\n  \r\n  // Phụ cấp ăn trưa theo ngày công\r\n  mealAllowancePerDay: 30000, // 30k/ngày\r\n};\r\n\r\ntype EmployeeSettingsState = {\r\n  settings: EmployeeSettings;\r\n  counters: SettingsCounters;\r\n  initialized: boolean;\r\n  setSettings: (settings: EmployeeSettings) => void;\r\n  getShiftBySystemId: (systemId: SystemId) => WorkShift | undefined;\r\n  getLeaveTypes: () => LeaveType[];\r\n  getSalaryComponents: () => SalaryComponent[];\r\n  getDefaultPayrollWindow: () => {\r\n    cycle: EmployeeSettings['payrollCycle'];\r\n    payday: number;\r\n    lockDate: number;\r\n  };\r\n  loadFromAPI: () => Promise<void>;\r\n};\r\n\r\nconst cloneSettings = (payload?: EmployeeSettings): EmployeeSettings => ({\r\n  ...defaultSettings,\r\n  ...payload,\r\n  annualLeaveSeniorityBonus: {\r\n    ...defaultSettings.annualLeaveSeniorityBonus,\r\n    ...(payload?.annualLeaveSeniorityBonus ?? {}),\r\n  },\r\n  workShifts: (payload?.workShifts ?? defaultSettings.workShifts).map((shift) => ({ ...shift })),\r\n  leaveTypes: (payload?.leaveTypes ?? defaultSettings.leaveTypes).map((type) => ({ ...type })),\r\n  salaryComponents: (payload?.salaryComponents ?? defaultSettings.salaryComponents).map((component) => ({ ...component })),\r\n});\r\n\r\nconst computeCounter = <T extends { systemId?: SystemId; id?: BusinessId }>(\r\n  items: T[],\r\n  entityType: EntityType\r\n): CounterState => {\r\n  const config = getEntityConfig(entityType);\r\n  const systemItems = items\r\n    .filter((item): item is T & { systemId: SystemId } => Boolean(item.systemId))\r\n    .map(({ systemId }) => ({ systemId }));\r\n  const businessItems = items\r\n    .filter((item): item is T & { id: BusinessId } => Boolean(item.id))\r\n    .map(({ id }) => ({ id }));\r\n  return {\r\n    systemId: getMaxSystemIdCounter(systemItems, config.systemIdPrefix),\r\n    businessId: getMaxBusinessIdCounter(businessItems, getPrefix(entityType)),\r\n  };\r\n};\r\n\r\nconst buildCounters = (settings: EmployeeSettings): SettingsCounters => ({\r\n  'work-shifts': computeCounter(settings.workShifts, 'work-shifts'),\r\n  'leave-types': computeCounter(settings.leaveTypes, 'leave-types'),\r\n  'salary-components': computeCounter(settings.salaryComponents, 'salary-components'),\r\n});\r\n\r\ntype BaseSettingsEntity = {\r\n  systemId?: SystemId;\r\n  id?: BusinessId;\r\n  createdAt?: string;\r\n  createdBy?: SystemId;\r\n  updatedAt?: string;\r\n  updatedBy?: SystemId;\r\n  applicableDepartmentSystemIds?: SystemId[];\r\n};\r\n\r\nconst normalizeCollection = <T extends BaseSettingsEntity>(\r\n  items: T[],\r\n  entityType: SettingsEntityType,\r\n  counters: SettingsCounters,\r\n  currentUser?: SystemId\r\n): { records: T[]; counters: SettingsCounters } => {\r\n  let systemCounter = counters[entityType]?.systemId ?? 0;\r\n  let businessCounter = counters[entityType]?.businessId ?? 0;\r\n  const prefix = getPrefix(entityType);\r\n  const config = getEntityConfig(entityType);\r\n  const allKnownIds = new Set<string>(\r\n    items\r\n      .map((item) => item.id?.toUpperCase())\r\n      .filter((id): id is string => Boolean(id))\r\n  );\r\n  const usedIds = new Set<string>();\r\n  const now = new Date().toISOString();\r\n\r\n  const records = items.map((item) => {\r\n    let systemId = item.systemId;\r\n    const hasValidSystemId = Boolean(systemId && systemId.startsWith(config.systemIdPrefix));\r\n    const isNew = !hasValidSystemId;\r\n    if (!hasValidSystemId) {\r\n      systemCounter += 1;\r\n      systemId = asSystemId(generateSystemId(entityType, systemCounter));\r\n    }\r\n\r\n    let businessIdString = item.id ? String(item.id).toUpperCase() : undefined;\r\n    const hasValidBusinessId = Boolean(businessIdString && businessIdString.startsWith(prefix));\r\n    if (!hasValidBusinessId || (businessIdString && usedIds.has(businessIdString))) {\r\n      const { nextId, updatedCounter } = findNextAvailableBusinessId(prefix, Array.from(allKnownIds), businessCounter);\r\n      businessIdString = nextId;\r\n      businessCounter = updatedCounter;\r\n    }\r\n    if (!businessIdString) {\r\n      businessCounter += 1;\r\n      businessIdString = `${prefix}${String(businessCounter).padStart(config.digitCount, '0')}`;\r\n    }\r\n\r\n    allKnownIds.add(businessIdString);\r\n    usedIds.add(businessIdString);\r\n\r\n    const resolvedSystemId = systemId ?? asSystemId(generateSystemId(entityType, systemCounter));\r\n    const resolvedBusinessId = asBusinessId(businessIdString);\r\n\r\n    const createdAt = item.createdAt ?? now;\r\n    const createdBy = item.createdBy ?? (isNew && currentUser ? currentUser : item.createdBy);\r\n\r\n    return {\r\n      ...item,\r\n      systemId: resolvedSystemId,\r\n      id: resolvedBusinessId,\r\n      applicableDepartmentSystemIds: item.applicableDepartmentSystemIds ?? [],\r\n      createdAt,\r\n      createdBy,\r\n      updatedAt: now,\r\n      updatedBy: currentUser ?? item.updatedBy,\r\n    } as T;\r\n  });\r\n\r\n  return {\r\n    records,\r\n    counters: {\r\n      ...counters,\r\n      [entityType]: {\r\n        systemId: systemCounter,\r\n        businessId: businessCounter,\r\n      },\r\n    },\r\n  };\r\n};\r\n\r\nconst normalizeSettings = (\r\n  incoming: EmployeeSettings,\r\n  counters: SettingsCounters,\r\n  currentUser?: SystemId\r\n): { settings: EmployeeSettings; counters: SettingsCounters } => {\r\n  let nextCounters = { ...counters };\r\n  const normalizedShifts = normalizeCollection(incoming.workShifts, 'work-shifts', nextCounters, currentUser);\r\n  nextCounters = normalizedShifts.counters;\r\n  const normalizedLeaves = normalizeCollection(incoming.leaveTypes, 'leave-types', nextCounters, currentUser);\r\n  nextCounters = normalizedLeaves.counters;\r\n  const normalizedComponents = normalizeCollection(incoming.salaryComponents, 'salary-components', nextCounters, currentUser);\r\n\r\n  return {\r\n    settings: {\r\n      ...incoming,\r\n      workShifts: normalizedShifts.records,\r\n      leaveTypes: normalizedLeaves.records,\r\n      salaryComponents: normalizedComponents.records,\r\n    },\r\n    counters: normalizedComponents.counters,\r\n  };\r\n};\r\n\r\nconst buildInitialState = () => {\r\n  const cloned = cloneSettings(defaultSettings);\r\n  const counters = buildCounters(cloned);\r\n  return normalizeSettings(cloned, counters);\r\n};\r\n\r\nconst initialState = buildInitialState();\r\n\r\n// API sync helper\r\nasync function syncSettingsToAPI(settings: EmployeeSettings): Promise<boolean> {\r\n  try {\r\n    const response = await fetch('/api/settings/employees', {\r\n      method: 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(settings),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('[Employee Settings API] sync error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useEmployeeSettingsStore = create<EmployeeSettingsState>()(\r\n  (set, get) => ({\r\n      settings: initialState.settings,\r\n      counters: initialState.counters,\r\n      initialized: false,\r\n      setSettings: (payload) => {\r\n        const cloned = cloneSettings(payload);\r\n        const currentUser = getCurrentUserSystemId();\r\n        const normalized = normalizeSettings(\r\n          cloned,\r\n          get().counters,\r\n          currentUser ? asSystemId(currentUser) : undefined\r\n        );\r\n        set(normalized);\r\n        \r\n        // Sync to API\r\n        syncSettingsToAPI(normalized.settings).catch(console.error);\r\n      },\r\n      getShiftBySystemId: (systemId) => get().settings.workShifts.find((shift) => shift.systemId === systemId),\r\n      getLeaveTypes: () => get().settings.leaveTypes,\r\n      getSalaryComponents: () => get().settings.salaryComponents,\r\n      getDefaultPayrollWindow: () => {\r\n        const current = get().settings;\r\n        return {\r\n          cycle: current.payrollCycle,\r\n          payday: current.payday,\r\n          lockDate: current.payrollLockDate,\r\n        };\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          const response = await fetch('/api/settings/employees');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const settings = json.data || json.settings;\r\n            if (settings) {\r\n              const cloned = cloneSettings(settings);\r\n              const counters = buildCounters(cloned);\r\n              const normalized = normalizeSettings(cloned, counters);\r\n              set({ ...normalized, initialized: true });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Employee Settings Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 953, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/use-settings-page-header.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { usePathname } from 'next/navigation';\r\nimport { Settings2 } from 'lucide-react';\r\nimport { usePageHeader, type PageHeaderState, type PageHeaderDocLink } from '../../contexts/page-header-context';\r\nimport type { BreadcrumbItem } from '../../lib/breadcrumb-system';\r\n\r\nexport type SettingsPageHeaderOptions = Omit<PageHeaderState, 'title' | 'docLink'> & {\r\n  title: string;\r\n  icon?: React.ReactNode;\r\n  docLink?: string | PageHeaderDocLink;\r\n};\r\n\r\nconst defaultDocLabel = 'Xem hướng dẫn';\r\nconst baseBreadcrumb: BreadcrumbItem[] = [\r\n  { label: 'Trang chủ', href: '/', isCurrent: false },\r\n  { label: 'Cài đặt', href: '/settings', isCurrent: false },\r\n];\r\n\r\nconst normalizeLabel = (label?: string) => label?.trim().toLocaleLowerCase('vi');\r\nconst isHomeCrumb = (item: BreadcrumbItem) => item.href === '/' || normalizeLabel(item.label) === 'trang chủ';\r\nconst isSettingsCrumb = (item: BreadcrumbItem) => item.href === '/settings' || normalizeLabel(item.label) === 'cài đặt';\r\n\r\nexport function useSettingsPageHeader(options: SettingsPageHeaderOptions) {\r\n  const pathname = usePathname();\r\n  const { title, icon, docLink, breadcrumb, ...rest } = options;\r\n\r\n  const normalizedDocLink = React.useMemo<PageHeaderDocLink | undefined>(() => {\r\n    if (!docLink) return undefined;\r\n    if (typeof docLink === 'string') {\r\n      return { href: docLink, label: defaultDocLabel };\r\n    }\r\n    return {\r\n      href: docLink.href,\r\n      label: docLink.label ?? defaultDocLabel,\r\n    };\r\n  }, [docLink]);\r\n\r\n  const decoratedTitle = React.useMemo(() => (\r\n    <span className=\"inline-flex items-center gap-2\">\r\n      {(icon ?? <Settings2 className=\"h-5 w-5 text-muted-foreground\" aria-hidden=\"true\" />)}\r\n      <span>{title}</span>\r\n    </span>\r\n  ), [icon, title]);\r\n\r\n  const normalizedBreadcrumb = React.useMemo(() => {\r\n    const custom = (breadcrumb ?? []).map((item) => ({\r\n      ...item,\r\n      href: item.href || pathname,\r\n    }));\r\n\r\n    let merged: BreadcrumbItem[] = custom.length\r\n      ? [...custom]\r\n      : [{ label: title, href: pathname, isCurrent: true }];\r\n\r\n    if (!merged.some(isHomeCrumb)) {\r\n      merged = [{ ...baseBreadcrumb[0] }, ...merged];\r\n    }\r\n\r\n    if (!merged.some(isSettingsCrumb)) {\r\n      const homeIndex = merged.findIndex(isHomeCrumb);\r\n      const insertionIndex = homeIndex >= 0 ? homeIndex + 1 : 0;\r\n      merged = [\r\n        ...merged.slice(0, insertionIndex),\r\n        { ...baseBreadcrumb[1] },\r\n        ...merged.slice(insertionIndex),\r\n      ];\r\n    }\r\n\r\n    return merged.map((item, index) => ({\r\n      ...item,\r\n      isCurrent: index === merged.length - 1,\r\n    }));\r\n  }, [breadcrumb, pathname, title]);\r\n\r\n  return usePageHeader({\r\n    ...rest,\r\n    breadcrumb: normalizedBreadcrumb,\r\n    title: decoratedTitle,\r\n    docLink: normalizedDocLink,\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;AASA,MAAM,kBAAkB;AACxB,MAAM,iBAAmC;IACvC;QAAE,OAAO;QAAa,MAAM;QAAK,WAAW;IAAM;IAClD;QAAE,OAAO;QAAW,MAAM;QAAa,WAAW;IAAM;CACzD;AAED,MAAM,iBAAiB,CAAC,QAAmB,OAAO,OAAO,kBAAkB;AAC3E,MAAM,cAAc,CAAC,OAAyB,KAAK,IAAI,KAAK,OAAO,eAAe,KAAK,KAAK,MAAM;AAClG,MAAM,kBAAkB,CAAC,OAAyB,KAAK,IAAI,KAAK,eAAe,eAAe,KAAK,KAAK,MAAM;AAEvG,SAAS,sBAAsB,OAAkC;;IACtE,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG,MAAM,GAAG;IAEtD,MAAM,oBAAoB,wKAAa;4DAAgC;YACrE,IAAI,CAAC,SAAS,OAAO;YACrB,IAAI,OAAO,YAAY,UAAU;gBAC/B,OAAO;oBAAE,MAAM;oBAAS,OAAO;gBAAgB;YACjD;YACA,OAAO;gBACL,MAAM,QAAQ,IAAI;gBAClB,OAAO,QAAQ,KAAK,IAAI;YAC1B;QACF;2DAAG;QAAC;KAAQ;IAEZ,MAAM,iBAAiB,wKAAa;yDAAC,kBACnC,6LAAC;gBAAK,WAAU;;oBACZ,sBAAQ,6LAAC,gOAAS;wBAAC,WAAU;wBAAgC,eAAY;;;;;;kCAC3E,6LAAC;kCAAM;;;;;;;;;;;;wDAER;QAAC;QAAM;KAAM;IAEhB,MAAM,uBAAuB,wKAAa;+DAAC;YACzC,MAAM,SAAS,CAAC,cAAc,EAAE,EAAE,GAAG;8EAAC,CAAC,OAAS,CAAC;wBAC/C,GAAG,IAAI;wBACP,MAAM,KAAK,IAAI,IAAI;oBACrB,CAAC;;YAED,IAAI,SAA2B,OAAO,MAAM,GACxC;mBAAI;aAAO,GACX;gBAAC;oBAAE,OAAO;oBAAO,MAAM;oBAAU,WAAW;gBAAK;aAAE;YAEvD,IAAI,CAAC,OAAO,IAAI,CAAC,cAAc;gBAC7B,SAAS;oBAAC;wBAAE,GAAG,cAAc,CAAC,EAAE;oBAAC;uBAAM;iBAAO;YAChD;YAEA,IAAI,CAAC,OAAO,IAAI,CAAC,kBAAkB;gBACjC,MAAM,YAAY,OAAO,SAAS,CAAC;gBACnC,MAAM,iBAAiB,aAAa,IAAI,YAAY,IAAI;gBACxD,SAAS;uBACJ,OAAO,KAAK,CAAC,GAAG;oBACnB;wBAAE,GAAG,cAAc,CAAC,EAAE;oBAAC;uBACpB,OAAO,KAAK,CAAC;iBACjB;YACH;YAEA,OAAO,OAAO,GAAG;uEAAC,CAAC,MAAM,QAAU,CAAC;wBAClC,GAAG,IAAI;wBACP,WAAW,UAAU,OAAO,MAAM,GAAG;oBACvC,CAAC;;QACH;8DAAG;QAAC;QAAY;QAAU;KAAM;IAEhC,OAAO,IAAA,0JAAa,EAAC;QACnB,GAAG,IAAI;QACP,YAAY;QACZ,OAAO;QACP,SAAS;IACX;AACF;GA1DgB;;QACG,oJAAW;QAmDrB,0JAAa"}},
    {"offset": {"line": 1102, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/settings/SettingsActionButton.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Button, type ButtonProps } from '../ui/button';\r\nimport { cn } from '../../lib/utils';\r\n\r\n/**\r\n * SettingsActionButton chuẩn hóa các nút hành động của module Cài đặt\r\n * để luôn tuân thủ chiều cao h-9 và padding đồng nhất.\r\n */\r\nexport const SettingsActionButton = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, size, children, ...props }, ref) => {\r\n    return (\r\n      <Button\r\n        ref={ref}\r\n        size={size ?? 'sm'}\r\n        className={cn('h-9 px-4 font-medium gap-2', className)}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </Button>\r\n    );\r\n  }\r\n);\r\n\r\nSettingsActionButton.displayName = 'SettingsActionButton';\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAMO,MAAM,qCAAuB,2KAAgB,MAClD,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IACxC,qBACE,6LAAC,wIAAM;QACL,KAAK;QACL,MAAM,QAAQ;QACd,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;kBAER;;;;;;AAGP;;AAGF,qBAAqB,WAAW,GAAG"}},
    {"offset": {"line": 1139, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"../../lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border border-border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-h3 font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,0EACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 1246, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/label.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"../../lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB;AAGF,MAAM,sBAAQ,2KAAgB,MAI5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,4KAAmB;QAClB,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,4KAAmB,CAAC,WAAW"}},
    {"offset": {"line": 1283, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport {\r\n  Controller,\r\n  FormProvider,\r\n  useFormContext,\r\n  type ControllerProps,\r\n  type FieldPath,\r\n  type FieldValues,\r\n} from \"react-hook-form\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { Label } from \"./label\"\r\n\r\nconst Form = FormProvider\r\n\r\ntype FormFieldContextValue<\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n> = {\r\n  name: TName\r\n}\r\n\r\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\r\n\r\nconst FormField = <\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n>({\r\n  ...props\r\n}: ControllerProps<TFieldValues, TName>) => {\r\n  return (\r\n    <FormFieldContext.Provider value={{ name: props.name }}>\r\n      <Controller {...props} />\r\n    </FormFieldContext.Provider>\r\n  )\r\n}\r\n\r\nconst useFormField = () => {\r\n  const fieldContext = React.useContext(FormFieldContext)\r\n  const itemContext = React.useContext(FormItemContext)\r\n  const { getFieldState, formState } = useFormContext()\r\n\r\n  if (!fieldContext) {\r\n    throw new Error(\"useFormField should be used within <FormField>\")\r\n  }\r\n\r\n  if (!itemContext) {\r\n    throw new Error(\"useFormField should be used within <FormItem>\")\r\n  }\r\n\r\n  const fieldState = getFieldState(fieldContext.name, formState)\r\n\r\n  const { id } = itemContext\r\n\r\n  return {\r\n    id,\r\n    name: fieldContext.name,\r\n    formItemId: `${id}-form-item`,\r\n    formDescriptionId: `${id}-form-item-description`,\r\n    formMessageId: `${id}-form-item-message`,\r\n    ...fieldState,\r\n  }\r\n}\r\n\r\ntype FormItemContextValue = {\r\n  id: string\r\n}\r\n\r\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\r\n\r\nconst FormItem = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => {\r\n  const id = React.useId()\r\n\r\n  return (\r\n    <FormItemContext.Provider value={{ id }}>\r\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\r\n    </FormItemContext.Provider>\r\n  )\r\n})\r\nFormItem.displayName = \"FormItem\"\r\n\r\nconst FormLabel = React.forwardRef<\r\n  React.ElementRef<typeof LabelPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\r\n>(({ className, ...props }, ref) => {\r\n  const { error, formItemId } = useFormField()\r\n\r\n  return (\r\n    <Label\r\n      ref={ref}\r\n      className={cn(error && \"text-destructive\", className)}\r\n      htmlFor={formItemId}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormLabel.displayName = \"FormLabel\"\r\n\r\nconst FormControl = React.forwardRef<\r\n  React.ElementRef<typeof Slot>,\r\n  React.ComponentPropsWithoutRef<typeof Slot>\r\n>(({ children, ...props }, ref) => {\r\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\r\n\r\n  const childElements = React.Children\r\n    .toArray(children)\r\n    .filter((child): child is React.ReactElement => React.isValidElement(child))\r\n\r\n  if (childElements.length === 0) {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.warn('FormControl cần ít nhất một phần tử con hợp lệ')\r\n    }\r\n    return null\r\n  }\r\n\r\n  if (childElements.length > 1 && process.env.NODE_ENV === 'development') {\r\n    console.warn('FormControl chỉ hỗ trợ một phần tử con. Đang dùng phần tử đầu tiên.')\r\n  }\r\n\r\n  return (\r\n    <Slot\r\n      ref={ref}\r\n      id={formItemId}\r\n      aria-describedby={\r\n        !error\r\n          ? `${formDescriptionId}`\r\n          : `${formDescriptionId} ${formMessageId}`\r\n      }\r\n      aria-invalid={!!error}\r\n      {...props}\r\n    >\r\n      {childElements[0]}\r\n    </Slot>\r\n  )\r\n})\r\nFormControl.displayName = \"FormControl\"\r\n\r\nconst FormDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => {\r\n  const { formDescriptionId } = useFormField()\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formDescriptionId}\r\n      className={cn(\"text-sm text-muted-foreground\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormDescription.displayName = \"FormDescription\"\r\n\r\nconst FormMessage = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, children, ...props }, ref) => {\r\n  const { error, formMessageId } = useFormField()\r\n  const body = error ? String(error?.message ?? \"\") : children\r\n\r\n  if (!body) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formMessageId}\r\n      className={cn(\"text-sm font-medium text-destructive\", className)}\r\n      {...props}\r\n    >\r\n      {body}\r\n    </p>\r\n  )\r\n})\r\nFormMessage.displayName = \"FormMessage\"\r\n\r\nexport {\r\n  useFormField,\r\n  Form,\r\n  FormItem,\r\n  FormLabel,\r\n  FormControl,\r\n  FormDescription,\r\n  FormMessage,\r\n  FormField,\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1522, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/select.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\r\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { useModal } from \"../../contexts/modal-context\"\r\n\r\ntype BaseSelectProps = React.ComponentPropsWithoutRef<typeof SelectPrimitive.Root>\r\n\r\ntype SelectProps = Omit<BaseSelectProps, \"value\" | \"defaultValue\"> & {\r\n  value?: string | undefined\r\n  defaultValue?: string | undefined\r\n}\r\n\r\nconst Select = ({ value, defaultValue, ...props }: SelectProps) => {\r\n  const controlledProps: Partial<BaseSelectProps> = {}\r\n\r\n  if (value !== undefined) {\r\n    controlledProps.value = value\r\n  }\r\n\r\n  if (defaultValue !== undefined) {\r\n    controlledProps.defaultValue = defaultValue\r\n  }\r\n\r\n  return <SelectPrimitive.Root {...props} {...controlledProps} />\r\n}\r\nSelect.displayName = SelectPrimitive.Root.displayName\r\n\r\nconst SelectGroup = SelectPrimitive.Group\r\n\r\nconst SelectValue = SelectPrimitive.Value\r\n\r\nconst SelectTrigger = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\r\n>(({ className, children, ...props }, ref) => (\r\n  <SelectPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    {children}\r\n    <SelectPrimitive.Icon asChild>\r\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\r\n    </SelectPrimitive.Icon>\r\n  </SelectPrimitive.Trigger>\r\n))\r\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\r\n\r\nconst SelectScrollUpButton = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.ScrollUpButton\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default items-center justify-center py-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ChevronUp className=\"h-4 w-4\" />\r\n  </SelectPrimitive.ScrollUpButton>\r\n))\r\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\r\n\r\nconst SelectScrollDownButton = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.ScrollDownButton\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default items-center justify-center py-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ChevronDown className=\"h-4 w-4\" />\r\n  </SelectPrimitive.ScrollDownButton>\r\n))\r\nSelectScrollDownButton.displayName =\r\n  SelectPrimitive.ScrollDownButton.displayName\r\n\r\nconst SelectContent = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\r\n>(({ className, children, position = \"popper\", ...props }, ref) => {\r\n  const modalId = React.useId();\r\n  const [isOpen, setIsOpen] = React.useState(false);\r\n  const { zIndex } = useModal(modalId, isOpen, 'select');\r\n\r\n  React.useEffect(() => {\r\n    const content = ref && 'current' in ref ? ref.current : null;\r\n    if (!content) return;\r\n\r\n    const observer = new MutationObserver((mutations) => {\r\n      mutations.forEach((mutation) => {\r\n        if (mutation.type === 'attributes' && mutation.attributeName === 'data-state') {\r\n          const target = mutation.target as HTMLElement;\r\n          const state = target.getAttribute('data-state');\r\n          setIsOpen(state === 'open');\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe(content, { attributes: true, attributeFilter: ['data-state'] });\r\n\r\n    return () => observer.disconnect();\r\n  }, [ref]);\r\n\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        ref={ref}\r\n        className={cn(\r\n          \"relative max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\r\n          position === \"popper\" &&\r\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\r\n          className\r\n        )}\r\n        style={{ zIndex }}\r\n        position={position}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            \"p-1\",\r\n            position === \"popper\" &&\r\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  );\r\n})\r\nSelectContent.displayName = SelectPrimitive.Content.displayName\r\n\r\nconst SelectLabel = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Label>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.Label\r\n    ref={ref}\r\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSelectLabel.displayName = SelectPrimitive.Label.displayName\r\n\r\nconst SelectItem = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\r\n>(({ className, children, ...props }, ref) => (\r\n  <SelectPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\r\n      <SelectPrimitive.ItemIndicator>\r\n        <Check className=\"h-4 w-4\" />\r\n      </SelectPrimitive.ItemIndicator>\r\n    </span>\r\n\r\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n  </SelectPrimitive.Item>\r\n))\r\nSelectItem.displayName = SelectPrimitive.Item.displayName\r\n\r\nconst SelectSeparator = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.Separator\r\n    ref={ref}\r\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\r\n\r\nexport {\r\n  Select,\r\n  SelectGroup,\r\n  SelectValue,\r\n  SelectTrigger,\r\n  SelectContent,\r\n  SelectLabel,\r\n  SelectItem,\r\n  SelectSeparator,\r\n  SelectScrollUpButton,\r\n  SelectScrollDownButton,\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1813, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\r\nimport { Check } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\ntype BaseCheckboxProps = React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\r\n\r\ntype CheckboxProps = Omit<BaseCheckboxProps, \"checked\" | \"defaultChecked\"> & {\r\n  checked?: CheckboxPrimitive.CheckedState | undefined\r\n  defaultChecked?: CheckboxPrimitive.CheckedState | undefined\r\n}\r\n\r\nconst Checkbox = React.forwardRef<\r\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\r\n  CheckboxProps\r\n>(({ className, checked, defaultChecked, ...props }, ref) => (\r\n  <CheckboxPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n    {...(checked !== undefined ? { checked } : {})}\r\n    {...(defaultChecked !== undefined ? { defaultChecked } : {})}\r\n  >\r\n    <CheckboxPrimitive.Indicator\r\n      className={cn(\"flex items-center justify-center text-current\")}\r\n    >\r\n      <Check className=\"h-4 w-4\" />\r\n    </CheckboxPrimitive.Indicator>\r\n  </CheckboxPrimitive.Root>\r\n))\r\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\r\n\r\nexport { Checkbox }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AASA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,oBACnD,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,kTACA;QAED,GAAG,KAAK;QACR,GAAI,YAAY,YAAY;YAAE;QAAQ,IAAI,CAAC,CAAC;QAC5C,GAAI,mBAAmB,YAAY;YAAE;QAAe,IAAI,CAAC,CAAC;kBAE3D,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,qHAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 1869, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\ntype SwitchProps = Omit<\r\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>,\r\n  \"checked\" | \"defaultChecked\"\r\n> & {\r\n  checked?: boolean | undefined\r\n  defaultChecked?: boolean | undefined\r\n}\r\n\r\nconst Switch = React.forwardRef<\r\n  React.ElementRef<typeof SwitchPrimitives.Root>,\r\n  SwitchProps\r\n>(({ className, checked, defaultChecked, ...props }, ref) => (\r\n  <SwitchPrimitives.Root\r\n    className={cn(\r\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\r\n      className\r\n    )}\r\n    {...props}\r\n    {...(checked !== undefined ? { checked } : {})}\r\n    {...(defaultChecked !== undefined ? { defaultChecked } : {})}\r\n    ref={ref}\r\n  >\r\n    <SwitchPrimitives.Thumb\r\n      className={cn(\r\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n      )}\r\n    />\r\n  </SwitchPrimitives.Root>\r\n))\r\nSwitch.displayName = SwitchPrimitives.Root.displayName\r\n\r\nexport { Switch }\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAeA,MAAM,uBAAS,2KAAgB,MAG7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,oBACnD,6LAAC,6KAAqB;QACpB,WAAW,IAAA,qHAAE,EACX,sXACA;QAED,GAAG,KAAK;QACR,GAAI,YAAY,YAAY;YAAE;QAAQ,IAAI,CAAC,CAAC;QAC5C,GAAI,mBAAmB,YAAY;YAAE;QAAe,IAAI,CAAC,CAAC;QAC3D,KAAK;kBAEL,cAAA,6LAAC,8KAAsB;YACrB,WAAW,IAAA,qHAAE,EACX;;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,6KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 1917, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Separator = React.forwardRef<\r\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\r\n>(\r\n  (\r\n    { className, orientation = \"horizontal\", decorative = true, ...props },\r\n    ref\r\n  ) => (\r\n    <SeparatorPrimitive.Root\r\n      ref={ref}\r\n      decorative={decorative}\r\n      orientation={orientation}\r\n      className={cn(\r\n        \"shrink-0 bg-border\",\r\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n)\r\nSeparator.displayName = SeparatorPrimitive.Root.displayName\r\n\r\nexport { Separator }\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,0BAAY,2KAAgB,MAIhC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,6LAAC,gLAAuB;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,qHAAE,EACX,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;;AAIf,UAAU,WAAW,GAAG,gLAAuB,CAAC,WAAW"}},
    {"offset": {"line": 1954, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/time-picker.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { cn } from '../../lib/utils';\r\n\r\nexport interface TimePickerProps {\r\n  value?: string; // \"HH:mm\"\r\n  onChange?: (value: string) => void;\r\n  className?: string;\r\n  disabled?: boolean;\r\n}\r\n\r\nconst TimePicker = React.forwardRef<HTMLDivElement, TimePickerProps>(\r\n  ({ className, value, onChange, disabled }, ref) => {\r\n    const [hourStr, minuteStr] = React.useMemo(() => {\r\n      const parts = (value || '').split(':');\r\n      return [parts[0] || '', parts[1] || ''];\r\n    }, [value]);\r\n\r\n    const handleTimeChange = (part: 'hour' | 'minute', newValue: string) => {\r\n      if (disabled) return;\r\n      let newHour = hourStr;\r\n      let newMinute = minuteStr;\r\n\r\n      if (part === 'hour') {\r\n        newHour = newValue.replace(/[^0-9]/g, '').slice(0, 2);\r\n      } else {\r\n        newMinute = newValue.replace(/[^0-9]/g, '').slice(0, 2);\r\n      }\r\n      onChange?.(`${newHour}:${newMinute}`);\r\n    };\r\n\r\n    const formatTimePart = (part: string, max: number) => {\r\n      let num = parseInt(part, 10);\r\n      if (isNaN(num)) return '00';\r\n      if (num > max) num = max;\r\n      if (num < 0) num = 0;\r\n      return num.toString().padStart(2, '0');\r\n    };\r\n\r\n    const handleBlur = () => {\r\n        if (disabled) return;\r\n        const formattedHour = formatTimePart(hourStr, 23);\r\n        const formattedMinute = formatTimePart(minuteStr, 59);\r\n        if(formattedHour !== hourStr || formattedMinute !== minuteStr) {\r\n            onChange?.(`${formattedHour}:${formattedMinute}`);\r\n        }\r\n    };\r\n\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={cn(\r\n          'flex h-9 w-full items-center rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background focus-within:outline-none focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 data-[disabled=true]:cursor-not-allowed data-[disabled=true]:opacity-50',\r\n          className\r\n        )}\r\n        data-disabled={disabled}\r\n        onBlur={handleBlur} // Attach blur to parent to catch when focus leaves the component\r\n      >\r\n        <input\r\n          value={hourStr}\r\n          onChange={(e) => handleTimeChange('hour', e.target.value)}\r\n          className=\"w-8 border-none bg-transparent p-0 text-center shadow-none focus:ring-0 focus:outline-none disabled:cursor-not-allowed\"\r\n          placeholder=\"00\"\r\n          disabled={disabled}\r\n          maxLength={2}\r\n        />\r\n        <span className=\"text-muted-foreground\">:</span>\r\n        <input\r\n          value={minuteStr}\r\n          onChange={(e) => handleTimeChange('minute', e.target.value)}\r\n          className=\"w-8 border-none bg-transparent p-0 text-center shadow-none focus:ring-0 focus:outline-none disabled:cursor-not-allowed\"\r\n          placeholder=\"00\"\r\n          disabled={disabled}\r\n          maxLength={2}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n);\r\nTimePicker.displayName = 'TimePicker';\r\n\r\nexport { TimePicker };\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;AASA,MAAM,2BAAa,GAAA,2KAAgB,SACjC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE;;IACzC,MAAM,CAAC,SAAS,UAAU,GAAG,wKAAa;8BAAC;YACzC,MAAM,QAAQ,CAAC,SAAS,EAAE,EAAE,KAAK,CAAC;YAClC,OAAO;gBAAC,KAAK,CAAC,EAAE,IAAI;gBAAI,KAAK,CAAC,EAAE,IAAI;aAAG;QACzC;6BAAG;QAAC;KAAM;IAEV,MAAM,mBAAmB,CAAC,MAAyB;QACjD,IAAI,UAAU;QACd,IAAI,UAAU;QACd,IAAI,YAAY;QAEhB,IAAI,SAAS,QAAQ;YACnB,UAAU,SAAS,OAAO,CAAC,WAAW,IAAI,KAAK,CAAC,GAAG;QACrD,OAAO;YACL,YAAY,SAAS,OAAO,CAAC,WAAW,IAAI,KAAK,CAAC,GAAG;QACvD;QACA,WAAW,GAAG,QAAQ,CAAC,EAAE,WAAW;IACtC;IAEA,MAAM,iBAAiB,CAAC,MAAc;QACpC,IAAI,MAAM,SAAS,MAAM;QACzB,IAAI,MAAM,MAAM,OAAO;QACvB,IAAI,MAAM,KAAK,MAAM;QACrB,IAAI,MAAM,GAAG,MAAM;QACnB,OAAO,IAAI,QAAQ,GAAG,QAAQ,CAAC,GAAG;IACpC;IAEA,MAAM,aAAa;QACf,IAAI,UAAU;QACd,MAAM,gBAAgB,eAAe,SAAS;QAC9C,MAAM,kBAAkB,eAAe,WAAW;QAClD,IAAG,kBAAkB,WAAW,oBAAoB,WAAW;YAC3D,WAAW,GAAG,cAAc,CAAC,EAAE,iBAAiB;QACpD;IACJ;IAEA,qBACE,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,+RACA;QAEF,iBAAe;QACf,QAAQ;;0BAER,6LAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,iBAAiB,QAAQ,EAAE,MAAM,CAAC,KAAK;gBACxD,WAAU;gBACV,aAAY;gBACZ,UAAU;gBACV,WAAW;;;;;;0BAEb,6LAAC;gBAAK,WAAU;0BAAwB;;;;;;0BACxC,6LAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,iBAAiB,UAAU,EAAE,MAAM,CAAC,KAAK;gBAC1D,WAAU;gBACV,aAAY;gBACZ,UAAU;gBACV,WAAW;;;;;;;;;;;;AAInB;;AAEF,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 2062, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/number-input.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { ChevronUp, ChevronDown } from 'lucide-react';\r\nimport { Input } from './input';\r\nimport { Button } from './button';\r\nimport { cn } from '../../lib/utils';\r\n\r\nexport interface NumberInputProps extends Omit<React.ComponentProps<\"input\">, 'onChange' | 'value'> {\r\n  value?: number;\r\n  onChange?: (value: number) => void;\r\n  step?: number;\r\n  min?: number;\r\n  max?: number;\r\n  format?: boolean;\r\n}\r\n\r\nconst NumberInput = React.forwardRef<HTMLInputElement, NumberInputProps>(\r\n  ({ className, value, onChange, step = 1, min, max, format = true, ...props }, ref) => {\r\n    \r\n    const formatValue = React.useCallback((num?: number) => {\r\n      if (num === undefined || num === null || isNaN(num)) return '';\r\n      if (!format) return String(num);\r\n      return new Intl.NumberFormat('vi-VN').format(num);\r\n    }, [format]);\r\n\r\n    const parseValue = React.useCallback((str: string): number => {\r\n      if (!str) return 0;\r\n      const parsed = parseInt(str.replace(/\\./g, ''), 10);\r\n      return isNaN(parsed) ? 0 : parsed;\r\n    }, []);\r\n\r\n    const [displayValue, setDisplayValue] = React.useState(formatValue(value));\r\n    const inputRef = React.useRef<HTMLInputElement>(null);\r\n\r\n    React.useImperativeHandle(ref, () => inputRef.current!);\r\n\r\n    React.useEffect(() => {\r\n      if (document.activeElement !== inputRef.current) {\r\n        setDisplayValue(formatValue(value));\r\n      }\r\n    }, [value, formatValue]);\r\n    \r\n    const handleStep = (direction: 'up' | 'down') => {\r\n      let currentValue = value ?? 0;\r\n      if (min !== undefined && currentValue < min) {\r\n        currentValue = min;\r\n      }\r\n      let newValue = currentValue + (direction === 'up' ? step : -step);\r\n\r\n      const stepDecimalPlaces = (String(step).split('.')[1] || '').length;\r\n      newValue = parseFloat(newValue.toFixed(stepDecimalPlaces));\r\n\r\n      if (min !== undefined) newValue = Math.max(min, newValue);\r\n      if (max !== undefined) newValue = Math.min(max, newValue);\r\n      \r\n      onChange?.(newValue);\r\n    };\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const rawValue = e.target.value;\r\n        \r\n        // Không cho phép nhập dấu trừ nếu min >= 0\r\n        if (min !== undefined && min >= 0 && rawValue.includes('-')) {\r\n            return;\r\n        }\r\n        \r\n        const num = parseValue(rawValue);\r\n        \r\n        // Kiểm tra giới hạn max ngay khi nhập\r\n        if (max !== undefined && num > max) {\r\n            return;\r\n        }\r\n\r\n        setDisplayValue(rawValue);\r\n        onChange?.(num);\r\n    }\r\n    \r\n    const handleBlur = (e: React.FocusEvent<HTMLInputElement>) => {\r\n        let currentNum = value ?? 0;\r\n        if (min !== undefined) currentNum = Math.max(min, currentNum);\r\n        if (max !== undefined) currentNum = Math.min(max, currentNum);\r\n        \r\n        if (currentNum !== value) {\r\n            onChange?.(currentNum);\r\n        }\r\n\r\n        setDisplayValue(formatValue(currentNum));\r\n        props.onBlur?.(e);\r\n    }\r\n\r\n    const inputType = format ? \"text\" : \"number\";\r\n\r\n    return (\r\n      <div className={cn(\"relative\", className)}>\r\n        <Input\r\n          type={inputType}\r\n          inputMode={format ? \"text\" : \"numeric\"}\r\n          ref={inputRef}\r\n          value={displayValue}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          step={format ? undefined : step}\r\n          min={format ? undefined : min}\r\n          max={format ? undefined : max}\r\n          className={cn(\r\n            \"pr-8\",\r\n            !format && \"[-moz-appearance:textfield] [&::-webkit-inner-spin-button]:m-0 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:m-0 [&::-webkit-outer-spin-button]:appearance-none\"\r\n          )}\r\n          {...props}\r\n        />\r\n        <div className=\"absolute right-0 top-0 h-full flex flex-col items-center justify-center border-l\">\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"ghost\"\r\n            className=\"h-1/2 px-2 py-0 rounded-none rounded-tr-md flex items-center justify-center\"\r\n            onClick={() => handleStep('up')}\r\n            disabled={props.disabled || (max !== undefined && value !== undefined && value >= max)}\r\n            tabIndex={-1}\r\n          >\r\n            <ChevronUp className=\"h-4 w-4 text-muted-foreground\" />\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"ghost\"\r\n            className=\"h-1/2 px-2 py-0 rounded-none rounded-br-md flex items-center justify-center\"\r\n            onClick={() => handleStep('down')}\r\n            disabled={props.disabled || (min !== undefined && value !== undefined && value <= min)}\r\n            tabIndex={-1}\r\n          >\r\n            <ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\nNumberInput.displayName = 'NumberInput';\r\n\r\nexport { NumberInput };\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2237, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/currency-input.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Input } from \"./input\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\nexport interface CurrencyInputProps\r\n  extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'onChange' | 'value'> {\r\n  value?: number | undefined;\r\n  onChange?: (value: number) => void;\r\n}\r\n\r\nconst CurrencyInput = React.forwardRef<HTMLInputElement, CurrencyInputProps>(\r\n  ({ className, value, onChange, ...props }, ref) => {\r\n    const [displayValue, setDisplayValue] = React.useState(\"\");\r\n\r\n    // Format number with thousand separators\r\n    const formatNumber = (num: number): string => {\r\n      return new Intl.NumberFormat('vi-VN').format(num);\r\n    };\r\n\r\n    // Parse formatted string back to number\r\n    const parseNumber = (str: string): number => {\r\n      const cleaned = str.replace(/\\./g, '').replace(/,/g, '');\r\n      const num = parseInt(cleaned, 10);\r\n      return isNaN(num) ? 0 : Math.max(0, num); // Không cho phép số âm\r\n    };\r\n\r\n    // Sync external value to display\r\n    React.useEffect(() => {\r\n      if (value !== undefined) {\r\n        setDisplayValue(value === 0 ? \"\" : formatNumber(value));\r\n      }\r\n    }, [value]);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      const inputValue = e.target.value;\r\n      \r\n      // Cho phép rỗng\r\n      if (inputValue === \"\") {\r\n        setDisplayValue(\"\");\r\n        onChange?.(0);\r\n        return;\r\n      }\r\n\r\n      // Chỉ cho phép số và dấu chấm, không cho phép dấu trừ\r\n      const cleaned = inputValue.replace(/[^\\d.]/g, '');\r\n      \r\n      // Không xử lý nếu có ký tự không hợp lệ (bao gồm dấu trừ)\r\n      if (inputValue.length > 0 && cleaned === \"\" && inputValue !== \"\") {\r\n        return;\r\n      }\r\n      \r\n      const num = parseNumber(cleaned);\r\n      \r\n      // Cập nhật display và gọi onChange\r\n      setDisplayValue(formatNumber(num));\r\n      onChange?.(num);\r\n    };\r\n\r\n    const handleBlur = (e: React.FocusEvent<HTMLInputElement>) => {\r\n      // Format lại khi blur\r\n      if (value !== undefined && value > 0) {\r\n        setDisplayValue(formatNumber(value));\r\n      }\r\n      props.onBlur?.(e);\r\n    };\r\n\r\n    return (\r\n      <div className=\"relative\">\r\n        <Input\r\n          ref={ref}\r\n          type=\"text\"\r\n          inputMode=\"numeric\"\r\n          value={displayValue}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          className={cn(\"text-right pr-14 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\", className)}\r\n          {...props}\r\n        />\r\n        <span className={cn(\r\n          \"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-muted-foreground pointer-events-none\",\r\n          props.disabled && \"opacity-50\"\r\n        )}>\r\n          VND\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nCurrencyInput.displayName = \"CurrencyInput\";\r\n\r\nexport { CurrencyInput };\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;;AAQA,MAAM,8BAAgB,GAAA,2KAAgB,SACpC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;;IACzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,yKAAc,CAAC;IAEvD,yCAAyC;IACzC,MAAM,eAAe,CAAC;QACpB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;IAC/C;IAEA,wCAAwC;IACxC,MAAM,cAAc,CAAC;QACnB,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM;QACrD,MAAM,MAAM,SAAS,SAAS;QAC9B,OAAO,MAAM,OAAO,IAAI,KAAK,GAAG,CAAC,GAAG,MAAM,uBAAuB;IACnE;IAEA,iCAAiC;IACjC,0KAAe;mCAAC;YACd,IAAI,UAAU,WAAW;gBACvB,gBAAgB,UAAU,IAAI,KAAK,aAAa;YAClD;QACF;kCAAG;QAAC;KAAM;IAEV,MAAM,eAAe,CAAC;QACpB,MAAM,aAAa,EAAE,MAAM,CAAC,KAAK;QAEjC,gBAAgB;QAChB,IAAI,eAAe,IAAI;YACrB,gBAAgB;YAChB,WAAW;YACX;QACF;QAEA,sDAAsD;QACtD,MAAM,UAAU,WAAW,OAAO,CAAC,WAAW;QAE9C,0DAA0D;QAC1D,IAAI,WAAW,MAAM,GAAG,KAAK,YAAY,MAAM,eAAe,IAAI;YAChE;QACF;QAEA,MAAM,MAAM,YAAY;QAExB,mCAAmC;QACnC,gBAAgB,aAAa;QAC7B,WAAW;IACb;IAEA,MAAM,aAAa,CAAC;QAClB,sBAAsB;QACtB,IAAI,UAAU,aAAa,QAAQ,GAAG;YACpC,gBAAgB,aAAa;QAC/B;QACA,MAAM,MAAM,GAAG;IACjB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,sIAAK;gBACJ,KAAK;gBACL,MAAK;gBACL,WAAU;gBACV,OAAO;gBACP,UAAU;gBACV,QAAQ;gBACR,WAAW,IAAA,qHAAE,EAAC,yIAAyI;gBACtJ,GAAG,KAAK;;;;;;0BAEX,6LAAC;gBAAK,WAAW,IAAA,qHAAE,EACjB,+FACA,MAAM,QAAQ,IAAI;0BACjB;;;;;;;;;;;;AAKT;;AAGF,cAAc,WAAW,GAAG"}},
    {"offset": {"line": 2344, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Table = React.forwardRef<\r\n  HTMLTableElement,\r\n  React.HTMLAttributes<HTMLTableElement>\r\n>(({ className, ...props }, ref) => (\r\n    <table\r\n      ref={ref}\r\n      className={cn(\"w-full caption-bottom text-sm\", className)}\r\n      {...props}\r\n    />\r\n))\r\nTable.displayName = \"Table\"\r\n\r\nconst TableHeader = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <thead ref={ref} className={cn(\"[&_tr]:border-b [&_tr]:border-border\", className)} {...props} />\r\n))\r\nTableHeader.displayName = \"TableHeader\"\r\n\r\nconst TableBody = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tbody\r\n    ref={ref}\r\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableBody.displayName = \"TableBody\"\r\n\r\nconst TableFooter = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tfoot\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-t border-border bg-muted/50 font-medium [&>tr]:last:border-b-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableFooter.displayName = \"TableFooter\"\r\n\r\nconst TableRow = React.forwardRef<\r\n  HTMLTableRowElement,\r\n  React.HTMLAttributes<HTMLTableRowElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tr\r\n    ref={ref}\r\n    className={cn(\r\n      \"group border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableRow.displayName = \"TableRow\"\r\n\r\nconst TableHead = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.ThHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <th\r\n    ref={ref}\r\n    className={cn(\r\n      \"h-9 px-4 text-left align-middle font-medium text-foreground [&:has([role=checkbox])]:px-3 [&:has([role=checkbox])]:w-12 [&:has([role=checkbox])]:text-center whitespace-nowrap\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableHead.displayName = \"TableHead\"\r\n\r\nconst TableCell = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.TdHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <td\r\n    ref={ref}\r\n    className={cn(\r\n      \"px-4 py-1 align-middle whitespace-nowrap [&:has([role=checkbox])]:px-3 [&:has([role=checkbox])]:w-12 [&:has([role=checkbox])]:text-center\", \r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableCell.displayName = \"TableCell\"\r\n\r\nconst TableCaption = React.forwardRef<\r\n  HTMLTableCaptionElement,\r\n  React.HTMLAttributes<HTMLTableCaptionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <caption\r\n    ref={ref}\r\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCaption.displayName = \"TableCaption\"\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGf,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,wCAAwC;QAAa,GAAG,KAAK;;;;;;;AAE9F,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,yEACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,mGACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,kLACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,6IACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGb,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 2481, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/dialog.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\r\nimport { X } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { useModal } from \"../../contexts/modal-context\"\r\n\r\n// Use the original Dialog component\r\nconst Dialog = DialogPrimitive.Root\r\n\r\n// Create a Context to pass ID through the Dialog component tree\r\nconst DialogContext = React.createContext<string>(\"\");\r\n\r\n// Provider component that accepts an ID\r\nconst DialogProvider = ({ id, children }: { id: string; children: React.ReactNode }) => {\r\n  return <DialogContext.Provider value={id}>{children}</DialogContext.Provider>;\r\n};\r\n\r\nconst DialogTrigger = DialogPrimitive.Trigger\r\n\r\nconst DialogPortal = DialogPrimitive.Portal\r\n\r\nconst DialogClose = DialogPrimitive.Close\r\n\r\nconst DialogOverlay = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Overlay\r\n    ref={ref}\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\r\n\r\nconst DialogContent = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> & { \r\n    id?: string;\r\n    open?: boolean;\r\n  }\r\n>(({ className, children, id: propId, open, ...props }, ref) => {\r\n  // Use either the prop id or the id from context\r\n  const contextId = React.useContext(DialogContext);\r\n  const id = propId || contextId || `dialog-${React.useId()}`;\r\n  \r\n  // Register with our modal context using the open prop\r\n  const { zIndex } = useModal(id, !!open, 'dialog');\r\n  \r\n  return (\r\n    <DialogPortal>\r\n      {/* Sử dụng overlay chỉ dành cho Dialog */}\r\n      <DialogOverlay style={{ zIndex: zIndex - 1 }} />\r\n      <DialogPrimitive.Content\r\n        ref={ref}\r\n        className={cn(\r\n          \"dialog-content fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg sm:rounded-lg\",\r\n          className\r\n        )}\r\n        style={{ zIndex }}\r\n        {...props}\r\n      >\r\n        <DialogProvider id={id}>\r\n          {children}\r\n          <DialogPrimitive.Close\r\n            aria-label=\"Đóng\"\r\n            className=\"absolute right-4 top-4 flex h-9 w-9 items-center justify-center rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">Đóng</span>\r\n          </DialogPrimitive.Close>\r\n        </DialogProvider>\r\n      </DialogPrimitive.Content>\r\n    </DialogPortal>\r\n  );\r\n})\r\nDialogContent.displayName = DialogPrimitive.Content.displayName\r\n\r\nconst DialogHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nDialogHeader.displayName = \"DialogHeader\"\r\n\r\nconst DialogFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nDialogFooter.displayName = \"DialogFooter\"\r\n\r\nconst DialogTitle = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\r\n      \"text-lg font-semibold leading-none tracking-tight\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDialogTitle.displayName = DialogPrimitive.Title.displayName\r\n\r\nconst DialogDescription = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nDialogDescription.displayName = DialogPrimitive.Description.displayName\r\n\r\nexport {\r\n  Dialog,\r\n  DialogPortal,\r\n  DialogOverlay,\r\n  DialogClose,\r\n  DialogTrigger,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogFooter,\r\n  DialogTitle,\r\n  DialogDescription,\r\n  DialogProvider,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;;;;;;;;AAEA,oCAAoC;AACpC,MAAM,SAAS,6KAAoB;AAEnC,gEAAgE;AAChE,MAAM,8BAAgB,8KAAmB,CAAS;AAElD,wCAAwC;AACxC,MAAM,iBAAiB,CAAC,EAAE,EAAE,EAAE,QAAQ,EAA6C;IACjF,qBAAO,6LAAC,cAAc,QAAQ;QAAC,OAAO;kBAAK;;;;;;AAC7C;KAFM;AAIN,MAAM,gBAAgB,gLAAuB;AAE7C,MAAM,eAAe,+KAAsB;AAE3C,MAAM,cAAc,8KAAqB;AAEzC,MAAM,8BAAgB,2KAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,gLAAuB;QACtB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;MAVP;AAaN,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,GAAA,2KAAgB,UAMpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,MAAM,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;;IACtD,gDAAgD;IAChD,MAAM,YAAY,2KAAgB,CAAC;IACnC,MAAM,KAAK,UAAU,aAAa,CAAC,OAAO,EAAE,sKAAW,IAAI;IAE3D,sDAAsD;IACtD,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,4IAAQ,EAAC,IAAI,CAAC,CAAC,MAAM;IAExC,qBACE,6LAAC;;0BAEC,6LAAC;gBAAc,OAAO;oBAAE,QAAQ,SAAS;gBAAE;;;;;;0BAC3C,6LAAC,gLAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,qHAAE,EACX,kLACA;gBAEF,OAAO;oBAAE;gBAAO;gBACf,GAAG,KAAK;0BAET,cAAA,6LAAC;oBAAe,IAAI;;wBACjB;sCACD,6LAAC,8KAAqB;4BACpB,cAAW;4BACX,WAAU;;8CAEV,6LAAC,oMAAC;oCAAC,WAAU;;;;;;8CACb,6LAAC;oCAAK,WAAU;8CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;;QA5BqB,4IAAQ;;;;QAAR,4IAAQ;;;;AA6B7B,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,oLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 2691, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/employees/leave-type-form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport type { LeaveType } from \"./types\";\r\nimport { Button } from \"../../../components/ui/button\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"../../../components/ui/form\";\r\nimport { Input } from \"../../../components/ui/input\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\nimport { DialogFooter } from \"../../../components/ui/dialog\";\r\nimport { NumberInput } from \"../../../components/ui/number-input\";\r\n\r\nexport type LeaveTypeFormValues = Omit<LeaveType, 'systemId' | 'id' | 'applicableGender' | 'applicableDepartmentSystemIds' | 'createdAt' | 'createdBy' | 'updatedAt' | 'updatedBy'>;\r\n\r\ntype LeaveTypeFormProps = {\r\n  initialData?: LeaveTypeFormValues | undefined;\r\n  onSubmit: (values: LeaveTypeFormValues) => void;\r\n  onCancel: () => void;\r\n};\r\n\r\nexport function LeaveTypeForm({ initialData, onSubmit, onCancel }: LeaveTypeFormProps) {\r\n  const form = useForm<LeaveTypeFormValues>({\r\n    defaultValues: initialData || {\r\n      name: '',\r\n      numberOfDays: 0,\r\n      isPaid: true,\r\n      requiresAttachment: false,\r\n    },\r\n  });\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\r\n        <FormField control={form.control} name=\"name\" render={({ field }) => (\r\n          <FormItem>\r\n            <FormLabel>Tên loại phép</FormLabel>\r\n            <FormControl><Input placeholder=\"VD: Nghỉ kết hôn\" {...field} value={field.value ?? ''} /></FormControl>\r\n            <FormMessage />\r\n          </FormItem>\r\n        )} />\r\n        <FormField control={form.control} name=\"numberOfDays\" render={({ field }) => (\r\n          <FormItem>\r\n            <FormLabel>Số ngày nghỉ</FormLabel>\r\n            <FormControl><NumberInput {...field} value={field.value ?? 0} onChange={field.onChange} /></FormControl>\r\n            <FormMessage />\r\n          </FormItem>\r\n        )} />\r\n        <FormField control={form.control} name=\"isPaid\" render={({ field }) => (\r\n          <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3 shadow-sm\">\r\n            <div className=\"space-y-0.5\">\r\n              <FormLabel>Được hưởng lương</FormLabel>\r\n            </div>\r\n            <FormControl><Switch checked={field.value ?? false} onCheckedChange={field.onChange} /></FormControl>\r\n          </FormItem>\r\n        )} />\r\n        <FormField control={form.control} name=\"requiresAttachment\" render={({ field }) => (\r\n          <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3 shadow-sm\">\r\n            <div className=\"space-y-0.5\">\r\n              <FormLabel>Yêu cầu tài liệu đính kèm</FormLabel>\r\n            </div>\r\n            <FormControl><Switch checked={field.value ?? false} onCheckedChange={field.onChange} /></FormControl>\r\n          </FormItem>\r\n        )} />\r\n        <DialogFooter className=\"pt-4\">\r\n          <Button type=\"button\" variant=\"outline\" onClick={onCancel}>Hủy</Button>\r\n          <Button type=\"submit\">Lưu</Button>\r\n        </DialogFooter>\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUO,SAAS,cAAc,EAAE,WAAW,EAAE,QAAQ,EAAE,QAAQ,EAAsB;;IACnF,MAAM,OAAO,IAAA,4KAAO,EAAsB;QACxC,eAAe,eAAe;YAC5B,MAAM;YACN,cAAc;YACd,QAAQ;YACR,oBAAoB;QACtB;IACF;IAEA,qBACE,6LAAC,oIAAI;QAAE,GAAG,IAAI;kBACZ,cAAA,6LAAC;YAAK,UAAU,KAAK,YAAY,CAAC;YAAW,WAAU;;8BACrD,6LAAC,yIAAS;oBAAC,SAAS,KAAK,OAAO;oBAAE,MAAK;oBAAO,QAAQ,CAAC,EAAE,KAAK,EAAE,iBAC9D,6LAAC,wIAAQ;;8CACP,6LAAC,yIAAS;8CAAC;;;;;;8CACX,6LAAC,2IAAW;8CAAC,cAAA,6LAAC,sIAAK;wCAAC,aAAY;wCAAoB,GAAG,KAAK;wCAAE,OAAO,MAAM,KAAK,IAAI;;;;;;;;;;;8CACpF,6LAAC,2IAAW;;;;;;;;;;;;;;;;8BAGhB,6LAAC,yIAAS;oBAAC,SAAS,KAAK,OAAO;oBAAE,MAAK;oBAAe,QAAQ,CAAC,EAAE,KAAK,EAAE,iBACtE,6LAAC,wIAAQ;;8CACP,6LAAC,yIAAS;8CAAC;;;;;;8CACX,6LAAC,2IAAW;8CAAC,cAAA,6LAAC,sJAAW;wCAAE,GAAG,KAAK;wCAAE,OAAO,MAAM,KAAK,IAAI;wCAAG,UAAU,MAAM,QAAQ;;;;;;;;;;;8CACtF,6LAAC,2IAAW;;;;;;;;;;;;;;;;8BAGhB,6LAAC,yIAAS;oBAAC,SAAS,KAAK,OAAO;oBAAE,MAAK;oBAAS,QAAQ,CAAC,EAAE,KAAK,EAAE,iBAChE,6LAAC,wIAAQ;4BAAC,WAAU;;8CAClB,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC,yIAAS;kDAAC;;;;;;;;;;;8CAEb,6LAAC,2IAAW;8CAAC,cAAA,6LAAC,wIAAM;wCAAC,SAAS,MAAM,KAAK,IAAI;wCAAO,iBAAiB,MAAM,QAAQ;;;;;;;;;;;;;;;;;;;;;;8BAGvF,6LAAC,yIAAS;oBAAC,SAAS,KAAK,OAAO;oBAAE,MAAK;oBAAqB,QAAQ,CAAC,EAAE,KAAK,EAAE,iBAC5E,6LAAC,wIAAQ;4BAAC,WAAU;;8CAClB,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC,yIAAS;kDAAC;;;;;;;;;;;8CAEb,6LAAC,2IAAW;8CAAC,cAAA,6LAAC,wIAAM;wCAAC,SAAS,MAAM,KAAK,IAAI;wCAAO,iBAAiB,MAAM,QAAQ;;;;;;;;;;;;;;;;;;;;;;8BAGvF,6LAAC,8IAAY;oBAAC,WAAU;;sCACtB,6LAAC,wIAAM;4BAAC,MAAK;4BAAS,SAAQ;4BAAU,SAAS;sCAAU;;;;;;sCAC3D,6LAAC,wIAAM;4BAAC,MAAK;sCAAS;;;;;;;;;;;;;;;;;;;;;;;AAKhC;GAlDgB;;QACD,4KAAO;;;KADN"}},
    {"offset": {"line": 2958, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Textarea = React.forwardRef<\r\n  HTMLTextAreaElement,\r\n  React.ComponentProps<\"textarea\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <textarea\r\n      className={cn(\r\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className\r\n      )}\r\n      ref={ref}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,qBACE,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AACA,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 2992, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/tabs.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Tabs = TabsPrimitive.Root\r\n\r\nconst TabsList = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.List\r\n    ref={ref}\r\n    className={cn(\r\n      \"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsList.displayName = TabsPrimitive.List.displayName\r\n\r\nconst TabsTrigger = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium text-muted-foreground ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\r\n\r\nconst TabsContent = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.Content\r\n    ref={ref}\r\n    className={cn(\r\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsContent.displayName = TabsPrimitive.Content.displayName\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,OAAO,2KAAkB;AAE/B,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,2KAAkB;QACjB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,uEACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG,2KAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,6ZACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,mIACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 3059, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/store-factory.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// persist, createJSONStorage removed - database is now source of truth\r\nimport { \r\n  generateSystemId, \r\n  generateBusinessId, \r\n  isBusinessIdUnique,\r\n  getMaxSystemIdCounter,\r\n  getMaxBusinessIdCounter,\r\n  findNextAvailableBusinessId,\r\n  type EntityType \r\n} from './id-utils';\r\nimport { getPrefix } from './smart-prefix';\r\nimport { ID_CONFIG, type SystemId, type BusinessId, createSystemId, createBusinessId as brandBusinessId } from './id-config';\r\n\r\nconst SYSTEM_FALLBACK_ID: SystemId = createSystemId('SYS000000');\r\n\r\nconst asSystemIdFallback = (): SystemId => SYSTEM_FALLBACK_ID;\r\n\r\n// ✅ API Sync helper for store-factory\r\nasync function syncToAPI<T>(\r\n  apiEndpoint: string,\r\n  action: 'create' | 'update' | 'delete' | 'restore',\r\n  data: T | { systemId: SystemId },\r\n  systemId?: SystemId\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' \r\n      ? apiEndpoint \r\n      : `${apiEndpoint}/${systemId || (data as any).systemId}`;\r\n    \r\n    const method = action === 'create' ? 'POST' \r\n      : action === 'update' ? 'PATCH' \r\n      : action === 'delete' ? 'DELETE'\r\n      : 'PATCH'; // restore uses PATCH\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'include',\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.warn(`[Store Factory API] ${action} failed for ${apiEndpoint}:`, response.status);\r\n    }\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Store Factory API] ${action} error for ${apiEndpoint}:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Item with SystemId (branded type)\r\nexport type ItemWithSystemId = { systemId: SystemId; [key: string]: any };\r\n\r\n// ✅ Counter state for ID generation\r\nexport type CounterState = {\r\n  systemId: number;\r\n  businessId: number;\r\n};\r\n\r\nexport type CrudState<T extends ItemWithSystemId> = {\r\n  data: T[];\r\n  _counters: CounterState; // ✅ Persisted counters\r\n  _initialized: boolean; // ✅ Track if loaded from API\r\n  add: (item: Omit<T, 'systemId'>) => T;\r\n  addMultiple: (items: Omit<T, 'systemId'>[]) => void;\r\n  update: (systemId: SystemId, item: Partial<T>) => void; // ✅ Accept partial updates\r\n  remove: (systemId: SystemId) => void; // ✅ Branded type\r\n  hardDelete: (systemId: SystemId) => void; // ✅ Branded type\r\n  restore: (systemId: SystemId) => void; // ✅ Branded type\r\n  findById: (systemId: SystemId | string) => T | undefined; // ✅ Branded type\r\n  getActive: () => T[];\r\n  getDeleted: () => T[];\r\n  loadFromAPI: () => Promise<void>; // ✅ Load data from database\r\n};\r\n\r\nexport const createCrudStore = <T extends ItemWithSystemId>(\r\n  _initialData: T[], // @deprecated - Kept for backward compatibility but NO LONGER USED\r\n  entityType: EntityType, // Changed from idPrefix to entityType\r\n  options?: {\r\n    businessIdField?: keyof T; // Field name for business ID (default: 'id')\r\n    persistKey?: string; // @deprecated - No longer used, kept for backward compatibility\r\n    getCurrentUser?: () => string | undefined; // Function to get current user systemId\r\n    apiEndpoint?: string; // ✅ API endpoint for database sync (e.g., '/api/employees')\r\n  }\r\n) => {\r\n  const businessPrefix = getPrefix(entityType); // Vietnamese prefix for Business ID (NV, KH, DH)\r\n  const config = ID_CONFIG[entityType];\r\n  const systemIdPrefix = config?.systemIdPrefix || entityType.toUpperCase(); // English prefix for SystemId (EMP, CUSTOMER, ORDER)\r\n  \r\n  const businessIdField = options?.businessIdField ?? 'id';\r\n  // const persistKey = options?.persistKey; // @deprecated - No longer used\r\n  const getCurrentUser = options?.getCurrentUser;\r\n  const apiEndpoint = options?.apiEndpoint;\r\n\r\n  // ✅ CHANGED: Start with empty array - database is source of truth\r\n  // Mock data files (data.ts) are NO LONGER USED for runtime\r\n  const normalizedInitialData: T[] = [];\r\n\r\n  const storeConfig = (set: any, get: any) => ({\r\n    data: normalizedInitialData, // ✅ Start empty - data loaded via React Query\r\n    // ✅ Counters start at 0 - will be initialized from API via loadFromAPI()\r\n    _counters: {\r\n      systemId: 0,\r\n      businessId: 0\r\n    },\r\n    _initialized: false, // ✅ Track API initialization\r\n    add: (item: Omit<T, 'systemId'>): T => {\r\n        // ✅ Get counters from state (persisted)\r\n        const currentCounters = get()._counters;\r\n        const newSystemIdCounter = currentCounters.systemId + 1;\r\n        const newSystemId = createSystemId(generateSystemId(entityType, newSystemIdCounter));\r\n        \r\n        // Generate or validate Business ID (if field exists)\r\n        let finalItem = { ...item } as any;\r\n        let newBusinessIdCounter = currentCounters.businessId;\r\n        \r\n        if (businessIdField in item) {\r\n          const customId = (item as any)[businessIdField];\r\n          const existingIds = get().data.map((d: any) => d[businessIdField]);\r\n          \r\n          // ✅ If customId provided, validate uniqueness\r\n          if (customId && customId.trim()) {\r\n            if (!isBusinessIdUnique(customId, existingIds)) {\r\n              throw new Error(`Mã \"${customId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n            }\r\n            finalItem[businessIdField] = customId.trim().toUpperCase();\r\n          } else {\r\n            // ✅ Auto-generate with findNextAvailableBusinessId\r\n            const digitCount = 6; // All entities use 6 digits\r\n            const result = findNextAvailableBusinessId(businessPrefix, existingIds, newBusinessIdCounter, digitCount);\r\n            finalItem[businessIdField] = result.nextId;\r\n            newBusinessIdCounter = result.updatedCounter;\r\n          }\r\n        }\r\n        \r\n        const now = new Date().toISOString();\r\n        const currentUser = getCurrentUser?.();\r\n        const newItem = { \r\n          ...finalItem, \r\n          systemId: newSystemId, // ✅ Branded SystemId\r\n          createdAt: finalItem.createdAt || now,\r\n          updatedAt: now,\r\n          createdBy: finalItem.createdBy || currentUser,\r\n          updatedBy: currentUser,\r\n        } as unknown as T;\r\n        \r\n        // ✅ Update both data and counters atomically\r\n        set((state: any) => ({ \r\n          data: [...state.data, newItem],\r\n          _counters: {\r\n            systemId: newSystemIdCounter,\r\n            businessId: newBusinessIdCounter\r\n          }\r\n        }));\r\n        \r\n        // ✅ Sync to API in background\r\n        if (apiEndpoint) {\r\n          syncToAPI(apiEndpoint, 'create', newItem).catch(console.error);\r\n        }\r\n        \r\n        return newItem;\r\n    },\r\n    addMultiple: (items: Omit<T, 'systemId'>[]) => \r\n        set((state: any) => {\r\n            const now = new Date().toISOString();\r\n            const currentUser = getCurrentUser?.();\r\n            const newItems: T[] = [];\r\n            const digitCount = 6; // All entities use 6 digits\r\n            \r\n            // ✅ Start from current counters\r\n            let currentSystemIdCounter = state._counters.systemId;\r\n            let currentBusinessIdCounter = state._counters.businessId;\r\n            \r\n            items.forEach(item => {\r\n                // ✅ Generate SystemId from current counter\r\n                currentSystemIdCounter++;\r\n                const newSystemId = createSystemId(generateSystemId(entityType, currentSystemIdCounter));\r\n                \r\n                // Generate or validate Business ID (if field exists)\r\n                let finalItem = { ...item } as any;\r\n                if (businessIdField in item) {\r\n                  const customId = (item as any)[businessIdField];\r\n                  \r\n                  // Collect existing IDs (from state + already added in this batch)\r\n                  const existingIds = [\r\n                    ...state.data.map((d: any) => d[businessIdField]),\r\n                    ...newItems.map((d: any) => d[businessIdField])\r\n                  ];\r\n                  \r\n                  // ✅ If customId provided, validate uniqueness\r\n                  if (customId && customId.trim()) {\r\n                    if (!isBusinessIdUnique(customId, existingIds)) {\r\n                      throw new Error(`Mã \"${customId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n                    }\r\n                    finalItem[businessIdField] = customId.trim().toUpperCase();\r\n                  } else {\r\n                    // ✅ Auto-generate with findNextAvailableBusinessId\r\n                    const result = findNextAvailableBusinessId(businessPrefix, existingIds, currentBusinessIdCounter, digitCount);\r\n                    finalItem[businessIdField] = result.nextId;\r\n                    currentBusinessIdCounter = result.updatedCounter;\r\n                  }\r\n                }\r\n                \r\n                newItems.push({ \r\n                  ...finalItem, \r\n                  systemId: newSystemId,\r\n                  createdAt: now,\r\n                  updatedAt: now,\r\n                  createdBy: currentUser,\r\n                  updatedBy: currentUser,\r\n                } as unknown as T);\r\n            });\r\n            \r\n            // ✅ Update both data and counters\r\n            const result = { \r\n              data: [...state.data, ...newItems],\r\n              _counters: {\r\n                systemId: currentSystemIdCounter,\r\n                businessId: currentBusinessIdCounter\r\n              }\r\n            };\r\n            \r\n            // ✅ Sync to API in background (batch)\r\n            if (apiEndpoint) {\r\n              newItems.forEach(item => {\r\n                syncToAPI(apiEndpoint, 'create', item).catch(console.error);\r\n              });\r\n            }\r\n            \r\n            return result;\r\n        }),\r\n    update: (systemId: SystemId, updatedItem: Partial<T>) => {\r\n      // Validate unique business ID (case-insensitive, skip self)\r\n      if (businessIdField in updatedItem) {\r\n        const businessId = (updatedItem as any)[businessIdField];\r\n        const existingIds = get().data\r\n          .filter((d: any) => d.systemId !== systemId)\r\n          .map((d: any) => d[businessIdField]);\r\n        \r\n        if (businessId && !isBusinessIdUnique(businessId, existingIds)) {\r\n          throw new Error(`Mã \"${businessId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n        }\r\n      }\r\n\r\n      const now = new Date().toISOString();\r\n      const currentUser = getCurrentUser?.();\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId \r\n            ? { ...item, ...updatedItem, updatedAt: now, updatedBy: currentUser } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const fullItem = get().data.find((item: T) => item.systemId === systemId);\r\n        if (fullItem) {\r\n          syncToAPI(apiEndpoint, 'update', fullItem, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    remove: (systemId: SystemId) => {\r\n      // Soft delete - mark as deleted\r\n      const now = new Date().toISOString();\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, deletedAt: now } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const item = get().data.find((item: T) => item.systemId === systemId);\r\n        if (item) {\r\n          syncToAPI(apiEndpoint, 'update', { ...item, isDeleted: true, deletedAt: now }, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    hardDelete: (systemId: SystemId) => {\r\n      // Permanent delete - remove from array\r\n      set((state: any) => ({\r\n        data: state.data.filter((item: T) => item.systemId !== systemId),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        syncToAPI(apiEndpoint, 'delete', { systemId }, systemId).catch(console.error);\r\n      }\r\n    },\r\n    restore: (systemId: SystemId) => {\r\n      // Restore soft-deleted item\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: false, deletedAt: null } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const item = get().data.find((item: T) => item.systemId === systemId);\r\n        if (item) {\r\n          syncToAPI(apiEndpoint, 'restore', { ...item, isDeleted: false, deletedAt: null }, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    getActive: () => get().data.filter((item: any) => !item.isDeleted),\r\n    getDeleted: () => get().data.filter((item: any) => item.isDeleted),\r\n    findById: (id: SystemId | string) => get().data.find((item: T) => item.systemId === id || (item as any).id === id),\r\n    \r\n    // ✅ Load data from database API - OPTIMIZED: No more limit=10000!\r\n    // This is now only used for counter initialization, NOT for loading all data\r\n    // Use React Query hooks for data fetching with proper pagination\r\n    loadFromAPI: async () => {\r\n      if (!apiEndpoint) return;\r\n      if (get()._initialized) return;\r\n      \r\n      try {\r\n        // Only fetch minimal data needed to initialize counters\r\n        // Actual data loading should be done via React Query hooks\r\n        const response = await fetch(`${apiEndpoint}?limit=1&sortBy=systemId&sortOrder=desc`, {\r\n          credentials: 'include',\r\n        });\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const pagination = json.pagination || {};\r\n          const lastItem = json.data?.[0];\r\n          \r\n          // Initialize counters from the latest item (highest IDs)\r\n          const newCounters = {\r\n            systemId: lastItem ? getMaxSystemIdCounter([lastItem], systemIdPrefix) : 0,\r\n            businessId: (lastItem && options?.businessIdField)\r\n              ? getMaxBusinessIdCounter([lastItem] as any[], businessPrefix)\r\n              : 0\r\n          };\r\n          \r\n          set({ \r\n            data: [], // Don't store data in Zustand anymore - use React Query\r\n            _counters: newCounters,\r\n            _initialized: true \r\n          });\r\n          \r\n          console.log(`[Store Factory] ${apiEndpoint} initialized. Total records: ${pagination.total || 'unknown'}`);\r\n        }\r\n      } catch (error) {\r\n        console.error(`[Store Factory] loadFromAPI error for ${apiEndpoint}:`, error);\r\n        // Still mark as initialized to prevent infinite retry\r\n        set({ _initialized: true });\r\n      }\r\n    },\r\n  });\r\n\r\n  // ✅ SIMPLIFIED: No localStorage persistence, database is source of truth\r\n  // Data is loaded via ApiSyncProvider on app init\r\n  return create<CrudState<T>>(storeConfig);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3370, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/departments/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Department } from './types';\r\n\r\nexport const useDepartmentStore = createCrudStore<Department>([], 'departments', {\r\n  apiEndpoint: '/api/departments',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,qBAAqB,IAAA,6IAAe,EAAa,EAAE,EAAE,eAAe;IAC/E,aAAa;AACf"}},
    {"offset": {"line": 3386, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/employees/salary-component-form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport type { SalaryComponent, SalaryComponentCategory } from \"./types\";\r\nimport { Button } from \"../../../components/ui/button\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"../../../components/ui/form\";\r\nimport { Input } from \"../../../components/ui/input\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\nimport { DialogFooter } from \"../../../components/ui/dialog\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../../components/ui/select\";\r\nimport { CurrencyInput } from \"../../../components/ui/currency-input\";\r\nimport { Textarea } from \"../../../components/ui/textarea\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"../../../components/ui/tabs\";\r\nimport { Card, CardContent } from \"../../../components/ui/card\";\r\nimport { Badge } from \"../../../components/ui/badge\";\r\nimport { Checkbox } from \"../../../components/ui/checkbox\";\r\nimport { ScrollArea } from \"../../../components/ui/scroll-area\";\r\nimport { useDepartmentStore } from \"../departments/store\";\r\nimport { Info, Calculator, Building2, Banknote, Receipt, Coins } from \"lucide-react\";\r\nimport type { SystemId } from \"@/lib/id-types\";\r\nimport { useEmployeeSettingsStore } from \"./employee-settings-store\";\r\n\r\nexport type SalaryComponentFormValues = Omit<SalaryComponent, 'systemId' | 'id' | 'createdAt' | 'createdBy' | 'updatedAt' | 'updatedBy'>;\r\n\r\ntype SalaryComponentFormProps = {\r\n  initialData?: SalaryComponentFormValues | undefined;\r\n  onSubmit: (values: SalaryComponentFormValues) => void;\r\n  onCancel: () => void;\r\n};\r\n\r\nconst categoryOptions: { value: SalaryComponentCategory; label: string; icon: React.ReactNode; color: string }[] = [\r\n  { value: 'earning', label: 'Thu nhập', icon: <Banknote className=\"h-4 w-4\" />, color: 'bg-green-500/10 text-green-700 border-green-200' },\r\n  { value: 'deduction', label: 'Khấu trừ', icon: <Receipt className=\"h-4 w-4\" />, color: 'bg-red-500/10 text-red-700 border-red-200' },\r\n  { value: 'contribution', label: 'Đóng góp', icon: <Coins className=\"h-4 w-4\" />, color: 'bg-blue-500/10 text-blue-700 border-blue-200' },\r\n];\r\n\r\nexport function SalaryComponentForm({ initialData, onSubmit, onCancel }: SalaryComponentFormProps) {\r\n  const { data: departments } = useDepartmentStore();\r\n  const { settings } = useEmployeeSettingsStore();\r\n  \r\n  // Format số để hiển thị\r\n  const formatNumber = (n: number) => n.toLocaleString('vi-VN');\r\n  \r\n  const form = useForm<SalaryComponentFormValues>({\r\n    defaultValues: initialData || {\r\n      name: '',\r\n      description: '',\r\n      category: 'earning',\r\n      type: 'fixed',\r\n      amount: 0,\r\n      formula: '',\r\n      taxable: false,\r\n      partOfSocialInsurance: false,\r\n      isActive: true,\r\n      sortOrder: 0,\r\n      applicableDepartmentSystemIds: [],\r\n    },\r\n  });\r\n\r\n  const componentType = form.watch('type');\r\n  const selectedCategory = form.watch('category');\r\n  const selectedDepartments = form.watch('applicableDepartmentSystemIds') || [];\r\n\r\n  const handleDepartmentToggle = (departmentSystemId: SystemId) => {\r\n    const current = form.getValues('applicableDepartmentSystemIds') || [];\r\n    if (current.includes(departmentSystemId)) {\r\n      form.setValue('applicableDepartmentSystemIds', current.filter(id => id !== departmentSystemId));\r\n    } else {\r\n      form.setValue('applicableDepartmentSystemIds', [...current, departmentSystemId]);\r\n    }\r\n  };\r\n\r\n  const handleSelectAllDepartments = () => {\r\n    const allIds = departments.map(d => d.systemId);\r\n    form.setValue('applicableDepartmentSystemIds', allIds);\r\n  };\r\n\r\n  const handleClearAllDepartments = () => {\r\n    form.setValue('applicableDepartmentSystemIds', []);\r\n  };\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-0\">\r\n        <Tabs defaultValue=\"basic\" className=\"w-full\">\r\n          <TabsList className=\"grid w-full grid-cols-3 mb-4\">\r\n            <TabsTrigger value=\"basic\" className=\"flex items-center gap-2\">\r\n              <Info className=\"h-4 w-4\" />\r\n              Thông tin cơ bản\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"calculation\" className=\"flex items-center gap-2\">\r\n              <Calculator className=\"h-4 w-4\" />\r\n              Tính toán\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"scope\" className=\"flex items-center gap-2\">\r\n              <Building2 className=\"h-4 w-4\" />\r\n              Phạm vi áp dụng\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          {/* Tab 1: Thông tin cơ bản */}\r\n          <TabsContent value=\"basic\" className=\"space-y-4 mt-0\">\r\n            <FormField control={form.control} name=\"name\" rules={{ required: 'Tên thành phần là bắt buộc' }} render={({ field }) => (\r\n              <FormItem>\r\n                <FormLabel>Tên thành phần <span className=\"text-destructive\">*</span></FormLabel>\r\n                <FormControl><Input placeholder=\"VD: Phụ cấp ăn trưa, Thưởng KPI...\" {...field} value={field.value ?? ''} /></FormControl>\r\n                <FormMessage />\r\n              </FormItem>\r\n            )} />\r\n            \r\n            <FormField control={form.control} name=\"description\" render={({ field }) => (\r\n              <FormItem>\r\n                <FormLabel>Mô tả</FormLabel>\r\n                <FormControl>\r\n                  <Textarea \r\n                    placeholder=\"Mô tả chi tiết về thành phần lương này...\" \r\n                    className=\"resize-none\" \r\n                    rows={3}\r\n                    {...field} \r\n                    value={field.value ?? ''} \r\n                  />\r\n                </FormControl>\r\n                <FormDescription>Ghi chú về cách tính hoặc điều kiện áp dụng</FormDescription>\r\n              </FormItem>\r\n            )} />\r\n\r\n            <FormField control={form.control} name=\"category\" render={({ field }) => (\r\n              <FormItem>\r\n                <FormLabel>Phân loại <span className=\"text-destructive\">*</span></FormLabel>\r\n                <div className=\"grid grid-cols-3 gap-2\">\r\n                  {categoryOptions.map(option => (\r\n                    <Card \r\n                      key={option.value}\r\n                      className={`cursor-pointer transition-all ${\r\n                        field.value === option.value \r\n                          ? `ring-2 ring-primary ${option.color}` \r\n                          : 'hover:bg-muted/50'\r\n                      }`}\r\n                      onClick={() => field.onChange(option.value)}\r\n                    >\r\n                      <CardContent className=\"flex flex-col items-center justify-center p-3 gap-1\">\r\n                        {option.icon}\r\n                        <span className=\"text-sm font-medium\">{option.label}</span>\r\n                      </CardContent>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              </FormItem>\r\n            )} />\r\n\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <FormField control={form.control} name=\"sortOrder\" render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Thứ tự hiển thị</FormLabel>\r\n                  <FormControl>\r\n                    <Input \r\n                      type=\"number\" \r\n                      placeholder=\"0\" \r\n                      {...field} \r\n                      value={field.value ?? 0}\r\n                      onChange={e => field.onChange(parseInt(e.target.value) || 0)}\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>Số nhỏ hơn hiển thị trước</FormDescription>\r\n                </FormItem>\r\n              )} />\r\n\r\n              <FormField control={form.control} name=\"isActive\" render={({ field }) => (\r\n                <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3 shadow-sm h-fit mt-6\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <FormLabel>Kích hoạt</FormLabel>\r\n                    <FormDescription>Bật/tắt thành phần này</FormDescription>\r\n                  </div>\r\n                  <FormControl><Switch checked={field.value ?? true} onCheckedChange={field.onChange} /></FormControl>\r\n                </FormItem>\r\n              )} />\r\n            </div>\r\n          </TabsContent>\r\n\r\n          {/* Tab 2: Tính toán */}\r\n          <TabsContent value=\"calculation\" className=\"space-y-4 mt-0\">\r\n            <FormField control={form.control} name=\"type\" render={({ field }) => (\r\n              <FormItem>\r\n                <FormLabel>Loại giá trị</FormLabel>\r\n                <Select onValueChange={field.onChange} value={field.value ?? 'fixed'}>\r\n                  <FormControl>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                  </FormControl>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"fixed\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Banknote className=\"h-4 w-4\" />\r\n                        Khoản cố định\r\n                      </div>\r\n                    </SelectItem>\r\n                    <SelectItem value=\"formula\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Calculator className=\"h-4 w-4\" />\r\n                        Theo công thức\r\n                      </div>\r\n                    </SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n                <FormDescription>\r\n                  {componentType === 'fixed' \r\n                    ? 'Số tiền cố định cho mỗi kỳ lương'\r\n                    : 'Tính dựa trên công thức với các biến'}\r\n                </FormDescription>\r\n              </FormItem>\r\n            )} />\r\n\r\n            {componentType === 'fixed' ? (\r\n              <FormField control={form.control} name=\"amount\" render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Số tiền</FormLabel>\r\n                  <FormControl>\r\n                    <CurrencyInput \r\n                      value={field.value ?? 0} \r\n                      onChange={field.onChange}\r\n                    />\r\n                  </FormControl>\r\n                  <FormMessage />\r\n                </FormItem>\r\n              )} />\r\n            ) : (\r\n              <>\r\n                <FormField control={form.control} name=\"formula\" render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Công thức</FormLabel>\r\n                    <FormControl>\r\n                      <Textarea \r\n                        placeholder=\"VD: baseSalary * 0.1 hoặc otPayTotal\" \r\n                        className=\"font-mono text-sm resize-none\"\r\n                        rows={3}\r\n                        {...field} \r\n                        value={field.value ?? ''} \r\n                      />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      <span className=\"font-medium\">Biến cơ bản:</span> baseSalary, workDays, standardWorkDays, leaveDays, absentDays<br />\r\n                      <span className=\"font-medium\">Biến OT:</span> otHours, otHoursWeekday, otHoursWeekend, otHoursHoliday<br />\r\n                      <span className=\"font-medium\">Tiền OT (đã nhân hệ số):</span> otPayWeekday, otPayWeekend, otPayHoliday, otPayTotal<br />\r\n                      <span className=\"font-medium\">Phụ cấp:</span> mealAllowancePerDay\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )} />\r\n                \r\n                {/* Hiển thị ô nhập mealAllowancePerDay khi công thức chứa biến này */}\r\n                {form.watch('formula')?.includes('mealAllowancePerDay') && (\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-sm font-medium\">Mức phụ cấp ăn trưa/ngày (VNĐ)</label>\r\n                    <CurrencyInput \r\n                      value={settings.mealAllowancePerDay || 30000} \r\n                      onChange={(value) => {\r\n                        // Cập nhật vào settings store\r\n                        useEmployeeSettingsStore.getState().setSettings({\r\n                          ...settings,\r\n                          mealAllowancePerDay: value,\r\n                        });\r\n                      }}\r\n                    />\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      Giá trị này áp dụng cho tất cả nhân viên. VD: 30,000đ × 20 ngày = 600,000đ\r\n                    </p>\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n\r\n            <div className=\"space-y-3 pt-2\">\r\n              <FormField control={form.control} name=\"taxable\" render={({ field }) => (\r\n                <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3 shadow-sm\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <FormLabel>Tính thuế TNCN</FormLabel>\r\n                    <FormDescription>Thành phần này có chịu thuế thu nhập cá nhân không?</FormDescription>\r\n                  </div>\r\n                  <FormControl><Switch checked={field.value ?? false} onCheckedChange={field.onChange} /></FormControl>\r\n                </FormItem>\r\n              )} />\r\n              \r\n              <FormField control={form.control} name=\"partOfSocialInsurance\" render={({ field }) => (\r\n                <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3 shadow-sm\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <FormLabel>Tính vào lương đóng BHXH</FormLabel>\r\n                    <FormDescription>Thành phần này có tính vào cơ sở đóng bảo hiểm xã hội không?</FormDescription>\r\n                  </div>\r\n                  <FormControl><Switch checked={field.value ?? false} onCheckedChange={field.onChange} /></FormControl>\r\n                </FormItem>\r\n              )} />\r\n            </div>\r\n          </TabsContent>\r\n\r\n          {/* Tab 3: Phạm vi áp dụng */}\r\n          <TabsContent value=\"scope\" className=\"space-y-4 mt-0\">\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\">Phòng ban áp dụng</label>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Chọn các phòng ban sẽ được áp dụng thành phần lương này. Để trống = áp dụng tất cả.\r\n              </p>\r\n              \r\n              <div className=\"flex items-center gap-2 py-2\">\r\n                <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={handleSelectAllDepartments}>\r\n                  Chọn tất cả\r\n                </Button>\r\n                <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={handleClearAllDepartments}>\r\n                  Bỏ chọn tất cả\r\n                </Button>\r\n                {selectedDepartments.length > 0 && (\r\n                  <Badge variant=\"secondary\" className=\"ml-2\">\r\n                    Đã chọn: {selectedDepartments.length}/{departments.length}\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n\r\n              <ScrollArea className=\"h-[200px] rounded-md border p-3\">\r\n                <div className=\"space-y-2\">\r\n                  {departments.map(department => (\r\n                    <div \r\n                      key={department.systemId}\r\n                      className=\"flex items-center space-x-3 p-2 rounded-md hover:bg-muted/50 cursor-pointer\"\r\n                      onClick={() => handleDepartmentToggle(department.systemId)}\r\n                    >\r\n                      <Checkbox \r\n                        checked={selectedDepartments.includes(department.systemId)}\r\n                        onCheckedChange={() => handleDepartmentToggle(department.systemId)}\r\n                      />\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"text-sm font-medium\">{department.name}</p>\r\n                        <p className=\"text-xs text-muted-foreground\">Mã: {department.id}</p>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                  {departments.length === 0 && (\r\n                    <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                      Chưa có phòng ban nào trong hệ thống\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </ScrollArea>\r\n\r\n              {selectedDepartments.length === 0 && (\r\n                <p className=\"text-sm text-muted-foreground flex items-center gap-1\">\r\n                  <Info className=\"h-4 w-4\" />\r\n                  Không chọn phòng ban = áp dụng cho tất cả nhân viên\r\n                </p>\r\n              )}\r\n            </div>\r\n          </TabsContent>\r\n        </Tabs>\r\n\r\n        <DialogFooter className=\"pt-6 border-t mt-4\">\r\n          <div className=\"flex items-center gap-2 mr-auto\">\r\n            <Badge variant={selectedCategory === 'earning' ? 'default' : selectedCategory === 'deduction' ? 'destructive' : 'secondary'}>\r\n              {categoryOptions.find(c => c.value === selectedCategory)?.label}\r\n            </Badge>\r\n            <Badge variant=\"outline\">\r\n              {componentType === 'fixed' ? 'Cố định' : 'Công thức'}\r\n            </Badge>\r\n          </div>\r\n          <Button type=\"button\" variant=\"outline\" onClick={onCancel}>Hủy</Button>\r\n          <Button type=\"submit\">Lưu</Button>\r\n        </DialogFooter>\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4554, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst alertVariants = cva(\r\n  \"relative w-full rounded-lg border border-border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-background text-foreground\",\r\n        destructive:\r\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst Alert = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\r\n>(({ className, variant, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    role=\"alert\"\r\n    className={cn(alertVariants({ variant }), className)}\r\n    {...props}\r\n  />\r\n))\r\nAlert.displayName = \"Alert\"\r\n\r\nconst AlertTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h5\r\n    ref={ref}\r\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertTitle.displayName = \"AlertTitle\"\r\n\r\nconst AlertDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDescription.displayName = \"AlertDescription\"\r\n\r\nexport { Alert, AlertTitle, AlertDescription }\r\n"],"names":[],"mappings":";;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,2KACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,6LAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,2KAAgB,OAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG"}},
    {"offset": {"line": 4632, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/employees/insurance-tax-settings.tsx"],"sourcesContent":["/**\r\n * Insurance & Tax Settings Component\r\n * Cài đặt bảo hiểm xã hội và thuế TNCN theo luật Việt Nam\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useFormContext, useFieldArray } from 'react-hook-form';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '../../../components/ui/card';\r\nimport { FormControl, FormField, FormItem, FormLabel, FormDescription, FormMessage } from '../../../components/ui/form';\r\nimport { Input } from '../../../components/ui/input';\r\nimport { NumberInput } from '../../../components/ui/number-input';\r\nimport { Separator } from '../../../components/ui/separator';\r\nimport { Button } from '../../../components/ui/button';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '../../../components/ui/table';\r\nimport { PlusCircle, Trash2, AlertCircle, Info } from 'lucide-react';\r\nimport { Alert, AlertDescription, AlertTitle } from '../../../components/ui/alert';\r\nimport type { EmployeeSettings } from './types';\r\n\r\nconst formatCurrency = (value: number) => \r\n  new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND', maximumFractionDigits: 0 }).format(value);\r\n\r\nexport function InsuranceTaxSettings() {\r\n  const { control, watch, setValue } = useFormContext<EmployeeSettings>();\r\n  \r\n  const { fields: taxBracketFields, append: appendBracket, remove: removeBracket } = useFieldArray({\r\n    control,\r\n    name: 'taxSettings.taxBrackets',\r\n  });\r\n\r\n  const baseSalaryReference = watch('insuranceRates.baseSalaryReference');\r\n  const calculatedCap = baseSalaryReference * 20;\r\n\r\n  // Auto-update cap when base salary changes\r\n  React.useEffect(() => {\r\n    if (baseSalaryReference) {\r\n      setValue('insuranceRates.insuranceSalaryCap', calculatedCap);\r\n    }\r\n  }, [baseSalaryReference, calculatedCap, setValue]);\r\n\r\n  const handleAddBracket = () => {\r\n    const lastBracket = taxBracketFields[taxBracketFields.length - 1];\r\n    const fromAmount = lastBracket?.toAmount ?? 0;\r\n    appendBracket({\r\n      fromAmount,\r\n      toAmount: fromAmount + 10000000,\r\n      rate: 35,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Insurance Settings */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Cài đặt Bảo hiểm xã hội</CardTitle>\r\n          <CardDescription>\r\n            Tỷ lệ đóng BHXH, BHYT, BHTN theo quy định hiện hành (Luật BHXH 2024)\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Base Salary Reference */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <FormField\r\n              control={control}\r\n              name=\"insuranceRates.baseSalaryReference\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Mức lương cơ sở</FormLabel>\r\n                  <FormControl>\r\n                    <NumberInput \r\n                      {...field} \r\n                      value={field.value as number}\r\n                      step={10000}\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>\r\n                    Lương cơ sở từ 1/7/2024: 2,340,000đ\r\n                  </FormDescription>\r\n                </FormItem>\r\n              )}\r\n            />\r\n            <FormField\r\n              control={control}\r\n              name=\"insuranceRates.insuranceSalaryCap\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Trần đóng BHXH (20 x lương cơ sở)</FormLabel>\r\n                  <FormControl>\r\n                    <NumberInput \r\n                      {...field} \r\n                      value={field.value as number}\r\n                      disabled\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>\r\n                    Tự động tính = {formatCurrency(calculatedCap)}\r\n                  </FormDescription>\r\n                </FormItem>\r\n              )}\r\n            />\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* BHXH Rates */}\r\n          <div>\r\n            <h4 className=\"text-sm font-medium mb-4\">Bảo hiểm xã hội (BHXH)</h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <FormField\r\n                control={control}\r\n                name=\"insuranceRates.socialInsurance.employeeRate\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Người lao động đóng (%)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={0.1}\r\n                        min={0}\r\n                        max={100}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <FormField\r\n                control={control}\r\n                name=\"insuranceRates.socialInsurance.employerRate\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Doanh nghiệp đóng (%)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={0.1}\r\n                        min={0}\r\n                        max={100}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* BHYT Rates */}\r\n          <div>\r\n            <h4 className=\"text-sm font-medium mb-4\">Bảo hiểm y tế (BHYT)</h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <FormField\r\n                control={control}\r\n                name=\"insuranceRates.healthInsurance.employeeRate\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Người lao động đóng (%)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={0.1}\r\n                        min={0}\r\n                        max={100}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <FormField\r\n                control={control}\r\n                name=\"insuranceRates.healthInsurance.employerRate\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Doanh nghiệp đóng (%)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={0.1}\r\n                        min={0}\r\n                        max={100}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* BHTN Rates */}\r\n          <div>\r\n            <h4 className=\"text-sm font-medium mb-4\">Bảo hiểm thất nghiệp (BHTN)</h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <FormField\r\n                control={control}\r\n                name=\"insuranceRates.unemploymentInsurance.employeeRate\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Người lao động đóng (%)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={0.1}\r\n                        min={0}\r\n                        max={100}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <FormField\r\n                control={control}\r\n                name=\"insuranceRates.unemploymentInsurance.employerRate\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Doanh nghiệp đóng (%)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={0.1}\r\n                        min={0}\r\n                        max={100}\r\n                      />\r\n                    </FormControl>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Summary */}\r\n          <Alert>\r\n            <Info className=\"h-4 w-4\" />\r\n            <AlertTitle>Tổng tỷ lệ đóng bảo hiểm</AlertTitle>\r\n            <AlertDescription>\r\n              <div className=\"grid grid-cols-2 gap-4 mt-2\">\r\n                <div>\r\n                  <span className=\"font-medium\">Người lao động:</span>{' '}\r\n                  {(watch('insuranceRates.socialInsurance.employeeRate') ?? 0) +\r\n                    (watch('insuranceRates.healthInsurance.employeeRate') ?? 0) +\r\n                    (watch('insuranceRates.unemploymentInsurance.employeeRate') ?? 0)}%\r\n                </div>\r\n                <div>\r\n                  <span className=\"font-medium\">Doanh nghiệp:</span>{' '}\r\n                  {(watch('insuranceRates.socialInsurance.employerRate') ?? 0) +\r\n                    (watch('insuranceRates.healthInsurance.employerRate') ?? 0) +\r\n                    (watch('insuranceRates.unemploymentInsurance.employerRate') ?? 0)}%\r\n                </div>\r\n              </div>\r\n            </AlertDescription>\r\n          </Alert>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Tax Settings */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Cài đặt Thuế thu nhập cá nhân (TNCN)</CardTitle>\r\n          <CardDescription>\r\n            Giảm trừ gia cảnh và biểu thuế lũy tiến theo Luật thuế TNCN hiện hành\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Deductions */}\r\n          <div>\r\n            <h4 className=\"text-sm font-medium mb-4\">Giảm trừ gia cảnh</h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <FormField\r\n                control={control}\r\n                name=\"taxSettings.personalDeduction\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Giảm trừ bản thân (đồng/tháng)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={100000}\r\n                      />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      Mức hiện hành: 11,000,000đ/tháng\r\n                    </FormDescription>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <FormField\r\n                control={control}\r\n                name=\"taxSettings.dependentDeduction\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>Giảm trừ người phụ thuộc (đồng/tháng/người)</FormLabel>\r\n                    <FormControl>\r\n                      <NumberInput \r\n                        {...field} \r\n                        value={field.value as number}\r\n                        step={100000}\r\n                      />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      Mức hiện hành: 4,400,000đ/người/tháng\r\n                    </FormDescription>\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* Tax Brackets */}\r\n          <div>\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h4 className=\"text-sm font-medium\">Biểu thuế lũy tiến từng phần</h4>\r\n              <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={handleAddBracket}>\r\n                <PlusCircle className=\"h-4 w-4 mr-2\" />\r\n                Thêm bậc thuế\r\n              </Button>\r\n            </div>\r\n            \r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead className=\"w-[80px]\">Bậc</TableHead>\r\n                  <TableHead>Từ (đồng)</TableHead>\r\n                  <TableHead>Đến (đồng)</TableHead>\r\n                  <TableHead className=\"w-[120px]\">Thuế suất (%)</TableHead>\r\n                  <TableHead className=\"w-[80px]\"></TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {taxBracketFields.map((field, index) => (\r\n                  <TableRow key={field.id}>\r\n                    <TableCell className=\"font-medium\">{index + 1}</TableCell>\r\n                    <TableCell>\r\n                      <FormField\r\n                        control={control}\r\n                        name={`taxSettings.taxBrackets.${index}.fromAmount`}\r\n                        render={({ field }) => (\r\n                          <NumberInput \r\n                            {...field} \r\n                            value={field.value as number}\r\n                            step={1000000}\r\n                            className=\"w-full\"\r\n                          />\r\n                        )}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <FormField\r\n                        control={control}\r\n                        name={`taxSettings.taxBrackets.${index}.toAmount`}\r\n                        render={({ field }) => (\r\n                          <NumberInput \r\n                            {...field} \r\n                            value={field.value as number ?? 0}\r\n                            step={1000000}\r\n                            className=\"w-full\"\r\n                            placeholder=\"Không giới hạn\"\r\n                          />\r\n                        )}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <FormField\r\n                        control={control}\r\n                        name={`taxSettings.taxBrackets.${index}.rate`}\r\n                        render={({ field }) => (\r\n                          <NumberInput \r\n                            {...field} \r\n                            value={field.value as number}\r\n                            step={1}\r\n                            min={0}\r\n                            max={100}\r\n                            className=\"w-full\"\r\n                          />\r\n                        )}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {taxBracketFields.length > 1 && (\r\n                        <Button\r\n                          type=\"button\"\r\n                          variant=\"ghost\"\r\n                          size=\"icon\"\r\n                          className=\"h-8 w-8 text-destructive\"\r\n                          onClick={() => removeBracket(index)}\r\n                        >\r\n                          <Trash2 className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      )}\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n            \r\n            <p className=\"text-xs text-muted-foreground mt-2\">\r\n              * Để trống hoặc nhập 0 ở cột \"Đến\" cho bậc cuối cùng (không giới hạn)\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Minimum Wage */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Lương tối thiểu vùng</CardTitle>\r\n          <CardDescription>\r\n            Theo Nghị định 74/2024/NĐ-CP (áp dụng từ 1/7/2024)\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n            <FormField\r\n              control={control}\r\n              name=\"minimumWage.region1\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Vùng I</FormLabel>\r\n                  <FormControl>\r\n                    <NumberInput \r\n                      {...field} \r\n                      value={field.value as number}\r\n                      step={10000}\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>Hà Nội, TP.HCM...</FormDescription>\r\n                </FormItem>\r\n              )}\r\n            />\r\n            <FormField\r\n              control={control}\r\n              name=\"minimumWage.region2\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Vùng II</FormLabel>\r\n                  <FormControl>\r\n                    <NumberInput \r\n                      {...field} \r\n                      value={field.value as number}\r\n                      step={10000}\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>Đà Nẵng, Cần Thơ...</FormDescription>\r\n                </FormItem>\r\n              )}\r\n            />\r\n            <FormField\r\n              control={control}\r\n              name=\"minimumWage.region3\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Vùng III</FormLabel>\r\n                  <FormControl>\r\n                    <NumberInput \r\n                      {...field} \r\n                      value={field.value as number}\r\n                      step={10000}\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>Thành phố tỉnh...</FormDescription>\r\n                </FormItem>\r\n              )}\r\n            />\r\n            <FormField\r\n              control={control}\r\n              name=\"minimumWage.region4\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Vùng IV</FormLabel>\r\n                  <FormControl>\r\n                    <NumberInput \r\n                      {...field} \r\n                      value={field.value as number}\r\n                      step={10000}\r\n                    />\r\n                  </FormControl>\r\n                  <FormDescription>Nông thôn...</FormDescription>\r\n                </FormItem>\r\n              )}\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Standard Work Days */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Ngày công chuẩn</CardTitle>\r\n          <CardDescription>\r\n            Số ngày công chuẩn để tính lương tháng\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <FormField\r\n            control={control}\r\n            name=\"standardWorkDays\"\r\n            render={({ field }) => (\r\n              <FormItem className=\"max-w-xs\">\r\n                <FormLabel>Số ngày công chuẩn/tháng</FormLabel>\r\n                <FormControl>\r\n                  <NumberInput \r\n                    {...field} \r\n                    value={field.value as number}\r\n                    min={20}\r\n                    max={31}\r\n                  />\r\n                </FormControl>\r\n                <FormDescription>\r\n                  Thông thường là 26 ngày (không tính Chủ Nhật)\r\n                </FormDescription>\r\n              </FormItem>\r\n            )}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5961, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/settings/SettingsVerticalTabs.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Tabs, TabsList, TabsTrigger } from \"../ui/tabs\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\ntype SettingsVerticalTabsItem = {\r\n  value: string;\r\n  label: React.ReactNode;\r\n  disabled?: boolean;\r\n  className?: string;\r\n};\r\n\r\ntype SettingsVerticalTabsProps = {\r\n  value: string;\r\n  onValueChange: (value: string) => void;\r\n  tabs: SettingsVerticalTabsItem[];\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  listClassName?: string;\r\n  contentWrapperClassName?: string;\r\n};\r\n\r\n/**\r\n * Shared layout for Settings pages that need sticky vertical tabs.\r\n * Uses shadcn/ui Tabs component with custom styling for vertical layout on desktop.\r\n */\r\nexport function SettingsVerticalTabs({\r\n  value,\r\n  onValueChange,\r\n  tabs,\r\n  children,\r\n  className,\r\n  listClassName,\r\n  contentWrapperClassName,\r\n}: SettingsVerticalTabsProps) {\r\n  return (\r\n    <Tabs \r\n      value={value} \r\n      onValueChange={onValueChange} \r\n      className={cn(\"flex flex-col md:flex-row md:gap-8\", className)}\r\n    >\r\n      {/* Mobile: horizontal scrollable tabs, Desktop: vertical sidebar */}\r\n      <TabsList\r\n        className={cn(\r\n          // Base styles\r\n          \"h-auto w-full justify-start rounded-lg bg-muted p-1\",\r\n          // Mobile: horizontal with scroll\r\n          \"flex flex-row gap-1 overflow-x-auto\",\r\n          // Desktop: vertical sidebar\r\n          \"md:flex-col md:w-[200px] md:shrink-0 md:bg-transparent md:p-0\",\r\n          \"md:sticky md:top-6 md:self-start\",\r\n          listClassName,\r\n        )}\r\n      >\r\n        {tabs.map((tab) => (\r\n          <TabsTrigger\r\n            key={tab.value}\r\n            value={tab.value}\r\n            disabled={tab.disabled}\r\n            className={cn(\r\n              // Mobile: compact horizontal tabs\r\n              \"flex-shrink-0 px-3 py-1.5 text-sm text-foreground\",\r\n              // Desktop: full-width vertical tabs\r\n              \"md:w-full md:justify-start md:px-4 md:py-2\",\r\n              \"md:data-[state=active]:bg-muted md:data-[state=active]:shadow-none\",\r\n              tab.className\r\n            )}\r\n          >\r\n            {tab.label}\r\n          </TabsTrigger>\r\n        ))}\r\n      </TabsList>\r\n      \r\n      {/* Content area */}\r\n      <div className={cn(\r\n        \"flex-1 min-w-0 mt-4 md:mt-0\",\r\n        contentWrapperClassName\r\n      )}>\r\n        {children}\r\n      </div>\r\n    </Tabs>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAuBO,SAAS,qBAAqB,EACnC,KAAK,EACL,aAAa,EACb,IAAI,EACJ,QAAQ,EACR,SAAS,EACT,aAAa,EACb,uBAAuB,EACG;IAC1B,qBACE,6LAAC,oIAAI;QACH,OAAO;QACP,eAAe;QACf,WAAW,IAAA,qHAAE,EAAC,sCAAsC;;0BAGpD,6LAAC,wIAAQ;gBACP,WAAW,IAAA,qHAAE,EACX,cAAc;gBACd,uDACA,iCAAiC;gBACjC,uCACA,4BAA4B;gBAC5B,iEACA,oCACA;0BAGD,KAAK,GAAG,CAAC,CAAC,oBACT,6LAAC,2IAAW;wBAEV,OAAO,IAAI,KAAK;wBAChB,UAAU,IAAI,QAAQ;wBACtB,WAAW,IAAA,qHAAE,EACX,kCAAkC;wBAClC,qDACA,oCAAoC;wBACpC,8CACA,sEACA,IAAI,SAAS;kCAGd,IAAI,KAAK;uBAZL,IAAI,KAAK;;;;;;;;;;0BAkBpB,6LAAC;gBAAI,WAAW,IAAA,qHAAE,EAChB,+BACA;0BAEC;;;;;;;;;;;;AAIT;KAxDgB"}},
    {"offset": {"line": 6024, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/alert-dialog.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { buttonVariants } from \"./button\"\r\n\r\nconst AlertDialog = AlertDialogPrimitive.Root\r\n\r\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\r\n\r\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\r\n\r\nconst AlertDialogOverlay = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Overlay\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/80 transition-opacity duration-200 opacity-0 data-[state=open]:opacity-100 data-[state=closed]:opacity-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  />\r\n))\r\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\r\n\r\nconst AlertDialogContent = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPortal>\r\n    <AlertDialogOverlay />\r\n    <AlertDialogPrimitive.Content\r\n      ref={ref}\r\n      className={cn(\r\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg transition-opacity duration-200 opacity-0 data-[state=open]:opacity-100 data-[state=closed]:opacity-0 sm:rounded-lg\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </AlertDialogPortal>\r\n))\r\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\r\n\r\nconst AlertDialogHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-2 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\r\n\r\nconst AlertDialogFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\r\n\r\nconst AlertDialogTitle = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\"text-lg font-semibold\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\r\n\r\nconst AlertDialogDescription = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogDescription.displayName =\r\n  AlertDialogPrimitive.Description.displayName\r\n\r\nconst AlertDialogAction = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Action\r\n    ref={ref}\r\n    className={cn(buttonVariants(), className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\r\n\r\nconst AlertDialogCancel = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Cancel\r\n    ref={ref}\r\n    className={cn(\r\n      buttonVariants({ variant: \"outline\" }),\r\n      \"mt-2 sm:mt-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\r\n\r\nexport {\r\n  AlertDialog,\r\n  AlertDialogPortal,\r\n  AlertDialogOverlay,\r\n  AlertDialogTrigger,\r\n  AlertDialogContent,\r\n  AlertDialogHeader,\r\n  AlertDialogFooter,\r\n  AlertDialogTitle,\r\n  AlertDialogDescription,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;;;;;;AAEA,MAAM,cAAc,sLAAyB;AAE7C,MAAM,qBAAqB,yLAA4B;AAEvD,MAAM,oBAAoB,wLAA2B;AAErD,MAAM,mCAAqB,2KAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,yLAA4B;QAC3B,WAAW,IAAA,qHAAE,EACX,wIACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;KAVH;AAaN,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,2KAAgB,OAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,yLAA4B;gBAC3B,KAAK;gBACL,WAAW,IAAA,qHAAE,EACX,yQACA;gBAED,GAAG,KAAK;;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,2KAAgB,OAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,uLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,uLAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,2KAAgB,OAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,uBAAuB,WAAW,GAChC,6LAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,IAAA,gJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,2KAAgB,QAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,IAAA,gJAAc,EAAC;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 6184, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/confirm-dialog.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"./alert-dialog\";\r\n\r\ninterface ConfirmDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  title: string;\r\n  description: string;\r\n  confirmText?: string;\r\n  cancelText?: string;\r\n  variant?: \"default\" | \"destructive\";\r\n  onConfirm: () => void;\r\n}\r\n\r\nexport const ConfirmDialog = React.memo(function ConfirmDialog({\r\n  open,\r\n  onOpenChange,\r\n  title,\r\n  description,\r\n  confirmText = \"Xác nhận\",\r\n  cancelText = \"Hủy\",\r\n  variant = \"default\",\r\n  onConfirm,\r\n}: ConfirmDialogProps) {\r\n  const handleConfirm = React.useCallback(() => {\r\n    onConfirm();\r\n    onOpenChange(false);\r\n  }, [onConfirm, onOpenChange]);\r\n  \r\n  // ⚡ OPTIMIZE: Don't render content when closed\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle>{title}</AlertDialogTitle>\r\n          <AlertDialogDescription>{description}</AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel onClick={() => onOpenChange(false)}>\r\n            {cancelText}\r\n          </AlertDialogCancel>\r\n          <AlertDialogAction\r\n            onClick={handleConfirm}\r\n            className={variant === \"destructive\" ? \"bg-destructive text-destructive-foreground hover:bg-destructive/90\" : \"\"}\r\n          >\r\n            {confirmText}\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n});\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;AAsBO,MAAM,8BAAgB,GAAA,qKAAU,SAAC,SAAS,cAAc,EAC7D,IAAI,EACJ,YAAY,EACZ,KAAK,EACL,WAAW,EACX,cAAc,UAAU,EACxB,aAAa,KAAK,EAClB,UAAU,SAAS,EACnB,SAAS,EACU;;IACnB,MAAM,gBAAgB,4KAAiB;kEAAC;YACtC;YACA,aAAa;QACf;iEAAG;QAAC;QAAW;KAAa;IAE5B,+CAA+C;IAC/C,IAAI,CAAC,MAAM,OAAO;IAElB,qBACE,6LAAC,sJAAW;QAAC,MAAM;QAAM,cAAc;kBACrC,cAAA,6LAAC,6JAAkB;;8BACjB,6LAAC,4JAAiB;;sCAChB,6LAAC,2JAAgB;sCAAE;;;;;;sCACnB,6LAAC,iKAAsB;sCAAE;;;;;;;;;;;;8BAE3B,6LAAC,4JAAiB;;sCAChB,6LAAC,4JAAiB;4BAAC,SAAS,IAAM,aAAa;sCAC5C;;;;;;sCAEH,6LAAC,4JAAiB;4BAChB,SAAS;4BACT,WAAW,YAAY,gBAAgB,uEAAuE;sCAE7G;;;;;;;;;;;;;;;;;;;;;;;AAMb"}},
    {"offset": {"line": 6283, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/penalties/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData, penaltyTypesData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Penalty, PenaltyType } from './types';\r\n\r\nexport const usePenaltyStore = createCrudStore<Penalty>([], 'penalties', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=penalty',\r\n});\r\n\r\nexport const usePenaltyTypeStore = createCrudStore<PenaltyType>([], 'penalties', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=penalty-type',\r\n});\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,MAAM,kBAAkB,IAAA,6IAAe,EAAU,EAAE,EAAE,aAAa;IACvE,iBAAiB;IACjB,aAAa;AACf;AAEO,MAAM,sBAAsB,IAAA,6IAAe,EAAc,EAAE,EAAE,aAAa;IAC/E,iBAAiB;IACjB,aAAa;AACf"}},
    {"offset": {"line": 6306, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/penalties/types.ts"],"sourcesContent":["import type { BusinessId, SystemId } from '@/lib/id-types';\r\nimport type { HistoryEntry } from '@/lib/activity-history-helper';\r\n\r\nexport type PenaltyStatus = 'Chưa thanh toán' | 'Đã thanh toán' | 'Đã hủy';\r\nexport type PenaltyCategory = 'complaint' | 'attendance' | 'performance' | 'other';\r\n\r\nexport type Penalty = {\r\n  systemId: SystemId;\r\n  id: BusinessId;\r\n  employeeSystemId: SystemId;\r\n  employeeName: string;\r\n  reason: string;\r\n  amount: number;\r\n  issueDate: string; // YYYY-MM-DD\r\n  status: PenaltyStatus;\r\n  issuerName: string; // Employee Name of the issuer\r\n  issuerSystemId?: SystemId; // Employee SystemId of the issuer\r\n  \r\n  // Linked entities\r\n  linkedComplaintSystemId?: SystemId; // Link to Complaint (if penalty from complaint)\r\n  linkedOrderSystemId?: SystemId; // Link to Order (if applicable)\r\n  \r\n  // Penalty type\r\n  penaltyTypeSystemId?: SystemId; // Link to PenaltyType settings\r\n  penaltyTypeName?: string; // Cached name\r\n  category?: PenaltyCategory;\r\n  \r\n  // Payroll integration\r\n  deductedInPayrollId?: string; // ID of payroll where this was deducted\r\n  deductedAt?: string; // Date when deducted from salary\r\n  \r\n  // Audit\r\n  createdAt?: string;\r\n  updatedAt?: string;\r\n  createdBy?: SystemId;\r\n  updatedBy?: SystemId;\r\n  activityHistory?: HistoryEntry[];\r\n};\r\n\r\n// =============================================\r\n// PENALTY TYPE - Settings for penalty categories\r\n// =============================================\r\n\r\nexport type PenaltyType = {\r\n  systemId: SystemId;\r\n  id: BusinessId;\r\n  name: string; // VD: \"Làm hỏng hàng khách\", \"Đi làm trễ\"\r\n  description?: string;\r\n  defaultAmount: number; // Mức phạt mặc định\r\n  category: PenaltyCategory;\r\n  isActive: boolean;\r\n  order: number; // For sorting in UI\r\n  createdAt?: string;\r\n  updatedAt?: string;\r\n  createdBy?: SystemId;\r\n  updatedBy?: SystemId;\r\n};\r\n\r\n// =============================================\r\n// CONSTANTS\r\n// =============================================\r\n\r\nexport const penaltyStatusLabels: Record<PenaltyStatus, string> = {\r\n  'Chưa thanh toán': 'Chưa thanh toán',\r\n  'Đã thanh toán': 'Đã thanh toán',\r\n  'Đã hủy': 'Đã hủy',\r\n};\r\n\r\nexport const penaltyStatusColors: Record<PenaltyStatus, string> = {\r\n  'Chưa thanh toán': 'bg-yellow-500/10 text-yellow-700 border-yellow-200',\r\n  'Đã thanh toán': 'bg-green-500/10 text-green-700 border-green-200',\r\n  'Đã hủy': 'bg-gray-500/10 text-gray-700 border-gray-200',\r\n};\r\n\r\nexport const penaltyCategoryLabels: Record<PenaltyCategory, string> = {\r\n  complaint: 'Khiếu nại',\r\n  attendance: 'Chấm công',\r\n  performance: 'Hiệu suất',\r\n  other: 'Khác',\r\n};\r\n\r\nexport const penaltyCategoryColors: Record<PenaltyCategory, string> = {\r\n  complaint: 'bg-red-500/10 text-red-700 border-red-200',\r\n  attendance: 'bg-orange-500/10 text-orange-700 border-orange-200',\r\n  performance: 'bg-blue-500/10 text-blue-700 border-blue-200',\r\n  other: 'bg-gray-500/10 text-gray-700 border-gray-200',\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;;AA8DO,MAAM,sBAAqD;IAChE,mBAAmB;IACnB,iBAAiB;IACjB,UAAU;AACZ;AAEO,MAAM,sBAAqD;IAChE,mBAAmB;IACnB,iBAAiB;IACjB,UAAU;AACZ;AAEO,MAAM,wBAAyD;IACpE,WAAW;IACX,YAAY;IACZ,aAAa;IACb,OAAO;AACT;AAEO,MAAM,wBAAyD;IACpE,WAAW;IACX,YAAY;IACZ,aAAa;IACb,OAAO;AACT"}},
    {"offset": {"line": 6345, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/penalties/penalty-types-settings-content.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../components/ui/card';\r\nimport { Label } from '../../../components/ui/label';\r\nimport { Input } from '../../../components/ui/input';\r\nimport { Button } from '../../../components/ui/button';\r\nimport { Switch } from '../../../components/ui/switch';\r\nimport { Textarea } from '../../../components/ui/textarea';\r\nimport { Badge } from '../../../components/ui/badge';\r\nimport { CurrencyInput } from '../../../components/ui/currency-input';\r\nimport { \r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '../../../components/ui/select';\r\nimport { \r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '../../../components/ui/table';\r\nimport { \r\n  MoreHorizontal,\r\n  Plus,\r\n  Save,\r\n  Pencil,\r\n  Trash2,\r\n} from 'lucide-react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '../../../components/ui/dialog';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '../../../components/ui/dropdown-menu';\r\nimport { ConfirmDialog } from '../../../components/ui/confirm-dialog';\r\nimport { toast } from 'sonner';\r\nimport { usePenaltyTypeStore } from './store';\r\nimport type { PenaltyType, PenaltyCategory } from './types';\r\nimport { penaltyCategoryLabels, penaltyCategoryColors } from './types';\r\nimport { asBusinessId } from '@/lib/id-types';\r\n\r\n// ============================================\r\n// PENALTY TYPES SETTINGS CONTENT (No Page Header)\r\n// For embedding in Employee Settings tabs\r\n// ============================================\r\n\r\nexport function PenaltyTypesSettingsContent() {\r\n  const { data: penaltyTypes, add, update, remove } = usePenaltyTypeStore();\r\n  \r\n  // Dialog state\r\n  const [isDialogOpen, setIsDialogOpen] = React.useState(false);\r\n  const [editingType, setEditingType] = React.useState<PenaltyType | null>(null);\r\n  const [deleteConfirmOpen, setDeleteConfirmOpen] = React.useState(false);\r\n  const [typeToDelete, setTypeToDelete] = React.useState<PenaltyType | null>(null);\r\n  \r\n  // Form state\r\n  const [formData, setFormData] = React.useState({\r\n    name: '',\r\n    description: '',\r\n    defaultAmount: 100000,\r\n    category: 'other' as PenaltyCategory,\r\n    isActive: true,\r\n  });\r\n  \r\n  // Sort by order\r\n  const sortedTypes = React.useMemo(() => \r\n    [...penaltyTypes].sort((a, b) => a.order - b.order),\r\n    [penaltyTypes]\r\n  );\r\n  \r\n  // Open dialog for new type\r\n  const handleAddNew = () => {\r\n    setEditingType(null);\r\n    setFormData({\r\n      name: '',\r\n      description: '',\r\n      defaultAmount: 100000,\r\n      category: 'other',\r\n      isActive: true,\r\n    });\r\n    setIsDialogOpen(true);\r\n  };\r\n  \r\n  // Open dialog for edit\r\n  const handleEdit = (type: PenaltyType) => {\r\n    setEditingType(type);\r\n    setFormData({\r\n      name: type.name,\r\n      description: type.description || '',\r\n      defaultAmount: type.defaultAmount,\r\n      category: type.category,\r\n      isActive: type.isActive,\r\n    });\r\n    setIsDialogOpen(true);\r\n  };\r\n  \r\n  // Save type\r\n  const handleSave = () => {\r\n    if (!formData.name.trim()) {\r\n      toast.error('Vui lòng nhập tên loại phạt');\r\n      return;\r\n    }\r\n    \r\n    if (editingType) {\r\n      // Update existing\r\n      update(editingType.systemId, {\r\n        ...editingType,\r\n        name: formData.name.trim(),\r\n        description: formData.description.trim(),\r\n        defaultAmount: formData.defaultAmount,\r\n        category: formData.category,\r\n        isActive: formData.isActive,\r\n        updatedAt: new Date().toISOString(),\r\n      });\r\n      toast.success('Đã cập nhật loại phạt');\r\n    } else {\r\n      // Create new\r\n      const newId = `LP${String(penaltyTypes.length + 1).padStart(3, '0')}`;\r\n      \r\n      add({\r\n        id: asBusinessId(newId),\r\n        name: formData.name.trim(),\r\n        description: formData.description.trim(),\r\n        defaultAmount: formData.defaultAmount,\r\n        category: formData.category,\r\n        isActive: formData.isActive,\r\n        order: penaltyTypes.length + 1,\r\n        createdAt: new Date().toISOString(),\r\n      });\r\n      toast.success('Đã thêm loại phạt mới');\r\n    }\r\n    \r\n    setIsDialogOpen(false);\r\n  };\r\n  \r\n  // Delete type\r\n  const handleDelete = (type: PenaltyType) => {\r\n    setTypeToDelete(type);\r\n    setDeleteConfirmOpen(true);\r\n  };\r\n  \r\n  const confirmDelete = () => {\r\n    if (typeToDelete) {\r\n      remove(typeToDelete.systemId);\r\n      toast.success('Đã xóa loại phạt');\r\n    }\r\n    setDeleteConfirmOpen(false);\r\n    setTypeToDelete(null);\r\n  };\r\n  \r\n  // Toggle active\r\n  const handleToggleActive = (type: PenaltyType) => {\r\n    update(type.systemId, {\r\n      ...type,\r\n      isActive: !type.isActive,\r\n      updatedAt: new Date().toISOString(),\r\n    });\r\n    toast.success(type.isActive ? 'Đã tắt loại phạt' : 'Đã bật loại phạt');\r\n  };\r\n  \r\n  return (\r\n    <>\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle>Loại phạt nhân viên</CardTitle>\r\n              <CardDescription>\r\n                Cấu hình các loại phạt và mức phạt mặc định cho từng loại vi phạm\r\n              </CardDescription>\r\n            </div>\r\n            <Button onClick={handleAddNew} size=\"sm\">\r\n              <Plus className=\"h-4 w-4 mr-2\" />\r\n              Thêm loại phạt\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"border border-border rounded-md\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead className=\"w-12 text-center\">#</TableHead>\r\n                  <TableHead>Tên loại phạt</TableHead>\r\n                  <TableHead>Phân loại</TableHead>\r\n                  <TableHead className=\"text-right\">Mức phạt mặc định</TableHead>\r\n                  <TableHead className=\"text-center\">Trạng thái</TableHead>\r\n                  <TableHead className=\"w-12\"></TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {sortedTypes.length === 0 ? (\r\n                  <TableRow>\r\n                    <TableCell colSpan={6} className=\"text-center text-muted-foreground py-8\">\r\n                      Chưa có loại phạt nào. Nhấn \"Thêm loại phạt\" để tạo mới.\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ) : (\r\n                  sortedTypes.map((type, index) => (\r\n                    <TableRow key={type.systemId}>\r\n                      <TableCell className=\"text-center text-muted-foreground\">\r\n                        {index + 1}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div>\r\n                          <p className=\"font-medium\">{type.name}</p>\r\n                          {type.description && (\r\n                            <p className=\"text-xs text-muted-foreground\">{type.description}</p>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge \r\n                          variant=\"outline\" \r\n                          className={penaltyCategoryColors[type.category]}\r\n                        >\r\n                          {penaltyCategoryLabels[type.category]}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right font-medium\">\r\n                        {type.defaultAmount.toLocaleString('vi-VN')}đ\r\n                      </TableCell>\r\n                      <TableCell className=\"text-center\">\r\n                        <Switch\r\n                          checked={type.isActive}\r\n                          onCheckedChange={() => handleToggleActive(type)}\r\n                        />\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <DropdownMenu>\r\n                          <DropdownMenuTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                              <MoreHorizontal className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          </DropdownMenuTrigger>\r\n                          <DropdownMenuContent align=\"end\">\r\n                            <DropdownMenuItem onClick={() => handleEdit(type)}>\r\n                              <Pencil className=\"h-4 w-4 mr-2\" />\r\n                              Chỉnh sửa\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuSeparator />\r\n                            <DropdownMenuItem \r\n                              onClick={() => handleDelete(type)}\r\n                              className=\"text-destructive\"\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4 mr-2\" />\r\n                              Xóa\r\n                            </DropdownMenuItem>\r\n                          </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))\r\n                )}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Add/Edit Dialog */}\r\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editingType ? 'Chỉnh sửa loại phạt' : 'Thêm loại phạt mới'}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {editingType \r\n                ? 'Cập nhật thông tin loại phạt'\r\n                : 'Tạo loại phạt mới cho nhân viên'\r\n              }\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          \r\n          <div className=\"space-y-4 py-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"name\">Tên loại phạt *</Label>\r\n              <Input\r\n                id=\"name\"\r\n                value={formData.name}\r\n                onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}\r\n                placeholder=\"VD: Đi làm trễ, Làm hỏng hàng...\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"description\">Mô tả</Label>\r\n              <Textarea\r\n                id=\"description\"\r\n                value={formData.description}\r\n                onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}\r\n                placeholder=\"Mô tả chi tiết về loại phạt này...\"\r\n                rows={2}\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"category\">Phân loại</Label>\r\n                <Select\r\n                  value={formData.category}\r\n                  onValueChange={(value: PenaltyCategory) => \r\n                    setFormData(prev => ({ ...prev, category: value }))\r\n                  }\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"complaint\">Khiếu nại</SelectItem>\r\n                    <SelectItem value=\"attendance\">Chấm công</SelectItem>\r\n                    <SelectItem value=\"performance\">Hiệu suất</SelectItem>\r\n                    <SelectItem value=\"other\">Khác</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              \r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"amount\">Mức phạt mặc định</Label>\r\n                <CurrencyInput\r\n                  value={formData.defaultAmount}\r\n                  onChange={(value) => setFormData(prev => ({ ...prev, defaultAmount: value }))}\r\n                />\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-2\">\r\n              <Switch\r\n                id=\"isActive\"\r\n                checked={formData.isActive}\r\n                onCheckedChange={(checked) => \r\n                  setFormData(prev => ({ ...prev, isActive: checked }))\r\n                }\r\n              />\r\n              <Label htmlFor=\"isActive\">Kích hoạt</Label>\r\n            </div>\r\n          </div>\r\n          \r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\r\n              Hủy\r\n            </Button>\r\n            <Button onClick={handleSave}>\r\n              <Save className=\"h-4 w-4 mr-2\" />\r\n              {editingType ? 'Cập nhật' : 'Thêm mới'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      {/* Delete Confirm Dialog */}\r\n      <ConfirmDialog\r\n        open={deleteConfirmOpen}\r\n        onOpenChange={setDeleteConfirmOpen}\r\n        title=\"Xóa loại phạt?\"\r\n        description={`Bạn có chắc muốn xóa loại phạt \"${typeToDelete?.name}\"? Hành động này không thể hoàn tác.`}\r\n        confirmText=\"Xóa\"\r\n        cancelText=\"Hủy\"\r\n        variant=\"destructive\"\r\n        onConfirm={confirmDelete}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7160, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/payroll-template-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { PayrollTemplate } from '../../lib/payroll-types';\r\nimport { generateSystemId, findNextAvailableBusinessId } from '../../lib/id-utils';\r\nimport { getPrefix } from '../../lib/smart-prefix';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { useEmployeeSettingsStore } from '../settings/employees/employee-settings-store';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '../../lib/id-types';\r\n\r\nconst TEMPLATE_ENTITY: 'payroll-templates' = 'payroll-templates';\r\n\r\nconst resolveActorSystemId = () => asSystemId(getCurrentUserSystemId() || 'SYSTEM00000000');\r\n\r\n// =============================================\r\n// DEFAULT TEMPLATES - Mẫu bảng lương chuẩn VN\r\n// =============================================\r\nconst defaultTemplates: PayrollTemplate[] = [\r\n  {\r\n    systemId: asSystemId('PAYTEMP000001'),\r\n    id: asBusinessId('PT000001'),\r\n    name: 'Mẫu lương cơ bản',\r\n    description: 'Dành cho nhân viên thử việc hoặc lương cơ bản không có phụ cấp',\r\n    componentSystemIds: [\r\n      asSystemId('SALCOMP000001'), // Lương cơ bản\r\n    ],\r\n    isDefault: false,\r\n    createdAt: '2024-01-01T00:00:00Z',\r\n    createdBy: asSystemId('SYSTEM00000000'),\r\n    updatedAt: '2024-01-01T00:00:00Z',\r\n    updatedBy: asSystemId('SYSTEM00000000'),\r\n  },\r\n  {\r\n    systemId: asSystemId('PAYTEMP000002'),\r\n    id: asBusinessId('PT000002'),\r\n    name: 'Mẫu lương nhân viên văn phòng',\r\n    description: 'Dành cho nhân viên văn phòng với đầy đủ phụ cấp và thưởng',\r\n    componentSystemIds: [\r\n      asSystemId('SALCOMP000001'), // Lương cơ bản\r\n      asSystemId('SALCOMP000002'), // Phụ cấp ăn trưa\r\n      asSystemId('SALCOMP000003'), // Phụ cấp xăng xe\r\n      asSystemId('SALCOMP000004'), // Phụ cấp điện thoại\r\n      asSystemId('SALCOMP000006'), // Phụ cấp thâm niên\r\n      asSystemId('SALCOMP000008'), // Thưởng chuyên cần\r\n      asSystemId('SALCOMP000009'), // Thưởng KPI\r\n      asSystemId('SALCOMP000010'), // Làm thêm ngày thường\r\n      asSystemId('SALCOMP000020'), // Làm thêm cuối tuần\r\n      asSystemId('SALCOMP000021'), // Làm thêm ngày lễ\r\n      asSystemId('SALCOMP000012'), // Khấu trừ đi trễ\r\n      asSystemId('SALCOMP000014'), // Tạm ứng lương\r\n      asSystemId('SALCOMP000016'), // BHXH\r\n      asSystemId('SALCOMP000017'), // BHYT\r\n      asSystemId('SALCOMP000018'), // BHTN\r\n    ],\r\n    isDefault: true,\r\n    createdAt: '2024-01-01T00:00:00Z',\r\n    createdBy: asSystemId('SYSTEM00000000'),\r\n    updatedAt: '2024-01-01T00:00:00Z',\r\n    updatedBy: asSystemId('SYSTEM00000000'),\r\n  },\r\n  {\r\n    systemId: asSystemId('PAYTEMP000003'),\r\n    id: asBusinessId('PT000003'),\r\n    name: 'Mẫu lương quản lý',\r\n    description: 'Dành cho cấp quản lý với phụ cấp chức vụ',\r\n    componentSystemIds: [\r\n      asSystemId('SALCOMP000001'), // Lương cơ bản\r\n      asSystemId('SALCOMP000002'), // Phụ cấp ăn trưa\r\n      asSystemId('SALCOMP000003'), // Phụ cấp xăng xe\r\n      asSystemId('SALCOMP000004'), // Phụ cấp điện thoại\r\n      asSystemId('SALCOMP000005'), // Phụ cấp chức vụ\r\n      asSystemId('SALCOMP000006'), // Phụ cấp thâm niên\r\n      asSystemId('SALCOMP000008'), // Thưởng chuyên cần\r\n      asSystemId('SALCOMP000009'), // Thưởng KPI\r\n      asSystemId('SALCOMP000010'), // Làm thêm ngày thường\r\n      asSystemId('SALCOMP000020'), // Làm thêm cuối tuần\r\n      asSystemId('SALCOMP000021'), // Làm thêm ngày lễ\r\n      asSystemId('SALCOMP000014'), // Tạm ứng lương\r\n      asSystemId('SALCOMP000016'), // BHXH\r\n      asSystemId('SALCOMP000017'), // BHYT\r\n      asSystemId('SALCOMP000018'), // BHTN\r\n    ],\r\n    isDefault: false,\r\n    createdAt: '2024-01-01T00:00:00Z',\r\n    createdBy: asSystemId('SYSTEM00000000'),\r\n    updatedAt: '2024-01-01T00:00:00Z',\r\n    updatedBy: asSystemId('SYSTEM00000000'),\r\n  },\r\n  {\r\n    systemId: asSystemId('PAYTEMP000004'),\r\n    id: asBusinessId('PT000004'),\r\n    name: 'Mẫu lương kinh doanh',\r\n    description: 'Dành cho nhân viên kinh doanh/sales với hoa hồng',\r\n    componentSystemIds: [\r\n      asSystemId('SALCOMP000001'), // Lương cơ bản\r\n      asSystemId('SALCOMP000002'), // Phụ cấp ăn trưa\r\n      asSystemId('SALCOMP000003'), // Phụ cấp xăng xe\r\n      asSystemId('SALCOMP000004'), // Phụ cấp điện thoại\r\n      asSystemId('SALCOMP000008'), // Thưởng chuyên cần\r\n      asSystemId('SALCOMP000009'), // Thưởng KPI\r\n      asSystemId('SALCOMP000011'), // Hoa hồng bán hàng\r\n      asSystemId('SALCOMP000014'), // Tạm ứng lương\r\n      asSystemId('SALCOMP000016'), // BHXH\r\n      asSystemId('SALCOMP000017'), // BHYT\r\n      asSystemId('SALCOMP000018'), // BHTN\r\n    ],\r\n    isDefault: false,\r\n    createdAt: '2024-01-01T00:00:00Z',\r\n    createdBy: asSystemId('SYSTEM00000000'),\r\n    updatedAt: '2024-01-01T00:00:00Z',\r\n    updatedBy: asSystemId('SYSTEM00000000'),\r\n  },\r\n  {\r\n    systemId: asSystemId('PAYTEMP000005'),\r\n    id: asBusinessId('PT000005'),\r\n    name: 'Mẫu lương toàn bộ',\r\n    description: 'Bao gồm tất cả thành phần lương có trong hệ thống',\r\n    componentSystemIds: [\r\n      asSystemId('SALCOMP000001'), // Lương cơ bản\r\n      asSystemId('SALCOMP000002'), // Phụ cấp ăn trưa\r\n      asSystemId('SALCOMP000003'), // Phụ cấp xăng xe\r\n      asSystemId('SALCOMP000004'), // Phụ cấp điện thoại\r\n      asSystemId('SALCOMP000005'), // Phụ cấp chức vụ\r\n      asSystemId('SALCOMP000006'), // Phụ cấp thâm niên\r\n      asSystemId('SALCOMP000008'), // Thưởng chuyên cần\r\n      asSystemId('SALCOMP000009'), // Thưởng KPI\r\n      asSystemId('SALCOMP000010'), // Làm thêm ngày thường\r\n      asSystemId('SALCOMP000020'), // Làm thêm cuối tuần\r\n      asSystemId('SALCOMP000021'), // Làm thêm ngày lễ\r\n      asSystemId('SALCOMP000011'), // Hoa hồng bán hàng\r\n      asSystemId('SALCOMP000012'), // Khấu trừ đi trễ\r\n      asSystemId('SALCOMP000013'), // Khấu trừ nghỉ không phép\r\n      asSystemId('SALCOMP000014'), // Tạm ứng lương\r\n      asSystemId('SALCOMP000016'), // BHXH\r\n      asSystemId('SALCOMP000017'), // BHYT\r\n      asSystemId('SALCOMP000018'), // BHTN\r\n    ],\r\n    isDefault: false,\r\n    createdAt: '2024-01-01T00:00:00Z',\r\n    createdBy: asSystemId('SYSTEM00000000'),\r\n    updatedAt: '2024-01-01T00:00:00Z',\r\n    updatedBy: asSystemId('SYSTEM00000000'),\r\n  },\r\n];\r\n\r\ntype TemplateCounterState = {\r\n  systemId: number;\r\n  businessId: number;\r\n};\r\n\r\ntype TemplateInput = {\r\n  name: string;\r\n  code?: string | undefined;\r\n  description?: string | undefined;\r\n  componentSystemIds?: SystemId[] | undefined;\r\n  isDefault?: boolean | undefined;\r\n};\r\n\r\ntype PayrollTemplateStoreState = {\r\n  templates: PayrollTemplate[];\r\n  counter: TemplateCounterState;\r\n  initialized: boolean;\r\n  createTemplate: (input: TemplateInput) => PayrollTemplate;\r\n  updateTemplate: (\r\n    systemId: SystemId,\r\n    input: Partial<Omit<TemplateInput, 'componentSystemIds'>> & { componentSystemIds?: SystemId[] }\r\n  ) => PayrollTemplate | undefined;\r\n  deleteTemplate: (systemId: SystemId) => void;\r\n  setDefaultTemplate: (systemId: SystemId) => PayrollTemplate | undefined;\r\n  getTemplateBySystemId: (systemId: SystemId) => PayrollTemplate | undefined;\r\n  getDefaultTemplate: () => PayrollTemplate | undefined;\r\n  ensureDefaultTemplate: () => PayrollTemplate;\r\n  resetToDefaultTemplates: () => void;\r\n  loadFromAPI: () => Promise<void>;\r\n};\r\n\r\nconst initialCounter: TemplateCounterState = {\r\n  systemId: 0,\r\n  businessId: 0,\r\n};\r\n\r\nconst collectBusinessIds = (items: PayrollTemplate[]) =>\r\n  items\r\n    .map((item) => item.id?.toUpperCase())\r\n    .filter((id): id is string => Boolean(id));\r\n\r\nconst sanitizeComponentIds = (componentIds?: Array<SystemId | string>): SystemId[] => {\r\n  const availableComponents = useEmployeeSettingsStore\r\n    .getState()\r\n    .getSalaryComponents()\r\n    .map((component) => asSystemId(component.systemId));\r\n\r\n  if (!availableComponents.length) {\r\n    return [];\r\n  }\r\n\r\n  if (!componentIds?.length) {\r\n    return [...availableComponents];\r\n  }\r\n\r\n  const whitelist = new Set(availableComponents);\r\n  const normalizedSelections = componentIds\r\n    .map((id) => asSystemId(id as string))\r\n    .filter((id) => whitelist.has(id));\r\n\r\n  return normalizedSelections.length\r\n    ? Array.from(new Set(normalizedSelections))\r\n    : [...availableComponents];\r\n};\r\n\r\nconst buildDualIds = (counter: TemplateCounterState, templates: PayrollTemplate[]) => {\r\n  const nextSystemCounter = counter.systemId + 1;\r\n  const systemId = asSystemId(generateSystemId(TEMPLATE_ENTITY, nextSystemCounter));\r\n  const { nextId, updatedCounter } = findNextAvailableBusinessId(\r\n    getPrefix(TEMPLATE_ENTITY),\r\n    collectBusinessIds(templates),\r\n    counter.businessId\r\n  );\r\n\r\n  return {\r\n    systemId,\r\n    id: asBusinessId(nextId),\r\n    counter: {\r\n      systemId: nextSystemCounter,\r\n      businessId: updatedCounter,\r\n    },\r\n  } as const;\r\n};\r\n\r\nconst enforceSingleDefault = (templates: PayrollTemplate[], defaultSystemId?: SystemId) => {\r\n  if (!templates.length) {\r\n    return templates;\r\n  }\r\n\r\n  let defaultAssigned = false;\r\n  return templates.map((template, index) => {\r\n    const shouldBeDefault = defaultSystemId\r\n      ? template.systemId === defaultSystemId\r\n      : (!defaultAssigned && (template.isDefault || index === 0));\r\n\r\n    if (shouldBeDefault) {\r\n      defaultAssigned = true;\r\n      return { ...template, isDefault: true };\r\n    }\r\n\r\n    return { ...template, isDefault: false };\r\n  });\r\n};\r\n\r\n// API sync helper\r\nasync function syncToAPI(\r\n  action: 'create' | 'update' | 'delete', \r\n  data: Partial<PayrollTemplate>\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' \r\n      ? '/api/payroll/templates'\r\n      : `/api/payroll/templates/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Payroll Template API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const usePayrollTemplateStore = create<PayrollTemplateStoreState>()(\r\n  (set, get) => ({\r\n      templates: [],\r\n      counter: initialCounter,\r\n      initialized: false,\r\n      createTemplate: (input) => {\r\n        let createdTemplate: PayrollTemplate | undefined;\r\n        set((state) => {\r\n          const now = new Date().toISOString();\r\n          const actor = resolveActorSystemId();\r\n          const dualIds = buildDualIds(state.counter, state.templates);\r\n          const sanitizedComponents = sanitizeComponentIds(input.componentSystemIds);\r\n\r\n          const template: PayrollTemplate = {\r\n            systemId: dualIds.systemId,\r\n            id: dualIds.id,\r\n            name: input.name,\r\n            code: input.code,\r\n            description: input.description,\r\n            componentSystemIds: sanitizedComponents,\r\n            isDefault: Boolean(input.isDefault),\r\n            createdAt: now,\r\n            createdBy: actor,\r\n            updatedAt: now,\r\n            updatedBy: actor,\r\n          };\r\n\r\n          createdTemplate = template;\r\n          const nextTemplates = enforceSingleDefault(\r\n            [...state.templates, template],\r\n            input.isDefault ? template.systemId : undefined\r\n          );\r\n\r\n          // Sync to API\r\n          syncToAPI('create', template).catch(console.error);\r\n\r\n          return {\r\n            ...state,\r\n            templates: nextTemplates,\r\n            counter: dualIds.counter,\r\n          };\r\n        });\r\n\r\n        if (!createdTemplate) {\r\n          throw new Error('Không thể tạo mẫu bảng lương mới.');\r\n        }\r\n\r\n        return createdTemplate;\r\n      },\r\n      updateTemplate: (systemId, input) => {\r\n        let updatedTemplate: PayrollTemplate | undefined;\r\n        set((state) => {\r\n          const now = new Date().toISOString();\r\n          const actor = resolveActorSystemId();\r\n          const nextTemplates = state.templates.map((template) => {\r\n            if (template.systemId !== systemId) {\r\n              return template;\r\n            }\r\n\r\n            const componentSystemIds = input.componentSystemIds\r\n              ? sanitizeComponentIds(input.componentSystemIds)\r\n              : template.componentSystemIds;\r\n\r\n            updatedTemplate = {\r\n              ...template,\r\n              name: input.name ?? template.name,\r\n              code: input.code ?? template.code,\r\n              description: input.description ?? template.description,\r\n              componentSystemIds,\r\n              isDefault: input.isDefault ?? template.isDefault,\r\n              updatedAt: now,\r\n              updatedBy: actor,\r\n            };\r\n\r\n            return updatedTemplate;\r\n          });\r\n\r\n          const enforcedTemplates = enforceSingleDefault(\r\n            nextTemplates,\r\n            input.isDefault ? systemId : undefined\r\n          );\r\n\r\n          // Sync to API\r\n          if (updatedTemplate) {\r\n            syncToAPI('update', updatedTemplate).catch(console.error);\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            templates: enforcedTemplates,\r\n          };\r\n        });\r\n\r\n        return updatedTemplate;\r\n      },\r\n      deleteTemplate: (systemId) => {\r\n        // Sync to API\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n        \r\n        set((state) => {\r\n          const remaining = state.templates.filter((template) => template.systemId !== systemId);\r\n          const nextTemplates = enforceSingleDefault(remaining);\r\n          return {\r\n            ...state,\r\n            templates: nextTemplates,\r\n          };\r\n        });\r\n\r\n        const hasTemplates = get().templates.length > 0;\r\n        if (!hasTemplates) {\r\n          get().ensureDefaultTemplate();\r\n        }\r\n      },\r\n      setDefaultTemplate: (systemId) => get().updateTemplate(systemId, { isDefault: true }),\r\n      getTemplateBySystemId: (systemId) => get().templates.find((template) => template.systemId === systemId),\r\n      getDefaultTemplate: () => {\r\n        const found = get().templates.find((template) => template.isDefault);\r\n        if (found) {\r\n          return found;\r\n        }\r\n        return get().ensureDefaultTemplate();\r\n      },\r\n      ensureDefaultTemplate: () => {\r\n        const state = get();\r\n        if (state.templates.length) {\r\n          const existingDefault = state.templates.find((template) => template.isDefault);\r\n          if (existingDefault) {\r\n            return existingDefault;\r\n          }\r\n        }\r\n\r\n        // Initialize with default templates\r\n        if (state.templates.length === 0) {\r\n          set((s) => ({\r\n            ...s,\r\n            templates: defaultTemplates,\r\n          }));\r\n          return defaultTemplates.find((t) => t.isDefault) || defaultTemplates[0];\r\n        }\r\n\r\n        return get().createTemplate({\r\n          name: 'Mẫu bảng lương mặc định',\r\n          description: 'Sinh tự động từ thành phần lương mặc định',\r\n          isDefault: true,\r\n        });\r\n      },\r\n      resetToDefaultTemplates: () => {\r\n        set({\r\n          templates: defaultTemplates,\r\n          counter: {\r\n            systemId: 5, // After PAYTEMP000005\r\n            businessId: 5, // After PT000005\r\n          },\r\n        });\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Payroll templates are typically small dataset\r\n          const response = await fetch('/api/payroll/templates?limit=100');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const templates = json.data || json.templates || [];\r\n            if (templates.length > 0) {\r\n              set({ \r\n                templates: templates.map((t: PayrollTemplate) => ({\r\n                  ...t,\r\n                  systemId: asSystemId(t.systemId as string),\r\n                  id: asBusinessId(t.id as string),\r\n                  componentSystemIds: t.componentSystemIds?.map((id: string) => asSystemId(id)) || [],\r\n                })),\r\n                initialized: true \r\n              });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payroll Template Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7552, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/employees/payroll-templates-settings-content.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport Fuse from 'fuse.js';\r\nimport { Plus, RotateCcw, Trash2, Search, X, Edit, MoreHorizontal } from 'lucide-react';\r\nimport { formatDateForDisplay } from '@/lib/date-utils';\r\nimport { Button } from '../../../components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '../../../components/ui/card';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '../../../components/ui/dialog';\r\nimport { Input } from '../../../components/ui/input';\r\nimport { Textarea } from '../../../components/ui/textarea';\r\nimport { Checkbox } from '../../../components/ui/checkbox';\r\nimport { Label } from '../../../components/ui/label';\r\nimport { Badge } from '../../../components/ui/badge';\r\nimport { Switch } from '../../../components/ui/switch';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '../../../components/ui/alert-dialog';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '../../../components/ui/dropdown-menu';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '../../../components/ui/table';\r\nimport { usePayrollTemplateStore } from '../../payroll/payroll-template-store';\r\nimport { useEmployeeSettingsStore } from './employee-settings-store';\r\nimport { toast } from 'sonner';\r\nimport { asSystemId, type SystemId } from '../../../lib/id-types';\r\nimport type { PayrollTemplate } from '../../../lib/payroll-types';\r\n\r\nexport function PayrollTemplatesSettingsContent() {\r\n  const templateStore = usePayrollTemplateStore();\r\n  const salaryComponents = useEmployeeSettingsStore((state) => state.getSalaryComponents());\r\n\r\n  // Search state\r\n  const [searchQuery, setSearchQuery] = React.useState('');\r\n\r\n  // Dialog states\r\n  const [isDialogOpen, setIsDialogOpen] = React.useState(false);\r\n  const [isResetDialogOpen, setIsResetDialogOpen] = React.useState(false);\r\n  const [editingTemplateId, setEditingTemplateId] = React.useState<SystemId | null>(null);\r\n  const [deleteConfirmId, setDeleteConfirmId] = React.useState<SystemId | null>(null);\r\n\r\n  // Form state\r\n  const [formState, setFormState] = React.useState({\r\n    name: '',\r\n    description: '',\r\n    componentSystemIds: salaryComponents.map((component) => asSystemId(component.systemId)),\r\n    isDefault: false,\r\n  });\r\n\r\n  // Raw data\r\n  const templates = templateStore.templates;\r\n\r\n  // Fuse.js for search\r\n  const fuse = React.useMemo(\r\n    () =>\r\n      new Fuse(templates, {\r\n        keys: ['id', 'name', 'description'],\r\n        threshold: 0.3,\r\n        includeScore: true,\r\n      }),\r\n    [templates]\r\n  );\r\n\r\n  // Filtered data\r\n  const filteredData = React.useMemo(() => {\r\n    if (!searchQuery.trim()) return templates;\r\n    const searchResults = fuse.search(searchQuery.trim());\r\n    return searchResults.map((r) => r.item);\r\n  }, [templates, searchQuery, fuse]);\r\n\r\n  // Handlers\r\n  const handleOpenCreateDialog = React.useCallback(() => {\r\n    setEditingTemplateId(null);\r\n    setFormState({\r\n      name: '',\r\n      description: '',\r\n      componentSystemIds: salaryComponents.map((component) => asSystemId(component.systemId)),\r\n      isDefault: false,\r\n    });\r\n    setIsDialogOpen(true);\r\n  }, [salaryComponents]);\r\n\r\n  const handleEdit = React.useCallback((systemId: SystemId) => {\r\n    const template = templateStore.getTemplateBySystemId(systemId);\r\n    if (!template) return;\r\n    setEditingTemplateId(systemId);\r\n    setFormState({\r\n      name: template.name,\r\n      description: template.description ?? '',\r\n      componentSystemIds: template.componentSystemIds,\r\n      isDefault: template.isDefault,\r\n    });\r\n    setIsDialogOpen(true);\r\n  }, [templateStore]);\r\n\r\n  const handleDelete = React.useCallback((systemId: SystemId) => {\r\n    setDeleteConfirmId(systemId);\r\n  }, []);\r\n\r\n  const handleConfirmDelete = React.useCallback(() => {\r\n    if (deleteConfirmId) {\r\n      templateStore.deleteTemplate(deleteConfirmId);\r\n      toast.success('Đã xóa mẫu', { description: 'Mẫu bảng lương đã được gỡ bỏ.' });\r\n      setDeleteConfirmId(null);\r\n    }\r\n  }, [templateStore, deleteConfirmId]);\r\n\r\n  const handleSetDefault = React.useCallback((systemId: SystemId) => {\r\n    templateStore.setDefaultTemplate(systemId);\r\n    toast.success('Đã đặt mặc định', { description: 'Mẫu này sẽ được chọn sẵn khi chạy lương.' });\r\n  }, [templateStore]);\r\n\r\n  const handleToggleDefault = React.useCallback((template: PayrollTemplate, isDefault: boolean) => {\r\n    if (isDefault) {\r\n      // Đặt làm mặc định\r\n      templateStore.setDefaultTemplate(template.systemId);\r\n      toast.success('Đã đặt mặc định', { description: `\"${template.name}\" sẽ được chọn sẵn khi chạy lương.` });\r\n    } else {\r\n      // Bỏ mặc định - hệ thống tự động chọn mẫu khác\r\n      templateStore.updateTemplate(template.systemId, { isDefault: false });\r\n      const newDefault = templateStore.getDefaultTemplate();\r\n      if (newDefault && newDefault.systemId !== template.systemId) {\r\n        toast.success('Đã bỏ mặc định', { description: `\"${newDefault.name}\" đã được đặt làm mặc định.` });\r\n      }\r\n    }\r\n  }, [templateStore]);\r\n\r\n  const handleResetToDefault = React.useCallback(() => {\r\n    templateStore.resetToDefaultTemplates();\r\n    toast.success('Đã khôi phục', { description: 'Đã khôi phục về danh sách mẫu mặc định.' });\r\n    setIsResetDialogOpen(false);\r\n  }, [templateStore]);\r\n\r\n  const resetDialog = () => {\r\n    setIsDialogOpen(false);\r\n    setEditingTemplateId(null);\r\n    setFormState({\r\n      name: '',\r\n      description: '',\r\n      componentSystemIds: salaryComponents.map((component) => asSystemId(component.systemId)),\r\n      isDefault: false,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    if (!formState.name.trim()) {\r\n      toast.error('Vui lòng nhập tên mẫu', { description: 'Tên mẫu bảng lương là bắt buộc.' });\r\n      return;\r\n    }\r\n\r\n    if (editingTemplateId) {\r\n      templateStore.updateTemplate(editingTemplateId, {\r\n        name: formState.name.trim(),\r\n        description: formState.description.trim(),\r\n        componentSystemIds: formState.componentSystemIds,\r\n        isDefault: formState.isDefault,\r\n      });\r\n      toast.success('Đã cập nhật mẫu', { description: 'Thông tin mẫu bảng lương đã được lưu.' });\r\n    } else {\r\n      templateStore.createTemplate({\r\n        name: formState.name.trim(),\r\n        description: formState.description.trim(),\r\n        componentSystemIds: formState.componentSystemIds,\r\n        isDefault: formState.isDefault,\r\n      });\r\n      toast.success('Đã tạo mẫu mới', { description: 'Bạn có thể dùng mẫu này trong wizard chạy lương.' });\r\n    }\r\n\r\n    resetDialog();\r\n  };\r\n\r\n  const toggleComponentSelection = (componentId: SystemId) => {\r\n    setFormState((prev) => {\r\n      const exists = prev.componentSystemIds.includes(componentId);\r\n      return {\r\n        ...prev,\r\n        componentSystemIds: exists\r\n          ? prev.componentSystemIds.filter((id) => id !== componentId)\r\n          : [...prev.componentSystemIds, componentId],\r\n      };\r\n    });\r\n  };\r\n\r\n  const formatDate = (dateString?: string) => {\r\n    if (!dateString) return '—';\r\n    return formatDateForDisplay(dateString);\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <CardTitle>Mẫu bảng lương</CardTitle>\r\n            <CardDescription>Quản lý bộ thành phần lương chuẩn để tái sử dụng khi chạy bảng lương.</CardDescription>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={() => setIsResetDialogOpen(true)}>\r\n              <RotateCcw className=\"mr-2 h-4 w-4\" />\r\n              Khôi phục mặc định\r\n            </Button>\r\n            <Button type=\"button\" size=\"sm\" onClick={handleOpenCreateDialog}>\r\n              <Plus className=\"mr-2 h-4 w-4\" />\r\n              Thêm mẫu\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Search */}\r\n        <div className=\"relative max-w-md\">\r\n          <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n          <Input\r\n            placeholder=\"Tìm theo tên, mã mẫu...\"\r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            className=\"h-9 pl-9 pr-9\"\r\n          />\r\n          {searchQuery && (\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2\"\r\n              onClick={() => setSearchQuery('')}\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Table */}\r\n        <div className=\"border border-border rounded-md\">\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead className=\"w-[120px]\">Mã mẫu</TableHead>\r\n                <TableHead>Tên mẫu</TableHead>\r\n                <TableHead className=\"text-center w-[120px]\">Số thành phần</TableHead>\r\n                <TableHead className=\"text-center w-[100px]\">Mặc định</TableHead>\r\n                <TableHead className=\"w-[120px]\">Ngày tạo</TableHead>\r\n                <TableHead className=\"text-right w-[80px]\">Hành động</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {filteredData.map((template) => (\r\n                <TableRow key={template.systemId}>\r\n                  <TableCell className=\"font-mono text-xs text-muted-foreground\">\r\n                    {template.id}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div>\r\n                      <p className=\"font-medium\">{template.name}</p>\r\n                      {template.description && (\r\n                        <p className=\"text-xs text-muted-foreground line-clamp-1\">{template.description}</p>\r\n                      )}\r\n                    </div>\r\n                  </TableCell>\r\n                  <TableCell className=\"text-center\">\r\n                    {template.componentSystemIds.length} thành phần\r\n                  </TableCell>\r\n                  <TableCell className=\"text-center\">\r\n                    <Switch\r\n                      checked={template.isDefault}\r\n                      onCheckedChange={(checked) => handleToggleDefault(template, checked)}\r\n                      aria-label={template.isDefault ? 'Đang là mẫu mặc định' : 'Đặt làm mẫu mặc định'}\r\n                    />\r\n                  </TableCell>\r\n                  <TableCell className=\"text-xs text-muted-foreground\">\r\n                    {formatDate(template.createdAt)}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right\">\r\n                    <DropdownMenu>\r\n                      <DropdownMenuTrigger asChild>\r\n                        <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 p-0\">\r\n                          <MoreHorizontal className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </DropdownMenuTrigger>\r\n                      <DropdownMenuContent align=\"end\" className=\"w-48\">\r\n                        <DropdownMenuItem onClick={() => handleEdit(template.systemId)}>\r\n                          <Edit className=\"mr-2 h-4 w-4\" />\r\n                          Chỉnh sửa\r\n                        </DropdownMenuItem>\r\n                        <DropdownMenuSeparator />\r\n                        <DropdownMenuItem\r\n                          className=\"text-destructive focus:text-destructive\"\r\n                          onClick={() => handleDelete(template.systemId)}\r\n                        >\r\n                          <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                          Xóa mẫu\r\n                        </DropdownMenuItem>\r\n                      </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {filteredData.length === 0 && (\r\n                <TableRow>\r\n                  <TableCell colSpan={6} className=\"text-center text-muted-foreground py-8\">\r\n                    {searchQuery ? 'Không tìm thấy mẫu phù hợp.' : 'Chưa có mẫu bảng lương nào.'}\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </div>\r\n\r\n        {/* Summary */}\r\n        <p className=\"text-xs text-muted-foreground\">\r\n          {searchQuery ? `Tìm thấy ${filteredData.length} / ${templates.length} mẫu` : `Tổng cộng ${templates.length} mẫu`}\r\n        </p>\r\n      </CardContent>\r\n\r\n      {/* Create/Edit Dialog */}\r\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>{editingTemplateId ? 'Chỉnh sửa mẫu' : 'Tạo mẫu bảng lương'}</DialogTitle>\r\n            <DialogDescription>\r\n              Lựa chọn thành phần lương mặc định để tái sử dụng khi chạy bảng lương.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <form className=\"space-y-4\" onSubmit={handleSubmit}>\r\n            <div className=\"grid gap-3\">\r\n              <Label htmlFor=\"template-name\">Tên mẫu</Label>\r\n              <Input\r\n                id=\"template-name\"\r\n                className=\"h-9\"\r\n                required\r\n                value={formState.name}\r\n                onChange={(event) => setFormState((prev) => ({ ...prev, name: event.target.value }))}\r\n              />\r\n            </div>\r\n            <div className=\"grid gap-3\">\r\n              <Label htmlFor=\"template-description\">Mô tả</Label>\r\n              <Textarea\r\n                id=\"template-description\"\r\n                placeholder=\"Mục đích sử dụng, phòng ban áp dụng...\"\r\n                value={formState.description}\r\n                onChange={(event) => setFormState((prev) => ({ ...prev, description: event.target.value }))}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Thành phần lương</Label>\r\n              <div className=\"max-h-60 space-y-2 overflow-y-auto rounded-lg border border-border p-3\">\r\n                {salaryComponents\r\n                  .filter((c) => c.isActive !== false)\r\n                  .sort((a, b) => (a.sortOrder ?? 0) - (b.sortOrder ?? 0))\r\n                  .map((component) => {\r\n                    const componentSystemId = asSystemId(component.systemId);\r\n                    const checked = formState.componentSystemIds.includes(componentSystemId);\r\n                    return (\r\n                      <label\r\n                        key={component.systemId}\r\n                        className=\"flex cursor-pointer items-center gap-3 text-sm\"\r\n                      >\r\n                        <Checkbox\r\n                          checked={checked}\r\n                          onCheckedChange={() => toggleComponentSelection(componentSystemId)}\r\n                          className=\"h-4 w-4\"\r\n                        />\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <p className=\"font-medium\">{component.name}</p>\r\n                            <Badge\r\n                              variant=\"outline\"\r\n                              className={`text-xs ${\r\n                                component.category === 'earning'\r\n                                  ? 'border-green-200 bg-green-50 text-green-700'\r\n                                  : component.category === 'deduction'\r\n                                    ? 'border-red-200 bg-red-50 text-red-700'\r\n                                    : 'border-blue-200 bg-blue-50 text-blue-700'\r\n                              }`}\r\n                            >\r\n                              {component.category === 'earning'\r\n                                ? 'Thu nhập'\r\n                                : component.category === 'deduction'\r\n                                  ? 'Khấu trừ'\r\n                                  : 'Đóng góp'}\r\n                            </Badge>\r\n                          </div>\r\n                          <p className=\"text-xs text-muted-foreground\">\r\n                            {component.type === 'fixed' ? 'Cố định' : component.formula ?? 'Theo công thức'}\r\n                          </p>\r\n                        </div>\r\n                      </label>\r\n                    );\r\n                  })}\r\n                {salaryComponents.filter((c) => c.isActive !== false).length === 0 && (\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Chưa có thành phần lương. Hãy thêm trong tab \"Lương & Phúc lợi\".\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <label className=\"flex cursor-pointer items-center gap-3 text-sm font-medium\">\r\n              <Checkbox\r\n                checked={formState.isDefault}\r\n                onCheckedChange={(checked) =>\r\n                  setFormState((prev) => ({ ...prev, isDefault: Boolean(checked) }))\r\n                }\r\n                className=\"h-4 w-4\"\r\n              />\r\n              Đặt làm mẫu mặc định\r\n            </label>\r\n\r\n            <DialogFooter className=\"flex flex-row items-center justify-between gap-2\">\r\n              <Button type=\"button\" variant=\"outline\" className=\"h-9\" onClick={resetDialog}>\r\n                Hủy\r\n              </Button>\r\n              <Button type=\"submit\" className=\"h-9\">\r\n                {editingTemplateId ? 'Lưu thay đổi' : 'Tạo mẫu'}\r\n              </Button>\r\n            </DialogFooter>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Reset Confirmation Dialog */}\r\n      <AlertDialog open={isResetDialogOpen} onOpenChange={setIsResetDialogOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Khôi phục mẫu mặc định?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Thao tác này sẽ xóa tất cả các mẫu hiện tại và thay thế bằng 5 mẫu mặc định theo chuẩn\r\n              Việt Nam:\r\n              <ul className=\"mt-2 list-inside list-disc space-y-1\">\r\n                <li>Mẫu lương cơ bản</li>\r\n                <li>Mẫu lương nhân viên văn phòng</li>\r\n                <li>Mẫu lương quản lý</li>\r\n                <li>Mẫu lương kinh doanh</li>\r\n                <li>Mẫu lương toàn bộ</li>\r\n              </ul>\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleResetToDefault}>Khôi phục</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Delete Confirmation Dialog */}\r\n      <AlertDialog open={!!deleteConfirmId} onOpenChange={(open) => !open && setDeleteConfirmId(null)}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa mẫu?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Bạn có chắc chắn muốn xóa mẫu bảng lương này không? Hành động này không thể hoàn tác.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction\r\n              onClick={handleConfirmDelete}\r\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n            >\r\n              Xóa mẫu\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </Card>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AAUA;AAOA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AAGO,SAAS;;IACd,MAAM,gBAAgB,IAAA,iLAAuB;IAC7C,MAAM,mBAAmB,IAAA,iMAAwB;sFAAC,CAAC,QAAU,MAAM,mBAAmB;;IAEtF,eAAe;IACf,MAAM,CAAC,aAAa,eAAe,GAAG,yKAAc,CAAC;IAErD,gBAAgB;IAChB,MAAM,CAAC,cAAc,gBAAgB,GAAG,yKAAc,CAAC;IACvD,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,yKAAc,CAAC;IACjE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,yKAAc,CAAkB;IAClF,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,yKAAc,CAAkB;IAE9E,aAAa;IACb,MAAM,CAAC,WAAW,aAAa,GAAG,yKAAc,CAAC;QAC/C,MAAM;QACN,aAAa;QACb,oBAAoB,iBAAiB,GAAG;wDAAC,CAAC,YAAc,IAAA,mIAAU,EAAC,UAAU,QAAQ;;QACrF,WAAW;IACb;IAEA,WAAW;IACX,MAAM,YAAY,cAAc,SAAS;IAEzC,qBAAqB;IACrB,MAAM,OAAO,wKAAa;yDACxB,IACE,IAAI,yJAAI,CAAC,WAAW;gBAClB,MAAM;oBAAC;oBAAM;oBAAQ;iBAAc;gBACnC,WAAW;gBACX,cAAc;YAChB;wDACF;QAAC;KAAU;IAGb,gBAAgB;IAChB,MAAM,eAAe,wKAAa;iEAAC;YACjC,IAAI,CAAC,YAAY,IAAI,IAAI,OAAO;YAChC,MAAM,gBAAgB,KAAK,MAAM,CAAC,YAAY,IAAI;YAClD,OAAO,cAAc,GAAG;yEAAC,CAAC,IAAM,EAAE,IAAI;;QACxC;gEAAG;QAAC;QAAW;QAAa;KAAK;IAEjC,WAAW;IACX,MAAM,yBAAyB,4KAAiB;+EAAC;YAC/C,qBAAqB;YACrB,aAAa;gBACX,MAAM;gBACN,aAAa;gBACb,oBAAoB,iBAAiB,GAAG;2FAAC,CAAC,YAAc,IAAA,mIAAU,EAAC,UAAU,QAAQ;;gBACrF,WAAW;YACb;YACA,gBAAgB;QAClB;8EAAG;QAAC;KAAiB;IAErB,MAAM,aAAa,4KAAiB;mEAAC,CAAC;YACpC,MAAM,WAAW,cAAc,qBAAqB,CAAC;YACrD,IAAI,CAAC,UAAU;YACf,qBAAqB;YACrB,aAAa;gBACX,MAAM,SAAS,IAAI;gBACnB,aAAa,SAAS,WAAW,IAAI;gBACrC,oBAAoB,SAAS,kBAAkB;gBAC/C,WAAW,SAAS,SAAS;YAC/B;YACA,gBAAgB;QAClB;kEAAG;QAAC;KAAc;IAElB,MAAM,eAAe,4KAAiB;qEAAC,CAAC;YACtC,mBAAmB;QACrB;oEAAG,EAAE;IAEL,MAAM,sBAAsB,4KAAiB;4EAAC;YAC5C,IAAI,iBAAiB;gBACnB,cAAc,cAAc,CAAC;gBAC7B,oJAAK,CAAC,OAAO,CAAC,cAAc;oBAAE,aAAa;gBAAgC;gBAC3E,mBAAmB;YACrB;QACF;2EAAG;QAAC;QAAe;KAAgB;IAEnC,MAAM,mBAAmB,4KAAiB;yEAAC,CAAC;YAC1C,cAAc,kBAAkB,CAAC;YACjC,oJAAK,CAAC,OAAO,CAAC,mBAAmB;gBAAE,aAAa;YAA2C;QAC7F;wEAAG;QAAC;KAAc;IAElB,MAAM,sBAAsB,4KAAiB;4EAAC,CAAC,UAA2B;YACxE,IAAI,WAAW;gBACb,mBAAmB;gBACnB,cAAc,kBAAkB,CAAC,SAAS,QAAQ;gBAClD,oJAAK,CAAC,OAAO,CAAC,mBAAmB;oBAAE,aAAa,CAAC,CAAC,EAAE,SAAS,IAAI,CAAC,kCAAkC,CAAC;gBAAC;YACxG,OAAO;gBACL,+CAA+C;gBAC/C,cAAc,cAAc,CAAC,SAAS,QAAQ,EAAE;oBAAE,WAAW;gBAAM;gBACnE,MAAM,aAAa,cAAc,kBAAkB;gBACnD,IAAI,cAAc,WAAW,QAAQ,KAAK,SAAS,QAAQ,EAAE;oBAC3D,oJAAK,CAAC,OAAO,CAAC,kBAAkB;wBAAE,aAAa,CAAC,CAAC,EAAE,WAAW,IAAI,CAAC,2BAA2B,CAAC;oBAAC;gBAClG;YACF;QACF;2EAAG;QAAC;KAAc;IAElB,MAAM,uBAAuB,4KAAiB;6EAAC;YAC7C,cAAc,uBAAuB;YACrC,oJAAK,CAAC,OAAO,CAAC,gBAAgB;gBAAE,aAAa;YAA0C;YACvF,qBAAqB;QACvB;4EAAG;QAAC;KAAc;IAElB,MAAM,cAAc;QAClB,gBAAgB;QAChB,qBAAqB;QACrB,aAAa;YACX,MAAM;YACN,aAAa;YACb,oBAAoB,iBAAiB,GAAG,CAAC,CAAC,YAAc,IAAA,mIAAU,EAAC,UAAU,QAAQ;YACrF,WAAW;QACb;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,MAAM,cAAc;QACpB,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,IAAI;YAC1B,oJAAK,CAAC,KAAK,CAAC,yBAAyB;gBAAE,aAAa;YAAkC;YACtF;QACF;QAEA,IAAI,mBAAmB;YACrB,cAAc,cAAc,CAAC,mBAAmB;gBAC9C,MAAM,UAAU,IAAI,CAAC,IAAI;gBACzB,aAAa,UAAU,WAAW,CAAC,IAAI;gBACvC,oBAAoB,UAAU,kBAAkB;gBAChD,WAAW,UAAU,SAAS;YAChC;YACA,oJAAK,CAAC,OAAO,CAAC,mBAAmB;gBAAE,aAAa;YAAwC;QAC1F,OAAO;YACL,cAAc,cAAc,CAAC;gBAC3B,MAAM,UAAU,IAAI,CAAC,IAAI;gBACzB,aAAa,UAAU,WAAW,CAAC,IAAI;gBACvC,oBAAoB,UAAU,kBAAkB;gBAChD,WAAW,UAAU,SAAS;YAChC;YACA,oJAAK,CAAC,OAAO,CAAC,kBAAkB;gBAAE,aAAa;YAAmD;QACpG;QAEA;IACF;IAEA,MAAM,2BAA2B,CAAC;QAChC,aAAa,CAAC;YACZ,MAAM,SAAS,KAAK,kBAAkB,CAAC,QAAQ,CAAC;YAChD,OAAO;gBACL,GAAG,IAAI;gBACP,oBAAoB,SAChB,KAAK,kBAAkB,CAAC,MAAM,CAAC,CAAC,KAAO,OAAO,eAC9C;uBAAI,KAAK,kBAAkB;oBAAE;iBAAY;YAC/C;QACF;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,IAAI,CAAC,YAAY,OAAO;QACxB,OAAO,IAAA,+IAAoB,EAAC;IAC9B;IAEA,qBACE,6LAAC,oIAAI;;0BACH,6LAAC,0IAAU;0BACT,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;;8CACC,6LAAC,yIAAS;8CAAC;;;;;;8CACX,6LAAC,+IAAe;8CAAC;;;;;;;;;;;;sCAEnB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,wIAAM;oCAAC,MAAK;oCAAS,SAAQ;oCAAU,MAAK;oCAAK,SAAS,IAAM,qBAAqB;;sDACpF,6LAAC,gOAAS;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAGxC,6LAAC,wIAAM;oCAAC,MAAK;oCAAS,MAAK;oCAAK,SAAS;;sDACvC,6LAAC,6MAAI;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;;;;;;;;;;;;;;;;;;0BAMzC,6LAAC,2IAAW;gBAAC,WAAU;;kCAErB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,mNAAM;gCAAC,WAAU;;;;;;0CAClB,6LAAC,sIAAK;gCACJ,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gCAC9C,WAAU;;;;;;4BAEX,6BACC,6LAAC,wIAAM;gCACL,MAAK;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS,IAAM,eAAe;0CAE9B,cAAA,6LAAC,oMAAC;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAMnB,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,sIAAK;;8CACJ,6LAAC,4IAAW;8CACV,cAAA,6LAAC,yIAAQ;;0DACP,6LAAC,0IAAS;gDAAC,WAAU;0DAAY;;;;;;0DACjC,6LAAC,0IAAS;0DAAC;;;;;;0DACX,6LAAC,0IAAS;gDAAC,WAAU;0DAAwB;;;;;;0DAC7C,6LAAC,0IAAS;gDAAC,WAAU;0DAAwB;;;;;;0DAC7C,6LAAC,0IAAS;gDAAC,WAAU;0DAAY;;;;;;0DACjC,6LAAC,0IAAS;gDAAC,WAAU;0DAAsB;;;;;;;;;;;;;;;;;8CAG/C,6LAAC,0IAAS;;wCACP,aAAa,GAAG,CAAC,CAAC,yBACjB,6LAAC,yIAAQ;;kEACP,6LAAC,0IAAS;wDAAC,WAAU;kEAClB,SAAS,EAAE;;;;;;kEAEd,6LAAC,0IAAS;kEACR,cAAA,6LAAC;;8EACC,6LAAC;oEAAE,WAAU;8EAAe,SAAS,IAAI;;;;;;gEACxC,SAAS,WAAW,kBACnB,6LAAC;oEAAE,WAAU;8EAA8C,SAAS,WAAW;;;;;;;;;;;;;;;;;kEAIrF,6LAAC,0IAAS;wDAAC,WAAU;;4DAClB,SAAS,kBAAkB,CAAC,MAAM;4DAAC;;;;;;;kEAEtC,6LAAC,0IAAS;wDAAC,WAAU;kEACnB,cAAA,6LAAC,wIAAM;4DACL,SAAS,SAAS,SAAS;4DAC3B,iBAAiB,CAAC,UAAY,oBAAoB,UAAU;4DAC5D,cAAY,SAAS,SAAS,GAAG,yBAAyB;;;;;;;;;;;kEAG9D,6LAAC,0IAAS;wDAAC,WAAU;kEAClB,WAAW,SAAS,SAAS;;;;;;kEAEhC,6LAAC,0IAAS;wDAAC,WAAU;kEACnB,cAAA,6LAAC,wJAAY;;8EACX,6LAAC,+JAAmB;oEAAC,OAAO;8EAC1B,cAAA,6LAAC,wIAAM;wEAAC,MAAK;wEAAS,SAAQ;wEAAQ,MAAK;wEAAO,WAAU;kFAC1D,cAAA,6LAAC,qOAAc;4EAAC,WAAU;;;;;;;;;;;;;;;;8EAG9B,6LAAC,+JAAmB;oEAAC,OAAM;oEAAM,WAAU;;sFACzC,6LAAC,4JAAgB;4EAAC,SAAS,IAAM,WAAW,SAAS,QAAQ;;8FAC3D,6LAAC,sNAAI;oFAAC,WAAU;;;;;;gFAAiB;;;;;;;sFAGnC,6LAAC,iKAAqB;;;;;sFACtB,6LAAC,4JAAgB;4EACf,WAAU;4EACV,SAAS,IAAM,aAAa,SAAS,QAAQ;;8FAE7C,6LAAC,uNAAM;oFAAC,WAAU;;;;;;gFAAiB;;;;;;;;;;;;;;;;;;;;;;;;;+CA1C9B,SAAS,QAAQ;;;;;wCAkDjC,aAAa,MAAM,KAAK,mBACvB,6LAAC,yIAAQ;sDACP,cAAA,6LAAC,0IAAS;gDAAC,SAAS;gDAAG,WAAU;0DAC9B,cAAc,gCAAgC;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAS3D,6LAAC;wBAAE,WAAU;kCACV,cAAc,CAAC,SAAS,EAAE,aAAa,MAAM,CAAC,GAAG,EAAE,UAAU,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,UAAU,MAAM,CAAC,IAAI,CAAC;;;;;;;;;;;;0BAKpH,6LAAC,wIAAM;gBAAC,MAAM;gBAAc,cAAc;0BACxC,cAAA,6LAAC,+IAAa;oBAAC,WAAU;;sCACvB,6LAAC,8IAAY;;8CACX,6LAAC,6IAAW;8CAAE,oBAAoB,kBAAkB;;;;;;8CACpD,6LAAC,mJAAiB;8CAAC;;;;;;;;;;;;sCAIrB,6LAAC;4BAAK,WAAU;4BAAY,UAAU;;8CACpC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,sIAAK;4CAAC,SAAQ;sDAAgB;;;;;;sDAC/B,6LAAC,sIAAK;4CACJ,IAAG;4CACH,WAAU;4CACV,QAAQ;4CACR,OAAO,UAAU,IAAI;4CACrB,UAAU,CAAC,QAAU,aAAa,CAAC,OAAS,CAAC;wDAAE,GAAG,IAAI;wDAAE,MAAM,MAAM,MAAM,CAAC,KAAK;oDAAC,CAAC;;;;;;;;;;;;8CAGtF,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,sIAAK;4CAAC,SAAQ;sDAAuB;;;;;;sDACtC,6LAAC,4IAAQ;4CACP,IAAG;4CACH,aAAY;4CACZ,OAAO,UAAU,WAAW;4CAC5B,UAAU,CAAC,QAAU,aAAa,CAAC,OAAS,CAAC;wDAAE,GAAG,IAAI;wDAAE,aAAa,MAAM,MAAM,CAAC,KAAK;oDAAC,CAAC;;;;;;;;;;;;8CAI7F,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,sIAAK;sDAAC;;;;;;sDACP,6LAAC;4CAAI,WAAU;;gDACZ,iBACE,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,OAC7B,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,SAAS,IAAI,CAAC,IAAI,CAAC,EAAE,SAAS,IAAI,CAAC,GACrD,GAAG,CAAC,CAAC;oDACJ,MAAM,oBAAoB,IAAA,mIAAU,EAAC,UAAU,QAAQ;oDACvD,MAAM,UAAU,UAAU,kBAAkB,CAAC,QAAQ,CAAC;oDACtD,qBACE,6LAAC;wDAEC,WAAU;;0EAEV,6LAAC,4IAAQ;gEACP,SAAS;gEACT,iBAAiB,IAAM,yBAAyB;gEAChD,WAAU;;;;;;0EAEZ,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAI,WAAU;;0FACb,6LAAC;gFAAE,WAAU;0FAAe,UAAU,IAAI;;;;;;0FAC1C,6LAAC,sIAAK;gFACJ,SAAQ;gFACR,WAAW,CAAC,QAAQ,EAClB,UAAU,QAAQ,KAAK,YACnB,gDACA,UAAU,QAAQ,KAAK,cACrB,0CACA,4CACN;0FAED,UAAU,QAAQ,KAAK,YACpB,aACA,UAAU,QAAQ,KAAK,cACrB,aACA;;;;;;;;;;;;kFAGV,6LAAC;wEAAE,WAAU;kFACV,UAAU,IAAI,KAAK,UAAU,YAAY,UAAU,OAAO,IAAI;;;;;;;;;;;;;uDA7B9D,UAAU,QAAQ;;;;;gDAkC7B;gDACD,iBAAiB,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK,OAAO,MAAM,KAAK,mBAC/D,6LAAC;oDAAE,WAAU;8DAAgC;;;;;;;;;;;;;;;;;;8CAOnD,6LAAC;oCAAM,WAAU;;sDACf,6LAAC,4IAAQ;4CACP,SAAS,UAAU,SAAS;4CAC5B,iBAAiB,CAAC,UAChB,aAAa,CAAC,OAAS,CAAC;wDAAE,GAAG,IAAI;wDAAE,WAAW,QAAQ;oDAAS,CAAC;4CAElE,WAAU;;;;;;wCACV;;;;;;;8CAIJ,6LAAC,8IAAY;oCAAC,WAAU;;sDACtB,6LAAC,wIAAM;4CAAC,MAAK;4CAAS,SAAQ;4CAAU,WAAU;4CAAM,SAAS;sDAAa;;;;;;sDAG9E,6LAAC,wIAAM;4CAAC,MAAK;4CAAS,WAAU;sDAC7B,oBAAoB,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAQhD,6LAAC,sJAAW;gBAAC,MAAM;gBAAmB,cAAc;0BAClD,cAAA,6LAAC,6JAAkB;;sCACjB,6LAAC,4JAAiB;;8CAChB,6LAAC,2JAAgB;8CAAC;;;;;;8CAClB,6LAAC,iKAAsB;;wCAAC;sDAGtB,6LAAC;4CAAG,WAAU;;8DACZ,6LAAC;8DAAG;;;;;;8DACJ,6LAAC;8DAAG;;;;;;8DACJ,6LAAC;8DAAG;;;;;;8DACJ,6LAAC;8DAAG;;;;;;8DACJ,6LAAC;8DAAG;;;;;;;;;;;;;;;;;;;;;;;;sCAIV,6LAAC,4JAAiB;;8CAChB,6LAAC,4JAAiB;8CAAC;;;;;;8CACnB,6LAAC,4JAAiB;oCAAC,SAAS;8CAAsB;;;;;;;;;;;;;;;;;;;;;;;0BAMxD,6LAAC,sJAAW;gBAAC,MAAM,CAAC,CAAC;gBAAiB,cAAc,CAAC,OAAS,CAAC,QAAQ,mBAAmB;0BACxF,cAAA,6LAAC,6JAAkB;;sCACjB,6LAAC,4JAAiB;;8CAChB,6LAAC,2JAAgB;8CAAC;;;;;;8CAClB,6LAAC,iKAAsB;8CAAC;;;;;;;;;;;;sCAI1B,6LAAC,4JAAiB;;8CAChB,6LAAC,4JAAiB;8CAAC;;;;;;8CACnB,6LAAC,4JAAiB;oCAChB,SAAS;oCACT,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb;GAvbgB;;QACQ,iLAAuB;QACpB,iMAAwB;;;KAFnC"}},
    {"offset": {"line": 8679, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/employees/employee-settings-page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n// FIX: Changed the import of 'FieldArray as useFieldArray' to 'useFieldArray' to resolve an export error.\r\nimport { useForm, useFieldArray } from 'react-hook-form';\r\nimport { useEmployeeSettingsStore } from './employee-settings-store';\r\nimport type { EmployeeSettings, LeaveType, SalaryComponent, LatePenaltyTier } from './types';\r\nimport { useSettingsPageHeader } from '../use-settings-page-header';\r\nimport { Button } from '../../../components/ui/button';\r\nimport { SettingsActionButton } from '../../../components/settings/SettingsActionButton';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '../../../components/ui/card';\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from '../../../components/ui/form';\r\nimport { Input } from '../../../components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../components/ui/select';\r\nimport { Checkbox } from '../../../components/ui/checkbox';\r\nimport { Switch } from '../../../components/ui/switch';\r\nimport { Separator } from '../../../components/ui/separator';\r\nimport { TimePicker } from '../../../components/ui/time-picker';\r\nimport { NumberInput } from '../../../components/ui/number-input';\r\nimport { CurrencyInput } from '../../../components/ui/currency-input';\r\nimport { PlusCircle, Trash2, Edit } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '../../../components/ui/table';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '../../../components/ui/dialog';\r\nimport { LeaveTypeForm, type LeaveTypeFormValues } from './leave-type-form';\r\nimport { SalaryComponentForm, type SalaryComponentFormValues } from './salary-component-form';\r\nimport { InsuranceTaxSettings } from './insurance-tax-settings';\r\nimport { asBusinessId, asSystemId } from '@/lib/id-types';\r\nimport { TabsContent } from '../../../components/ui/tabs';\r\nimport { SettingsVerticalTabs } from '../../../components/settings/SettingsVerticalTabs';\r\nimport { PenaltyTypesSettingsContent } from '../penalties/penalty-types-settings-content';\r\nimport { PayrollTemplatesSettingsContent } from './payroll-templates-settings-content';\r\n\r\nconst weekDays = [\r\n  { id: 1, label: 'Thứ 2' },\r\n  { id: 2, label: 'Thứ 3' },\r\n  { id: 3, label: 'Thứ 4' },\r\n  { id: 4, label: 'Thứ 5' },\r\n  { id: 5, label: 'Thứ 6' },\r\n  { id: 6, label: 'Thứ 7' },\r\n  { id: 0, label: 'Chủ Nhật' },\r\n];\r\n\r\nexport function EmployeeSettingsPage() {\r\n  const router = useRouter();\r\n  const { settings, setSettings } = useEmployeeSettingsStore();\r\n  \r\n  // Check if redirected from template-page with specific tab\r\n  const initialTab = React.useMemo(() => {\r\n    const savedTab = sessionStorage.getItem('employee-settings-active-tab');\r\n    if (savedTab) {\r\n      sessionStorage.removeItem('employee-settings-active-tab');\r\n      return savedTab;\r\n    }\r\n    return 'attendance';\r\n  }, []);\r\n  \r\n  const [activeTab, setActiveTab] = React.useState(initialTab);\r\n\r\n  const form = useForm<EmployeeSettings>({\r\n    defaultValues: settings,\r\n  });\r\n\r\n  // Manual validation function\r\n  const validateSettings = React.useCallback((data: EmployeeSettings): string[] => {\r\n    const errors: string[] = [];\r\n    \r\n    if (!data.workStartTime) errors.push('Vui lòng chọn giờ vào làm');\r\n    if (!data.workEndTime) errors.push('Vui lòng chọn giờ tan làm');\r\n    if (!data.lunchBreakStart) errors.push('Vui lòng chọn giờ bắt đầu nghỉ trưa');\r\n    if (!data.lunchBreakEnd) errors.push('Vui lòng chọn giờ kết thúc nghỉ trưa');\r\n    if (data.lunchBreakDuration < 0) errors.push('Thời gian nghỉ trưa không được âm');\r\n    if (!data.workingDays || data.workingDays.length === 0) errors.push('Chọn ít nhất 1 ngày làm việc');\r\n    if (data.standardWorkDays < 1 || data.standardWorkDays > 31) errors.push('Số công chuẩn phải từ 1-31');\r\n    if (data.allowedLateMinutes < 0) errors.push('Số phút đi trễ không được âm');\r\n    if (data.otHourlyRate < 0) errors.push('Tiền làm thêm/giờ không được âm');\r\n    if (data.otRateWeekend < 1) errors.push('Hệ số làm thêm cuối tuần phải >= 1');\r\n    if (data.otRateHoliday < 1) errors.push('Hệ số làm thêm ngày lễ phải >= 1');\r\n    if (data.baseAnnualLeaveDays < 0) errors.push('Số ngày phép không được âm');\r\n    if (data.payday < 1 || data.payday > 31) errors.push('Ngày trả lương phải từ 1-31');\r\n    if (data.payrollLockDate < 1 || data.payrollLockDate > 31) errors.push('Ngày khóa sổ phải từ 1-31');\r\n    \r\n    return errors;\r\n  }, []);\r\n\r\n  const { control, handleSubmit, watch } = form;\r\n  const handleCancel = React.useCallback(() => {\r\n    router.push('/settings');\r\n  }, [router]);\r\n\r\n  const onSubmit = React.useCallback((data: EmployeeSettings) => {\r\n    setSettings(data);\r\n    toast.success('Đã lưu cài đặt nhân viên thành công');\r\n  }, [setSettings]);\r\n\r\n  const handleSave = React.useCallback(() => {\r\n    void handleSubmit((data: EmployeeSettings) => {\r\n      const validationErrors = validateSettings(data);\r\n      \r\n      if (validationErrors.length > 0) {\r\n        toast.error('Vui lòng kiểm tra lại thông tin', {\r\n          description: validationErrors.slice(0, 3).join('. '),\r\n        });\r\n        return;\r\n      }\r\n      \r\n      onSubmit(data);\r\n    })();\r\n  }, [handleSubmit, onSubmit, validateSettings]);\r\n\r\n  const headerActions = React.useMemo(() => [\r\n    <SettingsActionButton key=\"cancel\" variant=\"outline\" onClick={handleCancel}>\r\n      Hủy\r\n    </SettingsActionButton>,\r\n    <SettingsActionButton key=\"save\" onClick={handleSave}>\r\n      Lưu thay đổi\r\n    </SettingsActionButton>,\r\n  ], [handleCancel, handleSave]);\r\n\r\n  useSettingsPageHeader({\r\n    title: 'Cài đặt nhân viên',\r\n    subtitle: 'Quy định về giờ làm việc, nghỉ phép và lương thưởng',\r\n    actions: headerActions,\r\n  });\r\n\r\n  const tabs = React.useMemo(() => [\r\n    { value: 'attendance', label: 'Chấm công & Thời gian' },\r\n    { value: 'leave', label: 'Quản lý Nghỉ phép' },\r\n    { value: 'payroll', label: 'Lương & Phúc lợi' },\r\n    { value: 'templates', label: 'Mẫu bảng lương' },\r\n    { value: 'insurance-tax', label: 'Bảo hiểm & Thuế' },\r\n    { value: 'penalties', label: 'Loại phạt' },\r\n  ], []);\r\n  \r\n  // State for dialogs\r\n  const [isLeaveTypeFormOpen, setIsLeaveTypeFormOpen] = React.useState(false);\r\n  const [editingLeaveTypeIndex, setEditingLeaveTypeIndex] = React.useState<number | null>(null);\r\n  const [isSalaryComponentFormOpen, setIsSalaryComponentFormOpen] = React.useState(false);\r\n  const [editingSalaryComponentIndex, setEditingSalaryComponentIndex] = React.useState<number | null>(null);\r\n\r\n  const { fields: leaveTypeFields, append: appendLeaveType, remove: removeLeaveType, update: updateLeaveType } = useFieldArray({\r\n      control,\r\n      name: \"leaveTypes\"\r\n  });\r\n\r\n  const { fields: salaryComponentFields, append: appendSalaryComponent, remove: removeSalaryComponent, update: updateSalaryComponent } = useFieldArray({\r\n      control,\r\n      name: \"salaryComponents\"\r\n  });\r\n  \r\n  const allowRollover = watch('allowRollover');\r\n  \r\n  // --- Handlers for Leave Type Dialog ---\r\n  const handleAddLeaveType = () => {\r\n    setEditingLeaveTypeIndex(null);\r\n    setIsLeaveTypeFormOpen(true);\r\n  };\r\n\r\n  const handleEditLeaveType = (index: number) => {\r\n    setEditingLeaveTypeIndex(index);\r\n    setIsLeaveTypeFormOpen(true);\r\n  };\r\n  \r\n  const handleLeaveTypeFormSubmit = (values: LeaveTypeFormValues) => {\r\n    const existing = editingLeaveTypeIndex !== null ? leaveTypeFields[editingLeaveTypeIndex] : undefined;\r\n    const fullValue: LeaveType = {\r\n      ...existing,\r\n      ...values,\r\n      systemId: existing?.systemId ?? asSystemId(`temp-leave-${Date.now()}`),\r\n      id: existing?.id ?? asBusinessId(`TEMP${Date.now()}`),\r\n      applicableGender: existing?.applicableGender ?? 'All',\r\n      applicableDepartmentSystemIds: existing?.applicableDepartmentSystemIds ?? [],\r\n    };\r\n    if (editingLeaveTypeIndex !== null) {\r\n        updateLeaveType(editingLeaveTypeIndex, fullValue);\r\n    } else {\r\n        appendLeaveType(fullValue);\r\n    }\r\n    setIsLeaveTypeFormOpen(false);\r\n  };\r\n  \r\n  // --- Handlers for Salary Component Dialog ---\r\n  const handleAddSalaryComponent = () => {\r\n    setEditingSalaryComponentIndex(null);\r\n    setIsSalaryComponentFormOpen(true);\r\n  };\r\n  \r\n  const handleEditSalaryComponent = (index: number) => {\r\n    setEditingSalaryComponentIndex(index);\r\n    setIsSalaryComponentFormOpen(true);\r\n  };\r\n\r\n  const handleSalaryComponentFormSubmit = (values: SalaryComponentFormValues) => {\r\n      const existing = editingSalaryComponentIndex !== null ? salaryComponentFields[editingSalaryComponentIndex] : undefined;\r\n      const fullValue: SalaryComponent = {\r\n        ...existing,\r\n        ...values,\r\n        systemId: existing?.systemId ?? asSystemId(`temp-sal-${Date.now()}`),\r\n        id: existing?.id ?? asBusinessId(`TEMP${Date.now()}`),\r\n      };\r\n       if (editingSalaryComponentIndex !== null) {\r\n          updateSalaryComponent(editingSalaryComponentIndex, fullValue);\r\n      } else {\r\n          appendSalaryComponent(fullValue);\r\n      }\r\n      setIsSalaryComponentFormOpen(false);\r\n  };\r\n\r\n  const currentLeaveTypeData = editingLeaveTypeIndex !== null ? (leaveTypeFields[editingLeaveTypeIndex] as unknown as LeaveTypeFormValues) : undefined;\r\n  const currentSalaryComponentData = editingSalaryComponentIndex !== null ? (salaryComponentFields[editingSalaryComponentIndex] as unknown as SalaryComponentFormValues) : undefined;\r\n  \r\n  return (\r\n    <>\r\n      <Form {...form}>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <SettingsVerticalTabs value={activeTab} onValueChange={setActiveTab} tabs={tabs}>\r\n            {/* Tab 1: Chấm công & Thời gian làm việc */}\r\n            <TabsContent value=\"attendance\" className=\"mt-0\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Chấm công & Thời gian làm việc</CardTitle>\r\n                  <CardDescription>Quy định về giờ làm, ca làm việc, OT và các chính sách liên quan.</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-6\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    <FormField control={control} name=\"workStartTime\" render={({ field }) => ( <FormItem><FormLabel>Giờ vào làm</FormLabel><TimePicker value={field.value as string} onChange={field.onChange} /><FormMessage /></FormItem> )} />\r\n                    <FormField control={control} name=\"workEndTime\" render={({ field }) => ( <FormItem><FormLabel>Giờ tan làm</FormLabel><TimePicker value={field.value as string} onChange={field.onChange} /><FormMessage /></FormItem> )} />\r\n                    <FormField control={control} name=\"standardWorkDays\" render={({ field }) => ( <FormItem><FormLabel>Số công chuẩn/tháng</FormLabel><FormControl><NumberInput {...field} value={field.value as number} /></FormControl><FormMessage /></FormItem> )} />\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    <FormField control={control} name=\"lunchBreakStart\" render={({ field }) => ( <FormItem><FormLabel>Giờ bắt đầu nghỉ trưa</FormLabel><TimePicker value={field.value as string} onChange={field.onChange} /><FormMessage /></FormItem> )} />\r\n                    <FormField control={control} name=\"lunchBreakEnd\" render={({ field }) => ( <FormItem><FormLabel>Giờ kết thúc nghỉ trưa</FormLabel><TimePicker value={field.value as string} onChange={field.onChange} /><FormMessage /></FormItem> )} />\r\n                    <FormField control={control} name=\"lunchBreakDuration\" render={({ field }) => ( <FormItem><FormLabel>Thời gian nghỉ trưa (phút)</FormLabel><FormControl><NumberInput {...field} value={field.value as number} /></FormControl><FormMessage /></FormItem> )} />\r\n                  </div>\r\n                  <FormField control={control} name=\"workingDays\" render={() => ( <FormItem> <FormLabel>Ngày làm việc trong tuần</FormLabel> <div className=\"flex flex-wrap gap-4 pt-2\"> {weekDays.map((day) => ( <FormField key={day.id} control={control} name=\"workingDays\" render={({ field }) => ( <FormItem className=\"flex flex-row items-start space-x-3 space-y-0\"> <FormControl> <Checkbox checked={(field.value as number[])?.includes(day.id)} onCheckedChange={(checked) => { return checked ? field.onChange([...(field.value as number[]), day.id]) : field.onChange((field.value as number[])?.filter((value) => value !== day.id)); }} /> </FormControl> <FormLabel className=\"font-normal\">{day.label}</FormLabel> </FormItem> )} /> ))} </div> <FormMessage /> </FormItem> )} />\r\n                  <Separator />\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <FormField control={control} name=\"allowedLateMinutes\" render={({ field }) => ( <FormItem><FormLabel>Số phút đi trễ cho phép (trước khi bắt đầu tính phạt)</FormLabel><FormControl><NumberInput {...field} value={field.value as number} /></FormControl><FormMessage /></FormItem> )} />\r\n                  </div>\r\n                  \r\n                  {/* Bảng mức phạt đi trễ */}\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <h4 className=\"font-medium text-base\">Các mức phạt đi trễ</h4>\r\n                      <Button type=\"button\" size=\"sm\" onClick={() => {\r\n                        const current = form.getValues('latePenaltyTiers') || [];\r\n                        const lastTier = current[current.length - 1];\r\n                        const newFrom = lastTier ? (lastTier.toMinutes || lastTier.fromMinutes + 30) : 0;\r\n                        form.setValue('latePenaltyTiers', [...current, { fromMinutes: newFrom, toMinutes: null, amount: 0 }]);\r\n                      }}>\r\n                        <PlusCircle className=\"mr-2 h-4 w-4\" /> Thêm mức\r\n                      </Button>\r\n                    </div>\r\n                    <div className=\"border border-border rounded-md\">\r\n                      <Table>\r\n                        <TableHeader>\r\n                          <TableRow>\r\n                            <TableHead className=\"w-[150px]\">Từ (phút)</TableHead>\r\n                            <TableHead className=\"w-[150px]\">Đến (phút)</TableHead>\r\n                            <TableHead>Số tiền phạt (VNĐ)</TableHead>\r\n                            <TableHead className=\"w-[80px]\"></TableHead>\r\n                          </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                          {(watch('latePenaltyTiers') || []).map((tier, index) => (\r\n                            <TableRow key={index}>\r\n                              <TableCell>\r\n                                <NumberInput \r\n                                  value={tier.fromMinutes} \r\n                                  onChange={(val) => {\r\n                                    const tiers = [...(form.getValues('latePenaltyTiers') || [])];\r\n                                    tiers[index] = { ...tiers[index], fromMinutes: val };\r\n                                    form.setValue('latePenaltyTiers', tiers);\r\n                                  }} \r\n                                />\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <NumberInput \r\n                                  value={tier.toMinutes ?? undefined} \r\n                                  placeholder=\"Không giới hạn\"\r\n                                  onChange={(val) => {\r\n                                    const tiers = [...(form.getValues('latePenaltyTiers') || [])];\r\n                                    tiers[index] = { ...tiers[index], toMinutes: typeof val === 'number' ? val : null };\r\n                                    form.setValue('latePenaltyTiers', tiers);\r\n                                  }} \r\n                                />\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <CurrencyInput \r\n                                  value={tier.amount} \r\n                                  onChange={(val) => {\r\n                                    const tiers = [...(form.getValues('latePenaltyTiers') || [])];\r\n                                    tiers[index] = { ...tiers[index], amount: val ?? 0 };\r\n                                    form.setValue('latePenaltyTiers', tiers);\r\n                                  }} \r\n                                />\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive\" onClick={() => {\r\n                                  const tiers = form.getValues('latePenaltyTiers')?.filter((_, i) => i !== index) || [];\r\n                                  form.setValue('latePenaltyTiers', tiers);\r\n                                }}>\r\n                                  <Trash2 className=\"h-4 w-4\" />\r\n                                </Button>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          ))}\r\n                          {(!watch('latePenaltyTiers') || watch('latePenaltyTiers').length === 0) && (\r\n                            <TableRow><TableCell colSpan={4} className=\"text-center text-muted-foreground\">Chưa có mức phạt nào. Thêm mức phạt để tự động tạo phiếu phạt khi đi trễ.</TableCell></TableRow>\r\n                          )}\r\n                        </TableBody>\r\n                      </Table>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Bảng mức phạt về sớm */}\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <h4 className=\"font-medium text-base\">Các mức phạt về sớm</h4>\r\n                      <Button type=\"button\" size=\"sm\" onClick={() => {\r\n                        const current = form.getValues('earlyLeavePenaltyTiers') || [];\r\n                        const lastTier = current[current.length - 1];\r\n                        const newFrom = lastTier ? (lastTier.toMinutes || lastTier.fromMinutes + 30) : 0;\r\n                        form.setValue('earlyLeavePenaltyTiers', [...current, { fromMinutes: newFrom, toMinutes: null, amount: 0 }]);\r\n                      }}>\r\n                        <PlusCircle className=\"mr-2 h-4 w-4\" /> Thêm mức\r\n                      </Button>\r\n                    </div>\r\n                    <div className=\"border border-border rounded-md\">\r\n                      <Table>\r\n                        <TableHeader>\r\n                          <TableRow>\r\n                            <TableHead className=\"w-[150px]\">Từ (phút)</TableHead>\r\n                            <TableHead className=\"w-[150px]\">Đến (phút)</TableHead>\r\n                            <TableHead>Số tiền phạt (VNĐ)</TableHead>\r\n                            <TableHead className=\"w-[80px]\"></TableHead>\r\n                          </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                          {(watch('earlyLeavePenaltyTiers') || []).map((tier, index) => (\r\n                            <TableRow key={index}>\r\n                              <TableCell>\r\n                                <NumberInput \r\n                                  value={tier.fromMinutes} \r\n                                  onChange={(val) => {\r\n                                    const tiers = [...(form.getValues('earlyLeavePenaltyTiers') || [])];\r\n                                    tiers[index] = { ...tiers[index], fromMinutes: val };\r\n                                    form.setValue('earlyLeavePenaltyTiers', tiers);\r\n                                  }} \r\n                                />\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <NumberInput \r\n                                  value={tier.toMinutes ?? undefined} \r\n                                  placeholder=\"Không giới hạn\"\r\n                                  onChange={(val) => {\r\n                                    const tiers = [...(form.getValues('earlyLeavePenaltyTiers') || [])];\r\n                                    tiers[index] = { ...tiers[index], toMinutes: typeof val === 'number' ? val : null };\r\n                                    form.setValue('earlyLeavePenaltyTiers', tiers);\r\n                                  }} \r\n                                />\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <CurrencyInput \r\n                                  value={tier.amount} \r\n                                  onChange={(val) => {\r\n                                    const tiers = [...(form.getValues('earlyLeavePenaltyTiers') || [])];\r\n                                    tiers[index] = { ...tiers[index], amount: val ?? 0 };\r\n                                    form.setValue('earlyLeavePenaltyTiers', tiers);\r\n                                  }} \r\n                                />\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive\" onClick={() => {\r\n                                  const tiers = form.getValues('earlyLeavePenaltyTiers')?.filter((_, i) => i !== index) || [];\r\n                                  form.setValue('earlyLeavePenaltyTiers', tiers);\r\n                                }}>\r\n                                  <Trash2 className=\"h-4 w-4\" />\r\n                                </Button>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          ))}\r\n                          {(!watch('earlyLeavePenaltyTiers') || watch('earlyLeavePenaltyTiers').length === 0) && (\r\n                            <TableRow><TableCell colSpan={4} className=\"text-center text-muted-foreground\">Chưa có mức phạt nào.</TableCell></TableRow>\r\n                          )}\r\n                        </TableBody>\r\n                      </Table>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <Separator />\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n                    <FormField control={control} name=\"otHourlyRate\" render={({ field }) => ( \r\n                      <FormItem>\r\n                        <FormLabel>Tiền làm thêm/giờ ngày thường (VNĐ)</FormLabel>\r\n                        <FormControl>\r\n                          <CurrencyInput value={field.value as number} onChange={field.onChange} />\r\n                        </FormControl>\r\n                        <FormMessage />\r\n                      </FormItem> \r\n                    )} />\r\n                    <FormField control={control} name=\"otRateWeekend\" render={({ field }) => ( \r\n                      <FormItem>\r\n                        <FormLabel>Hệ số làm thêm cuối tuần</FormLabel>\r\n                        <FormControl>\r\n                          <NumberInput step={0.1} {...field} value={field.value as number} />\r\n                        </FormControl>\r\n                        <FormMessage />\r\n                      </FormItem> \r\n                    )} />\r\n                    <FormField control={control} name=\"otRateHoliday\" render={({ field }) => ( \r\n                      <FormItem>\r\n                        <FormLabel>Hệ số làm thêm ngày lễ</FormLabel>\r\n                        <FormControl>\r\n                          <NumberInput step={0.1} {...field} value={field.value as number} />\r\n                        </FormControl>\r\n                        <FormMessage />\r\n                      </FormItem> \r\n                    )} />\r\n                    <FormField control={control} name=\"mealAllowancePerDay\" render={({ field }) => ( \r\n                      <FormItem>\r\n                        <FormLabel>Phụ cấp ăn trưa/ngày (VNĐ)</FormLabel>\r\n                        <FormControl>\r\n                          <CurrencyInput value={field.value as number} onChange={field.onChange} />\r\n                        </FormControl>\r\n                        <FormDescription>Tính theo ngày công thực tế</FormDescription>\r\n                        <FormMessage />\r\n                      </FormItem> \r\n                    )} />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Tab 2: Quản lý Nghỉ phép */}\r\n            <TabsContent value=\"leave\" className=\"mt-0\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Quản lý Nghỉ phép</CardTitle>\r\n                  <CardDescription>Thiết lập các loại phép, quỹ phép năm và các quy định liên quan.</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-6\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    <FormField control={control} name=\"baseAnnualLeaveDays\" render={({ field }) => ( <FormItem><FormLabel>Số ngày phép cơ bản/năm</FormLabel><FormControl><NumberInput {...field} value={field.value as number} /></FormControl><FormMessage /></FormItem> )} />\r\n                  </div>\r\n                  <FormField control={control} name=\"annualLeaveSeniorityBonus\" render={() => ( <div className=\"flex items-center gap-2 flex-wrap\"> <span className=\"text-sm\">Sau mỗi</span> <FormField control={control} name=\"annualLeaveSeniorityBonus.years\" render={({ field }) => (<FormItem><FormControl><NumberInput className=\"w-20\" {...field} value={field.value as number} /></FormControl></FormItem>)} /> <span className=\"text-sm\">năm làm việc, cộng thêm</span> <FormField control={control} name=\"annualLeaveSeniorityBonus.additionalDays\" render={({ field }) => (<FormItem><FormControl><NumberInput className=\"w-20\" {...field} value={field.value as number} /></FormControl></FormItem>)} /> <span className=\"text-sm\">ngày phép.</span> </div> )} />\r\n                  <div className=\"flex items-center gap-4 flex-wrap\">\r\n                    <FormField control={control} name=\"allowRollover\" render={({ field }) => ( <FormItem className=\"flex flex-row items-center space-y-0 space-x-2\"> <FormControl> <Switch checked={field.value as boolean} onCheckedChange={field.onChange} /> </FormControl> <FormLabel className=\"font-normal\">Cho phép mang phép tồn sang năm sau</FormLabel> </FormItem> )} />\r\n                    {allowRollover && ( <FormField control={control} name=\"rolloverExpirationDate\" render={({ field }) => ( <FormItem className=\"flex items-center gap-2\"> <FormLabel className=\"text-sm font-normal\">Sử dụng đến hết ngày</FormLabel> <FormControl><Input className=\"w-28\" placeholder=\"VD: 31/03\" {...field} value={field.value as string} /></FormControl> </FormItem> )} /> )}\r\n                  </div>\r\n                  <Separator />\r\n                  <div>\r\n                    <div className=\"flex justify-between items-center mb-2\">\r\n                      <h4 className=\"font-medium text-base\">Danh sách các loại nghỉ phép</h4>\r\n                      <Button type=\"button\" size=\"sm\" onClick={handleAddLeaveType}><PlusCircle className=\"mr-2 h-4 w-4\" /> Thêm loại phép</Button>\r\n                    </div>\r\n                    <div className=\"border border-border rounded-md\">\r\n                      <Table>\r\n                        <TableHeader>\r\n                          <TableRow>\r\n                            <TableHead>Tên loại phép</TableHead>\r\n                            <TableHead className=\"text-center\">Số ngày</TableHead>\r\n                            <TableHead className=\"text-center\">Hưởng lương</TableHead>\r\n                            <TableHead className=\"text-center\">Y/C File</TableHead>\r\n                            <TableHead className=\"text-right\">Hành động</TableHead>\r\n                          </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                          {leaveTypeFields.map((field, index) => (\r\n                            <TableRow key={field.id}>\r\n                              <TableCell className=\"font-medium\">{field.name}</TableCell>\r\n                              <TableCell className=\"text-center\">{field.numberOfDays}</TableCell>\r\n                              <TableCell className=\"text-center\"><Switch checked={field.isPaid} onCheckedChange={(checked) => updateLeaveType(index, { ...field, isPaid: checked })} /></TableCell>\r\n                              <TableCell className=\"text-center\"><Switch checked={field.requiresAttachment} onCheckedChange={(checked) => updateLeaveType(index, { ...field, requiresAttachment: checked })} /></TableCell>\r\n                              <TableCell className=\"text-right\">\r\n                                <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={() => handleEditLeaveType(index)}><Edit className=\"h-4 w-4\" /></Button>\r\n                                <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive\" onClick={() => removeLeaveType(index)}><Trash2 className=\"h-4 w-4\" /></Button>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          ))}\r\n                          {leaveTypeFields.length === 0 && <TableRow><TableCell colSpan={5} className=\"text-center text-muted-foreground\">Chưa có loại nghỉ phép nào.</TableCell></TableRow>}\r\n                        </TableBody>\r\n                      </Table>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n            \r\n            {/* Tab 3: Lương & Phúc lợi */}\r\n            <TabsContent value=\"payroll\" className=\"mt-0\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Lương & Phúc lợi</CardTitle>\r\n                  <CardDescription>Cài đặt các thành phần lương, công thức tính và chu kỳ trả lương.</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-6\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    <FormField control={control} name=\"payrollCycle\" render={({ field }) => ( <FormItem><FormLabel>Chu kỳ trả lương</FormLabel><Select onValueChange={field.onChange} value={field.value as string}><FormControl><SelectTrigger><SelectValue /></SelectTrigger></FormControl><SelectContent> <SelectItem value=\"monthly\">Hàng tháng</SelectItem> <SelectItem value=\"weekly\">Hàng tuần</SelectItem> <SelectItem value=\"bi-weekly\">Nửa tháng một lần</SelectItem> </SelectContent></Select><FormMessage /></FormItem> )} />\r\n                    <FormField control={control} name=\"payday\" render={({ field }) => ( <FormItem><FormLabel>Ngày trả lương</FormLabel><FormControl><NumberInput placeholder=\"VD: 5\" {...field} value={field.value as number} /></FormControl><FormMessage /></FormItem> )} />\r\n                    <FormField control={control} name=\"payrollLockDate\" render={({ field }) => ( <FormItem><FormLabel>Ngày khóa sổ lương</FormLabel><FormControl><NumberInput placeholder=\"VD: 5\" {...field} value={field.value as number} /></FormControl><FormMessage /></FormItem> )} />\r\n                  </div>\r\n                  <Separator />\r\n                  <div>\r\n                    <div className=\"flex justify-between items-center mb-2\">\r\n                      <h4 className=\"font-medium text-base\">Danh sách các thành phần lương & phụ cấp</h4>\r\n                      <Button type=\"button\" size=\"sm\" onClick={handleAddSalaryComponent}><PlusCircle className=\"mr-2 h-4 w-4\" /> Thêm thành phần</Button>\r\n                    </div>\r\n                    <div className=\"border border-border rounded-md\">\r\n                      <Table>\r\n                        <TableHeader>\r\n                          <TableRow>\r\n                            <TableHead className=\"w-10\">#</TableHead>\r\n                            <TableHead>Tên thành phần</TableHead>\r\n                            <TableHead>Phân loại</TableHead>\r\n                            <TableHead>Loại</TableHead>\r\n                            <TableHead className=\"text-center\">Tính thuế</TableHead>\r\n                            <TableHead className=\"text-center\">Tính BHXH</TableHead>\r\n                            <TableHead className=\"text-center\">Kích hoạt</TableHead>\r\n                            <TableHead className=\"text-right\">Hành động</TableHead>\r\n                          </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                          {salaryComponentFields\r\n                            .sort((a, b) => (a.sortOrder ?? 0) - (b.sortOrder ?? 0))\r\n                            .map((field, index) => (\r\n                            <TableRow key={field.id} className={!field.isActive ? 'opacity-50' : ''}>\r\n                              <TableCell className=\"text-muted-foreground\">{field.sortOrder ?? index + 1}</TableCell>\r\n                              <TableCell className=\"font-medium\">\r\n                                <div>{field.name}</div>\r\n                                {field.description && <div className=\"text-xs text-muted-foreground truncate max-w-[200px]\">{field.description}</div>}\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${\r\n                                  field.category === 'earning' ? 'bg-green-100 text-green-700' :\r\n                                  field.category === 'deduction' ? 'bg-red-100 text-red-700' :\r\n                                  'bg-blue-100 text-blue-700'\r\n                                }`}>\r\n                                  {field.category === 'earning' ? 'Thu nhập' : field.category === 'deduction' ? 'Khấu trừ' : 'Đóng góp'}\r\n                                </span>\r\n                              </TableCell>\r\n                              <TableCell>{field.type === 'fixed' ? 'Cố định' : 'Công thức'}</TableCell>\r\n                              <TableCell className=\"text-center\"><Switch checked={field.taxable} onCheckedChange={(checked) => updateSalaryComponent(index, { ...field, taxable: checked })} /></TableCell>\r\n                              <TableCell className=\"text-center\"><Switch checked={field.partOfSocialInsurance} onCheckedChange={(checked) => updateSalaryComponent(index, { ...field, partOfSocialInsurance: checked })} /></TableCell>\r\n                              <TableCell className=\"text-center\"><Switch checked={field.isActive ?? true} onCheckedChange={(checked) => updateSalaryComponent(index, { ...field, isActive: checked })} /></TableCell>\r\n                              <TableCell className=\"text-right\">\r\n                                <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={() => handleEditSalaryComponent(index)}><Edit className=\"h-4 w-4\" /></Button>\r\n                                <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive\" onClick={() => removeSalaryComponent(index)}><Trash2 className=\"h-4 w-4\" /></Button>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          ))}\r\n                          {salaryComponentFields.length === 0 && <TableRow><TableCell colSpan={8} className=\"text-center text-muted-foreground\">Chưa có thành phần lương nào.</TableCell></TableRow>}\r\n                        </TableBody>\r\n                      </Table>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Tab 4: Bảo hiểm & Thuế */}\r\n            <TabsContent value=\"insurance-tax\" className=\"mt-0\">\r\n              <InsuranceTaxSettings />\r\n            </TabsContent>\r\n\r\n            {/* Tab 5: Mẫu bảng lương */}\r\n            <TabsContent value=\"templates\" className=\"mt-0\">\r\n              <PayrollTemplatesSettingsContent />\r\n            </TabsContent>\r\n\r\n            {/* Tab 6: Loại phạt */}\r\n            <TabsContent value=\"penalties\" className=\"mt-0\">\r\n              <PenaltyTypesSettingsContent />\r\n            </TabsContent>\r\n          </SettingsVerticalTabs>\r\n        </form>\r\n      </Form>\r\n\r\n      <Dialog open={isLeaveTypeFormOpen} onOpenChange={setIsLeaveTypeFormOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{editingLeaveTypeIndex !== null ? 'Chỉnh sửa loại nghỉ phép' : 'Thêm loại nghỉ phép mới'}</DialogTitle>\r\n            <DialogDescription>Điền thông tin chi tiết cho loại nghỉ phép.</DialogDescription>\r\n          </DialogHeader>\r\n          <LeaveTypeForm \r\n            initialData={currentLeaveTypeData}\r\n            onSubmit={handleLeaveTypeFormSubmit}\r\n            onCancel={() => setIsLeaveTypeFormOpen(false)}\r\n          />\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      <Dialog open={isSalaryComponentFormOpen} onOpenChange={setIsSalaryComponentFormOpen}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>{editingSalaryComponentIndex !== null ? 'Chỉnh sửa thành phần lương' : 'Thêm thành phần lương mới'}</DialogTitle>\r\n            <DialogDescription>Điền thông tin chi tiết cho thành phần lương.</DialogDescription>\r\n          </DialogHeader>\r\n          <SalaryComponentForm\r\n            initialData={currentSalaryComponentData}\r\n            onSubmit={handleSalaryComponentFormSubmit}\r\n            onCancel={() => setIsSalaryComponentFormOpen(false)}\r\n          />\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}