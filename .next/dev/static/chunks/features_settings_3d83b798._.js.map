{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/api/receipt-types-api.ts"],"sourcesContent":["/**\r\n * Receipt Types API Layer\r\n */\r\n\r\nimport type { ReceiptType } from '../types';\r\n\r\nexport interface ReceiptTypeFilters {\r\n  page?: number;\r\n  limit?: number;\r\n  isActive?: boolean;\r\n  isBusinessResult?: boolean;\r\n}\r\n\r\nexport interface ReceiptTypeResponse {\r\n  data: ReceiptType[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface ReceiptTypeCreateInput {\r\n  systemId?: string;\r\n  id?: string;\r\n  name: string;\r\n  description?: string;\r\n  isBusinessResult?: boolean;\r\n  isActive?: boolean;\r\n  isDefault?: boolean;\r\n  color?: string;\r\n  createdAt?: string;\r\n}\r\n\r\nexport interface ReceiptTypeUpdateInput extends Partial<ReceiptTypeCreateInput> {}\r\n\r\nconst BASE_URL = '/api/settings/receipt-types';\r\n\r\nexport async function fetchReceiptTypes(\r\n  filters: ReceiptTypeFilters = {}\r\n): Promise<ReceiptTypeResponse> {\r\n  const params = new URLSearchParams();\r\n  if (filters.page) params.set('page', String(filters.page));\r\n  if (filters.limit) params.set('limit', String(filters.limit));\r\n  if (filters.isActive !== undefined) params.set('isActive', String(filters.isActive));\r\n  if (filters.isBusinessResult !== undefined) params.set('isBusinessResult', String(filters.isBusinessResult));\r\n\r\n  const url = params.toString() ? `${BASE_URL}?${params}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) throw new Error('Failed to fetch receipt types');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchReceiptTypeById(systemId: string): Promise<ReceiptType> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  if (!response.ok) throw new Error('Failed to fetch receipt type');\r\n  return response.json();\r\n}\r\n\r\nexport async function createReceiptType(data: ReceiptTypeCreateInput): Promise<ReceiptType> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to create receipt type');\r\n  return response.json();\r\n}\r\n\r\nexport async function updateReceiptType(\r\n  systemId: string,\r\n  data: ReceiptTypeUpdateInput\r\n): Promise<ReceiptType> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to update receipt type');\r\n  return response.json();\r\n}\r\n\r\nexport async function deleteReceiptType(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, { method: 'DELETE' });\r\n  if (!response.ok) throw new Error('Failed to delete receipt type');\r\n}\r\n\r\nexport async function setDefaultReceiptType(systemId: string): Promise<ReceiptType> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, { method: 'POST' });\r\n  if (!response.ok) throw new Error('Failed to set default');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchActiveReceiptTypes(): Promise<ReceiptType[]> {\r\n  const response = await fetchReceiptTypes({ isActive: true, limit: 100 });\r\n  return response.data;\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;AAmCD,MAAM,WAAW;AAEV,eAAe,kBACpB,UAA8B,CAAC,CAAC;IAEhC,MAAM,SAAS,IAAI;IACnB,IAAI,QAAQ,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,OAAO,QAAQ,IAAI;IACxD,IAAI,QAAQ,KAAK,EAAE,OAAO,GAAG,CAAC,SAAS,OAAO,QAAQ,KAAK;IAC3D,IAAI,QAAQ,QAAQ,KAAK,WAAW,OAAO,GAAG,CAAC,YAAY,OAAO,QAAQ,QAAQ;IAClF,IAAI,QAAQ,gBAAgB,KAAK,WAAW,OAAO,GAAG,CAAC,oBAAoB,OAAO,QAAQ,gBAAgB;IAE1G,MAAM,MAAM,OAAO,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,QAAQ,GAAG;IAC1D,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,qBAAqB,QAAgB;IACzD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IACtD,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,IAA4B;IAClE,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBACpB,QAAgB,EAChB,IAA4B;IAE5B,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC3E,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;AACpC;AAEO,eAAe,sBAAsB,QAAgB;IAC1D,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAAE,QAAQ;IAAO;IACrF,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,kBAAkB;QAAE,UAAU;QAAM,OAAO;IAAI;IACtE,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/hooks/use-receipt-types.ts"],"sourcesContent":["/**\r\n * Receipt Types React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchReceiptTypes,\r\n  fetchReceiptTypeById,\r\n  createReceiptType,\r\n  updateReceiptType,\r\n  deleteReceiptType,\r\n  setDefaultReceiptType,\r\n  fetchActiveReceiptTypes,\r\n  type ReceiptTypeFilters,\r\n  type ReceiptTypeCreateInput,\r\n  type ReceiptTypeUpdateInput,\r\n} from '../api/receipt-types-api';\r\n\r\nexport const receiptTypeKeys = {\r\n  all: ['receipt-types'] as const,\r\n  lists: () => [...receiptTypeKeys.all, 'list'] as const,\r\n  list: (filters: ReceiptTypeFilters) => [...receiptTypeKeys.lists(), filters] as const,\r\n  details: () => [...receiptTypeKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...receiptTypeKeys.details(), id] as const,\r\n  active: () => [...receiptTypeKeys.all, 'active'] as const,\r\n};\r\n\r\nexport function useReceiptTypes(filters: ReceiptTypeFilters = {}) {\r\n  return useQuery({\r\n    queryKey: receiptTypeKeys.list(filters),\r\n    queryFn: () => fetchReceiptTypes(filters),\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useReceiptTypeById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: receiptTypeKeys.detail(systemId!),\r\n    queryFn: () => fetchReceiptTypeById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useActiveReceiptTypes() {\r\n  return useQuery({\r\n    queryKey: receiptTypeKeys.active(),\r\n    queryFn: fetchActiveReceiptTypes,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useReceiptTypeMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n  const invalidate = () => queryClient.invalidateQueries({ queryKey: receiptTypeKeys.all });\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: ReceiptTypeCreateInput) => createReceiptType(data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: ReceiptTypeUpdateInput }) =>\r\n      updateReceiptType(systemId, data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deleteReceiptType(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const setDefault = useMutation({\r\n    mutationFn: (systemId: string) => setDefaultReceiptType(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create, update, remove, setDefault,\r\n    isLoading: create.isPending || update.isPending || remove.isPending || setDefault.isPending,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;CAEC,GAED;AAAA;AAAA;AACA;;;;AAaO,MAAM,kBAAkB;IAC7B,KAAK;QAAC;KAAgB;IACtB,OAAO,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAO;IAC7C,MAAM,CAAC,UAAgC;eAAI,gBAAgB,KAAK;YAAI;SAAQ;IAC5E,SAAS,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;IACjD,QAAQ,CAAC,KAAe;eAAI,gBAAgB,OAAO;YAAI;SAAG;IAC1D,QAAQ,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;AAClD;AAEO,SAAS,gBAAgB,UAA8B,CAAC,CAAC;;IAC9D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,IAAI,CAAC;QAC/B,OAAO;wCAAE,IAAM,IAAA,kMAAiB,EAAC;;QACjC,WAAW,OAAO,KAAK;IACzB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,mBAAmB,QAA4B;;IAC7D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM,CAAC;QACjC,OAAO;2CAAE,IAAM,IAAA,qMAAoB,EAAC;;QACpC,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IACzB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM;QAChC,SAAS,wMAAuB;QAChC,WAAW,OAAO,KAAK;IACzB;AACF;IANgB;;QACP,0LAAQ;;;AAYV,SAAS,wBAAwB,UAA6B,CAAC,CAAC;;IACrE,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,aAAa,IAAM,YAAY,iBAAiB,CAAC;YAAE,UAAU,gBAAgB,GAAG;QAAC;IAEvF,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,OAAiC,IAAA,kMAAiB,EAAC;;QAChE,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAsD,GACjF,IAAA,kMAAiB,EAAC,UAAU;;QAC9B,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,WAAqB,IAAA,kMAAiB,EAAC;;QACpD,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,aAAa,IAAA,gMAAW,EAAC;QAC7B,UAAU;+DAAE,CAAC,WAAqB,IAAA,sMAAqB,EAAC;;QACxD,SAAS;+DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QACL;QAAQ;QAAQ;QAAQ;QACxB,WAAW,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,WAAW,SAAS;IAC7F;AACF;IAjCgB;;QACM,2MAAc;QAGnB,gMAAW;QAMX,gMAAW;QAOX,gMAAW;QAMP,gMAAW"}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/hooks/use-all-receipt-types.ts"],"sourcesContent":["/**\r\n * useAllReceiptTypes - Convenience hook for flat array of receipt types\r\n */\r\n\r\nimport { useReceiptTypes } from './use-receipt-types';\r\n\r\nexport function useAllReceiptTypes() {\r\n  const { data, ...rest } = useReceiptTypes({});\r\n  return {\r\n    data: data?.data || [],\r\n    ...rest,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;CAEC,GAED;;;AAEO,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,GAAG,IAAA,kMAAe,EAAC,CAAC;IAC3C,OAAO;QACL,MAAM,MAAM,QAAQ,EAAE;QACtB,GAAG,IAAI;IACT;AACF;GANgB;;QACY,kMAAe"}},
    {"offset": {"line": 285, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { ReceiptType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<ReceiptType>([], 'receipt-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=receipt-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<ReceiptType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const useReceiptTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,oIAAS,EAAC,IAAA,yIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 316, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/api/branches-api.ts"],"sourcesContent":["/**\r\n * Branches API functions\r\n * \r\n * ⚠️ Direct import: import { fetchBranches } from '@/features/settings/branches/api/branches-api'\r\n */\r\n\r\nimport type { BranchModel as Branch } from '@/generated/prisma/models/Branch';\r\n\r\nconst BASE_URL = '/api/branches';\r\n\r\nexport interface BranchesParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  isDefault?: boolean;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface BranchesResponse {\r\n  data: Branch[];\r\n  total: number;\r\n  page: number;\r\n  pageSize: number;\r\n}\r\n\r\nexport async function fetchBranches(params: BranchesParams = {}): Promise<BranchesResponse> {\r\n  const searchParams = new URLSearchParams();\r\n  \r\n  if (params.page) searchParams.set('page', String(params.page));\r\n  if (params.limit) searchParams.set('limit', String(params.limit));\r\n  if (params.search) searchParams.set('search', params.search);\r\n  if (params.isDefault !== undefined) searchParams.set('isDefault', String(params.isDefault));\r\n  if (params.sortBy) searchParams.set('sortBy', params.sortBy);\r\n  if (params.sortOrder) searchParams.set('sortOrder', params.sortOrder);\r\n  \r\n  const url = searchParams.toString() ? `${BASE_URL}?${searchParams}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branches: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function fetchBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branch: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function createBranch(data: Omit<Branch, 'systemId' | 'createdAt' | 'updatedAt'>): Promise<Branch> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to create branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function updateBranch(systemId: string, data: Partial<Branch>): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PUT',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to update branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function deleteBranch(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to delete branch: ${response.statusText}`);\r\n  }\r\n}\r\n\r\nexport async function setDefaultBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to set default branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport type { Branch };\r\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;;;;AAID,MAAM,WAAW;AAkBV,eAAe,cAAc,SAAyB,CAAC,CAAC;IAC7D,MAAM,eAAe,IAAI;IAEzB,IAAI,OAAO,IAAI,EAAE,aAAa,GAAG,CAAC,QAAQ,OAAO,OAAO,IAAI;IAC5D,IAAI,OAAO,KAAK,EAAE,aAAa,GAAG,CAAC,SAAS,OAAO,OAAO,KAAK;IAC/D,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,KAAK,WAAW,aAAa,GAAG,CAAC,aAAa,OAAO,OAAO,SAAS;IACzF,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,EAAE,aAAa,GAAG,CAAC,aAAa,OAAO,SAAS;IAEpE,MAAM,MAAM,aAAa,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,cAAc,GAAG;IACtE,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,SAAS,UAAU,EAAE;IACpE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,YAAY,QAAgB;IAChD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IAEtD,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,wBAAwB,EAAE,SAAS,UAAU,EAAE;IAClE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,IAA0D;IAC3F,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB,EAAE,IAAqB;IACxE,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,SAAS,UAAU,EAAE;IACnE;AACF;AAEO,eAAe,iBAAiB,QAAgB;IACrD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;IAChD;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-branches.ts"],"sourcesContent":["/**\r\n * useBranches - React Query hooks\r\n * \r\n * ⚠️ Direct import: import { useBranches } from '@/features/settings/branches/hooks/use-branches'\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchBranches,\r\n  fetchBranch,\r\n  createBranch,\r\n  updateBranch,\r\n  deleteBranch,\r\n  setDefaultBranch,\r\n  type BranchesParams,\r\n  type Branch,\r\n} from '../api/branches-api';\r\n\r\nexport const branchKeys = {\r\n  all: ['branches'] as const,\r\n  lists: () => [...branchKeys.all, 'list'] as const,\r\n  list: (params: BranchesParams) => [...branchKeys.lists(), params] as const,\r\n  details: () => [...branchKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...branchKeys.details(), id] as const,\r\n};\r\n\r\nexport function useBranches(params: BranchesParams = {}) {\r\n  return useQuery({\r\n    queryKey: branchKeys.list(params),\r\n    queryFn: () => fetchBranches(params),\r\n    staleTime: 10 * 60 * 1000, // Branches rarely change\r\n    gcTime: 60 * 60 * 1000,\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\nexport function useBranch(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: branchKeys.detail(id!),\r\n    queryFn: () => fetchBranch(id!),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\ninterface UseBranchMutationsOptions {\r\n  onCreateSuccess?: (branch: Branch) => void;\r\n  onUpdateSuccess?: (branch: Branch) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onSetDefaultSuccess?: (branch: Branch) => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useBranchMutations(options: UseBranchMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: Partial<Branch> }) => \r\n      updateBranch(systemId, data),\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.lists() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: deleteBranch,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const makeDefault = useMutation({\r\n    mutationFn: setDefaultBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onSetDefaultSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return { create, update, remove, makeDefault };\r\n}\r\n\r\nexport function useAllBranches() {\r\n  return useBranches({ limit: 100 });\r\n}\r\n\r\nexport function useDefaultBranch() {\r\n  const { data, ...rest } = useBranches({ isDefault: true, limit: 1 });\r\n  return {\r\n    ...rest,\r\n    data: data?.data?.[0] ?? null,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;CAIC,GAED;AAAA;AAAA;AAAA;AACA;;;;AAWO,MAAM,aAAa;IACxB,KAAK;QAAC;KAAW;IACjB,OAAO,IAAM;eAAI,WAAW,GAAG;YAAE;SAAO;IACxC,MAAM,CAAC,SAA2B;eAAI,WAAW,KAAK;YAAI;SAAO;IACjE,SAAS,IAAM;eAAI,WAAW,GAAG;YAAE;SAAS;IAC5C,QAAQ,CAAC,KAAe;eAAI,WAAW,OAAO;YAAI;SAAG;AACvD;AAEO,SAAS,YAAY,SAAyB,CAAC,CAAC;;IACrD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,WAAW,IAAI,CAAC;QAC1B,OAAO;oCAAE,IAAM,IAAA,8KAAa,EAAC;;QAC7B,WAAW,KAAK,KAAK;QACrB,QAAQ,KAAK,KAAK;QAClB,iBAAiB,8LAAgB;IACnC;AACF;GARgB;;QACP,0LAAQ;;;AASV,SAAS,UAAU,EAA6B;;IACrD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,WAAW,MAAM,CAAC;QAC5B,OAAO;kCAAE,IAAM,IAAA,4KAAW,EAAC;;QAC3B,SAAS,CAAC,CAAC;QACX,WAAW,KAAK,KAAK;IACvB;AACF;IAPgB;;QACP,0LAAQ;;;AAgBV,SAAS,mBAAmB,UAAqC,CAAC,CAAC;;IACxE,MAAM,cAAc,IAAA,2MAAc;IAElC,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,YAAY,6KAAY;QACxB,SAAS;sDAAE,CAAC;gBACV,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,eAAe,GAAG;YAC5B;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;sDAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAA+C,GAC1E,IAAA,6KAAY,EAAC,UAAU;;QACzB,SAAS;sDAAE,CAAC,MAAM;gBAChB,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,MAAM,CAAC,UAAU,QAAQ;gBAAE;gBAChF,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,KAAK;gBAAG;gBAC7D,QAAQ,eAAe,GAAG;YAC5B;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,YAAY,6KAAY;QACxB,SAAS;sDAAE;gBACT,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,eAAe;YACzB;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,cAAc,IAAA,gMAAW,EAAC;QAC9B,YAAY,iLAAgB;QAC5B,SAAS;2DAAE,CAAC;gBACV,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,mBAAmB,GAAG;YAChC;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QAAE;QAAQ;QAAQ;QAAQ;IAAY;AAC/C;IA1CgB;;QACM,2MAAc;QAEnB,gMAAW;QASX,gMAAW;QAWX,gMAAW;QASN,gMAAW;;;AAY1B,SAAS;;IACd,OAAO,YAAY;QAAE,OAAO;IAAI;AAClC;IAFgB;;QACP;;;AAGF,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,GAAG,YAAY;QAAE,WAAW;QAAM,OAAO;IAAE;IAClE,OAAO;QACL,GAAG,IAAI;QACP,MAAM,MAAM,MAAM,CAAC,EAAE,IAAI;IAC3B;AACF;IANgB;;QACY"}},
    {"offset": {"line": 599, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-all-branches.ts"],"sourcesContent":["/**\r\n * useAllBranches - Convenience hook for components needing all branches as flat array\r\n * \r\n * Use case: Dropdowns, selects that need branch options\r\n * \r\n * ⚠️ For paginated views, use useBranches() instead\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useBranches } from './use-branches';\r\nimport type { Branch } from '../types';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n/**\r\n * Returns all branches as a flat array\r\n * Compatible with legacy store pattern: { data: branches }\r\n * \r\n * Note: API returns string systemIds, but we cast to Branch[] for internal use\r\n */\r\nexport function useAllBranches() {\r\n  const query = useBranches({ limit: 100 });\r\n  \r\n  return {\r\n    // Cast to Branch[] - API returns string systemId, but we trust the data structure\r\n    data: (query.data?.data || []) as unknown as Branch[],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns branches formatted as options for Select/Combobox\r\n */\r\nexport function useBranchOptions() {\r\n  const { data, isLoading } = useAllBranches();\r\n  \r\n  const options = data.map(b => ({\r\n    value: b.systemId,\r\n    label: b.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Returns the default branch\r\n */\r\nexport function useDefaultBranch() {\r\n  const { data, isLoading } = useAllBranches();\r\n  const defaultBranch = data.find(b => b.isDefault) || data[0];\r\n  \r\n  return { defaultBranch, isLoading };\r\n}\r\n\r\n/**\r\n * Helper hook to find a branch by ID from cached data\r\n * Replaces legacy findById() method\r\n */\r\nexport function useBranchFinder() {\r\n  const { data } = useAllBranches();\r\n  \r\n  const findById = React.useCallback(\r\n    (systemId: SystemId | string | undefined) => {\r\n      if (!systemId) return undefined;\r\n      return data.find(b => b.systemId === systemId);\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { findById };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;CAMC,GAED;AACA;;;;AAUO,SAAS;;IACd,MAAM,QAAQ,IAAA,8KAAW,EAAC;QAAE,OAAO;IAAI;IAEvC,OAAO;QACL,kFAAkF;QAClF,MAAO,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC7B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GAVgB;;QACA,8KAAW;;;AAcpB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;IATgB;;QACc;;;AAavB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAC5B,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,IAAI,CAAC,EAAE;IAE5D,OAAO;QAAE;QAAe;IAAU;AACpC;IALgB;;QACc;;;AAUvB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,4KAAiB;iDAChC,CAAC;YACC,IAAI,CAAC,UAAU,OAAO;YACtB,OAAO,KAAK,IAAI;yDAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;;QACvC;gDACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAS;AACpB;IAZgB;;QACG"}},
    {"offset": {"line": 698, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Branch } from './types';\r\nimport { SystemId } from '../../../lib/id-types';\r\n\r\nexport interface BranchStoreState extends CrudState<Branch> {\r\n  setDefault: (systemId: SystemId) => void;\r\n}\r\n\r\nconst baseStore = createCrudStore<Branch>([], 'branches', {\r\n  apiEndpoint: '/api/branches',\r\n});\r\n\r\nconst setDefault = (systemId: SystemId) => {\r\n  baseStore.setState(state => ({\r\n    data: state.data.map(branch => ({\r\n      ...branch,\r\n      isDefault: branch.systemId === systemId,\r\n    })),\r\n  }));\r\n};\r\n\r\nconst originalAdd = baseStore.getState().add;\r\nconst originalUpdate = baseStore.getState().update;\r\n\r\nbaseStore.setState({\r\n  add: (item: Omit<Branch, 'systemId'>) => {\r\n    const result = originalAdd(item);\r\n    if ((item as Branch).isDefault) {\r\n      setDefault(result.systemId);\r\n    }\r\n    return result;\r\n  },\r\n  update: (systemId: SystemId, updatedItem: Branch) => {\r\n    originalUpdate(systemId, updatedItem);\r\n    if (updatedItem.isDefault) {\r\n      setDefault(systemId);\r\n    }\r\n  },\r\n} as Partial<BranchStoreState>);\r\n\r\nconst enhanceState = (state: CrudState<Branch>): BranchStoreState => ({\r\n  ...state,\r\n  setDefault,\r\n});\r\n\r\ntype BranchStoreHook = (() => BranchStoreState) & {\r\n  getState: () => BranchStoreState;\r\n};\r\n\r\nconst useBranchStoreBase = (() => enhanceState(baseStore())) as BranchStoreHook;\r\n\r\nuseBranchStoreBase.getState = () => enhanceState(baseStore.getState());\r\n\r\nexport const useBranchStore = useBranchStoreBase;\r\n"],"names":[],"mappings":";;;;AAAA;;AASA,MAAM,YAAY,IAAA,6IAAe,EAAS,EAAE,EAAE,YAAY;IACxD,aAAa;AACf;AAEA,MAAM,aAAa,CAAC;IAClB,UAAU,QAAQ,CAAC,CAAA,QAAS,CAAC;YAC3B,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,SAAU,CAAC;oBAC9B,GAAG,MAAM;oBACT,WAAW,OAAO,QAAQ,KAAK;gBACjC,CAAC;QACH,CAAC;AACH;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAC5C,MAAM,iBAAiB,UAAU,QAAQ,GAAG,MAAM;AAElD,UAAU,QAAQ,CAAC;IACjB,KAAK,CAAC;QACJ,MAAM,SAAS,YAAY;QAC3B,IAAI,AAAC,KAAgB,SAAS,EAAE;YAC9B,WAAW,OAAO,QAAQ;QAC5B;QACA,OAAO;IACT;IACA,QAAQ,CAAC,UAAoB;QAC3B,eAAe,UAAU;QACzB,IAAI,YAAY,SAAS,EAAE;YACzB,WAAW;QACb;IACF;AACF;AAEA,MAAM,eAAe,CAAC,QAA+C,CAAC;QACpE,GAAG,KAAK;QACR;IACF,CAAC;AAMD,MAAM,qBAAsB,IAAM,aAAa;AAE/C,mBAAmB,QAAQ,GAAG,IAAM,aAAa,UAAU,QAAQ;AAE5D,MAAM,iBAAiB"}},
    {"offset": {"line": 746, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/store-info/api/store-info-api.ts"],"sourcesContent":["/**\r\n * Store Info Settings API Layer\r\n * Handles all store information settings API calls\r\n */\r\n\r\nimport type { StoreGeneralInfo, StoreGeneralInfoInput } from '../store-info-store';\r\n\r\nconst BASE_URL = '/api/settings/store-info';\r\n\r\n/**\r\n * Fetch store information\r\n */\r\nexport async function fetchStoreInfo(): Promise<StoreGeneralInfo> {\r\n  const response = await fetch(BASE_URL);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch store info');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Update store information\r\n */\r\nexport async function updateStoreInfo(\r\n  data: StoreGeneralInfoInput,\r\n  metadata?: { updatedBySystemId?: string; updatedByName?: string }\r\n): Promise<StoreGeneralInfo> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'PUT',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ ...data, ...metadata }),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.error || 'Failed to update store info');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Reset store info to defaults\r\n */\r\nexport async function resetStoreInfo(): Promise<StoreGeneralInfo> {\r\n  const response = await fetch(`${BASE_URL}/reset`, {\r\n    method: 'POST',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to reset store info');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Upload store logo\r\n */\r\nexport async function uploadStoreLogo(file: File): Promise<{ url: string }> {\r\n  const formData = new FormData();\r\n  formData.append('logo', file);\r\n  \r\n  const response = await fetch(`${BASE_URL}/logo`, {\r\n    method: 'POST',\r\n    body: formData,\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to upload logo');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;AAID,MAAM,WAAW;AAKV,eAAe;IACpB,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,gBACpB,IAA2B,EAC3B,QAAiE;IAEjE,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;YAAE,GAAG,IAAI;YAAE,GAAG,QAAQ;QAAC;IAC9C;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,KAAK,IAAI;IACjC;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe;IACpB,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,MAAM,CAAC,EAAE;QAChD,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,gBAAgB,IAAU;IAC9C,MAAM,WAAW,IAAI;IACrB,SAAS,MAAM,CAAC,QAAQ;IAExB,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,KAAK,CAAC,EAAE;QAC/C,QAAQ;QACR,MAAM;IACR;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/store-info/hooks/use-store-info.ts"],"sourcesContent":["/**\r\n * Store Info Settings React Query Hooks\r\n * Provides data fetching and mutations for store information\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchStoreInfo,\r\n  updateStoreInfo,\r\n  resetStoreInfo,\r\n  uploadStoreLogo,\r\n} from '../api/store-info-api';\r\nimport type { StoreGeneralInfoInput } from '../store-info-store';\r\n\r\n// Query keys factory\r\nexport const storeInfoKeys = {\r\n  all: ['store-info'] as const,\r\n  info: () => [...storeInfoKeys.all, 'current'] as const,\r\n};\r\n\r\n/**\r\n * Hook to fetch store information\r\n */\r\nexport function useStoreInfo() {\r\n  return useQuery({\r\n    queryKey: storeInfoKeys.info(),\r\n    queryFn: fetchStoreInfo,\r\n    staleTime: 1000 * 60 * 30, // 30 minutes - info rarely changes\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\n/**\r\n * Hook providing store info mutations\r\n */\r\nexport function useStoreInfoMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n\r\n  const invalidateInfo = () => {\r\n    queryClient.invalidateQueries({ queryKey: storeInfoKeys.all });\r\n  };\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ \r\n      data, \r\n      metadata \r\n    }: { \r\n      data: StoreGeneralInfoInput; \r\n      metadata?: { updatedBySystemId?: string; updatedByName?: string };\r\n    }) => updateStoreInfo(data, metadata),\r\n    onSuccess: () => {\r\n      invalidateInfo();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const reset = useMutation({\r\n    mutationFn: () => resetStoreInfo(),\r\n    onSuccess: () => {\r\n      invalidateInfo();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const uploadLogo = useMutation({\r\n    mutationFn: (file: File) => uploadStoreLogo(file),\r\n    onSuccess: () => {\r\n      invalidateInfo();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    update,\r\n    reset,\r\n    uploadLogo,\r\n    isLoading: update.isPending || reset.isPending || uploadLogo.isPending,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;;CAGC,GAED;AAAA;AAAA;AACA;;;;AASO,MAAM,gBAAgB;IAC3B,KAAK;QAAC;KAAa;IACnB,MAAM,IAAM;eAAI,cAAc,GAAG;YAAE;SAAU;AAC/C;AAKO,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,cAAc,IAAI;QAC5B,SAAS,yLAAc;QACvB,WAAW,OAAO,KAAK;IACzB;AACF;GANgB;;QACP,0LAAQ;;;AAeV,SAAS,sBAAsB,UAA6B,CAAC,CAAC;;IACnE,MAAM,cAAc,IAAA,2MAAc;IAElC,MAAM,iBAAiB;QACrB,YAAY,iBAAiB,CAAC;YAAE,UAAU,cAAc,GAAG;QAAC;IAC9D;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;yDAAE,CAAC,EACX,IAAI,EACJ,QAAQ,EAIT,GAAK,IAAA,0LAAe,EAAC,MAAM;;QAC5B,SAAS;yDAAE;gBACT;gBACA,QAAQ,SAAS;YACnB;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,QAAQ,IAAA,gMAAW,EAAC;QACxB,UAAU;wDAAE,IAAM,IAAA,yLAAc;;QAChC,SAAS;wDAAE;gBACT;gBACA,QAAQ,SAAS;YACnB;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,aAAa,IAAA,gMAAW,EAAC;QAC7B,UAAU;6DAAE,CAAC,OAAe,IAAA,0LAAe,EAAC;;QAC5C,SAAS;6DAAE;gBACT;gBACA,QAAQ,SAAS;YACnB;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QACL;QACA;QACA;QACA,WAAW,OAAO,SAAS,IAAI,MAAM,SAAS,IAAI,WAAW,SAAS;IACxE;AACF;IA9CgB;;QACM,2MAAc;QAMnB,gMAAW;QAeZ,gMAAW;QASN,gMAAW"}},
    {"offset": {"line": 918, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pricing/store.ts"],"sourcesContent":["import type { SystemId } from '@/lib/id-types';\r\nimport type { UseBoundStore, StoreApi } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PricingPolicy } from './types';\r\nimport { createCrudStore, type CrudState } from '../../../lib/store-factory';\r\nimport { getCurrentUserSystemId } from '../../../contexts/auth-context';\r\n\r\ntype PricingPolicyStore = CrudState<PricingPolicy> & {\r\n  setDefault: (systemId: SystemId) => void;\r\n  getActive: () => PricingPolicy[];\r\n  getInactive: () => PricingPolicy[];\r\n};\r\n\r\nconst baseStore = createCrudStore<PricingPolicy>([], 'pricing-settings', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId,\r\n  apiEndpoint: '/api/settings/data?type=pricing-policy',\r\n}) as UseBoundStore<StoreApi<PricingPolicyStore>>;\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nconst setDefaultAction = (systemId: SystemId) => {\r\n  baseStore.setState((current) => {\r\n    const target = current.data.find((policy) => policy.systemId === systemId);\r\n    if (!target) return current;\r\n\r\n    const updatedData = current.data.map((policy) => (\r\n      policy.type === target.type\r\n        ? { ...policy, isDefault: policy.systemId === systemId }\r\n        : policy\r\n    ));\r\n\r\n    return { ...current, data: updatedData };\r\n  });\r\n};\r\n\r\nconst enhancedAdd: typeof originalAdd = (item) => {\r\n  const newItem = originalAdd(item);\r\n  const storeData = baseStore.getState().data;\r\n  const hasDefaultForType = storeData\r\n    .filter((policy) => policy.type === newItem.type)\r\n    .some((policy) => policy.isDefault);\r\n\r\n  if (item.isDefault) {\r\n    setDefaultAction(newItem.systemId);\r\n  } else if (!hasDefaultForType) {\r\n    setDefaultAction(newItem.systemId);\r\n  }\r\n\r\n  return newItem;\r\n};\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: enhancedAdd,\r\n  setDefault: setDefaultAction,\r\n  getActive: () => baseStore.getState().data.filter((policy) => policy.isActive),\r\n  getInactive: () => baseStore.getState().data.filter((policy) => !policy.isActive),\r\n}));\r\n\r\nexport const usePricingPolicyStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAIA;AACA;;;AAQA,MAAM,YAAY,IAAA,6IAAe,EAAgB,EAAE,EAAE,oBAAoB;IACvE,iBAAiB;IACjB,gBAAgB,yJAAsB;IACtC,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,MAAM,mBAAmB,CAAC;IACxB,UAAU,QAAQ,CAAC,CAAC;QAClB,MAAM,SAAS,QAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,SAAW,OAAO,QAAQ,KAAK;QACjE,IAAI,CAAC,QAAQ,OAAO;QAEpB,MAAM,cAAc,QAAQ,IAAI,CAAC,GAAG,CAAC,CAAC,SACpC,OAAO,IAAI,KAAK,OAAO,IAAI,GACvB;gBAAE,GAAG,MAAM;gBAAE,WAAW,OAAO,QAAQ,KAAK;YAAS,IACrD;QAGN,OAAO;YAAE,GAAG,OAAO;YAAE,MAAM;QAAY;IACzC;AACF;AAEA,MAAM,cAAkC,CAAC;IACvC,MAAM,UAAU,YAAY;IAC5B,MAAM,YAAY,UAAU,QAAQ,GAAG,IAAI;IAC3C,MAAM,oBAAoB,UACvB,MAAM,CAAC,CAAC,SAAW,OAAO,IAAI,KAAK,QAAQ,IAAI,EAC/C,IAAI,CAAC,CAAC,SAAW,OAAO,SAAS;IAEpC,IAAI,KAAK,SAAS,EAAE;QAClB,iBAAiB,QAAQ,QAAQ;IACnC,OAAO,IAAI,CAAC,mBAAmB;QAC7B,iBAAiB,QAAQ,QAAQ;IACnC;IAEA,OAAO;AACT;AAEA,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK;QACL,YAAY;QACZ,WAAW,IAAM,UAAU,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,SAAW,OAAO,QAAQ;QAC7E,aAAa,IAAM,UAAU,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,SAAW,CAAC,OAAO,QAAQ;IAClF,CAAC;AAEM,MAAM,wBAAwB"}},
    {"offset": {"line": 972, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/product-type-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId } from '@/lib/id-types';\r\nimport type { ProductType } from './types';\r\n\r\nconst generateId = () => crypto.randomUUID();\r\n\r\n// API sync helper\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: Partial<ProductType>): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/settings/product-types' : `/api/settings/product-types/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Product Type API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface ProductTypeState {\r\n  data: ProductType[];\r\n  initialized: boolean;\r\n  add: (productType: Omit<ProductType, 'systemId'>) => ProductType;\r\n  update: (systemId: SystemId, updates: Partial<ProductType>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => ProductType | undefined;\r\n  getActive: () => ProductType[];\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst rawData = [\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT001',\r\n    name: 'Hàng hóa',\r\n    description: 'Sản phẩm vật lý có tồn kho',\r\n    isDefault: true,\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT002',\r\n    name: 'Dịch vụ',\r\n    description: 'Dịch vụ không có tồn kho',\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT003',\r\n    name: 'Digital',\r\n    description: 'Sản phẩm số (ebook, khóa học online...)',\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n] as const;\r\n\r\nconst initialData: ProductType[] = rawData.map((item) => ({\r\n  ...item,\r\n  systemId: asSystemId(item.systemId),\r\n  id: asBusinessId(item.id),\r\n}));\r\n\r\nexport const useProductTypeStore = create<ProductTypeState>()(\r\n  (set, get) => ({\r\n    data: initialData,\r\n    initialized: false,\r\n    \r\n    add: (productType) => {\r\n      const newProductType: ProductType = {\r\n        ...productType,\r\n        systemId: asSystemId(generateId()),\r\n        createdAt: new Date().toISOString(),\r\n        isDeleted: false,\r\n      };\r\n      set((state) => ({ data: [...state.data, newProductType] }));\r\n      syncToAPI('create', newProductType).catch(console.error);\r\n      return newProductType;\r\n    },\r\n    \r\n    update: (systemId, updates) => {\r\n      set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, ...updates, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      }));\r\n      const updated = get().data.find(i => i.systemId === systemId);\r\n      if (updated) syncToAPI('update', updated).catch(console.error);\r\n    },\r\n    \r\n    remove: (systemId) => {\r\n      set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      }));\r\n      syncToAPI('delete', { systemId }).catch(console.error);\r\n    },\r\n    \r\n    findById: (systemId) => {\r\n      return get().data.find((item) => item.systemId === systemId && !item.isDeleted);\r\n    },\r\n    \r\n    getActive: () => {\r\n      return get().data.filter((item) => !item.isDeleted && item.isActive !== false);\r\n    },\r\n    \r\n    loadFromAPI: async () => {\r\n      if (get().initialized) return;\r\n      try {\r\n        // NOTE: Settings data is typically small, but using limit for consistency\r\n        const response = await fetch('/api/settings/product-types?limit=50');\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const data = json.data || [];\r\n          if (data.length > 0) {\r\n            set({ data: data.map((item: any) => ({\r\n              ...item,\r\n              systemId: asSystemId(item.systemId),\r\n              id: asBusinessId(item.id),\r\n            })), initialized: true });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[Product Type Store] loadFromAPI error:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1114, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/product-category-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId, type BusinessId } from '@/lib/id-types';\r\nimport type { ProductCategory } from './types';\r\n\r\nconst generateSystemId = (counter: number): SystemId => {\r\n  return asSystemId(`CATEGORY${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\nconst generateBusinessId = (counter: number): BusinessId => {\r\n  return asBusinessId(`DM${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\n// Helper to calculate path and level\r\nconst calculatePathAndLevel = (category: ProductCategory, allCategories: ProductCategory[]): { path: string; level: number } => {\r\n  if (!category.parentId) {\r\n    return { path: category.name, level: 0 };\r\n  }\r\n  \r\n  const parent = allCategories.find(c => c.systemId === category.parentId);\r\n  if (!parent) {\r\n    return { path: category.name, level: 0 };\r\n  }\r\n  \r\n  const parentInfo = calculatePathAndLevel(parent, allCategories);\r\n  return {\r\n    path: `${parentInfo.path} > ${category.name}`,\r\n    level: parentInfo.level + 1\r\n  };\r\n};\r\n\r\ninterface ProductCategoryState {\r\n  data: ProductCategory[];\r\n  counter: number;\r\n  initialized: boolean;\r\n  add: (category: Omit<ProductCategory, 'systemId' | 'id' | 'path' | 'level'> & { id?: string }) => ProductCategory;\r\n  update: (systemId: SystemId, updates: Partial<ProductCategory>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => ProductCategory | undefined;\r\n  findByBusinessId: (id: BusinessId) => ProductCategory | undefined;\r\n  getActive: () => ProductCategory[];\r\n  getByParent: (parentId?: SystemId) => ProductCategory[];\r\n  updateSortOrder: (systemId: SystemId, newSortOrder: number) => void;\r\n  moveCategory: (systemId: SystemId, newParentId: SystemId | undefined, newSortOrder: number) => void;\r\n  recalculatePaths: () => void;\r\n  getNextId: () => BusinessId;\r\n  isBusinessIdExists: (id: string) => boolean;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\n// API sync helper\r\nasync function syncCategoryToAPI(category: ProductCategory, action: 'create' | 'update' | 'delete'): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/categories' : `/api/categories/${category.systemId}`;\r\n    const response = await fetch(endpoint, {\r\n      method: action === 'create' ? 'POST' : action === 'delete' ? 'DELETE' : 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(category),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('syncCategoryToAPI error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useProductCategoryStore = create<ProductCategoryState>()(\r\n  (set, get) => ({\r\n    data: [],\r\n    counter: 0,\r\n    initialized: false,\r\n      \r\n    add: (category) => {\r\n        const currentCounter = get().counter;\r\n        const allData = get().data;\r\n        const { id, ...rest } = category;\r\n        \r\n        const businessId = id && id.trim() \r\n          ? asBusinessId(id.trim())\r\n          : generateBusinessId(currentCounter);\r\n        \r\n        const { path, level } = calculatePathAndLevel(\r\n          { ...rest, systemId: 'temp' as SystemId, id: businessId, path: '', level: 0 } as ProductCategory,\r\n          allData\r\n        );\r\n        \r\n        const newCategory: ProductCategory = {\r\n          ...rest,\r\n          systemId: generateSystemId(currentCounter),\r\n          id: businessId,\r\n          path,\r\n          level,\r\n          createdAt: new Date().toISOString(),\r\n          isDeleted: false,\r\n          isActive: category.isActive !== undefined ? category.isActive : true,\r\n        };\r\n        set((state) => ({ \r\n          data: [...state.data, newCategory],\r\n          counter: state.counter + 1,\r\n        }));\r\n        get().recalculatePaths();\r\n        return newCategory;\r\n      },\r\n      \r\n      update: (systemId, updates) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, ...updates, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n        get().recalculatePaths();\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n      },\r\n      \r\n      findById: (systemId) => {\r\n        return get().data.find((item) => item.systemId === systemId && !item.isDeleted);\r\n      },\r\n      \r\n      findByBusinessId: (id) => {\r\n        return get().data.find((item) => item.id === id && !item.isDeleted);\r\n      },\r\n      \r\n      getActive: () => {\r\n        return get().data.filter((item) => !item.isDeleted && item.isActive);\r\n      },\r\n      \r\n      getByParent: (parentId) => {\r\n        return get().data.filter(\r\n          (item) => !item.isDeleted && item.isActive && item.parentId === parentId\r\n        ).sort((a, b) => (a.sortOrder ?? 0) - (b.sortOrder ?? 0));\r\n      },\r\n\r\n      updateSortOrder: (systemId, newSortOrder) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, sortOrder: newSortOrder, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n      },\r\n\r\n      moveCategory: (systemId, newParentId, newSortOrder) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { \r\n                  ...item, \r\n                  parentId: newParentId, \r\n                  sortOrder: newSortOrder,\r\n                  updatedAt: new Date().toISOString() \r\n                }\r\n              : item\r\n          ),\r\n        }));\r\n        get().recalculatePaths();\r\n      },\r\n\r\n      recalculatePaths: () => {\r\n        set((state) => {\r\n          const allData = [...state.data];\r\n          const updated = allData.map(cat => {\r\n            if (cat.isDeleted) return cat;\r\n            const { path, level } = calculatePathAndLevel(cat, allData);\r\n            return { ...cat, path, level };\r\n          });\r\n          return { data: updated };\r\n        });\r\n      },\r\n      \r\n      getNextId: () => generateBusinessId(get().counter),\r\n      \r\n      isBusinessIdExists: (id: string) => get().data.some((item) => String(item.id) === id),\r\n\r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        try {\r\n          const response = await fetch('/api/categories?all=true');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            if (json.data && Array.isArray(json.data)) {\r\n              const categories: ProductCategory[] = json.data.map((item: Record<string, unknown>) => ({\r\n                ...item,\r\n                systemId: asSystemId(item.systemId as string),\r\n                id: asBusinessId(item.id as string),\r\n                parentId: item.parentId ? asSystemId(item.parentId as string) : undefined,\r\n                // Add default values for fields not in database\r\n                isActive: item.isDeleted !== true,\r\n                color: item.color as string || '#6366f1',\r\n                path: '',\r\n                level: 0,\r\n              }));\r\n              set({ \r\n                data: categories, \r\n                counter: categories.length,\r\n                initialized: true,\r\n              });\r\n              get().recalculatePaths();\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('loadFromAPI error:', error);\r\n        }\r\n        set({ initialized: true });\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1315, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentMethod } from './types';\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\n\r\n// API sync helper\r\nasync function syncToAPI(\r\n  action: 'create' | 'update' | 'delete',\r\n  data: Partial<PaymentMethod>\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create'\r\n      ? '/api/settings/payment-methods'\r\n      : `/api/settings/payment-methods/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Payment Methods API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface PaymentMethodState {\r\n  data: PaymentMethod[];\r\n  initialized: boolean;\r\n  add: (item: Omit<PaymentMethod, 'systemId' | 'isDefault'>) => void;\r\n  update: (systemId: SystemId, updatedPolicy: Omit<PaymentMethod, 'isDefault' | 'systemId'>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  setDefault: (systemId: SystemId) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nexport const usePaymentMethodStore = create<PaymentMethodState>()(\r\n  (set, get) => ({\r\n      data: [],\r\n      initialized: false,\r\n      add: (item) => {\r\n        const newItem: PaymentMethod = { \r\n          ...item, \r\n          systemId: asSystemId(`PM_${Date.now()}`),\r\n          isDefault: get().data.length === 0,\r\n        };\r\n        set((state) => ({ data: [...state.data, newItem] }));\r\n        \r\n        // Sync to API\r\n        syncToAPI('create', newItem).catch(console.error);\r\n      },\r\n      update: (systemId, updatedFields) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => p.systemId === systemId ? { ...p, ...updatedFields } : p),\r\n        }));\r\n        \r\n        // Sync to API\r\n        const updated = get().data.find(p => p.systemId === systemId);\r\n        if (updated) {\r\n          syncToAPI('update', updated).catch(console.error);\r\n        }\r\n      },\r\n      remove: (systemId) => {\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n        set((state) => ({\r\n          data: state.data.filter((p) => p.systemId !== systemId),\r\n        }));\r\n      },\r\n      setDefault: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => ({ ...p, isDefault: p.systemId === systemId })),\r\n        }));\r\n        \r\n        // Sync all to API (update default status)\r\n        const data = get().data;\r\n        for (const item of data) {\r\n          syncToAPI('update', item).catch(console.error);\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Settings data is typically small, but using limit for consistency\r\n          const response = await fetch('/api/settings/payment-methods?limit=30');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const data = json.data || json.methods || [];\r\n            if (data.length > 0) {\r\n              set({ data, initialized: true });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payment Methods Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,kBAAkB;AAClB,eAAe,UACb,MAAsC,EACtC,IAA4B;IAE5B,IAAI;QACF,MAAM,WAAW,WAAW,WACxB,kCACA,CAAC,8BAA8B,EAAE,KAAK,QAAQ,EAAE;QACpD,MAAM,SAAS,WAAW,WAAW,SAAS,WAAW,WAAW,UAAU;QAE9E,MAAM,WAAW,MAAM,MAAM,UAAU;YACrC;YACA,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,WAAW,WAAW,KAAK,SAAS,CAAC,QAAQ;QACrD;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,OAAO,OAAO,CAAC,EAAE;QACxD,OAAO;IACT;AACF;AAYO,MAAM,wBAAwB,IAAA,qJAAM,IACzC,CAAC,KAAK,MAAQ,CAAC;QACX,MAAM,EAAE;QACR,aAAa;QACb,KAAK,CAAC;YACJ,MAAM,UAAyB;gBAC7B,GAAG,IAAI;gBACP,UAAU,IAAA,mIAAU,EAAC,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;gBACvC,WAAW,MAAM,IAAI,CAAC,MAAM,KAAK;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBAAE,MAAM;2BAAI,MAAM,IAAI;wBAAE;qBAAQ;gBAAC,CAAC;YAElD,cAAc;YACd,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;QAClD;QACA,QAAQ,CAAC,UAAU;YACjB,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW;4BAAE,GAAG,CAAC;4BAAE,GAAG,aAAa;wBAAC,IAAI;gBACnF,CAAC;YAED,cAAc;YACd,MAAM,UAAU,MAAM,IAAI,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;YACpD,IAAI,SAAS;gBACX,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;YAClD;QACF;QACA,QAAQ,CAAC;YACP,UAAU,UAAU;gBAAE;YAAS,GAAG,KAAK,CAAC,QAAQ,KAAK;YACrD,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;gBAChD,CAAC;QACH;QACA,YAAY,CAAC;YACX,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;4BAAE,GAAG,CAAC;4BAAE,WAAW,EAAE,QAAQ,KAAK;wBAAS,CAAC;gBACzE,CAAC;YAED,0CAA0C;YAC1C,MAAM,OAAO,MAAM,IAAI;YACvB,KAAK,MAAM,QAAQ,KAAM;gBACvB,UAAU,UAAU,MAAM,KAAK,CAAC,QAAQ,KAAK;YAC/C;QACF;QAEA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YAEvB,IAAI;gBACF,0EAA0E;gBAC1E,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,MAAM,OAAO,KAAK,IAAI,IAAI,KAAK,OAAO,IAAI,EAAE;oBAC5C,IAAI,KAAK,MAAM,GAAG,GAAG;wBACnB,IAAI;4BAAE;4BAAM,aAAa;wBAAK;oBAChC,OAAO;wBACL,IAAI;4BAAE,aAAa;wBAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8CAA8C;YAC9D;QACF;IACF,CAAC"}},
    {"offset": {"line": 1424, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { TargetGroup } from './types';\r\n\r\nexport const useTargetGroupStore = createCrudStore<TargetGroup>([], 'target-groups', {\r\n  apiEndpoint: '/api/settings/data?type=target-group',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,sBAAsB,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IACnF,aAAa;AACf"}}]
}