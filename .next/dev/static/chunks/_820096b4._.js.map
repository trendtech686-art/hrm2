{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/api-config.ts"],"sourcesContent":["/**\r\n * API Configuration Utilities\r\n * \r\n * Centralized configuration for API endpoints.\r\n * All API URLs should use these utilities instead of hardcoding.\r\n */\r\n\r\n/**\r\n * Get the API base URL from environment variables\r\n * Falls back to localhost:3001 for development\r\n */\r\nexport function getApiBaseUrl(): string {\r\n  // Use relative path to leverage Vite proxy in development\r\n  // This avoids CORS issues when frontend (5173) talks to backend (3001)\r\n  if ((import.meta as any).env?.DEV) {\r\n    return '/api';\r\n  }\r\n  return (import.meta as any).env?.VITE_API_BASE_URL || 'http://localhost:3001/api';\r\n}\r\n\r\n/**\r\n * Get the base URL without /api suffix\r\n * Falls back to localhost:3001 for development\r\n */\r\nexport function getBaseUrl(): string {\r\n  const apiUrl = getApiBaseUrl();\r\n  return apiUrl.replace('/api', '');\r\n}\r\n\r\n/**\r\n * Build a full file URL from a relative path\r\n * @param relativePath - Relative file path (e.g., \"/uploads/documents/file.pdf\")\r\n * @returns Full URL to the file\r\n */\r\nexport function getFileUrl(relativePath: string): string {\r\n  if (!relativePath) return '';\r\n  \r\n  // If already a full URL, return as is\r\n  if (relativePath.startsWith('http://') || relativePath.startsWith('https://')) {\r\n    return relativePath;\r\n  }\r\n  \r\n  // Build full URL\r\n  const baseUrl = getBaseUrl();\r\n  return `${baseUrl}${relativePath}`;\r\n}\r\n\r\n/**\r\n * Build an API endpoint URL\r\n * @param endpoint - API endpoint path (e.g., \"/employees/documents\")\r\n * @returns Full API URL\r\n */\r\nexport function getApiUrl(endpoint: string): string {\r\n  const apiBaseUrl = getApiBaseUrl();\r\n  return `${apiBaseUrl}${endpoint}`;\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;CAKC,GAED;;;CAGC;;;;;;;;;;;;;;;AACM,SAAS;IACd,0DAA0D;IAC1D,uEAAuE;IACvE,IAAI,8BAAqB,GAAG,EAAE,KAAK;QACjC,OAAO;IACT;IACA,OAAO,8BAAqB,GAAG,EAAE,qBAAqB;AACxD;AAMO,SAAS;IACd,MAAM,SAAS;IACf,OAAO,OAAO,OAAO,CAAC,QAAQ;AAChC;AAOO,SAAS,WAAW,YAAoB;IAC7C,IAAI,CAAC,cAAc,OAAO;IAE1B,sCAAsC;IACtC,IAAI,aAAa,UAAU,CAAC,cAAc,aAAa,UAAU,CAAC,aAAa;QAC7E,OAAO;IACT;IAEA,iBAAiB;IACjB,MAAM,UAAU;IAChB,OAAO,GAAG,UAAU,cAAc;AACpC;AAOO,SAAS,UAAU,QAAgB;IACxC,MAAM,aAAa;IACnB,OAAO,GAAG,aAAa,UAAU;AACnC"}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/file-upload-api.ts"],"sourcesContent":["// API client ƒë·ªÉ giao ti·∫øp v·ªõi server - Staging System\r\nimport { getApiBaseUrl } from './api-config';\r\n\r\nconst API_BASE_URL = getApiBaseUrl();\r\n\r\nexport type StagingFile = {\r\n  id: string;\r\n  sessionId: string;\r\n  name: string; // Display name (smart filename v·ªõi metadata)\r\n  originalName: string; // T√™n file g·ªëc\r\n  slug: string; // URL-safe slug\r\n  filename: string; // T√™n file h·ªá th·ªëng (UUID) - c·∫ßn cho preview URL\r\n  size: number;\r\n  type: string;\r\n  url: string;\r\n  status: 'staging' | 'permanent'; // ‚úÖ Support both staging and permanent files\r\n  uploadedAt: string;\r\n  metadata: string; // Smart filename metadata\r\n};\r\n\r\nexport type ServerFile = {\r\n  id: string;\r\n  employeeId: string;\r\n  documentType: string;\r\n  documentName: string;\r\n  name: string; // Display name\r\n  originalName: string; // T√™n file g·ªëc\r\n  slug: string; // URL-safe slug\r\n  filename: string; // T√™n file h·ªá th·ªëng\r\n  size: number;\r\n  type: string;\r\n  url: string;\r\n  uploadedAt: string;\r\n  confirmedAt?: string;\r\n  metadata: string; // Smart filename metadata\r\n};\r\n\r\nexport type UploadedAsset = {\r\n  id: string;\r\n  name: string;\r\n  size: number;\r\n  type: string;\r\n  url: string;\r\n  uploadedAt: string;\r\n};\r\n\r\nexport type UploadedFile = {\r\n  id: string;\r\n  name: string;\r\n  filename?: string;\r\n  type: string;\r\n  size: number;\r\n  url: string;\r\n  uploadedAt?: string;\r\n  metadata?: Record<string, unknown>;\r\n};\r\n\r\nexport class FileUploadAPI {\r\n  // Upload files v√†o staging (t·∫°m th·ªùi)\r\n  static async uploadToStaging(files: File[], sessionId?: string): Promise<{\r\n    files: StagingFile[];\r\n    sessionId: string;\r\n  }> {\r\n    const formData = new FormData();\r\n    \r\n    files.forEach(file => {\r\n      formData.append('files', file);\r\n    });\r\n\r\n    // CRITICAL FIX: sessionId in FormData doesn't work with multer\r\n    // Send via query params instead\r\n    const url = sessionId \r\n      ? `${API_BASE_URL}/staging/upload?sessionId=${encodeURIComponent(sessionId)}`\r\n      : `${API_BASE_URL}/staging/upload`;\r\n\r\n    console.log('üì§ Uploading to:', url);\r\n    console.log('üì¶ Files:', files.map(f => `${f.name} (${(f.size / 1024).toFixed(1)}KB)`));\r\n\r\n    let response;\r\n    try {\r\n      response = await fetch(url, {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n    } catch (fetchError) {\r\n      console.error('‚ùå Network fetch failed:', fetchError);\r\n      throw new Error(`Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server (${API_BASE_URL}). Vui l√≤ng ki·ªÉm tra server c√≥ ƒëang ch·∫°y.`);\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      console.error('‚ùå Server error:', response.status, errorText);\r\n      throw new Error(`Server error (${response.status}): ${errorText}`);\r\n    }\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Staging upload failed');\r\n    }\r\n\r\n    return {\r\n      files: result.files,\r\n      sessionId: result.sessionId\r\n    };\r\n  }\r\n\r\n  // Confirm staging files ‚Üí permanent v·ªõi smart filename\r\n  // NOTE: entitySystemId MUST be immutable (systemId) to avoid broken references\r\n  static async confirmStagingFiles(\r\n    sessionId: string,\r\n    entitySystemId: string,\r\n    documentType: string,\r\n    documentName: string,\r\n    metadata?: Record<string, any>\r\n  ): Promise<ServerFile[]> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/staging/confirm/${sessionId}/${entitySystemId}/${documentType}/${encodeURIComponent(documentName)}`,\r\n      { \r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ metadata })\r\n      }\r\n    );\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Confirm failed');\r\n    }\r\n\r\n    return result.files;\r\n  }\r\n\r\n  // L·∫•y staging files theo session\r\n  static async getStagingFiles(sessionId: string): Promise<StagingFile[]> {\r\n    const response = await fetch(`${API_BASE_URL}/staging/files/${sessionId}`);\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Failed to fetch staging files');\r\n    }\r\n\r\n    return result.files;\r\n  }\r\n\r\n  // X√≥a staging files (cancel)\r\n  static async deleteStagingFiles(sessionId: string): Promise<void> {\r\n    const response = await fetch(`${API_BASE_URL}/staging/${sessionId}`, {\r\n      method: 'DELETE',\r\n    });\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Delete staging failed');\r\n    }\r\n  }\r\n\r\n  // Upload files l√™n server (legacy - direct permanent)\r\n  // NOTE: employeeId MUST be the systemId (immutable), NOT the business ID\r\n  static async uploadFiles(\r\n    employeeId: string, // ‚ö†Ô∏è MUST use systemId (e.g., \"NV00000001\"), NOT business ID\r\n    documentType: string,\r\n    documentName: string,\r\n    files: File[]\r\n  ): Promise<ServerFile[]> {\r\n    const formData = new FormData();\r\n    \r\n    files.forEach(file => {\r\n      formData.append('files', file);\r\n    });\r\n\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/upload/${employeeId}/${documentType}/${encodeURIComponent(documentName)}`,\r\n      {\r\n        method: 'POST',\r\n        body: formData,\r\n      }\r\n    );\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Upload failed');\r\n    }\r\n\r\n    return result.files;\r\n  }\r\n\r\n  // L·∫•y danh s√°ch file permanent\r\n  // NOTE: employeeId MUST be the systemId (immutable), NOT the business ID\r\n  static async getFiles(\r\n    employeeId: string, // ‚ö†Ô∏è MUST use systemId (e.g., \"NV00000001\"), NOT business ID\r\n    documentType?: string\r\n  ): Promise<ServerFile[]> {\r\n    try {\r\n      const url = documentType \r\n        ? `${API_BASE_URL}/files/${employeeId}/${documentType}`\r\n        : `${API_BASE_URL}/files/${employeeId}`;\r\n\r\n      const response = await fetch(url);\r\n      \r\n      // Check if response is ok\r\n      if (!response.ok) {\r\n        return []; // Return empty array instead of throwing\r\n      }\r\n      \r\n      const result = await response.json();\r\n      \r\n      if (!result.success) {\r\n        return []; // Return empty array instead of throwing\r\n      }\r\n\r\n      return result.files || [];\r\n    } catch (error) {\r\n      return []; // Return empty array on network error\r\n    }\r\n  }\r\n\r\n  // X√≥a file permanent\r\n  static async deleteFile(fileId: string): Promise<void> {\r\n    const response = await fetch(`${API_BASE_URL}/files/${fileId}`, {\r\n      method: 'DELETE',\r\n    });\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Delete failed');\r\n    }\r\n  }\r\n\r\n  // L·∫•y URL file ƒë·ªÉ hi·ªÉn th·ªã (bao g·ªìm staging v√† permanent)\r\n  static getFileUrl(file: StagingFile | ServerFile): string {\r\n    // ‚úÖ Return relative path to use Vite proxy - avoid CORS\r\n    // Server already returns relative path like /api/staging/files/...\r\n    return file.url;\r\n  }\r\n\r\n  // Th·ªëng k√™ storage (ch·ªâ permanent files)\r\n  static async getStorageInfo(): Promise<{\r\n    totalFiles: number;\r\n    totalSize: number;\r\n    totalSizeMB: number;\r\n  }> {\r\n    const response = await fetch(`${API_BASE_URL}/storage/info`);\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error('Failed to get storage info');\r\n    }\r\n\r\n    return result.stats;\r\n  }\r\n\r\n  // Helper: Generate session ID cho staging\r\n  static generateSessionId(): string {\r\n    return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  static async getProductFiles(productId: string): Promise<ServerFile[]> {\r\n    return this.getFiles(productId, 'products');\r\n  }\r\n\r\n  // Get customer files (images)\r\n  static async getCustomerFiles(customerId: string): Promise<ServerFile[]> {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/files/customers/${customerId}`);\r\n      \r\n      if (!response.ok) {\r\n        return [];\r\n      }\r\n      \r\n      const result = await response.json();\r\n      \r\n      if (!result.success) {\r\n        return [];\r\n      }\r\n\r\n      return result.files || [];\r\n    } catch (error) {\r\n      console.error('Failed to get customer files:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Get customer contract files\r\n  static async getCustomerContractFiles(customerId: string): Promise<ServerFile[]> {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/files/customers/${customerId}/contracts`);\r\n      \r\n      if (!response.ok) {\r\n        return [];\r\n      }\r\n      \r\n      const result = await response.json();\r\n      \r\n      if (!result.success) {\r\n        return [];\r\n      }\r\n\r\n      return result.files || [];\r\n    } catch (error) {\r\n      console.error('Failed to get customer contract files:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Confirm customer contract files from staging to permanent\r\n  static async confirmCustomerContractFiles(\r\n    sessionId: string,\r\n    customerId: string,\r\n    customerData?: Record<string, any>\r\n  ): Promise<ServerFile[]> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/staging/confirm/${sessionId}/customers/${customerId}/contracts`,\r\n      { \r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ customerData })\r\n      }\r\n    );\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Confirm customer contract files failed');\r\n    }\r\n\r\n    return result.files;\r\n  }\r\n\r\n  // Confirm customer images from staging to permanent\r\n  static async confirmCustomerImages(\r\n    sessionId: string,\r\n    customerId: string,\r\n    customerData?: {\r\n      name?: string;\r\n      [key: string]: any;\r\n    }\r\n  ): Promise<ServerFile[]> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/staging/confirm/${sessionId}/customers/${customerId}`,\r\n      { \r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ customerData })\r\n      }\r\n    );\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Confirm customer images failed');\r\n    }\r\n\r\n    return result.files;\r\n  }\r\n\r\n  // Confirm warranty images from staging to permanent\r\n  static async confirmWarrantyImages(\r\n    sessionId: string,\r\n    warrantyId: string,\r\n    imageType: 'received' | 'processed',\r\n    warrantyData?: {\r\n      customerName?: string;\r\n      [key: string]: any;\r\n    }\r\n  ): Promise<ServerFile[]> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/staging/confirm/${sessionId}/warranty/${warrantyId}/${imageType}`,\r\n      { \r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ warrantyData })\r\n      }\r\n    );\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Confirm warranty images failed');\r\n    }\r\n\r\n    return result.files;\r\n  }\r\n\r\n  // Delete staging session (cleanup on cancel)\r\n  static async deleteStagingSession(sessionId: string): Promise<void> {\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/staging/${sessionId}`,\r\n      { method: 'DELETE' }\r\n    );\r\n\r\n    const result = await response.json();\r\n    \r\n    if (!result.success) {\r\n      throw new Error(result.message || 'Delete staging session failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Upload ·∫£nh t·ª´ TipTap Editor v√†o STAGING\r\n   * ·∫¢nh s·∫Ω ƒë∆∞·ª£c move sang permanent khi entity ƒë∆∞·ª£c save\r\n   * \r\n   * @param file - File ·∫£nh c·∫ßn upload\r\n   * @param sessionId - Session ID ƒë·ªÉ group c√°c ·∫£nh c√πng editor\r\n   * @returns StagingFile v·ªõi URL t·∫°m th·ªùi\r\n   */\r\n  static async uploadEditorImageToStaging(file: File, sessionId?: string): Promise<{\r\n    file: StagingFile;\r\n    sessionId: string;\r\n  }> {\r\n    const result = await FileUploadAPI.uploadToStaging([file], sessionId);\r\n    return {\r\n      file: result.files[0],\r\n      sessionId: result.sessionId,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Confirm ·∫£nh editor t·ª´ staging sang permanent\r\n   * ƒê·ªìng th·ªùi replace staging URLs trong HTML content b·∫±ng permanent URLs\r\n   * \r\n   * @param sessionId - Editor staging session\r\n   * @param entityId - ID c·ªßa entity (category, product, etc.)\r\n   * @param entityType - Lo·∫°i entity ('categories', 'products', etc.)\r\n   * @param htmlContent - N·ªôi dung HTML c·∫ßn update URLs\r\n   * @returns Updated HTML v·ªõi permanent URLs\r\n   */\r\n  static async confirmEditorImages(\r\n    sessionId: string,\r\n    entityId: string,\r\n    entityType: string,\r\n    htmlContent: string\r\n  ): Promise<{ html: string; files: ServerFile[] }> {\r\n    // Confirm staging files\r\n    const confirmedFiles = await FileUploadAPI.confirmStagingFiles(\r\n      sessionId,\r\n      entityId,\r\n      entityType,\r\n      'editor-images',\r\n      { source: 'tiptap-editor' }\r\n    );\r\n\r\n    // Replace staging URLs with permanent URLs in HTML\r\n    let updatedHtml = htmlContent;\r\n    for (const file of confirmedFiles) {\r\n      // Staging URL pattern: /api/staging/preview/{sessionId}/{filename}\r\n      // Find and replace with permanent URL\r\n      const stagingPattern = new RegExp(\r\n        `/api/staging/preview/[^/]+/${file.filename.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}`,\r\n        'g'\r\n      );\r\n      updatedHtml = updatedHtml.replace(stagingPattern, file.url);\r\n    }\r\n\r\n    return {\r\n      html: updatedHtml,\r\n      files: confirmedFiles,\r\n    };\r\n  }\r\n\r\n  static async uploadCommentImage(file: File): Promise<UploadedAsset> {\r\n    const formData = new FormData();\r\n    formData.append('image', file);\r\n\r\n    const response = await fetch(`${API_BASE_URL}/comments/upload-image`, {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    const result = await response.json();\r\n    if (!response.ok || !result.success) {\r\n      throw new Error(result.message || 'Upload ·∫£nh b√¨nh lu·∫≠n th·∫•t b·∫°i');\r\n    }\r\n\r\n    return FileUploadAPI.mapDirectUpload(result.file, file.name);\r\n  }\r\n\r\n  static async uploadPrintTemplateImage(file: File): Promise<UploadedAsset> {\r\n    const formData = new FormData();\r\n    formData.append('image', file);\r\n\r\n    const response = await fetch(`${API_BASE_URL}/print-templates/upload-image`, {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    const result = await response.json();\r\n    if (!response.ok || !result.success) {\r\n      throw new Error(result.message || 'Upload ·∫£nh m·∫´u in th·∫•t b·∫°i');\r\n    }\r\n\r\n    return FileUploadAPI.mapDirectUpload(result.file, file.name);\r\n  }\r\n\r\n  static async uploadComplaintCommentImage(complaintId: string, file: File): Promise<UploadedAsset> {\r\n    const formData = new FormData();\r\n    formData.append('image', file);\r\n\r\n    const response = await fetch(`${API_BASE_URL}/complaints/${complaintId}/comments/upload`, {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    const result = await response.json();\r\n    if (!response.ok || !result.success) {\r\n      throw new Error(result.message || 'Upload ·∫£nh khi·∫øu n·∫°i th·∫•t b·∫°i');\r\n    }\r\n\r\n    return FileUploadAPI.mapDirectUpload(result.file, file.name);\r\n  }\r\n\r\n  static async uploadTaskEvidence(taskId: string, files: File[]): Promise<UploadedAsset[]> {\r\n    if (files.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    const formData = new FormData();\r\n    files.forEach((file) => formData.append('files', file));\r\n\r\n    const response = await fetch(`${API_BASE_URL}/tasks/${taskId}/evidence`, {\r\n      method: 'POST',\r\n      body: formData,\r\n    });\r\n\r\n    const result = await response.json();\r\n    if (!response.ok || !result.success) {\r\n      throw new Error(result.message || 'Upload b·∫±ng ch·ª©ng c√¥ng vi·ªác th·∫•t b·∫°i');\r\n    }\r\n\r\n    return (result.files || []).map((file: any, index: number) =>\r\n      FileUploadAPI.mapDirectUpload(file, files[index]?.name || `evidence-${index}`)\r\n    );\r\n  }\r\n\r\n  private static mapDirectUpload(file: any, fallbackName: string): UploadedAsset {\r\n    return {\r\n      id: file.id,\r\n      name: file.originalName || file.name || fallbackName,\r\n      size: file.size || file.filesize || 0,\r\n      type: file.mimetype || file.type || 'application/octet-stream',\r\n      url: file.url,\r\n      uploadedAt: file.uploadedAt || new Date().toISOString(),\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 420, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/website-settings-sync.ts"],"sourcesContent":["/**\r\n * Website Settings Sync Utility\r\n * Synchronizes website settings with database as source of truth\r\n * Uses in-memory cache for fast synchronous access\r\n * \r\n * NOTE: localStorage has been removed - all data comes from API/database\r\n */\r\n\r\n// Types\r\nexport interface WebsiteSettings {\r\n  primaryDomain: string;\r\n  additionalDomains: string[];\r\n  wwwRedirect: 'www-to-non-www' | 'non-www-to-www' | 'keep';\r\n  trailingSlash: 'add' | 'remove' | 'keep';\r\n  sslEnabled: boolean;\r\n  forceHttps: boolean;\r\n  sslCertExpiry: string;\r\n  sslAutoRenew: boolean;\r\n  custom404Enabled: boolean;\r\n  custom404Title: string;\r\n  custom404Content: string;\r\n  custom404RedirectUrl: string;\r\n  custom404RedirectDelay: number;\r\n}\r\n\r\nexport interface Redirect301 {\r\n  id: string;\r\n  fromUrl: string;\r\n  toUrl: string;\r\n  isActive: boolean;\r\n  hitCount: number;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n// API endpoint\r\nconst API_ENDPOINT = '/api/website-settings';\r\n\r\n// Defaults\r\nconst DEFAULT_SETTINGS: WebsiteSettings = {\r\n  primaryDomain: '',\r\n  additionalDomains: [],\r\n  wwwRedirect: 'www-to-non-www',\r\n  trailingSlash: 'remove',\r\n  sslEnabled: true,\r\n  forceHttps: true,\r\n  sslCertExpiry: '',\r\n  sslAutoRenew: true,\r\n  custom404Enabled: false,\r\n  custom404Title: 'Trang kh√¥ng t·ªìn t·∫°i',\r\n  custom404Content: '<p>Xin l·ªói, trang b·∫°n ƒëang t√¨m ki·∫øm kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ b·ªã di chuy·ªÉn.</p>',\r\n  custom404RedirectUrl: '',\r\n  custom404RedirectDelay: 5,\r\n};\r\n\r\nconst DEFAULT_REDIRECTS: Redirect301[] = [];\r\n\r\n// In-memory cache\r\nlet settingsCache: WebsiteSettings | null = null;\r\nlet redirectsCache: Redirect301[] | null = null;\r\nlet isInitialized = false;\r\n\r\n// ============== SETTINGS ==============\r\n\r\n/**\r\n * Load settings from database\r\n */\r\nexport async function loadWebsiteSettingsAsync(): Promise<WebsiteSettings> {\r\n  try {\r\n    const res = await fetch(`${API_ENDPOINT}?type=settings`);\r\n    if (res.ok) {\r\n      const data = await res.json();\r\n      settingsCache = { ...DEFAULT_SETTINGS, ...data };\r\n      return settingsCache;\r\n    }\r\n  } catch (error) {\r\n    console.error('[WebsiteSettings] Error loading from database:', error);\r\n  }\r\n\r\n  // Return cache or defaults if API fails\r\n  return settingsCache ?? DEFAULT_SETTINGS;\r\n}\r\n\r\n/**\r\n * Get settings synchronously (from cache only)\r\n */\r\nexport function getWebsiteSettingsSync(): WebsiteSettings {\r\n  return settingsCache ?? DEFAULT_SETTINGS;\r\n}\r\n\r\n/**\r\n * Save settings to database\r\n */\r\nexport async function saveWebsiteSettingsAsync(settings: WebsiteSettings): Promise<void> {\r\n  // Update cache immediately\r\n  settingsCache = settings;\r\n\r\n  // Save to database\r\n  try {\r\n    await fetch(API_ENDPOINT, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ type: 'settings', data: settings }),\r\n    });\r\n  } catch (error) {\r\n    console.error('[WebsiteSettings] Error saving to database:', error);\r\n  }\r\n}\r\n\r\n// ============== REDIRECTS ==============\r\n\r\n/**\r\n * Load redirects from database\r\n */\r\nexport async function loadRedirectsAsync(): Promise<Redirect301[]> {\r\n  try {\r\n    const res = await fetch(`${API_ENDPOINT}?type=redirects`);\r\n    if (res.ok) {\r\n      const data = await res.json();\r\n      redirectsCache = data;\r\n      return redirectsCache;\r\n    }\r\n  } catch (error) {\r\n    console.error('[WebsiteSettings] Error loading redirects from database:', error);\r\n  }\r\n\r\n  // Return cache or defaults if API fails\r\n  return redirectsCache ?? DEFAULT_REDIRECTS;\r\n}\r\n\r\n/**\r\n * Get redirects synchronously (from cache only)\r\n */\r\nexport function getRedirectsSync(): Redirect301[] {\r\n  return redirectsCache ?? DEFAULT_REDIRECTS;\r\n}\r\n\r\n/**\r\n * Save redirects to database\r\n */\r\nexport async function saveRedirectsAsync(redirects: Redirect301[]): Promise<void> {\r\n  // Update cache immediately\r\n  redirectsCache = redirects;\r\n\r\n  // Save to database\r\n  try {\r\n    await fetch(API_ENDPOINT, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ type: 'redirects', data: redirects }),\r\n    });\r\n  } catch (error) {\r\n    console.error('[WebsiteSettings] Error saving redirects to database:', error);\r\n  }\r\n}\r\n\r\n// ============== INITIALIZATION ==============\r\n\r\n/**\r\n * Initialize both settings and redirects from database\r\n * Call this on app startup\r\n */\r\nexport async function initWebsiteSettings(): Promise<void> {\r\n  if (isInitialized) return;\r\n  \r\n  await Promise.all([\r\n    loadWebsiteSettingsAsync(),\r\n    loadRedirectsAsync(),\r\n  ]);\r\n  \r\n  isInitialized = true;\r\n  console.log('[WebsiteSettings] Initialized from database');\r\n}\r\n\r\n/**\r\n * Force refresh from database\r\n */\r\nexport async function refreshWebsiteSettings(): Promise<void> {\r\n  isInitialized = false;\r\n  settingsCache = null;\r\n  redirectsCache = null;\r\n  await initWebsiteSettings();\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;CAMC,GAED,QAAQ;;;;;;;;;;;;;;;;;;;AA2BR,eAAe;AACf,MAAM,eAAe;AAErB,WAAW;AACX,MAAM,mBAAoC;IACxC,eAAe;IACf,mBAAmB,EAAE;IACrB,aAAa;IACb,eAAe;IACf,YAAY;IACZ,YAAY;IACZ,eAAe;IACf,cAAc;IACd,kBAAkB;IAClB,gBAAgB;IAChB,kBAAkB;IAClB,sBAAsB;IACtB,wBAAwB;AAC1B;AAEA,MAAM,oBAAmC,EAAE;AAE3C,kBAAkB;AAClB,IAAI,gBAAwC;AAC5C,IAAI,iBAAuC;AAC3C,IAAI,gBAAgB;AAOb,eAAe;IACpB,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,cAAc,CAAC;QACvD,IAAI,IAAI,EAAE,EAAE;YACV,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,gBAAgB;gBAAE,GAAG,gBAAgB;gBAAE,GAAG,IAAI;YAAC;YAC/C,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kDAAkD;IAClE;IAEA,wCAAwC;IACxC,OAAO,iBAAiB;AAC1B;AAKO,SAAS;IACd,OAAO,iBAAiB;AAC1B;AAKO,eAAe,yBAAyB,QAAyB;IACtE,2BAA2B;IAC3B,gBAAgB;IAEhB,mBAAmB;IACnB,IAAI;QACF,MAAM,MAAM,cAAc;YACxB,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,MAAM;gBAAY,MAAM;YAAS;QAC1D;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+CAA+C;IAC/D;AACF;AAOO,eAAe;IACpB,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,eAAe,CAAC;QACxD,IAAI,IAAI,EAAE,EAAE;YACV,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,iBAAiB;YACjB,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4DAA4D;IAC5E;IAEA,wCAAwC;IACxC,OAAO,kBAAkB;AAC3B;AAKO,SAAS;IACd,OAAO,kBAAkB;AAC3B;AAKO,eAAe,mBAAmB,SAAwB;IAC/D,2BAA2B;IAC3B,iBAAiB;IAEjB,mBAAmB;IACnB,IAAI;QACF,MAAM,MAAM,cAAc;YACxB,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,MAAM;gBAAa,MAAM;YAAU;QAC5D;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yDAAyD;IACzE;AACF;AAQO,eAAe;IACpB,IAAI,eAAe;IAEnB,MAAM,QAAQ,GAAG,CAAC;QAChB;QACA;KACD;IAED,gBAAgB;IAChB,QAAQ,GAAG,CAAC;AACd;AAKO,eAAe;IACpB,gBAAgB;IAChB,gBAAgB;IAChB,iBAAiB;IACjB,MAAM;AACR"}},
    {"offset": {"line": 565, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/hooks/use-settings-storage.ts"],"sourcesContent":["/**\r\n * Settings Storage Hook\r\n * S·ª≠ d·ª•ng database API l√†m source of truth\r\n * localStorage ƒë√£ b·ªã remove kh·ªèi codebase\r\n */\r\n\r\nimport { useCallback, useEffect, useState } from 'react'\r\n\r\nconst API_BASE = '/api/settings'\r\n\r\n/**\r\n * Hook thay th·∫ø localStorage cho settings\r\n * Ch·ªâ d√πng database API - kh√¥ng c√≥ localStorage fallback\r\n */\r\nexport function useSettingsStorage<T extends Record<string, any>>(\r\n  storageKey: string,\r\n  defaultValue: T,\r\n  group?: string\r\n): [T, (value: T | ((prev: T) => T)) => void, { isLoading: boolean; isSaving: boolean; save: () => Promise<void> }] {\r\n  const [settings, setSettings] = useState<T>(defaultValue)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [isSaving, setIsSaving] = useState(false)\r\n\r\n  // Load settings on mount\r\n  useEffect(() => {\r\n    const loadSettings = async () => {\r\n      try {\r\n        const settingsGroup = group || storageKey.replace('-settings', '')\r\n        const res = await fetch(`${API_BASE}?group=${encodeURIComponent(settingsGroup)}`)\r\n        \r\n        if (res.ok) {\r\n          const data = await res.json()\r\n          \r\n          if (data.data && data.data.length > 0) {\r\n            const settingsMap = data.data.reduce((acc: Record<string, any>, item: any) => {\r\n              acc[item.key] = item.value\r\n              return acc\r\n            }, {})\r\n            \r\n            setSettings(prev => ({ ...prev, ...settingsMap }))\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(`Error loading settings for ${storageKey}:`, error)\r\n      } finally {\r\n        setIsLoading(false)\r\n      }\r\n    }\r\n\r\n    loadSettings()\r\n  }, [storageKey, group])\r\n\r\n  // Save settings to database\r\n  const save = useCallback(async () => {\r\n    setIsSaving(true)\r\n    try {\r\n      const settingsGroup = group || storageKey.replace('-settings', '')\r\n      \r\n      const settingsArray = Object.entries(settings).map(([key, value]) => ({\r\n        key,\r\n        group: settingsGroup,\r\n        value,\r\n      }))\r\n\r\n      await fetch(API_BASE, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ settings: settingsArray }),\r\n      })\r\n    } catch (error) {\r\n      console.error(`Error saving settings for ${storageKey}:`, error)\r\n      throw error\r\n    } finally {\r\n      setIsSaving(false)\r\n    }\r\n  }, [settings, storageKey, group])\r\n\r\n  return [settings, setSettings, { isLoading, isSaving, save }]\r\n}\r\n\r\n/**\r\n * Simple hook for single setting value\r\n */\r\nexport function useSettingValue<T>(\r\n  key: string,\r\n  defaultValue: T,\r\n  group: string = 'general'\r\n): [T, (value: T) => Promise<void>, boolean] {\r\n  const [value, setValue] = useState<T>(defaultValue)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      try {\r\n        const res = await fetch(`${API_BASE}?key=${encodeURIComponent(key)}`)\r\n        if (res.ok) {\r\n          const data = await res.json()\r\n          if (data && data.value !== undefined) {\r\n            setValue(data.value as T)\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(`Error loading setting ${key}:`, error)\r\n      } finally {\r\n        setIsLoading(false)\r\n      }\r\n    }\r\n    load()\r\n  }, [key])\r\n\r\n  const updateValue = useCallback(async (newValue: T) => {\r\n    setValue(newValue)\r\n    try {\r\n      await fetch(API_BASE, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ key, group, value: newValue }),\r\n      })\r\n    } catch (error) {\r\n      console.error(`Error saving setting ${key}:`, error)\r\n    }\r\n  }, [key, group])\r\n\r\n  return [value, updateValue, isLoading]\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 732, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/hooks/use-due-date-notifications.ts"],"sourcesContent":["/**\r\n * Due Date Notifications Hook\r\n * Manages automatic notifications for tasks with approaching due dates\r\n * \r\n * Generic hook - can be used with any entity that has dueDate field\r\n */\r\n\r\nimport { useEffect, useCallback, useRef } from 'react';\r\nimport { toast } from 'sonner';\r\nimport { AlertTriangle, Clock, Calendar } from 'lucide-react';\r\n\r\ntype TaskWithDueDate = {\r\n  id?: string;\r\n  systemId: string;\r\n  dueDate?: Date | string;\r\n  status?: string;\r\n  customerName?: string;\r\n  employeeName?: string;\r\n  [key: string]: any;\r\n};\r\n\r\ntype DueDateWarning = {\r\n  severity: 'none' | 'info' | 'warning' | 'critical' | 'overdue';\r\n  status?: 'overdue' | 'due-today' | 'due-tomorrow' | 'due-soon' | 'normal';\r\n  message: string;\r\n  daysRemaining: number;\r\n};\r\n\r\ntype NotificationSettings = {\r\n  enabled: boolean;\r\n  checkInterval: number; // minutes\r\n  notifyOverdue: boolean;\r\n  notifyDueToday: boolean;\r\n  notifyDueTomorrow: boolean;\r\n  notifyDueSoon: boolean; // within 3 days\r\n  playSound: boolean;\r\n  showDesktopNotification: boolean;\r\n  completedStatuses?: string[]; // Statuses to consider as completed\r\n  linkPrefix?: string; // URL prefix for \"View\" action (e.g., \"/warranty/\", \"/orders/\")\r\n};\r\n\r\nconst DEFAULT_SETTINGS: NotificationSettings = {\r\n  enabled: true,\r\n  checkInterval: 30, // Check every 30 minutes\r\n  notifyOverdue: true,\r\n  notifyDueToday: true,\r\n  notifyDueTomorrow: true,\r\n  notifyDueSoon: true,\r\n  playSound: false,\r\n  showDesktopNotification: false,\r\n  completedStatuses: ['returned', 'completed', 'cancelled'],\r\n  linkPrefix: '/warranty/',\r\n};\r\n\r\n// Helper functions (moved from warranty utils)\r\nfunction getDaysUntilDue(dueDate: Date | string): number {\r\n  const due = typeof dueDate === 'string' ? new Date(dueDate) : dueDate;\r\n  const now = new Date();\r\n  const diffTime = due.getTime() - now.getTime();\r\n  return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n}\r\n\r\nfunction getDueDateWarning(dueDate: Date | string): DueDateWarning {\r\n  const daysRemaining = getDaysUntilDue(dueDate);\r\n  \r\n  if (daysRemaining < 0) {\r\n    return {\r\n      severity: 'overdue',\r\n      status: 'overdue',\r\n      message: `Qu√° h·∫°n ${Math.abs(daysRemaining)} ng√†y`,\r\n      daysRemaining,\r\n    };\r\n  }\r\n  \r\n  if (daysRemaining === 0) {\r\n    return {\r\n      severity: 'critical',\r\n      status: 'due-today',\r\n      message: 'H√¥m nay',\r\n      daysRemaining,\r\n    };\r\n  }\r\n  \r\n  if (daysRemaining === 1) {\r\n    return {\r\n      severity: 'critical',\r\n      status: 'due-tomorrow',\r\n      message: 'Ng√†y mai',\r\n      daysRemaining,\r\n    };\r\n  }\r\n  \r\n  if (daysRemaining <= 3) {\r\n    return {\r\n      severity: 'critical',\r\n      status: 'due-soon',\r\n      message: `C√≤n ${daysRemaining} ng√†y`,\r\n      daysRemaining,\r\n    };\r\n  }\r\n  \r\n  if (daysRemaining <= 7) {\r\n    return {\r\n      severity: 'warning',\r\n      status: 'normal',\r\n      message: `C√≤n ${daysRemaining} ng√†y`,\r\n      daysRemaining,\r\n    };\r\n  }\r\n  \r\n  return {\r\n    severity: 'info',\r\n    status: 'normal',\r\n    message: `C√≤n ${daysRemaining} ng√†y`,\r\n    daysRemaining,\r\n  };\r\n}\r\n\r\nfunction getTasksNeedingNotification(\r\n  tasks: TaskWithDueDate[],\r\n  completedStatuses: string[] = ['returned', 'completed', 'cancelled']\r\n): TaskWithDueDate[] {\r\n  return tasks.filter(task => {\r\n    if (!task.dueDate) return false;\r\n    if (task.status && completedStatuses.includes(task.status)) return false;\r\n    \r\n    const warning = getDueDateWarning(task.dueDate);\r\n    return ['overdue', 'due-today', 'due-tomorrow', 'due-soon'].includes(warning.status || '');\r\n  });\r\n}\r\n\r\nfunction getDueDateNotificationMessage(task: TaskWithDueDate): string {\r\n  if (!task.dueDate) return '';\r\n  \r\n  const warning = getDueDateWarning(task.dueDate);\r\n  const prefix = `[${task.systemId}]`;\r\n  \r\n  switch (warning.status) {\r\n    case 'overdue':\r\n      return `${prefix} C√¥ng vi·ªác qu√° h·∫°n ${Math.abs(warning.daysRemaining)} ng√†y`;\r\n    case 'due-today':\r\n      return `${prefix} C√¥ng vi·ªác ƒë·∫øn h·∫°n h√¥m nay`;\r\n    case 'due-tomorrow':\r\n      return `${prefix} C√¥ng vi·ªác ƒë·∫øn h·∫°n ng√†y mai`;\r\n    case 'due-soon':\r\n      return `${prefix} C√¥ng vi·ªác c√≤n ${warning.daysRemaining} ng√†y`;\r\n    default:\r\n      return `${prefix} ${warning.message}`;\r\n  }\r\n}\r\n\r\n// Track notified tasks to avoid duplicate notifications\r\nconst notifiedTasks = new Set<string>();\r\n\r\nexport function useDueDateNotifications(\r\n  tasks: TaskWithDueDate[],\r\n  settings: Partial<NotificationSettings> = {}\r\n) {\r\n  const mergedSettings = { ...DEFAULT_SETTINGS, ...settings };\r\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const checkAndNotify = useCallback(() => {\r\n    if (!mergedSettings.enabled) return;\r\n\r\n    const tasksToNotify = getTasksNeedingNotification(\r\n      tasks,\r\n      mergedSettings.completedStatuses\r\n    );\r\n\r\n    tasksToNotify.forEach(task => {\r\n      if (!task.dueDate) return;\r\n      \r\n      const warning = getDueDateWarning(task.dueDate);\r\n      const taskKey = `${task.systemId}-${warning.status}`;\r\n\r\n      // Skip if already notified for this status\r\n      if (notifiedTasks.has(taskKey)) return;\r\n\r\n      // Check if this warning type should be notified\r\n      const shouldNotify = \r\n        (warning.status === 'overdue' && mergedSettings.notifyOverdue) ||\r\n        (warning.status === 'due-today' && mergedSettings.notifyDueToday) ||\r\n        (warning.status === 'due-tomorrow' && mergedSettings.notifyDueTomorrow) ||\r\n        (warning.status === 'due-soon' && mergedSettings.notifyDueSoon);\r\n\r\n      if (!shouldNotify) return;\r\n\r\n      // Show toast notification\r\n      const message = getDueDateNotificationMessage(task);\r\n      \r\n      const toastOptions: any = {\r\n        description: `${task.customerName ? `KH: ${task.customerName}` : ''}${task.employeeName ? ` | NV: ${task.employeeName}` : ''}`,\r\n        duration: warning.status === 'overdue' ? 10000 : 5000,\r\n        action: {\r\n          label: 'Xem',\r\n          onClick: () => {\r\n            const linkPrefix = mergedSettings.linkPrefix || '/warranty/';\r\n            window.location.href = `${linkPrefix}${task.systemId}`;\r\n          },\r\n        },\r\n      };\r\n\r\n      switch (warning.status) {\r\n        case 'overdue':\r\n          toast.error(message, toastOptions);\r\n          break;\r\n        case 'due-today':\r\n          toast.warning(message, toastOptions);\r\n          break;\r\n        case 'due-tomorrow':\r\n        case 'due-soon':\r\n          toast.info(message, toastOptions);\r\n          break;\r\n      }\r\n\r\n      // Mark as notified\r\n      notifiedTasks.add(taskKey);\r\n\r\n      // Desktop notification (if enabled and permitted)\r\n      if (mergedSettings.showDesktopNotification && 'Notification' in window) {\r\n        if (Notification.permission === 'granted') {\r\n          new Notification('Nh·∫Øc nh·ªü c√¥ng vi·ªác', {\r\n            body: message,\r\n            icon: '/logo.png',\r\n            tag: taskKey,\r\n          });\r\n        } else if (Notification.permission !== 'denied') {\r\n          Notification.requestPermission();\r\n        }\r\n      }\r\n\r\n      // Play sound (if enabled)\r\n      if (mergedSettings.playSound) {\r\n        const audio = new Audio('/notification-sound.mp3');\r\n        audio.play().catch(console.error);\r\n      }\r\n    });\r\n  }, [tasks, mergedSettings]);\r\n\r\n  // Initial check and periodic checks\r\n  useEffect(() => {\r\n    if (!mergedSettings.enabled) {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Check immediately\r\n    checkAndNotify();\r\n\r\n    // Set up periodic checks\r\n    const intervalMs = mergedSettings.checkInterval * 60 * 1000;\r\n    intervalRef.current = setInterval(checkAndNotify, intervalMs);\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n      }\r\n    };\r\n  }, [checkAndNotify, mergedSettings.enabled, mergedSettings.checkInterval]);\r\n\r\n  // Clear notification history for completed tasks\r\n  useEffect(() => {\r\n    const completedStatuses = mergedSettings.completedStatuses || ['returned', 'completed', 'cancelled'];\r\n    tasks.forEach(task => {\r\n      if (task.status && completedStatuses.includes(task.status)) {\r\n        // Remove all notifications for this task\r\n        Array.from(notifiedTasks).forEach(key => {\r\n          if (key.startsWith(task.systemId)) {\r\n            notifiedTasks.delete(key);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }, [tasks, mergedSettings.completedStatuses]);\r\n\r\n  const clearNotificationHistory = useCallback(() => {\r\n    notifiedTasks.clear();\r\n  }, []);\r\n\r\n  const requestDesktopPermission = useCallback(async () => {\r\n    if ('Notification' in window && Notification.permission === 'default') {\r\n      const permission = await Notification.requestPermission();\r\n      return permission === 'granted';\r\n    }\r\n    return false;\r\n  }, []);\r\n\r\n  return {\r\n    checkAndNotify,\r\n    clearNotificationHistory,\r\n    requestDesktopPermission,\r\n    hasDesktopPermission: 'Notification' in window && Notification.permission === 'granted',\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for managing notification settings\r\n * NOTE: localStorage has been removed - settings now stored in memory only\r\n * For persistent settings, use /api/user-preferences\r\n */\r\nexport function useNotificationSettings(storageKey: string = 'hrm-due-date-notification-settings') {\r\n  // In-memory cache for settings\r\n  const settingsRef = useRef<NotificationSettings>(DEFAULT_SETTINGS);\r\n  \r\n  const getSettings = useCallback((): NotificationSettings => {\r\n    return settingsRef.current;\r\n  }, []);\r\n\r\n  const saveSettings = useCallback((settings: Partial<NotificationSettings>) => {\r\n    const updated = { ...settingsRef.current, ...settings };\r\n    settingsRef.current = updated;\r\n    return updated;\r\n  }, []);\r\n\r\n  const resetSettings = useCallback(() => {\r\n    settingsRef.current = DEFAULT_SETTINGS;\r\n    return DEFAULT_SETTINGS;\r\n  }, []);\r\n\r\n  return {\r\n    getSettings,\r\n    saveSettings,\r\n    resetSettings,\r\n    defaultSettings: DEFAULT_SETTINGS,\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1048, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/app/%28authenticated%29/settings/other/page.tsx"],"sourcesContent":["'use client';\r\nimport { OtherSettingsPage } from '@/features/settings/other-page';\r\nexport default OtherSettingsPage;\r\n"],"names":[],"mappings":";;;;AACA;AADA;;uCAEe,8JAAiB"}}]
}