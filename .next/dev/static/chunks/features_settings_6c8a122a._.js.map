{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/api/inventory-settings-api.ts"],"sourcesContent":["/**\r\n * Inventory Settings API Layer\r\n */\r\n\r\nimport type { ProductType, ProductCategory, Brand } from '../types';\r\n\r\nconst BASE_URL = '/api/settings/inventory';\r\n\r\n// Product Types\r\nexport async function fetchProductTypes(): Promise<ProductType[]> {\r\n  const res = await fetch(`${BASE_URL}/product-types`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createProductType(data: Partial<ProductType>): Promise<ProductType> {\r\n  const res = await fetch(`${BASE_URL}/product-types`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateProductType(systemId: string, data: Partial<ProductType>): Promise<ProductType> {\r\n  const res = await fetch(`${BASE_URL}/product-types/${systemId}`, { method: 'PATCH', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteProductType(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/product-types/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// Product Categories\r\nexport async function fetchProductCategories(): Promise<ProductCategory[]> {\r\n  const res = await fetch('/api/categories?all=true');\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  const json = await res.json();\r\n  return json.data || json;\r\n}\r\n\r\nexport async function createProductCategory(data: Partial<ProductCategory>): Promise<ProductCategory> {\r\n  const res = await fetch('/api/categories', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateProductCategory(systemId: string, data: Partial<ProductCategory>): Promise<ProductCategory> {\r\n  const res = await fetch(`/api/categories/${systemId}`, { method: 'PATCH', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteProductCategory(systemId: string): Promise<void> {\r\n  const res = await fetch(`/api/categories/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// Brands\r\nexport async function fetchBrands(): Promise<Brand[]> {\r\n  const res = await fetch('/api/brands?all=true');\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  const json = await res.json();\r\n  return json.data || json;\r\n}\r\n\r\nexport async function createBrand(data: Partial<Brand>): Promise<Brand> {\r\n  const res = await fetch('/api/brands', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateBrand(systemId: string, data: Partial<Brand>): Promise<Brand> {\r\n  const res = await fetch(`/api/brands/${systemId}`, { method: 'PATCH', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteBrand(systemId: string): Promise<void> {\r\n  const res = await fetch(`/api/brands/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n\r\n// Importers\r\nexport async function fetchImporters(): Promise<any[]> {\r\n  const res = await fetch(`${BASE_URL}/importers`);\r\n  if (!res.ok) throw new Error('Failed to fetch');\r\n  return res.json();\r\n}\r\n\r\nexport async function createImporter(data: any): Promise<any> {\r\n  const res = await fetch(`${BASE_URL}/importers`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to create');\r\n  return res.json();\r\n}\r\n\r\nexport async function updateImporter(systemId: string, data: any): Promise<any> {\r\n  const res = await fetch(`${BASE_URL}/importers/${systemId}`, { method: 'PATCH', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });\r\n  if (!res.ok) throw new Error('Failed to update');\r\n  return res.json();\r\n}\r\n\r\nexport async function deleteImporter(systemId: string): Promise<void> {\r\n  const res = await fetch(`${BASE_URL}/importers/${systemId}`, { method: 'DELETE' });\r\n  if (!res.ok) throw new Error('Failed to delete');\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAID,MAAM,WAAW;AAGV,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,cAAc,CAAC;IACnD,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,kBAAkB,IAA0B;IAChE,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,cAAc,CAAC,EAAE;QAAE,QAAQ;QAAQ,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IACnJ,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,kBAAkB,QAAgB,EAAE,IAA0B;IAClF,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,eAAe,EAAE,UAAU,EAAE;QAAE,QAAQ;QAAS,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IAChK,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,eAAe,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IACpF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM;IACxB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,OAAO,KAAK,IAAI,IAAI;AACtB;AAEO,eAAe,sBAAsB,IAA8B;IACxE,MAAM,MAAM,MAAM,MAAM,mBAAmB;QAAE,QAAQ;QAAQ,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IACzI,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,sBAAsB,QAAgB,EAAE,IAA8B;IAC1F,MAAM,MAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,UAAU,EAAE;QAAE,QAAQ;QAAS,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IACtJ,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,sBAAsB,QAAgB;IAC1D,MAAM,MAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC1E,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM;IACxB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,OAAO,KAAK,IAAI,IAAI;AACtB;AAEO,eAAe,YAAY,IAAoB;IACpD,MAAM,MAAM,MAAM,MAAM,eAAe;QAAE,QAAQ;QAAQ,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IACrI,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,YAAY,QAAgB,EAAE,IAAoB;IACtE,MAAM,MAAM,MAAM,MAAM,CAAC,YAAY,EAAE,UAAU,EAAE;QAAE,QAAQ;QAAS,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IAClJ,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,YAAY,QAAgB;IAChD,MAAM,MAAM,MAAM,MAAM,CAAC,YAAY,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IACtE,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B;AAGO,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,UAAU,CAAC;IAC/C,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,eAAe,IAAS;IAC5C,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,UAAU,CAAC,EAAE;QAAE,QAAQ;QAAQ,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IAC/I,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAS;IAC9D,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,WAAW,EAAE,UAAU,EAAE;QAAE,QAAQ;QAAS,SAAS;YAAE,gBAAgB;QAAmB;QAAG,MAAM,KAAK,SAAS,CAAC;IAAM;IAC5J,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,eAAe,QAAgB;IACnD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,WAAW,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAChF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/hooks/use-inventory-settings.ts"],"sourcesContent":["/**\r\n * Inventory Settings React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport * as api from '../api/inventory-settings-api';\r\nimport type { ProductType, ProductCategory, Brand } from '../types';\r\n\r\nexport const inventorySettingsKeys = {\r\n  all: ['inventory-settings'] as const,\r\n  productTypes: () => [...inventorySettingsKeys.all, 'product-types'] as const,\r\n  categories: () => [...inventorySettingsKeys.all, 'categories'] as const,\r\n  brands: () => [...inventorySettingsKeys.all, 'brands'] as const,\r\n  importers: () => [...inventorySettingsKeys.all, 'importers'] as const,\r\n};\r\n\r\n// Product Types\r\nexport function useProductTypes() {\r\n  return useQuery({ queryKey: inventorySettingsKeys.productTypes(), queryFn: api.fetchProductTypes, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useProductTypeMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: inventorySettingsKeys.productTypes() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createProductType, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<ProductType> }) => api.updateProductType(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteProductType, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Product Categories\r\nexport function useProductCategories() {\r\n  return useQuery({ queryKey: inventorySettingsKeys.categories(), queryFn: api.fetchProductCategories, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useProductCategoryMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: inventorySettingsKeys.categories() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createProductCategory, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<ProductCategory> }) => api.updateProductCategory(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteProductCategory, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Brands\r\nexport function useInventoryBrands() {\r\n  return useQuery({ queryKey: inventorySettingsKeys.brands(), queryFn: api.fetchBrands, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useBrandMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: inventorySettingsKeys.brands() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createBrand, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: Partial<Brand> }) => api.updateBrand(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteBrand, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// Importers\r\nexport function useImporters() {\r\n  return useQuery({ queryKey: inventorySettingsKeys.importers(), queryFn: api.fetchImporters, staleTime: 1000 * 60 * 10 });\r\n}\r\n\r\nexport function useImporterMutations(opts?: { onSuccess?: () => void }) {\r\n  const qc = useQueryClient();\r\n  const invalidate = () => qc.invalidateQueries({ queryKey: inventorySettingsKeys.importers() });\r\n  return {\r\n    create: useMutation({ mutationFn: api.createImporter, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    update: useMutation({ mutationFn: ({ systemId, data }: { systemId: string; data: any }) => api.updateImporter(systemId, data), onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n    remove: useMutation({ mutationFn: api.deleteImporter, onSuccess: () => { invalidate(); opts?.onSuccess?.(); } }),\r\n  };\r\n}\r\n\r\n// =============================================\r\n// CONVENIENCE HOOKS (for backward compatibility)\r\n// =============================================\r\n\r\n// Active brands (isActive = true)\r\nexport function useActiveBrands() {\r\n  const query = useInventoryBrands();\r\n  const data = (query.data || []).filter((b: Brand) => b.isActive);\r\n  return { ...query, data };\r\n}\r\n\r\n// Active importers (isActive = true) \r\nexport function useActiveImporters() {\r\n  const query = useImporters();\r\n  const data = (query.data || []).filter((i: any) => i.isActive);\r\n  return { ...query, data };\r\n}\r\n\r\n// Storage locations - TODO: Implement when storage locations API is ready\r\nexport function useStorageLocations() {\r\n  // Placeholder - returns empty array until storage locations API is implemented\r\n  return { data: [], isLoading: false, isError: false, error: null };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 518, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/hooks/use-all-inventory-settings.ts"],"sourcesContent":["/**\r\n * Convenience hooks for inventory settings - flat array access\r\n */\r\n\r\nimport { useCallback } from 'react';\r\nimport { \r\n  useProductCategories, \r\n  useInventoryBrands,\r\n  useImporters \r\n} from './use-inventory-settings';\r\nimport type { ProductCategory, Brand } from '../types';\r\n\r\n/**\r\n * Returns all product categories as a flat array\r\n */\r\nexport function useAllProductCategories() {\r\n  const query = useProductCategories();\r\n  \r\n  return {\r\n    data: query.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns product categories formatted as options\r\n */\r\nexport function useProductCategoryOptions() {\r\n  const { data, isLoading } = useAllProductCategories();\r\n  \r\n  const options = data.map(c => ({\r\n    value: c.systemId,\r\n    label: c.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Hook for finding category by systemId\r\n */\r\nexport function useProductCategoryFinder() {\r\n  const { data } = useAllProductCategories();\r\n  \r\n  const findById = useCallback((systemId: string): ProductCategory | undefined => {\r\n    return data.find(c => c.systemId === systemId);\r\n  }, [data]);\r\n  \r\n  return { findById };\r\n}\r\n\r\n/**\r\n * Returns all brands as a flat array\r\n */\r\nexport function useAllBrands() {\r\n  const query = useInventoryBrands();\r\n  \r\n  return {\r\n    data: query.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns brands formatted as options\r\n */\r\nexport function useBrandOptions() {\r\n  const { data, isLoading } = useAllBrands();\r\n  \r\n  const options = data.map(b => ({\r\n    value: b.systemId,\r\n    label: b.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Hook for finding brand by systemId\r\n */\r\nexport function useBrandFinder() {\r\n  const { data } = useAllBrands();\r\n  \r\n  const findById = useCallback((systemId: string): Brand | undefined => {\r\n    return data.find(b => b.systemId === systemId);\r\n  }, [data]);\r\n  \r\n  return { findById };\r\n}\r\n\r\n/**\r\n * Returns all importers as a flat array\r\n */\r\nexport function useAllImporters() {\r\n  const query = useImporters();\r\n  \r\n  return {\r\n    data: query.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;CAEC,GAED;AACA;;;;AAUO,SAAS;;IACd,MAAM,QAAQ,IAAA,qMAAoB;IAElC,OAAO;QACL,MAAM,MAAM,IAAI,IAAI,EAAE;QACtB,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GATgB;;QACA,qMAAoB;;;AAa7B,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;IATgB;;QACc;;;AAavB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,IAAA,4KAAW;0DAAC,CAAC;YAC5B,OAAO,KAAK,IAAI;kEAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;;QACvC;yDAAG;QAAC;KAAK;IAET,OAAO;QAAE;IAAS;AACpB;IARgB;;QACG;;;AAYZ,SAAS;;IACd,MAAM,QAAQ,IAAA,mMAAkB;IAEhC,OAAO;QACL,MAAM,MAAM,IAAI,IAAI,EAAE;QACtB,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;IATgB;;QACA,mMAAkB;;;AAa3B,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;IATgB;;QACc;;;AAavB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,IAAA,4KAAW;gDAAC,CAAC;YAC5B,OAAO,KAAK,IAAI;wDAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;;QACvC;+CAAG;QAAC;KAAK;IAET,OAAO;QAAE;IAAS;AACpB;IARgB;;QACG;;;AAYZ,SAAS;;IACd,MAAM,QAAQ,IAAA,6LAAY;IAE1B,OAAO;QACL,MAAM,MAAM,IAAI,IAAI,EAAE;QACtB,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;IATgB;;QACA,6LAAY"}},
    {"offset": {"line": 669, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/product-category-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId, type BusinessId } from '@/lib/id-types';\r\nimport type { ProductCategory } from './types';\r\n\r\nconst generateSystemId = (counter: number): SystemId => {\r\n  return asSystemId(`CATEGORY${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\nconst generateBusinessId = (counter: number): BusinessId => {\r\n  return asBusinessId(`DM${String(counter + 1).padStart(6, '0')}`);\r\n};\r\n\r\n// Helper to calculate path and level\r\nconst calculatePathAndLevel = (category: ProductCategory, allCategories: ProductCategory[]): { path: string; level: number } => {\r\n  if (!category.parentId) {\r\n    return { path: category.name, level: 0 };\r\n  }\r\n  \r\n  const parent = allCategories.find(c => c.systemId === category.parentId);\r\n  if (!parent) {\r\n    return { path: category.name, level: 0 };\r\n  }\r\n  \r\n  const parentInfo = calculatePathAndLevel(parent, allCategories);\r\n  return {\r\n    path: `${parentInfo.path} > ${category.name}`,\r\n    level: parentInfo.level + 1\r\n  };\r\n};\r\n\r\ninterface ProductCategoryState {\r\n  data: ProductCategory[];\r\n  counter: number;\r\n  initialized: boolean;\r\n  add: (category: Omit<ProductCategory, 'systemId' | 'id' | 'path' | 'level'> & { id?: string }) => ProductCategory;\r\n  update: (systemId: SystemId, updates: Partial<ProductCategory>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => ProductCategory | undefined;\r\n  findByBusinessId: (id: BusinessId) => ProductCategory | undefined;\r\n  getActive: () => ProductCategory[];\r\n  getByParent: (parentId?: SystemId) => ProductCategory[];\r\n  updateSortOrder: (systemId: SystemId, newSortOrder: number) => void;\r\n  moveCategory: (systemId: SystemId, newParentId: SystemId | undefined, newSortOrder: number) => void;\r\n  recalculatePaths: () => void;\r\n  getNextId: () => BusinessId;\r\n  isBusinessIdExists: (id: string) => boolean;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\n// API sync helper\r\nasync function syncCategoryToAPI(category: ProductCategory, action: 'create' | 'update' | 'delete'): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/categories' : `/api/categories/${category.systemId}`;\r\n    const response = await fetch(endpoint, {\r\n      method: action === 'create' ? 'POST' : action === 'delete' ? 'DELETE' : 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(category),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('syncCategoryToAPI error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useProductCategoryStore = create<ProductCategoryState>()(\r\n  (set, get) => ({\r\n    data: [],\r\n    counter: 0,\r\n    initialized: false,\r\n      \r\n    add: (category) => {\r\n        const currentCounter = get().counter;\r\n        const allData = get().data;\r\n        const { id, ...rest } = category;\r\n        \r\n        const businessId = id && id.trim() \r\n          ? asBusinessId(id.trim())\r\n          : generateBusinessId(currentCounter);\r\n        \r\n        const { path, level } = calculatePathAndLevel(\r\n          { ...rest, systemId: 'temp' as SystemId, id: businessId, path: '', level: 0 } as ProductCategory,\r\n          allData\r\n        );\r\n        \r\n        const newCategory: ProductCategory = {\r\n          ...rest,\r\n          systemId: generateSystemId(currentCounter),\r\n          id: businessId,\r\n          path,\r\n          level,\r\n          createdAt: new Date().toISOString(),\r\n          isDeleted: false,\r\n          isActive: category.isActive !== undefined ? category.isActive : true,\r\n        };\r\n        set((state) => ({ \r\n          data: [...state.data, newCategory],\r\n          counter: state.counter + 1,\r\n        }));\r\n        get().recalculatePaths();\r\n        return newCategory;\r\n      },\r\n      \r\n      update: (systemId, updates) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, ...updates, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n        get().recalculatePaths();\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n      },\r\n      \r\n      findById: (systemId) => {\r\n        return get().data.find((item) => item.systemId === systemId && !item.isDeleted);\r\n      },\r\n      \r\n      findByBusinessId: (id) => {\r\n        return get().data.find((item) => item.id === id && !item.isDeleted);\r\n      },\r\n      \r\n      getActive: () => {\r\n        return get().data.filter((item) => !item.isDeleted && item.isActive);\r\n      },\r\n      \r\n      getByParent: (parentId) => {\r\n        return get().data.filter(\r\n          (item) => !item.isDeleted && item.isActive && item.parentId === parentId\r\n        ).sort((a, b) => (a.sortOrder ?? 0) - (b.sortOrder ?? 0));\r\n      },\r\n\r\n      updateSortOrder: (systemId, newSortOrder) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { ...item, sortOrder: newSortOrder, updatedAt: new Date().toISOString() }\r\n              : item\r\n          ),\r\n        }));\r\n      },\r\n\r\n      moveCategory: (systemId, newParentId, newSortOrder) => {\r\n        set((state) => ({\r\n          data: state.data.map((item) =>\r\n            item.systemId === systemId\r\n              ? { \r\n                  ...item, \r\n                  parentId: newParentId, \r\n                  sortOrder: newSortOrder,\r\n                  updatedAt: new Date().toISOString() \r\n                }\r\n              : item\r\n          ),\r\n        }));\r\n        get().recalculatePaths();\r\n      },\r\n\r\n      recalculatePaths: () => {\r\n        set((state) => {\r\n          const allData = [...state.data];\r\n          const updated = allData.map(cat => {\r\n            if (cat.isDeleted) return cat;\r\n            const { path, level } = calculatePathAndLevel(cat, allData);\r\n            return { ...cat, path, level };\r\n          });\r\n          return { data: updated };\r\n        });\r\n      },\r\n      \r\n      getNextId: () => generateBusinessId(get().counter),\r\n      \r\n      isBusinessIdExists: (id: string) => get().data.some((item) => String(item.id) === id),\r\n\r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        try {\r\n          const response = await fetch('/api/categories?all=true');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            if (json.data && Array.isArray(json.data)) {\r\n              const categories: ProductCategory[] = json.data.map((item: Record<string, unknown>) => ({\r\n                ...item,\r\n                systemId: asSystemId(item.systemId as string),\r\n                id: asBusinessId(item.id as string),\r\n                parentId: item.parentId ? asSystemId(item.parentId as string) : undefined,\r\n                // Add default values for fields not in database\r\n                isActive: item.isDeleted !== true,\r\n                color: item.color as string || '#6366f1',\r\n                path: '',\r\n                level: 0,\r\n              }));\r\n              set({ \r\n                data: categories, \r\n                counter: categories.length,\r\n                initialized: true,\r\n              });\r\n              get().recalculatePaths();\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('loadFromAPI error:', error);\r\n        }\r\n        set({ initialized: true });\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 870, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/brand-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId, type BusinessId } from '@/lib/id-types';\r\nimport type { Brand } from './types';\r\n\r\ninterface BrandState {\r\n  data: Brand[];\r\n  counter: number;\r\n  initialized: boolean;\r\n  add: (brand: Omit<Brand, 'systemId' | 'createdAt' | 'updatedAt'> & { id?: string }) => void;\r\n  update: (systemId: SystemId, brand: Partial<Brand>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  getActive: () => Brand[];\r\n  findById: (systemId: SystemId) => Brand | undefined;\r\n  findByBusinessId: (id: BusinessId) => Brand | undefined;\r\n  getNextId: () => BusinessId;\r\n  isBusinessIdExists: (id: string) => boolean;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst generateSystemId = (currentCounter: number): SystemId => {\r\n  return asSystemId(`BRAND${String(currentCounter + 1).padStart(6, '0')}`);\r\n};\r\n\r\nconst generateBusinessId = (currentCounter: number): BusinessId => {\r\n  return asBusinessId(`TH${String(currentCounter + 1).padStart(6, '0')}`);\r\n};\r\n\r\n// API sync helper\r\nasync function syncBrandToAPI(brand: Brand, action: 'create' | 'update' | 'delete'): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/brands' : `/api/brands/${brand.systemId}`;\r\n    const response = await fetch(endpoint, {\r\n      method: action === 'create' ? 'POST' : action === 'delete' ? 'DELETE' : 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(brand),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('syncBrandToAPI error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useBrandStore = create<BrandState>()(\r\n  (set, get) => ({\r\n    data: [],\r\n    counter: 0,\r\n    initialized: false,\r\n      \r\n    add: (brand) => {\r\n        const currentCounter = get().counter;\r\n        const { id, ...rest } = brand;\r\n        const businessId = id && id.trim() \r\n          ? asBusinessId(id.trim())\r\n          : generateBusinessId(currentCounter);\r\n          \r\n        set((state) => ({\r\n          data: [\r\n            ...state.data,\r\n            {\r\n              ...rest,\r\n              systemId: generateSystemId(currentCounter),\r\n              id: businessId,\r\n              createdAt: new Date().toISOString(),\r\n              updatedAt: new Date().toISOString(),\r\n              isActive: brand.isActive ?? true,\r\n              isDeleted: false,\r\n            },\r\n          ],\r\n          counter: state.counter + 1,\r\n        }));\r\n      },\r\n      \r\n      update: (systemId, brand) => set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, ...brand, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      })),\r\n      \r\n      remove: (systemId) => set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      })),\r\n      \r\n      getActive: () => get().data.filter((item) => !item.isDeleted && item.isActive),\r\n      \r\n      findById: (systemId) => get().data.find((item) => item.systemId === systemId),\r\n      \r\n      findByBusinessId: (id) => get().data.find((item) => item.id === id),\r\n      \r\n      getNextId: () => generateBusinessId(get().counter),\r\n      \r\n      isBusinessIdExists: (id: string) => get().data.some((item) => String(item.id) === id),\r\n\r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        try {\r\n          const response = await fetch('/api/brands?all=true');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            if (json.data && Array.isArray(json.data)) {\r\n              const brands: Brand[] = json.data.map((item: Record<string, unknown>) => ({\r\n                ...item,\r\n                systemId: asSystemId(item.systemId as string),\r\n                id: asBusinessId(item.id as string),\r\n                // Add default values for fields not in database\r\n                isActive: item.isDeleted !== true,\r\n              }));\r\n              set({ \r\n                data: brands, \r\n                counter: brands.length,\r\n                initialized: true,\r\n              });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('loadFromAPI error:', error);\r\n        }\r\n        set({ initialized: true });\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 980, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/sla-settings-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { ProductSlaSettings } from './types';\r\n\r\ninterface SlaSettingsState {\r\n  settings: ProductSlaSettings;\r\n  initialized: boolean;\r\n  update: (updates: Partial<ProductSlaSettings>) => void;\r\n  reset: () => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst defaultSettings: ProductSlaSettings = {\r\n  // Ngưỡng mặc định\r\n  defaultReorderLevel: 10,\r\n  defaultSafetyStock: 5,\r\n  defaultMaxStock: 100,\r\n  \r\n  // Cảnh báo hàng tồn lâu\r\n  deadStockDays: 90,\r\n  slowMovingDays: 30,\r\n  \r\n  // Notifications\r\n  enableEmailAlerts: false,\r\n  alertEmailRecipients: [],\r\n  alertFrequency: 'daily',\r\n  \r\n  // Dashboard\r\n  showOnDashboard: true,\r\n  dashboardAlertTypes: ['out_of_stock', 'low_stock', 'below_safety'],\r\n};\r\n\r\n// API sync helper\r\nasync function syncToAPI(settings: ProductSlaSettings): Promise<boolean> {\r\n  try {\r\n    const response = await fetch('/api/settings/product-sla', {\r\n      method: 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(settings),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('[SLA Settings API] sync error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const useSlaSettingsStore = create<SlaSettingsState>()(\r\n  (set, get) => ({\r\n    settings: defaultSettings,\r\n    initialized: false,\r\n    \r\n    update: (updates) => {\r\n      const newSettings = { ...get().settings, ...updates };\r\n      set({ settings: newSettings });\r\n      syncToAPI(newSettings).catch(console.error);\r\n    },\r\n    \r\n    reset: () => {\r\n      set({ settings: defaultSettings });\r\n      syncToAPI(defaultSettings).catch(console.error);\r\n    },\r\n    \r\n    loadFromAPI: async () => {\r\n      if (get().initialized) return;\r\n      try {\r\n        const response = await fetch('/api/settings/product-sla');\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const data = json.data || json;\r\n          if (data && Object.keys(data).length > 0) {\r\n            set({ settings: { ...defaultSettings, ...data }, initialized: true });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[SLA Settings Store] loadFromAPI error:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAWA,MAAM,kBAAsC;IAC1C,kBAAkB;IAClB,qBAAqB;IACrB,oBAAoB;IACpB,iBAAiB;IAEjB,wBAAwB;IACxB,eAAe;IACf,gBAAgB;IAEhB,gBAAgB;IAChB,mBAAmB;IACnB,sBAAsB,EAAE;IACxB,gBAAgB;IAEhB,YAAY;IACZ,iBAAiB;IACjB,qBAAqB;QAAC;QAAgB;QAAa;KAAe;AACpE;AAEA,kBAAkB;AAClB,eAAe,UAAU,QAA4B;IACnD,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,6BAA6B;YACxD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACvB;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO;IACT;AACF;AAEO,MAAM,sBAAsB,IAAA,qJAAM,IACvC,CAAC,KAAK,MAAQ,CAAC;QACb,UAAU;QACV,aAAa;QAEb,QAAQ,CAAC;YACP,MAAM,cAAc;gBAAE,GAAG,MAAM,QAAQ;gBAAE,GAAG,OAAO;YAAC;YACpD,IAAI;gBAAE,UAAU;YAAY;YAC5B,UAAU,aAAa,KAAK,CAAC,QAAQ,KAAK;QAC5C;QAEA,OAAO;YACL,IAAI;gBAAE,UAAU;YAAgB;YAChC,UAAU,iBAAiB,KAAK,CAAC,QAAQ,KAAK;QAChD;QAEA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YACvB,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,MAAM,OAAO,KAAK,IAAI,IAAI;oBAC1B,IAAI,QAAQ,OAAO,IAAI,CAAC,MAAM,MAAM,GAAG,GAAG;wBACxC,IAAI;4BAAE,UAAU;gCAAE,GAAG,eAAe;gCAAE,GAAG,IAAI;4BAAC;4BAAG,aAAa;wBAAK;oBACrE,OAAO;wBACL,IAAI;4BAAE,aAAa;wBAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2CAA2C;YAC3D;QACF;IACF,CAAC"}},
    {"offset": {"line": 1074, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/inventory/product-type-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { asSystemId, asBusinessId, type SystemId } from '@/lib/id-types';\r\nimport type { ProductType } from './types';\r\n\r\nconst generateId = () => crypto.randomUUID();\r\n\r\n// API sync helper\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: Partial<ProductType>): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/settings/product-types' : `/api/settings/product-types/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Product Type API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface ProductTypeState {\r\n  data: ProductType[];\r\n  initialized: boolean;\r\n  add: (productType: Omit<ProductType, 'systemId'>) => ProductType;\r\n  update: (systemId: SystemId, updates: Partial<ProductType>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => ProductType | undefined;\r\n  getActive: () => ProductType[];\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst rawData = [\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT001',\r\n    name: 'Hàng hóa',\r\n    description: 'Sản phẩm vật lý có tồn kho',\r\n    isDefault: true,\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT002',\r\n    name: 'Dịch vụ',\r\n    description: 'Dịch vụ không có tồn kho',\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n  {\r\n    systemId: generateId(),\r\n    id: 'PT003',\r\n    name: 'Digital',\r\n    description: 'Sản phẩm số (ebook, khóa học online...)',\r\n    isActive: true,\r\n    createdAt: new Date().toISOString(),\r\n  },\r\n] as const;\r\n\r\nconst initialData: ProductType[] = rawData.map((item) => ({\r\n  ...item,\r\n  systemId: asSystemId(item.systemId),\r\n  id: asBusinessId(item.id),\r\n}));\r\n\r\nexport const useProductTypeStore = create<ProductTypeState>()(\r\n  (set, get) => ({\r\n    data: initialData,\r\n    initialized: false,\r\n    \r\n    add: (productType) => {\r\n      const newProductType: ProductType = {\r\n        ...productType,\r\n        systemId: asSystemId(generateId()),\r\n        createdAt: new Date().toISOString(),\r\n        isDeleted: false,\r\n      };\r\n      set((state) => ({ data: [...state.data, newProductType] }));\r\n      syncToAPI('create', newProductType).catch(console.error);\r\n      return newProductType;\r\n    },\r\n    \r\n    update: (systemId, updates) => {\r\n      set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, ...updates, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      }));\r\n      const updated = get().data.find(i => i.systemId === systemId);\r\n      if (updated) syncToAPI('update', updated).catch(console.error);\r\n    },\r\n    \r\n    remove: (systemId) => {\r\n      set((state) => ({\r\n        data: state.data.map((item) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, updatedAt: new Date().toISOString() }\r\n            : item\r\n        ),\r\n      }));\r\n      syncToAPI('delete', { systemId }).catch(console.error);\r\n    },\r\n    \r\n    findById: (systemId) => {\r\n      return get().data.find((item) => item.systemId === systemId && !item.isDeleted);\r\n    },\r\n    \r\n    getActive: () => {\r\n      return get().data.filter((item) => !item.isDeleted && item.isActive !== false);\r\n    },\r\n    \r\n    loadFromAPI: async () => {\r\n      if (get().initialized) return;\r\n      try {\r\n        // NOTE: Settings data is typically small, but using limit for consistency\r\n        const response = await fetch('/api/settings/product-types?limit=50');\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const data = json.data || [];\r\n          if (data.length > 0) {\r\n            set({ data: data.map((item: any) => ({\r\n              ...item,\r\n              systemId: asSystemId(item.systemId),\r\n              id: asBusinessId(item.id),\r\n            })), initialized: true });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[Product Type Store] loadFromAPI error:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1216, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/api/branches-api.ts"],"sourcesContent":["/**\r\n * Branches API functions\r\n * \r\n * ⚠️ Direct import: import { fetchBranches } from '@/features/settings/branches/api/branches-api'\r\n */\r\n\r\nimport type { BranchModel as Branch } from '@/generated/prisma/models/Branch';\r\n\r\nconst BASE_URL = '/api/branches';\r\n\r\nexport interface BranchesParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  isDefault?: boolean;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface BranchesResponse {\r\n  data: Branch[];\r\n  total: number;\r\n  page: number;\r\n  pageSize: number;\r\n}\r\n\r\nexport async function fetchBranches(params: BranchesParams = {}): Promise<BranchesResponse> {\r\n  const searchParams = new URLSearchParams();\r\n  \r\n  if (params.page) searchParams.set('page', String(params.page));\r\n  if (params.limit) searchParams.set('limit', String(params.limit));\r\n  if (params.search) searchParams.set('search', params.search);\r\n  if (params.isDefault !== undefined) searchParams.set('isDefault', String(params.isDefault));\r\n  if (params.sortBy) searchParams.set('sortBy', params.sortBy);\r\n  if (params.sortOrder) searchParams.set('sortOrder', params.sortOrder);\r\n  \r\n  const url = searchParams.toString() ? `${BASE_URL}?${searchParams}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branches: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function fetchBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branch: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function createBranch(data: Omit<Branch, 'systemId' | 'createdAt' | 'updatedAt'>): Promise<Branch> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to create branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function updateBranch(systemId: string, data: Partial<Branch>): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PUT',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to update branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function deleteBranch(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to delete branch: ${response.statusText}`);\r\n  }\r\n}\r\n\r\nexport async function setDefaultBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to set default branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport type { Branch };\r\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;;;;AAID,MAAM,WAAW;AAkBV,eAAe,cAAc,SAAyB,CAAC,CAAC;IAC7D,MAAM,eAAe,IAAI;IAEzB,IAAI,OAAO,IAAI,EAAE,aAAa,GAAG,CAAC,QAAQ,OAAO,OAAO,IAAI;IAC5D,IAAI,OAAO,KAAK,EAAE,aAAa,GAAG,CAAC,SAAS,OAAO,OAAO,KAAK;IAC/D,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,KAAK,WAAW,aAAa,GAAG,CAAC,aAAa,OAAO,OAAO,SAAS;IACzF,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,EAAE,aAAa,GAAG,CAAC,aAAa,OAAO,SAAS;IAEpE,MAAM,MAAM,aAAa,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,cAAc,GAAG;IACtE,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,SAAS,UAAU,EAAE;IACpE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,YAAY,QAAgB;IAChD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IAEtD,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,wBAAwB,EAAE,SAAS,UAAU,EAAE;IAClE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,IAA0D;IAC3F,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB,EAAE,IAAqB;IACxE,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,SAAS,UAAU,EAAE;IACnE;AACF;AAEO,eAAe,iBAAiB,QAAgB;IACrD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;IAChD;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 1313, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-branches.ts"],"sourcesContent":["/**\r\n * useBranches - React Query hooks\r\n * \r\n * ⚠️ Direct import: import { useBranches } from '@/features/settings/branches/hooks/use-branches'\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchBranches,\r\n  fetchBranch,\r\n  createBranch,\r\n  updateBranch,\r\n  deleteBranch,\r\n  setDefaultBranch,\r\n  type BranchesParams,\r\n  type Branch,\r\n} from '../api/branches-api';\r\n\r\nexport const branchKeys = {\r\n  all: ['branches'] as const,\r\n  lists: () => [...branchKeys.all, 'list'] as const,\r\n  list: (params: BranchesParams) => [...branchKeys.lists(), params] as const,\r\n  details: () => [...branchKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...branchKeys.details(), id] as const,\r\n};\r\n\r\nexport function useBranches(params: BranchesParams = {}) {\r\n  return useQuery({\r\n    queryKey: branchKeys.list(params),\r\n    queryFn: () => fetchBranches(params),\r\n    staleTime: 10 * 60 * 1000, // Branches rarely change\r\n    gcTime: 60 * 60 * 1000,\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\nexport function useBranch(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: branchKeys.detail(id!),\r\n    queryFn: () => fetchBranch(id!),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\ninterface UseBranchMutationsOptions {\r\n  onCreateSuccess?: (branch: Branch) => void;\r\n  onUpdateSuccess?: (branch: Branch) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onSetDefaultSuccess?: (branch: Branch) => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useBranchMutations(options: UseBranchMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: Partial<Branch> }) => \r\n      updateBranch(systemId, data),\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.lists() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: deleteBranch,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const makeDefault = useMutation({\r\n    mutationFn: setDefaultBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onSetDefaultSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return { create, update, remove, makeDefault };\r\n}\r\n\r\nexport function useAllBranches() {\r\n  return useBranches({ limit: 100 });\r\n}\r\n\r\nexport function useDefaultBranch() {\r\n  const { data, ...rest } = useBranches({ isDefault: true, limit: 1 });\r\n  return {\r\n    ...rest,\r\n    data: data?.data?.[0] ?? null,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;CAIC,GAED;AAAA;AAAA;AAAA;AACA;;;;AAWO,MAAM,aAAa;IACxB,KAAK;QAAC;KAAW;IACjB,OAAO,IAAM;eAAI,WAAW,GAAG;YAAE;SAAO;IACxC,MAAM,CAAC,SAA2B;eAAI,WAAW,KAAK;YAAI;SAAO;IACjE,SAAS,IAAM;eAAI,WAAW,GAAG;YAAE;SAAS;IAC5C,QAAQ,CAAC,KAAe;eAAI,WAAW,OAAO;YAAI;SAAG;AACvD;AAEO,SAAS,YAAY,SAAyB,CAAC,CAAC;;IACrD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,WAAW,IAAI,CAAC;QAC1B,OAAO;oCAAE,IAAM,IAAA,8KAAa,EAAC;;QAC7B,WAAW,KAAK,KAAK;QACrB,QAAQ,KAAK,KAAK;QAClB,iBAAiB,8LAAgB;IACnC;AACF;GARgB;;QACP,0LAAQ;;;AASV,SAAS,UAAU,EAA6B;;IACrD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,WAAW,MAAM,CAAC;QAC5B,OAAO;kCAAE,IAAM,IAAA,4KAAW,EAAC;;QAC3B,SAAS,CAAC,CAAC;QACX,WAAW,KAAK,KAAK;IACvB;AACF;IAPgB;;QACP,0LAAQ;;;AAgBV,SAAS,mBAAmB,UAAqC,CAAC,CAAC;;IACxE,MAAM,cAAc,IAAA,2MAAc;IAElC,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,YAAY,6KAAY;QACxB,SAAS;sDAAE,CAAC;gBACV,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,eAAe,GAAG;YAC5B;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;sDAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAA+C,GAC1E,IAAA,6KAAY,EAAC,UAAU;;QACzB,SAAS;sDAAE,CAAC,MAAM;gBAChB,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,MAAM,CAAC,UAAU,QAAQ;gBAAE;gBAChF,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,KAAK;gBAAG;gBAC7D,QAAQ,eAAe,GAAG;YAC5B;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,YAAY,6KAAY;QACxB,SAAS;sDAAE;gBACT,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,eAAe;YACzB;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,cAAc,IAAA,gMAAW,EAAC;QAC9B,YAAY,iLAAgB;QAC5B,SAAS;2DAAE,CAAC;gBACV,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,mBAAmB,GAAG;YAChC;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QAAE;QAAQ;QAAQ;QAAQ;IAAY;AAC/C;IA1CgB;;QACM,2MAAc;QAEnB,gMAAW;QASX,gMAAW;QAWX,gMAAW;QASN,gMAAW;;;AAY1B,SAAS;;IACd,OAAO,YAAY;QAAE,OAAO;IAAI;AAClC;IAFgB;;QACP;;;AAGF,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,GAAG,YAAY;QAAE,WAAW;QAAM,OAAO;IAAE;IAClE,OAAO;QACL,GAAG,IAAI;QACP,MAAM,MAAM,MAAM,CAAC,EAAE,IAAI;IAC3B;AACF;IANgB;;QACY"}},
    {"offset": {"line": 1499, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-all-branches.ts"],"sourcesContent":["/**\r\n * useAllBranches - Convenience hook for components needing all branches as flat array\r\n * \r\n * Use case: Dropdowns, selects that need branch options\r\n * \r\n * ⚠️ For paginated views, use useBranches() instead\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useBranches } from './use-branches';\r\nimport type { Branch } from '../types';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n/**\r\n * Returns all branches as a flat array\r\n * Compatible with legacy store pattern: { data: branches }\r\n * \r\n * Note: API returns string systemIds, but we cast to Branch[] for internal use\r\n */\r\nexport function useAllBranches() {\r\n  const query = useBranches({ limit: 100 });\r\n  \r\n  return {\r\n    // Cast to Branch[] - API returns string systemId, but we trust the data structure\r\n    data: (query.data?.data || []) as unknown as Branch[],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns branches formatted as options for Select/Combobox\r\n */\r\nexport function useBranchOptions() {\r\n  const { data, isLoading } = useAllBranches();\r\n  \r\n  const options = data.map(b => ({\r\n    value: b.systemId,\r\n    label: b.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Returns the default branch\r\n */\r\nexport function useDefaultBranch() {\r\n  const { data, isLoading } = useAllBranches();\r\n  const defaultBranch = data.find(b => b.isDefault) || data[0];\r\n  \r\n  return { defaultBranch, isLoading };\r\n}\r\n\r\n/**\r\n * Helper hook to find a branch by ID from cached data\r\n * Replaces legacy findById() method\r\n */\r\nexport function useBranchFinder() {\r\n  const { data } = useAllBranches();\r\n  \r\n  const findById = React.useCallback(\r\n    (systemId: SystemId | string | undefined) => {\r\n      if (!systemId) return undefined;\r\n      return data.find(b => b.systemId === systemId);\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { findById };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;CAMC,GAED;AACA;;;;AAUO,SAAS;;IACd,MAAM,QAAQ,IAAA,8KAAW,EAAC;QAAE,OAAO;IAAI;IAEvC,OAAO;QACL,kFAAkF;QAClF,MAAO,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC7B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GAVgB;;QACA,8KAAW;;;AAcpB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;IATgB;;QACc;;;AAavB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAC5B,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,IAAI,CAAC,EAAE;IAE5D,OAAO;QAAE;QAAe;IAAU;AACpC;IALgB;;QACc;;;AAUvB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,4KAAiB;iDAChC,CAAC;YACC,IAAI,CAAC,UAAU,OAAO;YACtB,OAAO,KAAK,IAAI;yDAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;;QACvC;gDACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAS;AACpB;IAZgB;;QACG"}},
    {"offset": {"line": 1598, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Branch } from './types';\r\nimport { SystemId } from '../../../lib/id-types';\r\n\r\nexport interface BranchStoreState extends CrudState<Branch> {\r\n  setDefault: (systemId: SystemId) => void;\r\n}\r\n\r\nconst baseStore = createCrudStore<Branch>([], 'branches', {\r\n  apiEndpoint: '/api/branches',\r\n});\r\n\r\nconst setDefault = (systemId: SystemId) => {\r\n  baseStore.setState(state => ({\r\n    data: state.data.map(branch => ({\r\n      ...branch,\r\n      isDefault: branch.systemId === systemId,\r\n    })),\r\n  }));\r\n};\r\n\r\nconst originalAdd = baseStore.getState().add;\r\nconst originalUpdate = baseStore.getState().update;\r\n\r\nbaseStore.setState({\r\n  add: (item: Omit<Branch, 'systemId'>) => {\r\n    const result = originalAdd(item);\r\n    if ((item as Branch).isDefault) {\r\n      setDefault(result.systemId);\r\n    }\r\n    return result;\r\n  },\r\n  update: (systemId: SystemId, updatedItem: Branch) => {\r\n    originalUpdate(systemId, updatedItem);\r\n    if (updatedItem.isDefault) {\r\n      setDefault(systemId);\r\n    }\r\n  },\r\n} as Partial<BranchStoreState>);\r\n\r\nconst enhanceState = (state: CrudState<Branch>): BranchStoreState => ({\r\n  ...state,\r\n  setDefault,\r\n});\r\n\r\ntype BranchStoreHook = (() => BranchStoreState) & {\r\n  getState: () => BranchStoreState;\r\n};\r\n\r\nconst useBranchStoreBase = (() => enhanceState(baseStore())) as BranchStoreHook;\r\n\r\nuseBranchStoreBase.getState = () => enhanceState(baseStore.getState());\r\n\r\nexport const useBranchStore = useBranchStoreBase;\r\n"],"names":[],"mappings":";;;;AAAA;;AASA,MAAM,YAAY,IAAA,6IAAe,EAAS,EAAE,EAAE,YAAY;IACxD,aAAa;AACf;AAEA,MAAM,aAAa,CAAC;IAClB,UAAU,QAAQ,CAAC,CAAA,QAAS,CAAC;YAC3B,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,SAAU,CAAC;oBAC9B,GAAG,MAAM;oBACT,WAAW,OAAO,QAAQ,KAAK;gBACjC,CAAC;QACH,CAAC;AACH;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAC5C,MAAM,iBAAiB,UAAU,QAAQ,GAAG,MAAM;AAElD,UAAU,QAAQ,CAAC;IACjB,KAAK,CAAC;QACJ,MAAM,SAAS,YAAY;QAC3B,IAAI,AAAC,KAAgB,SAAS,EAAE;YAC9B,WAAW,OAAO,QAAQ;QAC5B;QACA,OAAO;IACT;IACA,QAAQ,CAAC,UAAoB;QAC3B,eAAe,UAAU;QACzB,IAAI,YAAY,SAAS,EAAE;YACzB,WAAW;QACb;IACF;AACF;AAEA,MAAM,eAAe,CAAC,QAA+C,CAAC;QACpE,GAAG,KAAK;QACR;IACF,CAAC;AAMD,MAAM,qBAAsB,IAAM,aAAa;AAE/C,mBAAmB,QAAQ,GAAG,IAAM,aAAa,UAAU,QAAQ;AAE5D,MAAM,iBAAiB"}},
    {"offset": {"line": 1646, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pricing/api/pricing-api.ts"],"sourcesContent":["/**\r\n * Pricing Settings API Layer\r\n * Handles all pricing policy-related API calls\r\n */\r\n\r\nimport type { PricingPolicy } from '../types';\r\n\r\nexport interface PricingPolicyFilters {\r\n  page?: number;\r\n  limit?: number;\r\n  type?: 'Nhập hàng' | 'Bán hàng';\r\n  isActive?: boolean;\r\n}\r\n\r\nexport interface PricingPolicyResponse {\r\n  data: PricingPolicy[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface PricingPolicyCreateInput {\r\n  systemId?: string;\r\n  id?: string;\r\n  name: string;\r\n  description?: string;\r\n  type: 'Nhập hàng' | 'Bán hàng';\r\n  isDefault?: boolean;\r\n  isActive?: boolean;\r\n}\r\n\r\nexport interface PricingPolicyUpdateInput extends Partial<PricingPolicyCreateInput> {}\r\n\r\nconst BASE_URL = '/api/settings/pricing-policies';\r\nconst LEGACY_URL = '/api/settings/data?type=pricing-policy';\r\n\r\n/**\r\n * Fetch pricing policies with filters\r\n */\r\nexport async function fetchPricingPolicies(\r\n  filters: PricingPolicyFilters = {}\r\n): Promise<PricingPolicyResponse> {\r\n  const params = new URLSearchParams();\r\n  \r\n  if (filters.page) params.set('page', String(filters.page));\r\n  if (filters.limit) params.set('limit', String(filters.limit));\r\n  if (filters.type) params.set('type', filters.type);\r\n  if (filters.isActive !== undefined) params.set('isActive', String(filters.isActive));\r\n\r\n  // Try new endpoint first, fallback to legacy\r\n  let url = params.toString() ? `${BASE_URL}?${params}` : BASE_URL;\r\n  let response = await fetch(url);\r\n  \r\n  // Fallback to legacy endpoint\r\n  if (!response.ok && response.status === 404) {\r\n    url = `${LEGACY_URL}${params.toString() ? '&' + params : ''}`;\r\n    response = await fetch(url);\r\n  }\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch pricing policies');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Fetch single pricing policy by ID\r\n */\r\nexport async function fetchPricingPolicyById(\r\n  systemId: string\r\n): Promise<PricingPolicy> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch pricing policy');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Create new pricing policy\r\n */\r\nexport async function createPricingPolicy(\r\n  data: PricingPolicyCreateInput\r\n): Promise<PricingPolicy> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.error || 'Failed to create pricing policy');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Update pricing policy\r\n */\r\nexport async function updatePricingPolicy(\r\n  systemId: string,\r\n  data: PricingPolicyUpdateInput\r\n): Promise<PricingPolicy> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.error || 'Failed to update pricing policy');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Delete pricing policy\r\n */\r\nexport async function deletePricingPolicy(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to delete pricing policy');\r\n  }\r\n}\r\n\r\n/**\r\n * Set default pricing policy for type\r\n */\r\nexport async function setDefaultPricingPolicy(\r\n  systemId: string\r\n): Promise<PricingPolicy> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, {\r\n    method: 'POST',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to set default pricing policy');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Get active pricing policies\r\n */\r\nexport async function fetchActivePricingPolicies(): Promise<PricingPolicy[]> {\r\n  const response = await fetchPricingPolicies({ isActive: true, limit: 100 });\r\n  return response.data;\r\n}\r\n\r\n/**\r\n * Get pricing policies by type\r\n */\r\nexport async function fetchPricingPoliciesByType(\r\n  type: 'Nhập hàng' | 'Bán hàng'\r\n): Promise<PricingPolicy[]> {\r\n  const response = await fetchPricingPolicies({ type, isActive: true, limit: 100 });\r\n  return response.data;\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;;;;;;;AAiCD,MAAM,WAAW;AACjB,MAAM,aAAa;AAKZ,eAAe,qBACpB,UAAgC,CAAC,CAAC;IAElC,MAAM,SAAS,IAAI;IAEnB,IAAI,QAAQ,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,OAAO,QAAQ,IAAI;IACxD,IAAI,QAAQ,KAAK,EAAE,OAAO,GAAG,CAAC,SAAS,OAAO,QAAQ,KAAK;IAC3D,IAAI,QAAQ,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,QAAQ,IAAI;IACjD,IAAI,QAAQ,QAAQ,KAAK,WAAW,OAAO,GAAG,CAAC,YAAY,OAAO,QAAQ,QAAQ;IAElF,6CAA6C;IAC7C,IAAI,MAAM,OAAO,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,QAAQ,GAAG;IACxD,IAAI,WAAW,MAAM,MAAM;IAE3B,8BAA8B;IAC9B,IAAI,CAAC,SAAS,EAAE,IAAI,SAAS,MAAM,KAAK,KAAK;QAC3C,MAAM,GAAG,aAAa,OAAO,QAAQ,KAAK,MAAM,SAAS,IAAI;QAC7D,WAAW,MAAM,MAAM;IACzB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,uBACpB,QAAgB;IAEhB,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IAEtD,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,oBACpB,IAA8B;IAE9B,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,KAAK,IAAI;IACjC;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,oBACpB,QAAgB,EAChB,IAA8B;IAE9B,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,KAAK,IAAI;IACjC;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,oBAAoB,QAAgB;IACxD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;AACF;AAKO,eAAe,wBACpB,QAAgB;IAEhB,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe;IACpB,MAAM,WAAW,MAAM,qBAAqB;QAAE,UAAU;QAAM,OAAO;IAAI;IACzE,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,2BACpB,IAA8B;IAE9B,MAAM,WAAW,MAAM,qBAAqB;QAAE;QAAM,UAAU;QAAM,OAAO;IAAI;IAC/E,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 1762, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pricing/hooks/use-pricing.ts"],"sourcesContent":["/**\r\n * Pricing Settings React Query Hooks\r\n * Provides data fetching and mutations for pricing policies\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchPricingPolicies,\r\n  fetchPricingPolicyById,\r\n  createPricingPolicy,\r\n  updatePricingPolicy,\r\n  deletePricingPolicy,\r\n  setDefaultPricingPolicy,\r\n  fetchActivePricingPolicies,\r\n  fetchPricingPoliciesByType,\r\n  type PricingPolicyFilters,\r\n  type PricingPolicyCreateInput,\r\n  type PricingPolicyUpdateInput,\r\n} from '../api/pricing-api';\r\n\r\n// Query keys factory\r\nexport const pricingPolicyKeys = {\r\n  all: ['pricing-policies'] as const,\r\n  lists: () => [...pricingPolicyKeys.all, 'list'] as const,\r\n  list: (filters: PricingPolicyFilters) => [...pricingPolicyKeys.lists(), filters] as const,\r\n  details: () => [...pricingPolicyKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...pricingPolicyKeys.details(), id] as const,\r\n  active: () => [...pricingPolicyKeys.all, 'active'] as const,\r\n  byType: (type: string) => [...pricingPolicyKeys.all, 'type', type] as const,\r\n};\r\n\r\n/**\r\n * Hook to fetch pricing policies with filters\r\n */\r\nexport function usePricingPolicies(filters: PricingPolicyFilters = {}) {\r\n  return useQuery({\r\n    queryKey: pricingPolicyKeys.list(filters),\r\n    queryFn: () => fetchPricingPolicies(filters),\r\n    staleTime: 1000 * 60 * 10, // 10 minutes - rarely changes\r\n  });\r\n}\r\n\r\n/**\r\n * Hook to fetch active pricing policies\r\n */\r\nexport function useActivePricingPolicies() {\r\n  return useQuery({\r\n    queryKey: pricingPolicyKeys.active(),\r\n    queryFn: fetchActivePricingPolicies,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook to fetch pricing policies by type\r\n */\r\nexport function usePricingPoliciesByType(type: 'Nhập hàng' | 'Bán hàng') {\r\n  return useQuery({\r\n    queryKey: pricingPolicyKeys.byType(type),\r\n    queryFn: () => fetchPricingPoliciesByType(type),\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook to fetch single pricing policy\r\n */\r\nexport function usePricingPolicyById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: pricingPolicyKeys.detail(systemId!),\r\n    queryFn: () => fetchPricingPolicyById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\n/**\r\n * Hook providing pricing policy mutations\r\n */\r\nexport function usePricingPolicyMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n\r\n  const invalidatePolicies = () => {\r\n    queryClient.invalidateQueries({ queryKey: pricingPolicyKeys.all });\r\n  };\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: PricingPolicyCreateInput) => createPricingPolicy(data),\r\n    onSuccess: () => {\r\n      invalidatePolicies();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: PricingPolicyUpdateInput }) =>\r\n      updatePricingPolicy(systemId, data),\r\n    onSuccess: () => {\r\n      invalidatePolicies();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deletePricingPolicy(systemId),\r\n    onSuccess: () => {\r\n      invalidatePolicies();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const setDefault = useMutation({\r\n    mutationFn: (systemId: string) => setDefaultPricingPolicy(systemId),\r\n    onSuccess: () => {\r\n      invalidatePolicies();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create,\r\n    update,\r\n    remove,\r\n    setDefault,\r\n    isLoading:\r\n      create.isPending || update.isPending || remove.isPending || setDefault.isPending,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook to get sale pricing policies\r\n */\r\nexport function useSalePricingPolicies() {\r\n  return usePricingPoliciesByType('Bán hàng');\r\n}\r\n\r\n/**\r\n * Hook to get purchase pricing policies\r\n */\r\nexport function usePurchasePricingPolicies() {\r\n  return usePricingPoliciesByType('Nhập hàng');\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1977, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pricing/hooks/use-all-pricing-policies.ts"],"sourcesContent":["/**\r\n * useAllPricingPolicies - Convenience hook for components needing all policies as flat array\r\n */\r\n\r\nimport { usePricingPolicies as usePricingPoliciesQuery } from './use-pricing';\r\n\r\n// Re-export for backward compatibility\r\nexport { usePricingPolicies } from './use-pricing';\r\n\r\nexport function useAllPricingPolicies() {\r\n  const query = usePricingPoliciesQuery({});\r\n  \r\n  return {\r\n    data: query.data?.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\nexport function useDefaultSellingPolicy() {\r\n  const { data, isLoading } = useAllPricingPolicies();\r\n  const defaultPolicy = data.find(p => p.type === 'Bán hàng' && p.isDefault);\r\n  \r\n  return { defaultPolicy, isLoading };\r\n}\r\n\r\nexport function useSellingPolicies() {\r\n  const { data, isLoading } = useAllPricingPolicies();\r\n  const sellingPolicies = data.filter(p => p.type === 'Bán hàng');\r\n  \r\n  return { data: sellingPolicies, isLoading };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;CAEC,GAED;;;;AAKO,SAAS;;IACd,MAAM,QAAQ,IAAA,mLAAuB,EAAC,CAAC;IAEvC,OAAO;QACL,MAAM,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC5B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GATgB;;QACA,mLAAuB;;;AAUhC,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAC5B,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK,cAAc,EAAE,SAAS;IAEzE,OAAO;QAAE;QAAe;IAAU;AACpC;IALgB;;QACc;;;AAMvB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAC5B,MAAM,kBAAkB,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK;IAEpD,OAAO;QAAE,MAAM;QAAiB;IAAU;AAC5C;IALgB;;QACc"}},
    {"offset": {"line": 2041, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pricing/store.ts"],"sourcesContent":["import type { SystemId } from '@/lib/id-types';\r\nimport type { UseBoundStore, StoreApi } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PricingPolicy } from './types';\r\nimport { createCrudStore, type CrudState } from '../../../lib/store-factory';\r\nimport { getCurrentUserSystemId } from '../../../contexts/auth-context';\r\n\r\ntype PricingPolicyStore = CrudState<PricingPolicy> & {\r\n  setDefault: (systemId: SystemId) => void;\r\n  getActive: () => PricingPolicy[];\r\n  getInactive: () => PricingPolicy[];\r\n};\r\n\r\nconst baseStore = createCrudStore<PricingPolicy>([], 'pricing-settings', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId,\r\n  apiEndpoint: '/api/settings/data?type=pricing-policy',\r\n}) as UseBoundStore<StoreApi<PricingPolicyStore>>;\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nconst setDefaultAction = (systemId: SystemId) => {\r\n  baseStore.setState((current) => {\r\n    const target = current.data.find((policy) => policy.systemId === systemId);\r\n    if (!target) return current;\r\n\r\n    const updatedData = current.data.map((policy) => (\r\n      policy.type === target.type\r\n        ? { ...policy, isDefault: policy.systemId === systemId }\r\n        : policy\r\n    ));\r\n\r\n    return { ...current, data: updatedData };\r\n  });\r\n};\r\n\r\nconst enhancedAdd: typeof originalAdd = (item) => {\r\n  const newItem = originalAdd(item);\r\n  const storeData = baseStore.getState().data;\r\n  const hasDefaultForType = storeData\r\n    .filter((policy) => policy.type === newItem.type)\r\n    .some((policy) => policy.isDefault);\r\n\r\n  if (item.isDefault) {\r\n    setDefaultAction(newItem.systemId);\r\n  } else if (!hasDefaultForType) {\r\n    setDefaultAction(newItem.systemId);\r\n  }\r\n\r\n  return newItem;\r\n};\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: enhancedAdd,\r\n  setDefault: setDefaultAction,\r\n  getActive: () => baseStore.getState().data.filter((policy) => policy.isActive),\r\n  getInactive: () => baseStore.getState().data.filter((policy) => !policy.isActive),\r\n}));\r\n\r\nexport const usePricingPolicyStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAIA;AACA;;;AAQA,MAAM,YAAY,IAAA,6IAAe,EAAgB,EAAE,EAAE,oBAAoB;IACvE,iBAAiB;IACjB,gBAAgB,yJAAsB;IACtC,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,MAAM,mBAAmB,CAAC;IACxB,UAAU,QAAQ,CAAC,CAAC;QAClB,MAAM,SAAS,QAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,SAAW,OAAO,QAAQ,KAAK;QACjE,IAAI,CAAC,QAAQ,OAAO;QAEpB,MAAM,cAAc,QAAQ,IAAI,CAAC,GAAG,CAAC,CAAC,SACpC,OAAO,IAAI,KAAK,OAAO,IAAI,GACvB;gBAAE,GAAG,MAAM;gBAAE,WAAW,OAAO,QAAQ,KAAK;YAAS,IACrD;QAGN,OAAO;YAAE,GAAG,OAAO;YAAE,MAAM;QAAY;IACzC;AACF;AAEA,MAAM,cAAkC,CAAC;IACvC,MAAM,UAAU,YAAY;IAC5B,MAAM,YAAY,UAAU,QAAQ,GAAG,IAAI;IAC3C,MAAM,oBAAoB,UACvB,MAAM,CAAC,CAAC,SAAW,OAAO,IAAI,KAAK,QAAQ,IAAI,EAC/C,IAAI,CAAC,CAAC,SAAW,OAAO,SAAS;IAEpC,IAAI,KAAK,SAAS,EAAE;QAClB,iBAAiB,QAAQ,QAAQ;IACnC,OAAO,IAAI,CAAC,mBAAmB;QAC7B,iBAAiB,QAAQ,QAAQ;IACnC;IAEA,OAAO;AACT;AAEA,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK;QACL,YAAY;QACZ,WAAW,IAAM,UAAU,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,SAAW,OAAO,QAAQ;QAC7E,aAAa,IAAM,UAAU,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,SAAW,CAAC,OAAO,QAAQ;IAClF,CAAC;AAEM,MAAM,wBAAwB"}},
    {"offset": {"line": 2095, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/store-info/store-info-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n\r\nexport type StoreGeneralInfoInput = {\r\n  companyName: string;\r\n  brandName: string;\r\n  logo?: string;\r\n  taxCode: string;\r\n  registrationNumber: string;\r\n  representativeName: string;\r\n  representativeTitle: string;\r\n  hotline: string;\r\n  email: string;\r\n  website: string;\r\n  headquartersAddress: string;\r\n  ward: string;\r\n  district: string;\r\n  province: string;\r\n  note: string;\r\n  bankAccountName: string;\r\n  bankAccountNumber: string;\r\n  bankName: string;\r\n};\r\n\r\nexport type StoreGeneralInfo = StoreGeneralInfoInput & {\r\n  updatedAt?: string | undefined;\r\n  updatedBySystemId?: string | undefined;\r\n  updatedByName?: string | undefined;\r\n};\r\n\r\ninterface StoreInfoState {\r\n  info: StoreGeneralInfo;\r\n  updateInfo: (\r\n    values: StoreGeneralInfoInput,\r\n    metadata?: { updatedBySystemId?: string | undefined; updatedByName?: string | undefined }\r\n  ) => void;\r\n  reset: () => void;\r\n  loadFromAPI: () => Promise<void>;\r\n  saveToAPI: () => Promise<void>;\r\n}\r\n\r\nconst defaultInfo: StoreGeneralInfo = {\r\n  companyName: '',\r\n  brandName: '',\r\n  logo: '',\r\n  taxCode: '',\r\n  registrationNumber: '',\r\n  representativeName: '',\r\n  representativeTitle: '',\r\n  hotline: '',\r\n  email: '',\r\n  website: '',\r\n  headquartersAddress: '',\r\n  ward: '',\r\n  district: '',\r\n  province: '',\r\n  note: '',\r\n  bankAccountName: '',\r\n  bankAccountNumber: '',\r\n  bankName: '',\r\n  updatedAt: undefined,\r\n  updatedBySystemId: undefined,\r\n  updatedByName: undefined,\r\n};\r\n\r\nexport const useStoreInfoStore = create<StoreInfoState>()(\r\n  (set) => ({\r\n    info: { ...defaultInfo },\r\n    updateInfo: (values, metadata) =>\r\n      set(() => ({\r\n        info: {\r\n          ...values,\r\n          updatedAt: new Date().toISOString(),\r\n          updatedBySystemId: metadata?.updatedBySystemId,\r\n          updatedByName: metadata?.updatedByName,\r\n        },\r\n      })),\r\n    reset: () => set(() => ({ info: { ...defaultInfo } })),\r\n    // Load from API - should be called on app init\r\n    loadFromAPI: async () => {\r\n      try {\r\n        const res = await fetch('/api/settings?key=store-info');\r\n        if (res.ok) {\r\n          const data = await res.json();\r\n          if (data?.value) {\r\n            set({ info: { ...defaultInfo, ...data.value } });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[StoreInfo] Failed to load from API:', error);\r\n      }\r\n    },\r\n    // Save to API\r\n    saveToAPI: async () => {\r\n      try {\r\n        const state = useStoreInfoStore.getState();\r\n        await fetch('/api/settings', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            key: 'store-info',\r\n            group: 'store',\r\n            value: state.info,\r\n          }),\r\n        });\r\n      } catch (error) {\r\n        console.error('[StoreInfo] Failed to save to API:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n\r\nexport function getDefaultStoreInfo(): StoreGeneralInfo {\r\n  return { ...defaultInfo };\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAwCA,MAAM,cAAgC;IACpC,aAAa;IACb,WAAW;IACX,MAAM;IACN,SAAS;IACT,oBAAoB;IACpB,oBAAoB;IACpB,qBAAqB;IACrB,SAAS;IACT,OAAO;IACP,SAAS;IACT,qBAAqB;IACrB,MAAM;IACN,UAAU;IACV,UAAU;IACV,MAAM;IACN,iBAAiB;IACjB,mBAAmB;IACnB,UAAU;IACV,WAAW;IACX,mBAAmB;IACnB,eAAe;AACjB;AAEO,MAAM,oBAAoB,IAAA,qJAAM,IACrC,CAAC,MAAQ,CAAC;QACR,MAAM;YAAE,GAAG,WAAW;QAAC;QACvB,YAAY,CAAC,QAAQ,WACnB,IAAI,IAAM,CAAC;oBACT,MAAM;wBACJ,GAAG,MAAM;wBACT,WAAW,IAAI,OAAO,WAAW;wBACjC,mBAAmB,UAAU;wBAC7B,eAAe,UAAU;oBAC3B;gBACF,CAAC;QACH,OAAO,IAAM,IAAI,IAAM,CAAC;oBAAE,MAAM;wBAAE,GAAG,WAAW;oBAAC;gBAAE,CAAC;QACpD,+CAA+C;QAC/C,aAAa;YACX,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,IAAI,EAAE,EAAE;oBACV,MAAM,OAAO,MAAM,IAAI,IAAI;oBAC3B,IAAI,MAAM,OAAO;wBACf,IAAI;4BAAE,MAAM;gCAAE,GAAG,WAAW;gCAAE,GAAG,KAAK,KAAK;4BAAC;wBAAE;oBAChD;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wCAAwC;YACxD;QACF;QACA,cAAc;QACd,WAAW;YACT,IAAI;gBACF,MAAM,QAAQ,kBAAkB,QAAQ;gBACxC,MAAM,MAAM,iBAAiB;oBAC3B,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBACnB,KAAK;wBACL,OAAO;wBACP,OAAO,MAAM,IAAI;oBACnB;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,sCAAsC;YACtD;QACF;IACF,CAAC;AAGI,SAAS;IACd,OAAO;QAAE,GAAG,WAAW;IAAC;AAC1B"}}]
}