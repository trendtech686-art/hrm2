{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/api/employees-api.ts"],"sourcesContent":["/**\r\n * Employees API - Isolated API functions\r\n * \r\n * ⚠️ IMPORTANT: This file should ONLY contain:\r\n * - Fetch functions\r\n * - Type imports from ../types\r\n * - NO store imports\r\n * - NO cross-feature imports\r\n */\r\n\r\nimport type { Employee } from '../types';\r\n\r\nconst API_BASE = '/api/employees';\r\n\r\nexport interface EmployeesParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  departmentId?: string;\r\n  branchId?: string;\r\n  jobTitleId?: string;\r\n  status?: string;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface PaginatedResponse<T> {\r\n  data: T[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface CreateEmployeeInput {\r\n  fullName: string;\r\n  email?: string;\r\n  phone?: string;\r\n  departmentId?: string;\r\n  branchId?: string;\r\n  jobTitleId?: string;\r\n  hireDate?: string;\r\n  // Optional fields for updates\r\n  isDeleted?: boolean;\r\n  employmentStatus?: string;\r\n}\r\n\r\nexport interface UpdateEmployeeInput extends Partial<CreateEmployeeInput> {\r\n  systemId: string;\r\n}\r\n\r\n/**\r\n * Fetch paginated employees list\r\n */\r\nexport async function fetchEmployees(params: EmployeesParams = {}): Promise<PaginatedResponse<Employee>> {\r\n  const { page = 1, limit = 50, ...rest } = params;\r\n  \r\n  const searchParams = new URLSearchParams({\r\n    page: String(page),\r\n    limit: String(limit),\r\n  });\r\n  \r\n  // Add optional params\r\n  Object.entries(rest).forEach(([key, value]) => {\r\n    if (value != null && value !== '') {\r\n      searchParams.set(key, String(value));\r\n    }\r\n  });\r\n  \r\n  const res = await fetch(`${API_BASE}?${searchParams}`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employees: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Fetch single employee by ID\r\n */\r\nexport async function fetchEmployee(id: string): Promise<Employee> {\r\n  const res = await fetch(`${API_BASE}/${id}`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employee ${id}: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Create new employee\r\n */\r\nexport async function createEmployee(data: CreateEmployeeInput): Promise<Employee> {\r\n  const res = await fetch(API_BASE, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    credentials: 'include',\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({}));\r\n    throw new Error(error.message || `Failed to create employee: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Update existing employee\r\n */\r\nexport async function updateEmployee({ systemId, ...data }: UpdateEmployeeInput): Promise<Employee> {\r\n  const res = await fetch(`${API_BASE}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    credentials: 'include',\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({}));\r\n    throw new Error(error.message || `Failed to update employee: ${res.statusText}`);\r\n  }\r\n  \r\n  return res.json();\r\n}\r\n\r\n/**\r\n * Delete employee (soft delete)\r\n */\r\nexport async function deleteEmployee(id: string): Promise<void> {\r\n  const res = await fetch(`${API_BASE}/${id}`, {\r\n    method: 'DELETE',\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({}));\r\n    throw new Error(error.message || `Failed to delete employee: ${res.statusText}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Search employees for autocomplete\r\n */\r\nexport async function searchEmployees(query: string, limit = 20): Promise<Employee[]> {\r\n  const res = await fetch(`${API_BASE}?search=${encodeURIComponent(query)}&limit=${limit}`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to search employees: ${res.statusText}`);\r\n  }\r\n  \r\n  const json = await res.json();\r\n  return json.data || [];\r\n}\r\n\r\n/**\r\n * Fetch employees by department\r\n */\r\nexport async function fetchEmployeesByDepartment(departmentId: string): Promise<Employee[]> {\r\n  const res = await fetch(`${API_BASE}?departmentId=${departmentId}&limit=100`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employees by department: ${res.statusText}`);\r\n  }\r\n  \r\n  const json = await res.json();\r\n  return json.data || [];\r\n}\r\n\r\n/**\r\n * Fetch employees by branch\r\n */\r\nexport async function fetchEmployeesByBranch(branchId: string): Promise<Employee[]> {\r\n  const res = await fetch(`${API_BASE}?branchId=${branchId}&limit=100`, {\r\n    credentials: 'include',\r\n  });\r\n  \r\n  if (!res.ok) {\r\n    throw new Error(`Failed to fetch employees by branch: ${res.statusText}`);\r\n  }\r\n  \r\n  const json = await res.json();\r\n  return json.data || [];\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/hooks/use-employees.ts"],"sourcesContent":["/**\r\n * useEmployees - React Query hooks for employees\r\n * \r\n * ⚠️ IMPORTANT: Direct import pattern\r\n * - Import this file directly: import { useEmployees } from '@/features/employees/hooks/use-employees'\r\n * - NEVER import from '@/features/employees' or '@/features/employees/store'\r\n * \r\n * This hook is ISOLATED - it only depends on:\r\n * - @tanstack/react-query\r\n * - Local API functions\r\n * - Local types\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchEmployees,\r\n  fetchEmployee,\r\n  createEmployee,\r\n  updateEmployee,\r\n  deleteEmployee,\r\n  searchEmployees,\r\n  fetchEmployeesByDepartment,\r\n  fetchEmployeesByBranch,\r\n  type EmployeesParams,\r\n  type CreateEmployeeInput,\r\n  type UpdateEmployeeInput,\r\n} from '../api/employees-api';\r\n\r\n// Query keys - exported for invalidation\r\nexport const employeeKeys = {\r\n  all: ['employees'] as const,\r\n  lists: () => [...employeeKeys.all, 'list'] as const,\r\n  list: (params: EmployeesParams) => [...employeeKeys.lists(), params] as const,\r\n  details: () => [...employeeKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...employeeKeys.details(), id] as const,\r\n  search: (query: string) => [...employeeKeys.all, 'search', query] as const,\r\n  byDepartment: (id: string) => [...employeeKeys.all, 'department', id] as const,\r\n  byBranch: (id: string) => [...employeeKeys.all, 'branch', id] as const,\r\n};\r\n\r\n/**\r\n * Hook for fetching paginated employees list\r\n * \r\n * @example\r\n * ```tsx\r\n * function EmployeesPage() {\r\n *   const [page, setPage] = useState(1);\r\n *   const { data, isLoading } = useEmployees({ page, limit: 50 });\r\n *   \r\n *   return (\r\n *     <DataTable \r\n *       data={data?.data || []} \r\n *       pagination={data?.pagination}\r\n *       onPageChange={setPage}\r\n *     />\r\n *   );\r\n * }\r\n * ```\r\n */\r\nexport function useEmployees(params: EmployeesParams = {}) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.list(params),\r\n    queryFn: () => fetchEmployees(params),\r\n    staleTime: 60_000, // 1 minute - employees don't change frequently\r\n    gcTime: 10 * 60 * 1000, // 10 minutes\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for fetching single employee by ID\r\n */\r\nexport function useEmployee(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.detail(id!),\r\n    queryFn: () => fetchEmployee(id!),\r\n    enabled: !!id,\r\n    staleTime: 60_000,\r\n    gcTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for searching employees (autocomplete)\r\n */\r\nexport function useEmployeeSearch(query: string, limit = 20) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.search(query),\r\n    queryFn: () => searchEmployees(query, limit),\r\n    enabled: query.length >= 2,\r\n    staleTime: 30_000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for fetching employees by department\r\n */\r\nexport function useEmployeesByDepartment(departmentId: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.byDepartment(departmentId!),\r\n    queryFn: () => fetchEmployeesByDepartment(departmentId!),\r\n    enabled: !!departmentId,\r\n    staleTime: 60_000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for fetching employees by branch\r\n */\r\nexport function useEmployeesByBranch(branchId: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: employeeKeys.byBranch(branchId!),\r\n    queryFn: () => fetchEmployeesByBranch(branchId!),\r\n    enabled: !!branchId,\r\n    staleTime: 60_000,\r\n  });\r\n}\r\n\r\n/**\r\n * Hook for employee mutations (create/update/delete)\r\n */\r\ninterface UseEmployeeMutationsOptions {\r\n  onCreateSuccess?: (employee: unknown) => void;\r\n  onUpdateSuccess?: (employee: unknown) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useEmployeeMutations(options: UseEmployeeMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createEmployee,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.lists() });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: updateEmployee,\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.lists() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: deleteEmployee,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: employeeKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return {\r\n    create,\r\n    update,\r\n    remove,\r\n    isCreating: create.isPending,\r\n    isUpdating: update.isPending,\r\n    isDeleting: remove.isPending,\r\n    isMutating: create.isPending || update.isPending || remove.isPending,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for getting active employees\r\n */\r\nexport function useActiveEmployees(params: Omit<EmployeesParams, 'status'> = {}) {\r\n  return useEmployees({ ...params, status: 'active' });\r\n}\r\n\r\n/**\r\n * Prefetch employee for faster navigation\r\n */\r\nexport function usePrefetchEmployee() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return (id: string) => {\r\n    queryClient.prefetchQuery({\r\n      queryKey: employeeKeys.detail(id),\r\n      queryFn: () => fetchEmployee(id),\r\n      staleTime: 60_000,\r\n    });\r\n  };\r\n}\r\n\r\n// Re-export from use-all-employees for backward compatibility\r\nexport { useAllEmployees, useEmployeeOptions, useEmployeeFinder, useEmployeeSearcher } from './use-all-employees';\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 392, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/hooks/use-all-employees.ts"],"sourcesContent":["/**\r\n * useAllEmployees - Convenience hook for components needing all employees as flat array\r\n * \r\n * Use case: Dropdowns, selects, comboboxes that need all employees for selection\r\n * \r\n * ⚠️ For paginated views, use useEmployees() instead\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useEmployees } from './use-employees';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n/**\r\n * Returns all employees as a flat array\r\n * Compatible with legacy store pattern: { data: employees }\r\n */\r\nexport function useAllEmployees() {\r\n  const query = useEmployees({ limit: 30 });\r\n  \r\n  return {\r\n    data: query.data?.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns employees formatted as options for Select/Combobox\r\n */\r\nexport function useEmployeeOptions() {\r\n  const { data, isLoading } = useAllEmployees();\r\n  \r\n  const options = data.map(e => ({\r\n    value: e.systemId,\r\n    label: e.fullName,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Helper hook to find an employee by ID from cached data\r\n * Replaces legacy findById() method\r\n */\r\nexport function useEmployeeFinder() {\r\n  const { data } = useAllEmployees();\r\n  \r\n  const findById = React.useCallback(\r\n    (systemId: SystemId | string | undefined) => {\r\n      if (!systemId) return undefined;\r\n      return data.find(e => e.systemId === systemId);\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { findById };\r\n}\r\n\r\n/**\r\n * Helper hook for searching employees (for Combobox async search)\r\n * Returns a search function that filters cached employees\r\n */\r\nexport function useEmployeeSearcher() {\r\n  const { data } = useAllEmployees();\r\n  \r\n  const searchEmployees = React.useCallback(\r\n    async (query: string, _page = 0, limit = 100) => {\r\n      const lowerQuery = query.toLowerCase();\r\n      const filtered = data.filter(e => \r\n        e.fullName?.toLowerCase().includes(lowerQuery) ||\r\n        e.id?.toLowerCase().includes(lowerQuery) ||\r\n        e.phone?.includes(query)\r\n      );\r\n      \r\n      return {\r\n        items: filtered.slice(0, limit).map(e => ({\r\n          value: e.systemId,\r\n          label: e.fullName || e.id || 'N/A',\r\n        })),\r\n        total: filtered.length,\r\n      };\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { searchEmployees };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;CAMC,GAED;AACA;;;;AAOO,SAAS;;IACd,MAAM,QAAQ,IAAA,qLAAY,EAAC;QAAE,OAAO;IAAG;IAEvC,OAAO;QACL,MAAM,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC5B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GATgB;;QACA,qLAAY;;;AAarB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,QAAQ;QACnB,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;IATgB;;QACc;;;AAcvB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,4KAAiB;mDAChC,CAAC;YACC,IAAI,CAAC,UAAU,OAAO;YACtB,OAAO,KAAK,IAAI;2DAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;;QACvC;kDACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAS;AACpB;IAZgB;;QACG;;;AAiBZ,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,kBAAkB,4KAAiB;4DACvC,OAAO,OAAe,QAAQ,CAAC,EAAE,QAAQ,GAAG;YAC1C,MAAM,aAAa,MAAM,WAAW;YACpC,MAAM,WAAW,KAAK,MAAM;6EAAC,CAAA,IAC3B,EAAE,QAAQ,EAAE,cAAc,SAAS,eACnC,EAAE,EAAE,EAAE,cAAc,SAAS,eAC7B,EAAE,KAAK,EAAE,SAAS;;YAGpB,OAAO;gBACL,OAAO,SAAS,KAAK,CAAC,GAAG,OAAO,GAAG;wEAAC,CAAA,IAAK,CAAC;4BACxC,OAAO,EAAE,QAAQ;4BACjB,OAAO,EAAE,QAAQ,IAAI,EAAE,EAAE,IAAI;wBAC/B,CAAC;;gBACD,OAAO,SAAS,MAAM;YACxB;QACF;2DACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAgB;AAC3B;IAxBgB;;QACG"}},
    {"offset": {"line": 507, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/columns.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { formatDate, formatDateCustom, toISODate, toISODateTime } from '../../lib/date-utils';\r\nimport type { Employee } from './types'\r\nimport type { Branch } from \"../settings/branches/types\";\r\nimport { Checkbox } from \"../../components/ui/checkbox\"\r\nimport { DataTableColumnHeader } from \"../../components/data-table/data-table-column-header\"\r\nimport { Badge } from \"../../components/ui/badge\"\r\nimport type { ColumnDef } from '../../components/data-table/types';\r\nimport { Button } from \"../../components/ui/button\";\r\nimport { Pencil, Trash2, RotateCcw, Mail, FileText, Clock, Eye, MoreHorizontal } from \"lucide-react\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"../../components/ui/tooltip\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from \"../../components/ui/dropdown-menu\";\r\n\r\nconst formatCurrency = (value?: number) => {\r\n    if (typeof value !== 'number') return '';\r\n    return new Intl.NumberFormat('vi-VN').format(value);\r\n};\r\n\r\nconst formatDateDisplay = (dateString?: string) => {\r\n    if (!dateString) return '';\r\n    const date = new Date(dateString);\r\n    return formatDateCustom(date, \"dd/MM/yyyy\");\r\n};\r\n\r\nconst formatAddress = (address: any): string => {\r\n  if (!address) return '';\r\n  if (typeof address === 'string') return address;\r\n  \r\n  const parts = [\r\n    address.street,\r\n    address.ward,\r\n    address.district,\r\n    address.province\r\n  ].filter(Boolean);\r\n  \r\n  return parts.join(', ');\r\n};\r\n\r\n\r\nexport const getColumns = (\r\n  onDelete: (systemId: string) => void,\r\n  onRestore: (systemId: string) => void,\r\n  navigate: (path: string) => void,\r\n  branches: Branch[]\r\n): ColumnDef<Employee>[] => [\r\n  {\r\n    id: \"select\",\r\n    header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n        <Checkbox\r\n          checked={isAllPageRowsSelected ? true : isSomePageRowsSelected ? \"indeterminate\" : false}\r\n          onCheckedChange={(value) => onToggleAll?.(!!value)}\r\n          aria-label=\"Select all\"\r\n        />\r\n    ),\r\n    cell: ({ onToggleSelect, isSelected }) => (\r\n        <Checkbox\r\n          checked={isSelected}\r\n          onCheckedChange={onToggleSelect}\r\n          aria-label=\"Select row\"\r\n        />\r\n    ),\r\n    size: 48,\r\n    meta: {\r\n      displayName: \"Chọn\",\r\n      sticky: \"left\",\r\n    }\r\n  },\r\n  // Personal Info\r\n  {\r\n    id: \"fullName\",\r\n    accessorKey: \"fullName\",\r\n    header: ({ sorting, setSorting }) => (\r\n      <DataTableColumnHeader \r\n        title=\"Họ và tên\"\r\n        sortKey=\"fullName\"\r\n        isSorted={sorting?.id === 'fullName'}\r\n        sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n        // FIX: Correctly call `setSorting` with a function to update the state based on the previous state.\r\n        onSort={() => setSorting?.((s: any) => ({ id: 'fullName', desc: s.id === 'fullName' ? !s.desc : false }))}\r\n       />\r\n    ),\r\n    cell: ({ row }) => (\r\n      <div className=\"max-w-[200px] truncate\" title={row.fullName}>\r\n        {row.fullName}\r\n      </div>\r\n    ),\r\n    meta: {\r\n      displayName: \"Họ và tên\",\r\n      group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"gender\",\r\n    accessorKey: \"gender\",\r\n    header: \"Giới tính\",\r\n    cell: ({ row }) => row.gender,\r\n    meta: {\r\n      displayName: \"Giới tính\",\r\n      group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"dob\",\r\n    accessorKey: \"dob\",\r\n    header: \"Ngày sinh\",\r\n    cell: ({ row }) => formatDate(row.dob),\r\n    meta: {\r\n      displayName: \"Ngày sinh\",\r\n      group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"placeOfBirth\",\r\n    accessorKey: \"placeOfBirth\",\r\n    header: \"Nơi sinh\",\r\n    cell: ({ row }) => row.placeOfBirth,\r\n    meta: {\r\n        displayName: \"Nơi sinh\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"phone\",\r\n    accessorKey: \"phone\",\r\n    header: \"Số điện thoại\",\r\n    cell: ({ row }) => row.phone,\r\n    meta: {\r\n      displayName: \"Số điện thoại\",\r\n      group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"personalEmail\",\r\n    accessorKey: \"personalEmail\",\r\n    header: \"Email cá nhân\",\r\n    cell: ({ row }) => row.personalEmail,\r\n    meta: {\r\n      displayName: \"Email cá nhân\",\r\n      group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"maritalStatus\",\r\n    accessorKey: \"maritalStatus\",\r\n    header: \"Tình trạng hôn nhân\",\r\n    cell: ({ row }) => row.maritalStatus,\r\n    meta: {\r\n        displayName: \"Tình trạng hôn nhân\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"permanentAddress\",\r\n    accessorKey: \"permanentAddress\",\r\n    header: \"Địa chỉ thường trú\",\r\n    cell: ({ row }) => {\r\n      const addressStr = formatAddress(row.permanentAddress);\r\n      return (\r\n        <div className=\"max-w-[250px] truncate\" title={addressStr}>\r\n          {addressStr}\r\n        </div>\r\n      );\r\n    },\r\n    meta: {\r\n        displayName: \"Địa chỉ thường trú\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"temporaryAddress\",\r\n    accessorKey: \"temporaryAddress\",\r\n    header: \"Địa chỉ tạm trú\",\r\n    cell: ({ row }) => {\r\n      const addressStr = formatAddress(row.temporaryAddress);\r\n      return (\r\n        <div className=\"max-w-[250px] truncate\" title={addressStr}>\r\n          {addressStr}\r\n        </div>\r\n      );\r\n    },\r\n    meta: {\r\n        displayName: \"Địa chỉ tạm trú\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"nationalId\",\r\n    accessorKey: \"nationalId\",\r\n    header: \"Số CCCD/Passport\",\r\n    cell: ({ row }) => row.nationalId,\r\n    meta: {\r\n        displayName: \"Số CCCD/Passport\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"nationalIdIssueDate\",\r\n    accessorKey: \"nationalIdIssueDate\",\r\n    header: \"Ngày cấp CCCD\",\r\n    cell: ({ row }) => formatDate(row.nationalIdIssueDate),\r\n    meta: {\r\n        displayName: \"Ngày cấp CCCD\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"nationalIdIssuePlace\",\r\n    accessorKey: \"nationalIdIssuePlace\",\r\n    header: \"Nơi cấp CCCD\",\r\n    cell: ({ row }) => row.nationalIdIssuePlace,\r\n    meta: {\r\n        displayName: \"Nơi cấp CCCD\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"personalTaxId\",\r\n    accessorKey: \"personalTaxId\",\r\n    header: \"Mã số thuế\",\r\n    cell: ({ row }) => row.personalTaxId,\r\n    meta: {\r\n        displayName: \"Mã số thuế\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"socialInsuranceNumber\",\r\n    accessorKey: \"socialInsuranceNumber\",\r\n    header: \"Số sổ BHXH\",\r\n    cell: ({ row }) => row.socialInsuranceNumber,\r\n    meta: {\r\n        displayName: \"Số sổ BHXH\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"bankAccountNumber\",\r\n    accessorKey: \"bankAccountNumber\",\r\n    header: \"Số tài khoản\",\r\n    cell: ({ row }) => row.bankAccountNumber,\r\n    meta: {\r\n        displayName: \"Số tài khoản\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"bankName\",\r\n    accessorKey: \"bankName\",\r\n    header: \"Ngân hàng\",\r\n    cell: ({ row }) => row.bankName,\r\n    meta: {\r\n        displayName: \"Ngân hàng\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"bankBranch\",\r\n    accessorKey: \"bankBranch\",\r\n    header: \"Chi nhánh NH\",\r\n    cell: ({ row }) => row.bankBranch,\r\n    meta: {\r\n        displayName: \"Chi nhánh NH\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"emergencyContactName\",\r\n    accessorKey: \"emergencyContactName\",\r\n    header: \"Tên người thân (KC)\",\r\n    cell: ({ row }) => row.emergencyContactName,\r\n    meta: {\r\n        displayName: \"Tên người thân (KC)\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  {\r\n    id: \"emergencyContactPhone\",\r\n    accessorKey: \"emergencyContactPhone\",\r\n    header: \"SĐT người thân (KC)\",\r\n    cell: ({ row }) => row.emergencyContactPhone,\r\n    meta: {\r\n        displayName: \"SĐT người thân (KC)\",\r\n        group: \"Thông tin cá nhân\"\r\n    },\r\n  },\r\n  // Employment Info\r\n  {\r\n    id: \"id\",\r\n    accessorKey: \"id\",\r\n    header: ({ sorting, setSorting }) => (\r\n      <DataTableColumnHeader \r\n        title=\"Mã NV\"\r\n        sortKey=\"id\"\r\n        isSorted={sorting?.id === 'id'}\r\n        sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n        // FIX: Correctly call `setSorting` with a function to update the state based on the previous state.\r\n        onSort={() => setSorting?.((s: any) => ({ id: 'id', desc: s.id === 'id' ? !s.desc : false }))}\r\n       />\r\n    ),\r\n    cell: ({ row }) => <div className=\"font-medium\">{row.id}</div>,\r\n    meta: {\r\n      displayName: \"Mã NV\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"workEmail\",\r\n    accessorKey: \"workEmail\",\r\n    header: \"Email công việc\",\r\n    cell: ({ row }) => (\r\n      <div className=\"max-w-[180px] truncate\" title={row.workEmail}>\r\n        {row.workEmail}\r\n      </div>\r\n    ),\r\n    meta: {\r\n      displayName: \"Email công việc\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"branch\",\r\n    accessorKey: \"branchSystemId\",\r\n    header: \"Chi nhánh\",\r\n    cell: ({ row }) => {\r\n        const branch = branches.find(b => b.systemId === row.branchSystemId);\r\n        return branch ? branch.name : '';\r\n    },\r\n    meta: {\r\n      displayName: \"Chi nhánh\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"department\",\r\n    accessorKey: \"department\",\r\n    header: ({ sorting, setSorting }) => (\r\n       <DataTableColumnHeader \r\n        title=\"Phòng ban\"\r\n        sortKey=\"department\"\r\n        isSorted={sorting?.id === 'department'}\r\n        sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n        // FIX: Correctly call `setSorting` with a function to update the state based on the previous state.\r\n        onSort={() => setSorting?.((s: any) => ({ id: 'department', desc: s.id === 'department' ? !s.desc : false }))}\r\n       />\r\n    ),\r\n    cell: ({ row }) => {\r\n      // API returns department as object relation or string\r\n      const dept = row.department;\r\n      if (!dept) return null;\r\n      if (typeof dept === 'string') return dept;\r\n      return (dept as { name?: string }).name || null;\r\n    },\r\n    meta: {\r\n      displayName: \"Phòng ban\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"jobTitle\",\r\n    accessorKey: \"jobTitle\",\r\n    header: \"Chức danh\",\r\n    cell: ({ row }) => {\r\n      // API returns jobTitle as object relation or string\r\n      const jt = row.jobTitle;\r\n      if (!jt) return null;\r\n      if (typeof jt === 'string') return jt;\r\n      return (jt as { name?: string }).name || null;\r\n    },\r\n    meta: {\r\n      displayName: \"Chức danh\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"hireDate\",\r\n    accessorKey: \"hireDate\",\r\n    header: ({ sorting, setSorting }) => (\r\n       <DataTableColumnHeader \r\n        title=\"Ngày vào làm\"\r\n        sortKey=\"hireDate\"\r\n        isSorted={sorting?.id === 'hireDate'}\r\n        sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n        // FIX: Correctly call `setSorting` with a function to update the state based on the previous state.\r\n        onSort={() => setSorting?.((s: any) => ({ id: 'hireDate', desc: s.id === 'hireDate' ? !s.desc : false }))}\r\n       />\r\n    ),\r\n    cell: ({ row }) => formatDate(row.hireDate),\r\n    meta: {\r\n      displayName: \"Ngày vào làm\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"employeeType\",\r\n    accessorKey: \"employeeType\",\r\n    header: \"Loại nhân viên\",\r\n    cell: ({ row }) => row.employeeType,\r\n    meta: {\r\n        displayName: \"Loại nhân viên\",\r\n        group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"employmentStatus\",\r\n    accessorKey: \"employmentStatus\",\r\n    header: \"Trạng thái\",\r\n    cell: ({ row }) => {\r\n        const status = row.employmentStatus;\r\n        \r\n        if (status === \"Đang làm việc\") {\r\n          return (\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"h-2 w-2 rounded-full bg-green-500\"></div>\r\n              <span className=\"text-body-sm\">Đang làm việc</span>\r\n            </div>\r\n          );\r\n        }\r\n        \r\n        if (status === \"Tạm nghỉ\") {\r\n          return (\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"h-2 w-2 rounded-full bg-yellow-500\"></div>\r\n              <span className=\"text-body-sm\">Tạm nghỉ</span>\r\n            </div>\r\n          );\r\n        }\r\n        \r\n        return (\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"h-2 w-2 rounded-full bg-gray-400\"></div>\r\n            <span className=\"text-body-sm\">{status}</span>\r\n          </div>\r\n        );\r\n    },\r\n    meta: {\r\n      displayName: \"Trạng thái\",\r\n      group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"terminationDate\",\r\n    accessorKey: \"terminationDate\",\r\n    header: \"Ngày nghỉ việc\",\r\n    cell: ({ row }) => formatDate(row.terminationDate),\r\n    meta: {\r\n        displayName: \"Ngày nghỉ việc\",\r\n        group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"reasonForLeaving\",\r\n    accessorKey: \"reasonForLeaving\",\r\n    header: \"Lý do nghỉ việc\",\r\n    cell: ({ row }) => row.reasonForLeaving,\r\n    meta: {\r\n        displayName: \"Lý do nghỉ việc\",\r\n        group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  {\r\n    id: \"createdAt\",\r\n    accessorKey: \"createdAt\",\r\n    header: ({ sorting, setSorting }) => (\r\n       <DataTableColumnHeader \r\n        title=\"Ngày khởi tạo\"\r\n        sortKey=\"createdAt\"\r\n        isSorted={sorting?.id === 'createdAt'}\r\n        sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n        onSort={() => setSorting?.((s: any) => ({ id: 'createdAt', desc: s.id === 'createdAt' ? !s.desc : false }))}\r\n       />\r\n    ),\r\n    cell: ({ row }) => {\r\n      if (!row.createdAt) return '';\r\n      return (\r\n        <div className=\"flex flex-col\">\r\n          <span className=\"text-body-sm\">{formatDateDisplay(row.createdAt)}</span>\r\n          <span className=\"text-body-xs text-muted-foreground\">\r\n            {formatDateCustom(new Date(row.createdAt), 'HH:mm')}\r\n          </span>\r\n        </div>\r\n      );\r\n    },\r\n    meta: {\r\n        displayName: \"Ngày khởi tạo\",\r\n        group: \"Thông tin công việc\"\r\n    },\r\n  },\r\n  // Salary & Contract\r\n  {\r\n    id: \"baseSalary\",\r\n    accessorKey: \"baseSalary\",\r\n    header: \"Lương cơ bản\",\r\n    cell: ({ row }) => formatCurrency(row.baseSalary),\r\n    meta: {\r\n        displayName: \"Lương cơ bản\",\r\n        group: \"Lương & Hợp đồng\"\r\n    },\r\n  },\r\n  {\r\n    id: \"socialInsuranceSalary\",\r\n    accessorKey: \"socialInsuranceSalary\",\r\n    header: \"Lương đóng BHXH\",\r\n    cell: ({ row }) => formatCurrency(row.socialInsuranceSalary),\r\n    meta: {\r\n        displayName: \"Lương đóng BHXH\",\r\n        group: \"Lương & Hợp đồng\"\r\n    },\r\n  },\r\n  {\r\n    id: \"positionAllowance\",\r\n    accessorKey: \"positionAllowance\",\r\n    header: \"Phụ cấp chức vụ\",\r\n    cell: ({ row }) => formatCurrency(row.positionAllowance),\r\n    meta: {\r\n        displayName: \"Phụ cấp chức vụ\",\r\n        group: \"Lương & Hợp đồng\"\r\n    },\r\n  },\r\n  {\r\n    id: \"mealAllowance\",\r\n    accessorKey: \"mealAllowance\",\r\n    header: \"Phụ cấp ăn trưa\",\r\n    cell: ({ row }) => formatCurrency(row.mealAllowance),\r\n    meta: {\r\n        displayName: \"Phụ cấp ăn trưa\",\r\n        group: \"Lương & Hợp đồng\"\r\n    },\r\n  },\r\n  {\r\n    id: \"otherAllowances\",\r\n    accessorKey: \"otherAllowances\",\r\n    header: \"Phụ cấp khác\",\r\n    cell: ({ row }) => formatCurrency(row.otherAllowances),\r\n    meta: {\r\n        displayName: \"Phụ cấp khác\",\r\n        group: \"Lương & Hợp đồng\"\r\n    },\r\n  },\r\n  // Leave\r\n  {\r\n    id: \"leaveTaken\",\r\n    accessorKey: \"leaveTaken\",\r\n    header: \"Phép đã nghỉ\",\r\n    cell: ({ row }) => row.leaveTaken,\r\n    meta: {\r\n        displayName: \"Phép đã nghỉ\",\r\n        group: \"Quản lý nghỉ phép\"\r\n    },\r\n  },\r\n   {\r\n    id: \"actions\",\r\n    header: () => <div className=\"text-center\">Hành động</div>,\r\n    cell: ({ row }) => {\r\n      const employee = row as unknown as Employee;\r\n      const isDeleted = employee.isDeleted;\r\n      \r\n      return (\r\n       <div className=\"flex items-center justify-center gap-0.5\">\r\n        {isDeleted ? (\r\n          // ✅ Show Restore button for deleted items\r\n          <TooltipProvider>\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button \r\n                  variant=\"ghost\" \r\n                  size=\"icon\"\r\n                  className=\"h-7 w-7 p-0 text-green-600 hover:text-green-600 hover:bg-green-600/10\" \r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    onRestore(employee.systemId);\r\n                  }}\r\n                >\r\n                  <RotateCcw className=\"h-3.5 w-3.5\" />\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Khôi phục</TooltipContent>\r\n            </Tooltip>\r\n          </TooltipProvider>\r\n        ) : (\r\n          // ✅ Show Quick Actions Menu for active items\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button \r\n                variant=\"ghost\" \r\n                size=\"icon\"\r\n                className=\"h-7 w-7 p-0\"\r\n                onClick={(e) => e.stopPropagation()}\r\n              >\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\" className=\"w-48\">\r\n              <DropdownMenuItem \r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  navigate(`/employees/${employee.systemId}/edit`);\r\n                }}\r\n              >\r\n                Chỉnh sửa\r\n              </DropdownMenuItem>\r\n              <DropdownMenuSeparator />\r\n              <DropdownMenuItem \r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  navigate(`/payroll?employee=${employee.systemId}`);\r\n                }}\r\n              >\r\n                Xem bảng lương\r\n              </DropdownMenuItem>\r\n              <DropdownMenuItem \r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  navigate(`/attendance?employee=${employee.systemId}`);\r\n                }}\r\n              >\r\n                Xem chấm công\r\n              </DropdownMenuItem>\r\n              <DropdownMenuSeparator />\r\n              <DropdownMenuItem \r\n                className=\"text-destructive focus:text-destructive\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  onDelete(employee.systemId);\r\n                }}\r\n              >\r\n                Chuyển vào thùng rác\r\n              </DropdownMenuItem>\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        )}\r\n       </div>\r\n      );\r\n    },\r\n    size: 100,\r\n    meta: {\r\n      displayName: \"Hành động\",\r\n      sticky: \"right\",\r\n    },\r\n  },\r\n];\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1354, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Employee } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\nimport Fuse from 'fuse.js';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { registerBreadcrumbStore } from '../../lib/breadcrumb-generator'; // ✅ NEW\r\nimport { type SystemId } from '../../lib/id-types';\r\nimport { createInMemoryRepository } from '../../repositories/in-memory-repository';\r\nimport { \r\n  createHistoryEntry, \r\n  getCurrentUserInfo,\r\n  appendHistoryEntry \r\n} from '../../lib/activity-history-helper';\r\n\r\ntype EmployeePersistenceAdapter = {\r\n  create: (payload: Omit<Employee, 'systemId'>) => Promise<Employee>;\r\n  update: (systemId: SystemId, payload: Partial<Employee>) => Promise<Employee>;\r\n  softDelete: (systemId: SystemId) => Promise<void>;\r\n  restore: (systemId: SystemId) => Promise<Employee | undefined>;\r\n  hardDelete: (systemId: SystemId) => Promise<void>;\r\n};\r\n\r\nconst baseStore = createCrudStore<Employee>([], 'employees', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId, // ✅ Track who creates/updates\r\n  apiEndpoint: '/api/employees',\r\n});\r\n\r\n// ✅ Wrap add method to include activity history\r\nconst originalAdd = baseStore.getState().add;\r\nconst wrappedAdd = (item: Omit<Employee, 'systemId'>): Employee => {\r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntry = createHistoryEntry(\r\n    'created',\r\n    `${userInfo.name} đã tạo hồ sơ nhân viên ${item.fullName} (${item.id})`,\r\n    userInfo\r\n  );\r\n  \r\n  const newEmployee = originalAdd({\r\n    ...item,\r\n    activityHistory: [historyEntry],\r\n  });\r\n  \r\n  return newEmployee;\r\n};\r\n\r\n// ✅ Wrap update method to include activity history\r\nconst originalUpdate = baseStore.getState().update;\r\nconst wrappedUpdate = (systemId: SystemId, updates: Partial<Employee>): void => {\r\n  const currentEmployee = baseStore.getState().data.find(e => e.systemId === systemId);\r\n  if (!currentEmployee) return;\r\n  \r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntries: HistoryEntry[] = [];\r\n  \r\n  // Track important field changes\r\n  const trackedFields: { key: keyof Employee; label: string }[] = [\r\n    { key: 'fullName', label: 'họ tên' },\r\n    { key: 'jobTitle', label: 'chức danh' },\r\n    { key: 'department', label: 'phòng ban' },\r\n    { key: 'employmentStatus', label: 'trạng thái làm việc' },\r\n    { key: 'employeeType', label: 'loại nhân viên' },\r\n    { key: 'baseSalary', label: 'lương cơ bản' },\r\n    { key: 'phone', label: 'số điện thoại' },\r\n    { key: 'workEmail', label: 'email công việc' },\r\n    { key: 'role', label: 'vai trò' },\r\n  ];\r\n  \r\n  trackedFields.forEach(({ key, label }) => {\r\n    if (updates[key] !== undefined && updates[key] !== currentEmployee[key]) {\r\n      const oldValue = currentEmployee[key];\r\n      const newValue = updates[key];\r\n      \r\n      // Format values for display\r\n      let oldDisplay = oldValue;\r\n      let newDisplay = newValue;\r\n      \r\n      if (key === 'baseSalary') {\r\n        oldDisplay = new Intl.NumberFormat('vi-VN').format(oldValue as number) + 'đ';\r\n        newDisplay = new Intl.NumberFormat('vi-VN').format(newValue as number) + 'đ';\r\n      }\r\n      \r\n      historyEntries.push(createHistoryEntry(\r\n        'updated',\r\n        `${userInfo.name} đã cập nhật ${label}: \"${oldDisplay || '(trống)'}\" → \"${newDisplay}\"`,\r\n        userInfo,\r\n        { field: key, oldValue, newValue }\r\n      ));\r\n    }\r\n  });\r\n  \r\n  // If status changed specifically\r\n  if (updates.employmentStatus && updates.employmentStatus !== currentEmployee.employmentStatus) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'status_changed',\r\n      `${userInfo.name} đã thay đổi trạng thái làm việc từ \"${currentEmployee.employmentStatus}\" thành \"${updates.employmentStatus}\"`,\r\n      userInfo,\r\n      { field: 'employmentStatus', oldValue: currentEmployee.employmentStatus, newValue: updates.employmentStatus }\r\n    ));\r\n  }\r\n  \r\n  // If no specific changes tracked, add generic update entry\r\n  if (historyEntries.length === 0) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'updated',\r\n      `${userInfo.name} đã cập nhật thông tin nhân viên`,\r\n      userInfo\r\n    ));\r\n  }\r\n  \r\n  const updatedHistory = appendHistoryEntry(currentEmployee.activityHistory, ...historyEntries);\r\n  \r\n  originalUpdate(systemId, {\r\n    ...updates,\r\n    activityHistory: updatedHistory,\r\n  });\r\n};\r\n\r\n// ✅ Override base store methods\r\nbaseStore.setState({\r\n  add: wrappedAdd,\r\n  update: wrappedUpdate,\r\n});\r\n\r\nexport const employeeRepository = createInMemoryRepository<Employee>(() => baseStore.getState());\r\n\r\n// ✅ API-backed persistence adapter - syncs to PostgreSQL\r\nconst API_ENDPOINT = '/api/employees';\r\n\r\nconst persistence: EmployeePersistenceAdapter = {\r\n  create: async (payload) => {\r\n    // First create locally for immediate UI update\r\n    const localResult = await employeeRepository.create(payload);\r\n    \r\n    // Then sync to API (background)\r\n    try {\r\n      const response = await fetch(API_ENDPOINT, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ ...payload, systemId: localResult.systemId }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Create sync failed, data saved locally');\r\n      } else {\r\n        console.log('[Employee API] Created:', localResult.systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Create sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  update: async (systemId, payload) => {\r\n    // First update locally\r\n    const localResult = await employeeRepository.update(systemId, payload);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'PATCH',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Update sync failed');\r\n      } else {\r\n        console.log('[Employee API] Updated:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Update sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  softDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.softDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: false }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Soft delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Soft deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Soft delete sync error:', e);\r\n    }\r\n  },\r\n  restore: async (systemId) => {\r\n    // First restore locally\r\n    const localResult = await employeeRepository.restore(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}/restore`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Restore sync failed');\r\n      } else {\r\n        console.log('[Employee API] Restored:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Restore sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  hardDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.hardDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: true }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Hard delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Hard deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Hard delete sync error:', e);\r\n    }\r\n  },\r\n};\r\n\r\n// ✅ Register for breadcrumb auto-generation\r\nregisterBreadcrumbStore('employees', () => baseStore.getState());\r\n\r\n// Define enhanced interface\r\ninterface EmployeeStoreState extends CrudState<Employee> {\r\n  searchEmployees: (query: string, page: number, limit?: number) => Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>;\r\n  permanentDelete: (systemId: SystemId) => Promise<void>;\r\n  persistence: EmployeePersistenceAdapter;\r\n}\r\n\r\ntype EmployeeStoreHook = (() => EmployeeStoreState) & {\r\n  getState: () => EmployeeStoreState;\r\n  persistence: EmployeePersistenceAdapter;\r\n};\r\n\r\n// Augmented methods\r\nconst augmentedMethods = {\r\n    // FIX: Changed `page: number = 1` to `page: number` to make it a required parameter, matching Combobox prop type.\r\n    // ✅ CRITICAL FIX: Create fresh Fuse instance on each search to avoid stale data\r\n    searchEmployees: async (query: string, page: number, limit: number = 20) => {\r\n        return new Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>(resolve => {\r\n            setTimeout(() => {\r\n                const allEmployees = baseStore.getState().data;\r\n                \r\n                // ✅ Create fresh Fuse instance with current data\r\n                const fuse = new Fuse(allEmployees, {\r\n                    keys: ['fullName', 'id', 'phone', 'personalEmail', 'workEmail'],\r\n                    threshold: 0.3,\r\n                });\r\n                \r\n                const results = query ? fuse.search(query).map(r => r.item) : allEmployees;\r\n                \r\n                const start = (page - 1) * limit;\r\n                const end = start + limit;\r\n                const paginatedItems = results.slice(start, end);\r\n\r\n                resolve({\r\n                    items: paginatedItems.map(e => ({ value: e.systemId, label: e.fullName })),\r\n                    hasNextPage: end < results.length,\r\n                });\r\n            }, 300);\r\n        });\r\n    },\r\n    permanentDelete: async (systemId: SystemId) => {\r\n        await persistence.hardDelete(systemId);\r\n    }\r\n};\r\n\r\nconst useEmployeeStoreHook = (): EmployeeStoreState => {\r\n  const state = baseStore();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods, // This includes permanentDelete\r\n    persistence,\r\n  };\r\n};\r\n\r\nexport const useEmployeeStore = useEmployeeStoreHook as EmployeeStoreHook;\r\n\r\n// Export getState for non-hook usage\r\nuseEmployeeStore.getState = (): EmployeeStoreState => {\r\n  const state = baseStore.getState();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods,\r\n    persistence,\r\n  };\r\n};\r\n\r\nuseEmployeeStore.persistence = persistence;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1666, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from \"react\"\r\nimport { useRouter } from 'next/navigation';\r\nimport { useColumnVisibility, useColumnOrder, usePinnedColumns } from '@/hooks/use-column-visibility';\r\nimport { ROUTES } from '../../lib/router';\r\nimport { formatDate, formatDateTime, formatDateTimeSeconds, formatDateCustom, getCurrentDate, isDateSame, isDateBetween, isDateAfter, isDateBefore, isValidDate, getStartOfDay, getEndOfDay } from '../../lib/date-utils'\r\nimport { useAllEmployees } from \"./hooks/use-all-employees\"\r\nimport { useEmployeeMutations } from \"./hooks/use-employees\"\r\nimport { useAllBranches } from \"../settings/branches/hooks/use-all-branches\";\r\nimport { useDefaultPageSize } from \"../settings/global-settings-store\";\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\nimport { getColumns } from \"./columns\"\r\nimport { ResponsiveDataTable } from \"../../components/data-table/responsive-data-table\"\r\nimport { DataTableToolbar } from \"../../components/data-table/data-table-toolbar\"\r\nimport { DataTableFacetedFilter } from \"../../components/data-table/data-table-faceted-filter\"\r\nimport { toast } from \"sonner\"\r\nimport { \r\n  Card, \r\n  CardContent,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"../../components/ui/card\"\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"../../components/ui/alert-dialog\"\r\nimport { Button } from \"../../components/ui/button\"\r\nimport { PlusCircle, Phone, Mail, Building2, Calendar, MoreHorizontal, Trash2, Upload, Download } from \"lucide-react\"\r\nimport type { Employee } from \"./types\"\r\nimport { DataTableExportDialog } from \"../../components/data-table/data-table-export-dialog\";\r\nimport { DataTableImportDialog, type ImportConfig } from \"../../components/data-table/data-table-import-dialog\";\r\nimport { GenericImportDialogV2 } from \"../../components/shared/generic-import-dialog-v2\";\r\nimport { GenericExportDialogV2 } from \"../../components/shared/generic-export-dialog-v2\";\r\nimport { employeeImportExportConfig } from \"../../lib/import-export/configs/employee.config\";\r\nimport Fuse from \"fuse.js\"\r\nimport { usePageHeader } from \"../../contexts/page-header-context\";\r\nimport { DataTableColumnCustomizer } from \"../../components/data-table/data-table-column-toggle\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../components/ui/select\";\r\nimport { ResponsiveContainer } from \"../../components/ui/responsive-container\";\r\nimport { MobileSearchBar } from \"../../components/mobile/mobile-search-bar\";\r\nimport { TouchButton } from \"../../components/mobile/touch-button\";\r\nimport { Badge } from \"../../components/ui/badge\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"../../components/ui/avatar\";\r\nimport { useMediaQuery } from \"../../lib/use-media-query\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"../../components/ui/dropdown-menu\";\r\nimport { PageToolbar } from \"../../components/layout/page-toolbar\";\r\nimport { PageFilters } from \"../../components/layout/page-filters\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\nexport function EmployeesPage() {\r\n\r\n  const { data: employees } = useAllEmployees();\r\n  const { remove, update, create } = useEmployeeMutations();\r\n  const { data: branchesRaw } = useAllBranches();\r\n  const router = useRouter();\r\n  \r\n  // ✅ Memoize branches to prevent re-renders\r\n  const branches = React.useMemo(() => branchesRaw, [branchesRaw]);\r\n  \r\n  // Calculate deleted count reactively\r\n  const deletedCount = React.useMemo(() => \r\n    employees.filter((e: any) => e.isDeleted).length, \r\n    [employees]\r\n  );\r\n  \r\n  // ✅ Memoize actions to prevent infinite loop\r\n  const headerActions = React.useMemo(() => [\r\n    <Button key=\"trash\" variant=\"outline\" size=\"sm\" className=\"h-9\" onClick={() => router.push('/employees/trash')}>\r\n      <Trash2 className=\"mr-2 h-4 w-4\" />\r\n      Thùng rác ({deletedCount})\r\n    </Button>,\r\n    <Button key=\"add\" size=\"sm\" className=\"h-9\" onClick={() => router.push('/employees/new')}>\r\n      <PlusCircle className=\"mr-2 h-4 w-4\" />\r\n      Thêm nhân viên\r\n    </Button>\r\n  ], [router, deletedCount]);\r\n  \r\n  // Set page header with actions\r\n  usePageHeader({\r\n    title: 'Danh sách nhân viên',\r\n    breadcrumb: [\r\n      { label: 'Trang chủ', href: '/', isCurrent: false },\r\n      { label: 'Nhân viên', href: '/employees', isCurrent: true },\r\n    ],\r\n    actions: headerActions,\r\n    showBackButton: false,\r\n  });\r\n  \r\n  const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({})\r\n  const [isAlertOpen, setIsAlertOpen] = React.useState(false)\r\n  const [idToDelete, setIdToDelete] = React.useState<string | null>(null)\r\n  const [isBulkDeleteAlertOpen, setIsBulkDeleteAlertOpen] = React.useState(false)\r\n  \r\n  // V2 Import/Export Dialog states\r\n  const [isImportV2Open, setIsImportV2Open] = React.useState(false)\r\n  const [isExportV2Open, setIsExportV2Open] = React.useState(false)\r\n  \r\n  // Table state\r\n  // ✅ Use global default page size from settings\r\n  const defaultPageSize = useDefaultPageSize();\r\n  \r\n  // FIX: Cast `setSorting` to the correct type to allow functional updates and prevent stale state issues when sorting columns.\r\n  const [sorting, setSorting] = React.useState<{ id: string, desc: boolean }>({ id: 'createdAt', desc: true });\r\n  const [globalFilter, setGlobalFilter] = React.useState('');\r\n  const [debouncedGlobalFilter, setDebouncedGlobalFilter] = React.useState('');\r\n  const [branchFilter, setBranchFilter] = React.useState('all');\r\n  const [dateFilter, setDateFilter] = React.useState<[string | undefined, string | undefined] | undefined>();\r\n  const [departmentFilter, setDepartmentFilter] = React.useState<Set<string>>(new Set());\r\n  const [jobTitleFilter, setJobTitleFilter] = React.useState<Set<string>>(new Set());\r\n  const [statusFilter, setStatusFilter] = React.useState<Set<string>>(new Set());\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: defaultPageSize });\r\n  const [expanded, setExpanded] = React.useState<Record<string, boolean>>({});\r\n  \r\n  // Debounce search input for better performance\r\n  React.useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedGlobalFilter(globalFilter);\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [globalFilter]);\r\n  \r\n  // Column customization state - all from hooks with database sync\r\n  const [columnVisibility, setColumnVisibility] = useColumnVisibility('employees', {});\r\n  const [columnOrder, setColumnOrder] = useColumnOrder('employees', []);\r\n  const [pinnedColumns, setPinnedColumns] = usePinnedColumns('employees', []);\r\n\r\n  const handleDelete = React.useCallback((systemId: string) => {\r\n    setIdToDelete(systemId)\r\n    setIsAlertOpen(true)\r\n  }, [])\r\n  \r\n  const handleRestore = React.useCallback((systemId: string) => {\r\n    const employee = employees.find(e => e.systemId === systemId);\r\n    if (employee) {\r\n      update.mutate(\r\n        { systemId: asSystemId(systemId), ...employee, isDeleted: false },\r\n        { onSuccess: () => toast.success(\"Đã khôi phục nhân viên\") }\r\n      );\r\n    }\r\n  }, [employees, update]);\r\n  \r\n  const columns = React.useMemo(() => getColumns(handleDelete, handleRestore, (path: string) => router.push(path), branches), [handleDelete, handleRestore, router, branches]);\r\n\r\n  const buildDefaultVisibility = React.useCallback(() => {\r\n    const defaultVisibleColumns = new Set([\r\n      'id', 'fullName', 'workEmail', 'phone', 'branch', 'department',\r\n      'jobTitle', 'hireDate', 'employmentStatus', 'dob', 'gender',\r\n      'nationalId', 'permanentAddress', 'bankName', 'bankAccountNumber', 'baseSalary',\r\n      'contractType', 'annualLeaveBalance', 'sickLeaveBalance'\r\n    ]);\r\n\r\n    const initialVisibility: Record<string, boolean> = {};\r\n    columns.forEach(c => {\r\n      if (!c.id) return;\r\n      if (c.id === 'select' || c.id === 'actions') {\r\n        initialVisibility[c.id] = true;\r\n        return;\r\n      }\r\n      initialVisibility[c.id] = defaultVisibleColumns.has(c.id);\r\n    });\r\n    return initialVisibility;\r\n  }, [columns]);\r\n\r\n  const buildDefaultOrder = React.useCallback(() => (\r\n    columns.map(c => c.id).filter(Boolean) as string[]\r\n  ), [columns]);\r\n\r\n  React.useEffect(() => {\r\n    if (columns.length === 0) return;\r\n\r\n    // Only set defaults if visibility is empty\r\n    if (Object.keys(columnVisibility).length === 0) {\r\n      setColumnVisibility(buildDefaultVisibility());\r\n    }\r\n\r\n    // Set default order if empty\r\n    if (columnOrder.length === 0) {\r\n      setColumnOrder(buildDefaultOrder());\r\n    }\r\n\r\n    // Ensure pinned array initialized\r\n    if (pinnedColumns.length === 0) {\r\n      // Already empty, no action needed\r\n    }\r\n  }, [columns, buildDefaultOrder, buildDefaultVisibility, columnVisibility, columnOrder, pinnedColumns, setColumnVisibility, setColumnOrder, setPinnedColumns]);\r\n\r\n  const resetColumnLayout = React.useCallback(() => {\r\n    const defaultVisibility = buildDefaultVisibility();\r\n    const defaultOrder = buildDefaultOrder();\r\n    setColumnVisibility(defaultVisibility);\r\n    setColumnOrder(defaultOrder);\r\n    setPinnedColumns([]);\r\n    toast.success('Đã khôi phục bố cục cột mặc định');\r\n  }, [buildDefaultVisibility, buildDefaultOrder, setColumnVisibility, setColumnOrder, setPinnedColumns]);\r\n  \r\n  const confirmDelete = () => {\r\n    if (idToDelete) {\r\n      const employee = employees.find(e => e.systemId === idToDelete);\r\n      remove.mutate(asSystemId(idToDelete), {\r\n        onSuccess: () => {\r\n          toast.success(\"Đã xóa nhân viên vào thùng rác\", {\r\n            description: `Nhân viên ${employee?.fullName || ''} đã được chuyển vào thùng rác.`,\r\n          });\r\n        }\r\n      });\r\n    }\r\n    setIsAlertOpen(false)\r\n    setIdToDelete(null)\r\n  }\r\n\r\n  const confirmBulkDelete = () => {\r\n    const idsToDelete = Object.keys(rowSelection);\r\n    idsToDelete.forEach(systemId => remove.mutate(asSystemId(systemId)));\r\n    toast.success(\"Đã xóa nhân viên vào thùng rác\", {\r\n      description: `Đã chuyển ${idsToDelete.length} nhân viên vào thùng rác.`,\r\n    });\r\n    setRowSelection({});\r\n    setIsBulkDeleteAlertOpen(false);\r\n  }\r\n  \r\n  // ✅ Cache active/deleted lists to prevent infinite loops\r\n  const activeEmployees = React.useMemo(() => employees.filter(e => !e.isDeleted), [employees]);\r\n  const deletedEmployees = React.useMemo(() => employees.filter(e => e.isDeleted), [employees]);\r\n  \r\n  // ✅ PERFORMANCE: Create Fuse instance once for active employees only\r\n  const fuseInstance = React.useMemo(() => {\r\n    return new Fuse(activeEmployees, { \r\n      keys: [\"id\", \"fullName\", \"workEmail\", \"phone\", \"personalEmail\", \"department\", \"jobTitle\"],\r\n      threshold: 0.3,\r\n      ignoreLocation: true,\r\n      useExtendedSearch: false\r\n    });\r\n  }, [activeEmployees]);\r\n  \r\n  const filteredData = React.useMemo(() => {\r\n    // ✅ Only work with active employees\r\n    let filtered = activeEmployees;\r\n\r\n    if (branchFilter !== 'all') {\r\n      filtered = filtered.filter(emp => emp.branchSystemId === branchFilter);\r\n    }\r\n    \r\n    if (departmentFilter.size > 0) {\r\n      filtered = filtered.filter(emp => {\r\n        const deptName = typeof emp.department === 'object' \r\n          ? (emp.department as any)?.name \r\n          : emp.department;\r\n        return deptName && departmentFilter.has(deptName);\r\n      });\r\n    }\r\n    \r\n    if (jobTitleFilter.size > 0) {\r\n      filtered = filtered.filter(emp => {\r\n        const jtName = typeof emp.jobTitle === 'object'\r\n          ? (emp.jobTitle as any)?.name\r\n          : emp.jobTitle;\r\n        return jtName && jobTitleFilter.has(jtName);\r\n      });\r\n    }\r\n    \r\n    if (statusFilter.size > 0) {\r\n      filtered = filtered.filter(emp => emp.employmentStatus && statusFilter.has(emp.employmentStatus));\r\n    }\r\n    \r\n    // ✅ FIX: Apply search using pre-built Fuse instance\r\n    if (debouncedGlobalFilter && debouncedGlobalFilter.trim()) {\r\n      // Update Fuse data if needed and search\r\n      fuseInstance.setCollection(filtered);\r\n      filtered = fuseInstance.search(debouncedGlobalFilter.trim()).map(result => result.item);\r\n    }\r\n    \r\n    if (dateFilter && (dateFilter[0] || dateFilter[1])) {\r\n      const [start, end] = dateFilter;\r\n      const startDate = start ? getStartOfDay(start) : null;\r\n      const endDate = end ? getEndOfDay(end) : null;\r\n\r\n      filtered = filtered.filter(employee => {\r\n        const rowDate = new Date(employee.hireDate);\r\n        if (!isValidDate(rowDate)) return false;\r\n        \r\n        if (startDate && !endDate) return isDateAfter(rowDate, startDate) || isDateSame(rowDate, startDate);\r\n        if (!startDate && endDate) return isDateBefore(rowDate, endDate) || isDateSame(rowDate, endDate);\r\n        if (startDate && endDate) return isDateBetween(rowDate, startDate, endDate);\r\n        return true;\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [activeEmployees, debouncedGlobalFilter, dateFilter, fuseInstance, branchFilter, departmentFilter, jobTitleFilter, statusFilter]);\r\n  \r\n  // Reset pagination when filters change\r\n  React.useEffect(() => {\r\n    setPagination(p => ({ ...p, pageIndex: 0 }));\r\n  }, [debouncedGlobalFilter, branchFilter, departmentFilter, jobTitleFilter, statusFilter, dateFilter]);\r\n  \r\n  const sortedData = React.useMemo(() => {\r\n    const sorted = [...filteredData];\r\n    if (sorting.id) {\r\n      sorted.sort((a, b) => {\r\n        const aValue = (a as any)[sorting.id];\r\n        const bValue = (b as any)[sorting.id];\r\n        if (aValue === null || aValue === undefined) return 1;\r\n        if (bValue === null || bValue === undefined) return -1;\r\n        // Special handling for date columns\r\n        if (sorting.id === 'createdAt' || sorting.id === 'hireDate') {\r\n          const aTime = aValue ? new Date(aValue).getTime() : 0;\r\n          const bTime = bValue ? new Date(bValue).getTime() : 0;\r\n          return sorting.desc ? bTime - aTime : aTime - bTime;\r\n        }\r\n        if (aValue < bValue) return sorting.desc ? 1 : -1;\r\n        if (aValue > bValue) return sorting.desc ? -1 : 1;\r\n        return 0;\r\n      });\r\n    }\r\n    return sorted;\r\n  }, [filteredData, sorting]);\r\n\r\n  const pageCount = Math.ceil(sortedData.length / pagination.pageSize);\r\n  const paginatedData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    const end = start + pagination.pageSize;\r\n    return sortedData.slice(start, end);\r\n  }, [sortedData, pagination]);\r\n\r\n  const numSelected = Object.keys(rowSelection).length;\r\n  const allSelectedRows = React.useMemo(() => \r\n    employees.filter(emp => rowSelection[emp.systemId]),\r\n  [employees, rowSelection]);\r\n\r\n  const isMobile = !useMediaQuery(\"(min-width: 768px)\");\r\n\r\n  // Filter options - Only recalculate when employees change\r\n  const departmentOptions = React.useMemo(() => {\r\n    const departments = new Set<string>();\r\n    activeEmployees.forEach(emp => {\r\n      const deptName = typeof emp.department === 'object'\r\n        ? (emp.department as any)?.name\r\n        : emp.department;\r\n      if (deptName) departments.add(deptName);\r\n    });\r\n    return Array.from(departments).sort().map(d => ({ label: d, value: d }));\r\n  }, [activeEmployees]);\r\n\r\n  const jobTitleOptions = React.useMemo(() => {\r\n    const jobTitles = new Set<string>();\r\n    activeEmployees.forEach(emp => {\r\n      const jtName = typeof emp.jobTitle === 'object'\r\n        ? (emp.jobTitle as any)?.name\r\n        : emp.jobTitle;\r\n      if (jtName) jobTitles.add(jtName);\r\n    });\r\n    return Array.from(jobTitles).sort().map(j => ({ label: j, value: j }));\r\n  }, [activeEmployees]);\r\n\r\n  const statusOptions = React.useMemo(() => [\r\n    { label: 'Đang làm việc', value: 'Đang làm việc' },\r\n    { label: 'Đã nghỉ việc', value: 'Đã nghỉ việc' },\r\n    { label: 'Tạm nghỉ', value: 'Tạm nghỉ' },\r\n  ], []);\r\n\r\n\r\n  const exportConfig = {\r\n    fileName: 'Danh_sach_Nhan_vien',\r\n    columns,\r\n  }\r\n\r\n  const importConfig: ImportConfig<Employee> = {\r\n    importer: (items) => {\r\n      // Convert from Omit<Employee, 'id'> to Omit<Employee, 'systemId'>\r\n      items.forEach(item => {\r\n        const { systemId, ...rest } = item as any;\r\n        create.mutate(rest as Omit<Employee, 'systemId'>);\r\n      });\r\n    },\r\n    fileName: 'Mau_Nhap_Nhan_vien',\r\n    existingData: employees,\r\n    getUniqueKey: (item: any) => item.id || item.nationalId || item.workEmail\r\n  }\r\n\r\n  // V2 Import handler with upsert support\r\n  const handleImportV2 = React.useCallback(async (\r\n    data: Partial<Employee>[],\r\n    mode: 'insert-only' | 'update-only' | 'upsert',\r\n    branchId?: string\r\n  ) => {\r\n    let inserted = 0;\r\n    let updated = 0;\r\n    let skipped = 0;\r\n    let failed = 0;\r\n    const errors: Array<{ row: number; message: string }> = [];\r\n\r\n    for (let i = 0; i < data.length; i++) {\r\n      const item = data[i];\r\n      try {\r\n        // Find existing by business ID (id field like NV000001)\r\n        const existingEmployee = item.id \r\n          ? activeEmployees.find(e => e.id === item.id)\r\n          : null;\r\n\r\n        if (existingEmployee) {\r\n          if (mode === 'insert-only') {\r\n            skipped++;\r\n            continue;\r\n          }\r\n          // Update existing\r\n          update.mutate({ systemId: existingEmployee.systemId, ...existingEmployee, ...item });\r\n          updated++;\r\n        } else {\r\n          if (mode === 'update-only') {\r\n            errors.push({ row: i + 2, message: `Không tìm thấy nhân viên với mã ${item.id}` });\r\n            failed++;\r\n            continue;\r\n          }\r\n          // Insert new - remove systemId if present\r\n          const { systemId, ...newEmployeeData } = item as any;\r\n          create.mutate(newEmployeeData as Omit<Employee, 'systemId'>);\r\n          inserted++;\r\n        }\r\n      } catch (error) {\r\n        errors.push({ row: i + 2, message: String(error) });\r\n        failed++;\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: inserted + updated,\r\n      failed,\r\n      inserted,\r\n      updated,\r\n      skipped,\r\n      errors,\r\n    };\r\n  }, [activeEmployees, update, create]);\r\n\r\n  // Current user for logging (mock - replace with actual auth)\r\n  const currentUser = React.useMemo(() => ({\r\n    name: 'Admin',\r\n    systemId: 'USR000001' as SystemId,\r\n  }), []);\r\n\r\n  const bulkActions = [\r\n    {\r\n      label: \"Chuyển vào thùng rác\",\r\n      onSelect: (selectedRows: Employee[]) => {\r\n        setIsBulkDeleteAlertOpen(true);\r\n      }\r\n    },\r\n    {\r\n      label: \"Đang làm việc\",\r\n      onSelect: (selectedRows: Employee[]) => {\r\n        selectedRows.forEach(emp => {\r\n          update.mutate({ systemId: emp.systemId, ...emp, employmentStatus: \"Đang làm việc\" });\r\n        });\r\n        toast.success(\"Đã cập nhật trạng thái\", {\r\n          description: `${selectedRows.length} nhân viên đã chuyển sang \"Đang làm việc\"`,\r\n        });\r\n        setRowSelection({});\r\n      }\r\n    },\r\n    {\r\n      label: \"Nghỉ việc\",\r\n      onSelect: (selectedRows: Employee[]) => {\r\n        selectedRows.forEach(emp => {\r\n          update.mutate({ systemId: emp.systemId, ...emp, employmentStatus: \"Đã nghỉ việc\" });\r\n        });\r\n        toast.success(\"Đã cập nhật trạng thái\", {\r\n          description: `${selectedRows.length} nhân viên đã chuyển sang \"Đã nghỉ việc\"`,\r\n        });\r\n        setRowSelection({});\r\n      }\r\n    }\r\n  ];\r\n\r\n  const handleRowClick = (row: Employee) => {\r\n    router.push(ROUTES.HRM.EMPLOYEE_VIEW.replace(':systemId', row.systemId));\r\n  };\r\n\r\n  // Mobile Employee Card Component\r\n  const MobileEmployeeCard = ({ employee }: { employee: Employee }) => {\r\n    const getInitials = (name: string) => {\r\n      return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\r\n    };\r\n\r\n    const getStatusVariant = (status: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\r\n      const map: Record<string, \"default\" | \"secondary\" | \"destructive\" | \"outline\"> = {\r\n        'Đang làm việc': 'default',\r\n        'Tạm nghỉ': 'secondary',\r\n        'Đã nghỉ việc': 'destructive'\r\n      };\r\n      return map[status] || 'default';\r\n    };\r\n\r\n    return (\r\n      <Card \r\n        className=\"hover:shadow-md transition-shadow cursor-pointer\"\r\n        onClick={() => handleRowClick(employee)}\r\n      >\r\n        <CardContent className=\"p-4\">\r\n          {/* Header: Avatar + Name + Code + Menu */}\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <div className=\"flex items-center gap-2 flex-1 min-w-0\">\r\n              <Avatar className=\"h-9 w-10 flex-shrink-0\">\r\n                <AvatarImage src={employee.avatarUrl} alt={employee.fullName} />\r\n                <AvatarFallback className=\"text-body-xs\">{getInitials(employee.fullName)}</AvatarFallback>\r\n              </Avatar>\r\n              <div className=\"flex items-center gap-1.5 min-w-0 flex-1\">\r\n                <h3 className=\"font-semibold text-body-medium truncate\">{employee.fullName}</h3>\r\n                <span className=\"text-body-xs text-muted-foreground\">•</span>\r\n                <span className=\"text-body-xs text-muted-foreground font-mono\">{employee.id}</span>\r\n              </div>\r\n            </div>\r\n            <DropdownMenu>\r\n              <DropdownMenuTrigger asChild>\r\n                <TouchButton\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  className=\"h-9 w-10 p-0 flex-shrink-0\"\r\n                  onClick={(e) => e.stopPropagation()}\r\n                >\r\n                  <MoreHorizontal className=\"h-4 w-4\" />\r\n                </TouchButton>\r\n              </DropdownMenuTrigger>\r\n              <DropdownMenuContent align=\"end\">\r\n                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); router.push(`/employees/${employee.systemId}/edit`); }}>\r\n                  Chỉnh sửa\r\n                </DropdownMenuItem>\r\n                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); handleDelete(employee.systemId); }}>\r\n                  Chuyển vào thùng rác\r\n                </DropdownMenuItem>\r\n              </DropdownMenuContent>\r\n            </DropdownMenu>\r\n          </div>\r\n\r\n          {/* Job Title + Department */}\r\n          <div className=\"text-body-xs text-muted-foreground mb-3 flex items-center\">\r\n            <Building2 className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n            <span className=\"truncate\">\r\n              {typeof employee.jobTitle === 'object' ? (employee.jobTitle as any)?.name : employee.jobTitle}\r\n              {' • '}\r\n              {typeof employee.department === 'object' ? (employee.department as any)?.name : employee.department}\r\n            </span>\r\n          </div>\r\n\r\n          {/* Divider */}\r\n          <div className=\"border-t mb-3\" />\r\n\r\n          {/* Contact Info */}\r\n          <div className=\"space-y-2\">\r\n            {employee.workEmail && (\r\n              <div className=\"flex items-center text-body-xs text-muted-foreground\">\r\n                <Mail className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n                <span className=\"truncate\">{employee.workEmail}</span>\r\n              </div>\r\n            )}\r\n            {employee.phone && (\r\n              <div className=\"flex items-center text-body-xs text-muted-foreground\">\r\n                <Phone className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n                <span>{employee.phone}</span>\r\n              </div>\r\n            )}\r\n            <div className=\"flex items-center justify-between text-body-xs pt-1\">\r\n              <div className=\"flex items-center text-muted-foreground\">\r\n                <Calendar className=\"h-3 w-3 mr-1.5\" />\r\n                <span>{formatDate(employee.hireDate)}</span>\r\n              </div>\r\n              <Badge variant={getStatusVariant(employee.employmentStatus)} className=\"text-body-xs\">\r\n                {employee.employmentStatus}\r\n              </Badge>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Quick Actions */}\r\n          <div className=\"flex gap-2 mt-3 pt-3 border-t\">\r\n            {employee.phone && (\r\n              <TouchButton \r\n                variant=\"outline\" \r\n                size=\"sm\" \r\n                className=\"flex-1 h-8 text-body-xs\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  window.location.href = `tel:${employee.phone}`;\r\n                }}\r\n              >\r\n                <Phone className=\"h-3 w-3 mr-1.5\" />\r\n                Gọi\r\n              </TouchButton>\r\n            )}\r\n            {employee.workEmail && (\r\n              <TouchButton \r\n                variant=\"outline\" \r\n                size=\"sm\" \r\n                className=\"flex-1 h-8 text-body-xs\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  window.location.href = `mailto:${employee.workEmail}`;\r\n                }}\r\n              >\r\n                <Mail className=\"h-3 w-3 mr-1.5\" />\r\n                Email\r\n              </TouchButton>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col w-full h-full\">\r\n      {/* ===== HÀNG 2: TOOLBAR - Common Actions (Desktop only) ===== */}\r\n      {!isMobile && (\r\n        <PageToolbar\r\n          leftActions={\r\n            <>\r\n              {/* V2 Import/Export with preview & logging */}\r\n              <Button variant=\"outline\" size=\"sm\" className=\"h-9\" onClick={() => setIsImportV2Open(true)}>\r\n                <Upload className=\"mr-2 h-4 w-4\" />\r\n                Nhập Excel\r\n              </Button>\r\n              <Button variant=\"outline\" size=\"sm\" className=\"h-9\" onClick={() => setIsExportV2Open(true)}>\r\n                <Download className=\"mr-2 h-4 w-4\" />\r\n                Xuất Excel\r\n              </Button>\r\n            </>\r\n          }\r\n          rightActions={\r\n            <DataTableColumnCustomizer\r\n              columns={columns}\r\n              columnVisibility={columnVisibility}\r\n              setColumnVisibility={setColumnVisibility}\r\n              columnOrder={columnOrder}\r\n              setColumnOrder={setColumnOrder}\r\n              pinnedColumns={pinnedColumns}\r\n              setPinnedColumns={setPinnedColumns}\r\n              onResetToDefault={resetColumnLayout}\r\n            />\r\n          }\r\n        />\r\n      )}\r\n\r\n      {/* ===== HÀNG 3: FILTERS - Search & Custom Filters (1 hàng) ===== */}\r\n      <PageFilters\r\n        searchValue={globalFilter}\r\n        onSearchChange={setGlobalFilter}\r\n        searchPlaceholder=\"Tìm kiếm nhân viên (tên, mã, email, SĐT)...\"\r\n      >\r\n        {/* Branch Filter */}\r\n        <Select value={branchFilter} onValueChange={setBranchFilter}>\r\n          <SelectTrigger className=\"w-full sm:w-[180px] h-9\">\r\n            <SelectValue placeholder=\"Tất cả chi nhánh\" />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            <SelectItem value=\"all\">Tất cả chi nhánh</SelectItem>\r\n            {branches.map(b => (\r\n              <SelectItem key={b.systemId} value={b.systemId}>\r\n                {b.name}\r\n              </SelectItem>\r\n            ))}\r\n          </SelectContent>\r\n        </Select>\r\n\r\n        {/* Department Filter */}\r\n        {departmentOptions.length > 0 && (\r\n          <DataTableFacetedFilter\r\n            title=\"Phòng ban\"\r\n            options={departmentOptions}\r\n            selectedValues={departmentFilter}\r\n            onSelectedValuesChange={setDepartmentFilter}\r\n          />\r\n        )}\r\n\r\n        {/* Job Title Filter */}\r\n        {jobTitleOptions.length > 0 && (\r\n          <DataTableFacetedFilter\r\n            title=\"Chức danh\"\r\n            options={jobTitleOptions}\r\n            selectedValues={jobTitleFilter}\r\n            onSelectedValuesChange={setJobTitleFilter}\r\n          />\r\n        )}\r\n\r\n        {/* Status Filter */}\r\n        <DataTableFacetedFilter\r\n          title=\"Trạng thái\"\r\n          options={statusOptions}\r\n          selectedValues={statusFilter}\r\n          onSelectedValuesChange={setStatusFilter}\r\n        />\r\n      </PageFilters>\r\n\r\n      <div className=\"w-full py-4\">\r\n        <ResponsiveDataTable\r\n          columns={columns}\r\n          data={paginatedData}\r\n          renderMobileCard={(employee) => (\r\n            <MobileEmployeeCard employee={employee} />\r\n          )}\r\n          pageCount={pageCount}\r\n          pagination={pagination}\r\n          setPagination={setPagination}\r\n          rowCount={filteredData.length}\r\n          rowSelection={rowSelection}\r\n          setRowSelection={setRowSelection}\r\n          onBulkDelete={() => setIsBulkDeleteAlertOpen(true)}\r\n          bulkActions={bulkActions}\r\n          allSelectedRows={allSelectedRows}\r\n          expanded={expanded}\r\n          setExpanded={setExpanded}\r\n          sorting={sorting}\r\n          setSorting={setSorting as React.Dispatch<React.SetStateAction<{ id: string; desc: boolean; }>>}\r\n          columnVisibility={columnVisibility}\r\n          setColumnVisibility={setColumnVisibility}\r\n          columnOrder={columnOrder}\r\n          setColumnOrder={setColumnOrder}\r\n          pinnedColumns={pinnedColumns}\r\n          setPinnedColumns={setPinnedColumns}\r\n          onRowClick={handleRowClick}\r\n        />\r\n      </div>\r\n\r\n      {/* Delete Confirmation Dialogs */}\r\n      <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa nhân viên</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Nhân viên sẽ được chuyển vào thùng rác. Bạn có thể khôi phục lại sau nếu cần.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel className=\"h-9\">Hủy</AlertDialogCancel>\r\n            <AlertDialogAction className=\"h-9\" onClick={confirmDelete}>Tiếp tục</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n      \r\n      <AlertDialog open={isBulkDeleteAlertOpen} onOpenChange={setIsBulkDeleteAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa {numSelected} nhân viên</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Các nhân viên sẽ được chuyển vào thùng rác. Bạn có thể khôi phục lại sau nếu cần.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel className=\"h-9\">Hủy</AlertDialogCancel>\r\n            <AlertDialogAction className=\"h-9\" onClick={confirmBulkDelete}>Tiếp tục</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* V2 Import Dialog with Preview */}\r\n      <GenericImportDialogV2<Employee>\r\n        open={isImportV2Open}\r\n        onOpenChange={setIsImportV2Open}\r\n        config={employeeImportExportConfig}\r\n        branches={branches.map(b => ({ systemId: b.systemId, name: b.name }))}\r\n        requireBranch={true}\r\n        defaultBranchId={branches[0]?.systemId}\r\n        existingData={activeEmployees}\r\n        onImport={handleImportV2}\r\n        currentUser={currentUser}\r\n      />\r\n\r\n      {/* V2 Export Dialog with Column Selection */}\r\n      <GenericExportDialogV2<Employee>\r\n        open={isExportV2Open}\r\n        onOpenChange={setIsExportV2Open}\r\n        config={employeeImportExportConfig}\r\n        allData={activeEmployees}\r\n        filteredData={sortedData}\r\n        currentPageData={paginatedData}\r\n        selectedData={allSelectedRows}\r\n        appliedFilters={{\r\n          branch: branchFilter !== 'all' ? branchFilter : undefined,\r\n          department: departmentFilter.size > 0 ? Array.from(departmentFilter) : undefined,\r\n          jobTitle: jobTitleFilter.size > 0 ? Array.from(jobTitleFilter) : undefined,\r\n          status: statusFilter.size > 0 ? Array.from(statusFilter) : undefined,\r\n          search: debouncedGlobalFilter || undefined,\r\n        }}\r\n        currentUser={currentUser}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}