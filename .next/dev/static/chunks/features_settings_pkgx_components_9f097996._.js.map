{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/general-config-tab.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Label } from '../../../../components/ui/label';\r\nimport { Input } from '../../../../components/ui/input';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Switch } from '../../../../components/ui/switch';\r\nimport { Badge } from '../../../../components/ui/badge';\r\nimport { Eye, EyeOff, RefreshCw, CheckCircle2, XCircle, Loader2, Save } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport { PKGX_API_CONFIG } from '../constants';\r\n\r\nexport function GeneralConfigTab() {\r\n  const { settings, setApiUrl, setApiKey, setEnabled, setConnectionStatus, updateSyncSetting, addLog } = usePkgxSettingsStore();\r\n  const [showApiKey, setShowApiKey] = React.useState(false);\r\n  const [isTesting, setIsTesting] = React.useState(false);\r\n  const [localApiUrl, setLocalApiUrl] = React.useState(settings.apiUrl);\r\n  const [localApiKey, setLocalApiKey] = React.useState(settings.apiKey);\r\n  \r\n  const handleSaveConfig = () => {\r\n    setApiUrl(localApiUrl);\r\n    setApiKey(localApiKey);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'success',\r\n      message: 'Đã lưu cấu hình API',\r\n      details: { url: localApiUrl },\r\n    });\r\n    toast.success('Đã lưu cấu hình API');\r\n  };\r\n  \r\n  const handleTestConnection = async () => {\r\n    if (!localApiKey) {\r\n      toast.error('Vui lòng nhập API Key trước khi test');\r\n      return;\r\n    }\r\n    \r\n    setIsTesting(true);\r\n    const startTime = Date.now();\r\n    \r\n    try {\r\n      // Step 1: Ping server (không cần API key) để kiểm tra server hoạt động\r\n      const pingUrl = `${localApiUrl}?action=ping`;\r\n      const pingResponse = await fetch(pingUrl, {\r\n        method: 'GET',\r\n      });\r\n      \r\n      if (!pingResponse.ok) {\r\n        addLog({\r\n          action: 'ping',\r\n          status: 'error',\r\n          message: `Server không phản hồi`,\r\n          details: { url: pingUrl, httpStatus: pingResponse.status },\r\n        });\r\n        throw new Error(`Server không phản hồi (HTTP ${pingResponse.status})`);\r\n      }\r\n      \r\n      // Verify ping response is valid JSON\r\n      const pingText = await pingResponse.text();\r\n      try {\r\n        JSON.parse(pingText);\r\n      } catch {\r\n        // Lấy tên file từ URL người dùng nhập\r\n        const apiFileName = localApiUrl.split('/').pop() || 'api_product_hrm.php';\r\n        addLog({\r\n          action: 'ping',\r\n          status: 'error',\r\n          message: 'Server trả về lỗi PHP thay vì JSON',\r\n          details: { url: pingUrl, error: pingText.substring(0, 100) },\r\n        });\r\n        throw new Error(`Server có lỗi PHP. Vui lòng upload lại file ${apiFileName}`);\r\n      }\r\n      \r\n      addLog({\r\n        action: 'ping',\r\n        status: 'success',\r\n        message: 'Server hoạt động',\r\n        details: { url: pingUrl, responseTime: Date.now() - startTime },\r\n      });\r\n      \r\n      // Step 2: Test với API key\r\n      const testUrl = `${localApiUrl}?action=test`;\r\n      const testStartTime = Date.now();\r\n      const response = await fetch(testUrl, {\r\n        method: 'GET',\r\n        headers: {\r\n          'X-API-KEY': localApiKey,\r\n        },\r\n      });\r\n      \r\n      // Check if response is JSON\r\n      const contentType = response.headers.get('content-type');\r\n      const responseText = await response.text();\r\n      \r\n      let data;\r\n      try {\r\n        data = JSON.parse(responseText);\r\n      } catch (parseError) {\r\n        // PHP trả về HTML error thay vì JSON\r\n        const errorPreview = responseText.substring(0, 200);\r\n        console.error('Invalid JSON response:', errorPreview);\r\n        throw new Error(`Server trả về lỗi PHP. Kiểm tra file API trên server.`);\r\n      }\r\n      \r\n      if (!data.error) {\r\n        setConnectionStatus('connected');\r\n        const stats = data.stats || {};\r\n        addLog({\r\n          action: 'test_connection',\r\n          status: 'success',\r\n          message: `Kết nối thành công! SP: ${stats.total_products}, DM: ${stats.total_categories}, TH: ${stats.total_brands}`,\r\n          details: { \r\n            url: testUrl, \r\n            responseTime: Date.now() - testStartTime,\r\n            total: stats.total_products,\r\n          },\r\n        });\r\n        toast.success(`Kết nối thành công! Sản phẩm: ${stats.total_products || 0}, Danh mục: ${stats.total_categories || 0}, Thương hiệu: ${stats.total_brands || 0}`);\r\n      } else {\r\n        setConnectionStatus('error', data.message);\r\n        addLog({\r\n          action: 'test_connection',\r\n          status: 'error',\r\n          message: `Lỗi xác thực: ${data.message}`,\r\n          details: { url: testUrl, error: data.message },\r\n        });\r\n        toast.error(`Lỗi: ${data.message}`);\r\n      }\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Không thể kết nối';\r\n      setConnectionStatus('error', errorMessage);\r\n      addLog({\r\n        action: 'test_connection',\r\n        status: 'error',\r\n        message: `Lỗi kết nối: ${errorMessage}`,\r\n        details: { error: errorMessage, responseTime: Date.now() - startTime },\r\n      });\r\n      toast.error(`Không thể kết nối đến server PKGX: ${errorMessage}`);\r\n    } finally {\r\n      setIsTesting(false);\r\n    }\r\n  };\r\n  \r\n  const getStatusBadge = () => {\r\n    switch (settings.connectionStatus) {\r\n      case 'connected':\r\n        return <Badge variant=\"default\" className=\"bg-green-500\"><CheckCircle2 className=\"h-3 w-3 mr-1\" />Đã kết nối</Badge>;\r\n      case 'error':\r\n        return <Badge variant=\"destructive\"><XCircle className=\"h-3 w-3 mr-1\" />Lỗi kết nối</Badge>;\r\n      default:\r\n        return <Badge variant=\"secondary\">Chưa kết nối</Badge>;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* API Connection Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Thông tin kết nối API</CardTitle>\r\n          <CardDescription>Cấu hình kết nối với website phukiengiaxuong.com.vn</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"apiUrl\">API URL</Label>\r\n            <Input\r\n              id=\"apiUrl\"\r\n              value={localApiUrl}\r\n              onChange={(e) => setLocalApiUrl(e.target.value)}\r\n              placeholder={PKGX_API_CONFIG.baseUrl}\r\n            />\r\n          </div>\r\n          \r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"apiKey\">API Key</Label>\r\n            <div className=\"flex gap-2\">\r\n              <div className=\"relative flex-1\">\r\n                <Input\r\n                  id=\"apiKey\"\r\n                  type={showApiKey ? 'text' : 'password'}\r\n                  value={localApiKey}\r\n                  onChange={(e) => setLocalApiKey(e.target.value)}\r\n                  placeholder=\"Nhập API Key...\"\r\n                  className=\"pr-10\"\r\n                />\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"ghost\"\r\n                  size=\"icon\"\r\n                  className=\"absolute right-0 top-0 h-full\"\r\n                  onClick={() => setShowApiKey(!showApiKey)}\r\n                >\r\n                  {showApiKey ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-2 pt-2\">\r\n            <Button onClick={handleSaveConfig} variant=\"default\">\r\n              <Save className=\"h-4 w-4 mr-2\" />\r\n              Lưu cấu hình\r\n            </Button>\r\n            <Button onClick={handleTestConnection} disabled={isTesting} variant=\"outline\">\r\n              {isTesting ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <RefreshCw className=\"h-4 w-4 mr-2\" />}\r\n              Test Connection\r\n            </Button>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-sm text-muted-foreground\">Trạng thái:</span>\r\n            {getStatusBadge()}\r\n          </div>\r\n          \r\n          {settings.connectionError && (\r\n            <p className=\"text-sm text-destructive\">{settings.connectionError}</p>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Enable/Disable Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Trạng thái tích hợp</CardTitle>\r\n          <CardDescription>Bật/tắt đồng bộ với PKGX</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"font-medium\">Bật tích hợp PKGX</p>\r\n              <p className=\"text-sm text-muted-foreground\">Cho phép đồng bộ sản phẩm với website</p>\r\n            </div>\r\n            <Switch checked={settings.enabled} onCheckedChange={setEnabled} />\r\n          </div>\r\n          \r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"font-medium\">Bật Auto Sync</p>\r\n              <p className=\"text-sm text-muted-foreground\">Tự động đồng bộ dữ liệu theo lịch</p>\r\n            </div>\r\n            <Switch \r\n              checked={settings.syncSettings.autoSyncEnabled} \r\n              onCheckedChange={(checked) => updateSyncSetting('autoSyncEnabled', checked)} \r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Stats Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Thống kê</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n            <div className=\"text-center p-3 bg-muted rounded-lg\">\r\n              <p className=\"text-2xl font-bold\">{settings.categories.length}</p>\r\n              <p className=\"text-sm text-muted-foreground\">Danh mục PKGX</p>\r\n            </div>\r\n            <div className=\"text-center p-3 bg-muted rounded-lg\">\r\n              <p className=\"text-2xl font-bold\">{settings.brands.length}</p>\r\n              <p className=\"text-sm text-muted-foreground\">Thương hiệu PKGX</p>\r\n            </div>\r\n            <div className=\"text-center p-3 bg-muted rounded-lg\">\r\n              <p className=\"text-2xl font-bold\">{settings.categoryMappings.length}</p>\r\n              <p className=\"text-sm text-muted-foreground\">Mapping danh mục</p>\r\n            </div>\r\n            <div className=\"text-center p-3 bg-muted rounded-lg\">\r\n              <p className=\"text-2xl font-bold\">{settings.brandMappings.length}</p>\r\n              <p className=\"text-sm text-muted-foreground\">Mapping thương hiệu</p>\r\n            </div>\r\n          </div>\r\n          {settings.lastSyncAt && (\r\n            <p className=\"text-sm text-muted-foreground mt-4\">\r\n              Lần sync cuối: {new Date(settings.lastSyncAt).toLocaleString('vi-VN')}\r\n            </p>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 737, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/pkgx-sync-confirm-dialog.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Loader2 } from 'lucide-react';\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '../../../../components/ui/alert-dialog';\r\nimport type { ConfirmActionState } from '../hooks/use-pkgx-entity-sync';\r\n\r\ninterface PkgxSyncConfirmDialogProps {\r\n  confirmAction: ConfirmActionState;\r\n  isSyncing: boolean;\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n}\r\n\r\n/**\r\n * Shared confirmation dialog for PKGX sync actions\r\n * Used by category-mapping-tab, brand-mapping-tab, product-mapping-tab\r\n */\r\nexport function PkgxSyncConfirmDialog({\r\n  confirmAction,\r\n  isSyncing,\r\n  onConfirm,\r\n  onCancel,\r\n}: PkgxSyncConfirmDialogProps) {\r\n  return (\r\n    <AlertDialog open={confirmAction.open} onOpenChange={(open) => !open && onCancel()}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle>{confirmAction.title}</AlertDialogTitle>\r\n          <AlertDialogDescription>{confirmAction.description}</AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n          <AlertDialogAction onClick={onConfirm} disabled={isSyncing}>\r\n            {isSyncing && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\r\n            Xác nhận\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAcO,SAAS,sBAAsB,EACpC,aAAa,EACb,SAAS,EACT,SAAS,EACT,QAAQ,EACmB;IAC3B,qBACE,6LAAC,sJAAW;QAAC,MAAM,cAAc,IAAI;QAAE,cAAc,CAAC,OAAS,CAAC,QAAQ;kBACtE,cAAA,6LAAC,6JAAkB;;8BACjB,6LAAC,4JAAiB;;sCAChB,6LAAC,2JAAgB;sCAAE,cAAc,KAAK;;;;;;sCACtC,6LAAC,iKAAsB;sCAAE,cAAc,WAAW;;;;;;;;;;;;8BAEpD,6LAAC,4JAAiB;;sCAChB,6LAAC,4JAAiB;sCAAC;;;;;;sCACnB,6LAAC,4JAAiB;4BAAC,SAAS;4BAAW,UAAU;;gCAC9C,2BAAa,6LAAC,+NAAO;oCAAC,WAAU;;;;;;gCAA+B;;;;;;;;;;;;;;;;;;;;;;;;AAO5E;KAvBgB"}},
    {"offset": {"line": 830, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/category-mapping-tab.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Input } from '../../../../components/ui/input';\r\nimport { Badge } from '../../../../components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../../../../components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '../../../../components/ui/dialog';\r\nimport { Label } from '../../../../components/ui/label';\r\nimport { ScrollArea } from '../../../../components/ui/scroll-area';\r\nimport { Plus, Pencil, Trash2, RefreshCw, Search, Loader2, FolderTree, Link, Unlink, CheckCircle2, MoreHorizontal, ExternalLink, Upload, AlignLeft, FolderEdit, Link2 } from 'lucide-react';\r\nimport { Checkbox } from '../../../../components/ui/checkbox';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '../../../../components/ui/dropdown-menu';\r\nimport { getCategoryById, updateCategory } from '../../../../lib/pkgx/api-service';\r\nimport { toast } from 'sonner';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport { useProductCategoryStore } from '../../inventory/product-category-store';\r\nimport { ResponsiveDataTable } from '../../../../components/data-table/responsive-data-table';\r\nimport type { ColumnDef } from '../../../../components/data-table/types';\r\nimport type { PkgxCategoryMapping, PkgxCategory, PkgxCategoryFromApi } from '../types';\r\nimport { useCategoryMappingValidation, usePkgxEntitySync } from '../hooks';\r\nimport type { HrmCategoryData } from '../hooks';\r\nimport type { CategoryMappingInput } from '../validation';\r\nimport { PkgxMappingDialog } from '../../../../components/shared/pkgx-mapping-dialog';\r\nimport { PkgxSyncConfirmDialog } from './pkgx-sync-confirm-dialog';\r\n\r\n// Extended type for PKGX categories table\r\ninterface PkgxCategoryRow extends PkgxCategory {\r\n  systemId: string;\r\n  mappedToHrm?: string;\r\n}\r\n\r\n// Extended type for mappings table\r\ninterface MappingRow extends PkgxCategoryMapping {\r\n  systemId: string;\r\n}\r\n\r\nexport function CategoryMappingTab() {\r\n  const { \r\n    settings, \r\n    addCategoryMapping, \r\n    updateCategoryMapping, \r\n    deleteCategoryMapping,\r\n    syncCategoriesFromPkgx,\r\n    addLog,\r\n  } = usePkgxSettingsStore();\r\n  const productCategories = useProductCategoryStore();\r\n  \r\n  const [searchTerm, setSearchTerm] = React.useState('');\r\n  const [activeTab, setActiveTab] = React.useState('pkgx-categories');\r\n  const [isDialogOpen, setIsDialogOpen] = React.useState(false);\r\n  const [editingMapping, setEditingMapping] = React.useState<PkgxCategoryMapping | null>(null);\r\n  const [isSyncing, setIsSyncing] = React.useState(false);\r\n  \r\n  // Detail dialog state\r\n  const [isDetailDialogOpen, setIsDetailDialogOpen] = React.useState(false);\r\n  const [selectedCategoryForDetail, setSelectedCategoryForDetail] = React.useState<PkgxCategoryFromApi | null>(null);\r\n  const [isLoadingDetail, setIsLoadingDetail] = React.useState(false);\r\n  const [isPushing, setIsPushing] = React.useState(false);\r\n  \r\n  // Table state\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 20 });\r\n  const [sorting, setSorting] = React.useState<{ id: string; desc: boolean }>({ id: 'id', desc: false });\r\n  const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({});\r\n  \r\n  // Form state\r\n  const [selectedHrmCategory, setSelectedHrmCategory] = React.useState('');\r\n  const [selectedPkgxCategory, setSelectedPkgxCategory] = React.useState('');\r\n  const [showWarningConfirm, setShowWarningConfirm] = React.useState(false);\r\n  \r\n  // Use shared PKGX entity sync hook\r\n  const entitySync = usePkgxEntitySync({\r\n    entityType: 'category',\r\n    onLog: addLog,\r\n  });\r\n  \r\n  const hrmCategories = React.useMemo(\r\n    () => productCategories.getActive().sort((a, b) => (a.path || '').localeCompare(b.path || '')),\r\n    [productCategories]\r\n  );\r\n  \r\n  // Validation hook\r\n  const validation = useCategoryMappingValidation({\r\n    existingMappings: settings.categoryMappings,\r\n    hrmCategories: hrmCategories,\r\n    pkgxCategories: settings.categories,\r\n    editingMappingId: editingMapping?.id,\r\n    debounceMs: 300,\r\n  });\r\n  \r\n  // Find if PKGX category is mapped\r\n  const findMapping = React.useCallback((pkgxCatId: number) => {\r\n    return settings.categoryMappings.find(m => m.pkgxCatId === pkgxCatId);\r\n  }, [settings.categoryMappings]);\r\n  \r\n  // PKGX Categories data for table\r\n  const pkgxCategoriesData = React.useMemo((): PkgxCategoryRow[] => {\r\n    let filtered = settings.categories;\r\n    if (searchTerm) {\r\n      const term = searchTerm.toLowerCase();\r\n      filtered = settings.categories.filter(c => \r\n        c.name.toLowerCase().includes(term) ||\r\n        c.id.toString().includes(term)\r\n      );\r\n    }\r\n    return filtered.map(c => ({\r\n      ...c,\r\n      systemId: c.id.toString(),\r\n      mappedToHrm: findMapping(c.id)?.hrmCategoryName,\r\n    }));\r\n  }, [settings.categories, searchTerm, findMapping]);\r\n  \r\n  // Mappings data for table\r\n  const mappingsData = React.useMemo((): MappingRow[] => {\r\n    let filtered = settings.categoryMappings;\r\n    if (searchTerm) {\r\n      const term = searchTerm.toLowerCase();\r\n      filtered = settings.categoryMappings.filter(m =>\r\n        m.hrmCategoryName.toLowerCase().includes(term) ||\r\n        m.pkgxCatName.toLowerCase().includes(term)\r\n      );\r\n    }\r\n    return filtered.map(m => ({\r\n      ...m,\r\n      systemId: m.id,\r\n    }));\r\n  }, [settings.categoryMappings, searchTerm]);\r\n  \r\n  // Paginated data\r\n  const paginatedPkgxData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    return pkgxCategoriesData.slice(start, start + pagination.pageSize);\r\n  }, [pkgxCategoriesData, pagination]);\r\n  \r\n  const paginatedMappingsData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    return mappingsData.slice(start, start + pagination.pageSize);\r\n  }, [mappingsData, pagination]);\r\n  \r\n  // All selected rows and bulk actions for PKGX categories table\r\n  const allSelectedPkgxRows = React.useMemo(() => \r\n    paginatedPkgxData.filter(p => rowSelection[p.systemId]),\r\n  [paginatedPkgxData, rowSelection]);\r\n  \r\n  // Get selected PKGX categories that are NOT mapped (for bulk mapping)\r\n  const selectedUnmappedCategories = React.useMemo(() => \r\n    allSelectedPkgxRows.filter(c => !c.mappedToHrm),\r\n  [allSelectedPkgxRows]);\r\n  \r\n  // Get selected PKGX categories that ARE mapped (for bulk unlink)\r\n  const selectedMappedCategories = React.useMemo(() => \r\n    allSelectedPkgxRows.filter(c => c.mappedToHrm),\r\n  [allSelectedPkgxRows]);\r\n  \r\n  // Bulk actions for PKGX categories table\r\n  const pkgxBulkActions = React.useMemo(() => [\r\n    {\r\n      label: `Hủy liên kết (${selectedMappedCategories.length})`,\r\n      icon: Unlink,\r\n      variant: 'destructive' as const,\r\n      disabled: selectedMappedCategories.length === 0,\r\n      onSelect: () => {\r\n        if (selectedMappedCategories.length === 0) {\r\n          toast.error('Không có danh mục đã liên kết nào được chọn');\r\n          return;\r\n        }\r\n        // Bulk delete mappings\r\n        selectedMappedCategories.forEach(category => {\r\n          const mapping = findMapping(category.id);\r\n          if (mapping) {\r\n            deleteCategoryMapping(mapping.id);\r\n          }\r\n        });\r\n        toast.success(`Đã hủy liên kết ${selectedMappedCategories.length} danh mục`);\r\n        setRowSelection({});\r\n      },\r\n    },\r\n  ], [selectedMappedCategories, findMapping, deleteCategoryMapping]);\r\n  \r\n  // PKGX Categories columns\r\n  const pkgxColumns: ColumnDef<PkgxCategoryRow>[] = React.useMemo(() => [\r\n    {\r\n      id: 'select',\r\n      header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n        <Checkbox\r\n          checked={isAllPageRowsSelected ? true : isSomePageRowsSelected ? 'indeterminate' : false}\r\n          onCheckedChange={onToggleAll}\r\n          aria-label=\"Select all\"\r\n        />\r\n      ),\r\n      cell: ({ row, isSelected, onToggleSelect }) => (\r\n        <Checkbox\r\n          checked={isSelected}\r\n          onCheckedChange={onToggleSelect}\r\n          aria-label=\"Select row\"\r\n          onClick={(e) => e.stopPropagation()}\r\n        />\r\n      ),\r\n      size: 48,\r\n      enableSorting: false,\r\n      meta: { sticky: 'left', displayName: '' },\r\n    },\r\n    {\r\n      id: 'id',\r\n      accessorKey: 'id',\r\n      header: 'ID',\r\n      size: 70,\r\n      cell: ({ row }) => <span className=\"font-mono text-xs\">{row.id}</span>,\r\n    },\r\n    {\r\n      id: 'name',\r\n      accessorKey: 'name',\r\n      header: 'Danh mục PKGX',\r\n      cell: ({ row }) => {\r\n        // Gộp danh mục cha > danh mục con\r\n        const parent = row.parentId ? settings.categories.find(c => c.id === row.parentId) : null;\r\n        return (\r\n          <div className=\"flex items-center gap-1\">\r\n            {parent && (\r\n              <>\r\n                <span className=\"text-muted-foreground text-sm\">{parent.name}</span>\r\n                <span className=\"text-muted-foreground\">›</span>\r\n              </>\r\n            )}\r\n            <span className=\"font-medium\">{row.name}</span>\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      id: 'mappedToHrm',\r\n      header: 'Mapping HRM',\r\n      cell: ({ row }) => (\r\n        row.mappedToHrm ? (\r\n          <Badge variant=\"default\" className=\"bg-green-500\">\r\n            <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n            {row.mappedToHrm}\r\n          </Badge>\r\n        ) : (\r\n          <Badge variant=\"secondary\">Chưa liên kết</Badge>\r\n        )\r\n      ),\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: '',\r\n      size: 50,\r\n      cell: ({ row }) => {\r\n        // Get HRM category for sync actions\r\n        const mapping = findMapping(row.id);\r\n        const hrmCategory = mapping ? hrmCategories.find(c => c.systemId === mapping.hrmCategorySystemId) : null;\r\n        \r\n        // Helper to trigger sync with proper HRM data\r\n        const triggerSync = (actionKey: 'sync_all' | 'sync_basic' | 'sync_seo' | 'sync_description') => {\r\n          if (!mapping || !hrmCategory) {\r\n            toast.error('Danh mục chưa được liên kết với HRM');\r\n            return;\r\n          }\r\n          const hrmData: HrmCategoryData = {\r\n            systemId: hrmCategory.systemId,\r\n            name: hrmCategory.name,\r\n            isActive: hrmCategory.isActive,\r\n            seoKeywords: hrmCategory.seoKeywords,\r\n            seoTitle: hrmCategory.seoTitle,\r\n            metaDescription: hrmCategory.metaDescription,\r\n            shortDescription: hrmCategory.shortDescription,\r\n            longDescription: hrmCategory.longDescription,\r\n            websiteSeo: hrmCategory.websiteSeo,\r\n          };\r\n          entitySync.triggerSyncAction(actionKey, row.id, hrmData, row.name);\r\n        };\r\n        \r\n        return (\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n              {row.mappedToHrm ? (\r\n                <>\r\n                  {/* Sync All */}\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_all')}\r\n                    className=\"font-medium\"\r\n                    title=\"Đồng bộ: Tên, Keywords, Meta Title, Meta Desc, Mô tả ngắn, Mô tả dài\"\r\n                  >\r\n                    <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                    Đồng bộ tất cả\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuSeparator />\r\n                  \r\n                  {/* Individual sync actions */}\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_seo')}\r\n                    title=\"Đồng bộ: Keywords, Meta Title, Meta Desc\"\r\n                  >\r\n                    <Search className=\"h-4 w-4 mr-2\" />\r\n                    SEO\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_description')}\r\n                    title=\"Đồng bộ: Mô tả ngắn (Short Desc), Mô tả dài (Long Desc)\"\r\n                  >\r\n                    <AlignLeft className=\"h-4 w-4 mr-2\" />\r\n                    Mô tả\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_basic')}\r\n                    title=\"Đồng bộ: Tên danh mục, Trạng thái hiển thị\"\r\n                  >\r\n                    <FolderEdit className=\"h-4 w-4 mr-2\" />\r\n                    Thông tin cơ bản\r\n                  </DropdownMenuItem>\r\n                  \r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem onClick={() => window.open(`https://phukiengiaxuong.com.vn/admin/category.php?act=edit&cat_id=${row.id}`, '_blank')}>\r\n                    <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n                    Xem trên PKGX\r\n                  </DropdownMenuItem>\r\n                  \r\n                  {/* Hủy liên kết */}\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem \r\n                    onClick={() => entitySync.handleConfirm(\r\n                      'Hủy liên kết PKGX',\r\n                      `Bạn có chắc muốn hủy liên kết danh mục \"${row.name}\" với PKGX?`,\r\n                      () => handleUnlinkCategory(row.id)\r\n                    )}\r\n                    className=\"text-destructive focus:text-destructive\"\r\n                  >\r\n                    <Unlink className=\"h-4 w-4 mr-2\" />\r\n                    Hủy liên kết\r\n                  </DropdownMenuItem>\r\n                </>\r\n              ) : (\r\n                /* Not linked - show link option */\r\n                <>\r\n                  <DropdownMenuItem onClick={() => handleQuickMap(row)}>\r\n                    <Link2 className=\"h-4 w-4 mr-2\" />\r\n                    Liên kết với HRM\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        );\r\n      },\r\n    },\r\n  ], [settings.categories, hrmCategories, findMapping, entitySync]);\r\n  \r\n  // Mappings columns\r\n  const mappingColumns: ColumnDef<MappingRow>[] = React.useMemo(() => [\r\n    {\r\n      id: 'hrmCategoryName',\r\n      accessorKey: 'hrmCategoryName',\r\n      header: 'Danh mục HRM',\r\n      cell: ({ row }) => <span className=\"font-medium\">{row.hrmCategoryName}</span>,\r\n    },\r\n    {\r\n      id: 'pkgxCatName',\r\n      accessorKey: 'pkgxCatName',\r\n      header: 'Danh mục PKGX',\r\n      cell: ({ row }) => <span>{row.pkgxCatName}</span>,\r\n    },\r\n    {\r\n      id: 'pkgxCatId',\r\n      accessorKey: 'pkgxCatId',\r\n      header: 'ID PKGX',\r\n      size: 80,\r\n      cell: ({ row }) => <span className=\"font-mono text-muted-foreground\">{row.pkgxCatId}</span>,\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: 'Hành động',\r\n      size: 100,\r\n      cell: ({ row }) => (\r\n        <div className=\"flex justify-end gap-1\">\r\n          <Button variant=\"ghost\" size=\"sm\" onClick={() => handleOpenDialog(row)}>\r\n            <Pencil className=\"h-4 w-4\" />\r\n          </Button>\r\n          <Button variant=\"ghost\" size=\"sm\" onClick={() => handleDelete(row.id)}>\r\n            <Trash2 className=\"h-4 w-4 text-destructive\" />\r\n          </Button>\r\n        </div>\r\n      ),\r\n    },\r\n  ], []);\r\n  \r\n  const handleQuickMap = (pkgxCategory: PkgxCategoryRow) => {\r\n    setSelectedPkgxCategory(pkgxCategory.id.toString());\r\n    setSelectedHrmCategory('');\r\n    setEditingMapping(null);\r\n    setIsDialogOpen(true);\r\n  };\r\n  \r\n  const handleUnlinkCategory = (pkgxCatId: number) => {\r\n    const mapping = findMapping(pkgxCatId);\r\n    if (mapping) {\r\n      deleteCategoryMapping(mapping.id);\r\n      addLog({\r\n        action: 'unlink_mapping',\r\n        status: 'success',\r\n        message: `Đã hủy liên kết danh mục: ${mapping.hrmCategoryName} ↔ ${mapping.pkgxCatName}`,\r\n        details: { categoryId: pkgxCatId },\r\n      });\r\n      toast.success('Đã hủy liên kết danh mục');\r\n    }\r\n  };\r\n  \r\n  // Open detail dialog with category info\r\n  const handleViewDetail = async (catId: number) => {\r\n    setIsDetailDialogOpen(true);\r\n    setIsLoadingDetail(true);\r\n    setSelectedCategoryForDetail(null);\r\n    \r\n    try {\r\n      const response = await getCategoryById(catId);\r\n      if (response.success && response.data?.data) {\r\n        setSelectedCategoryForDetail(response.data.data as any);\r\n      } else {\r\n        toast.error(response.error || 'Không thể lấy thông tin danh mục');\r\n      }\r\n    } catch (error) {\r\n      toast.error('Lỗi khi lấy thông tin danh mục');\r\n    } finally {\r\n      setIsLoadingDetail(false);\r\n    }\r\n  };\r\n  \r\n  // Push category info from HRM to PKGX\r\n  const handlePushCategory = async (pkgxCatId: number) => {\r\n    const mapping = findMapping(pkgxCatId);\r\n    if (!mapping) {\r\n      toast.error('Danh mục chưa được mapping với HRM');\r\n      return;\r\n    }\r\n    \r\n    const hrmCategory = hrmCategories.find(c => c.systemId === mapping.hrmCategorySystemId);\r\n    if (!hrmCategory) {\r\n      toast.error('Không tìm thấy danh mục HRM');\r\n      return;\r\n    }\r\n    \r\n    setIsPushing(true);\r\n    try {\r\n      const payload: { cat_name?: string; cat_desc?: string; keywords?: string } = {};\r\n      \r\n      // Push name\r\n      if (hrmCategory.name) payload.cat_name = hrmCategory.name;\r\n      // Push description (nếu HRM category có field này)\r\n      if ((hrmCategory as any).description) payload.cat_desc = (hrmCategory as any).description;\r\n      // Push keywords (nếu HRM category có field này)\r\n      if ((hrmCategory as any).seoKeywords) payload.keywords = (hrmCategory as any).seoKeywords;\r\n      \r\n      const response = await updateCategory(pkgxCatId, payload);\r\n      if (response.success) {\r\n        toast.success('Đã đẩy thông tin danh mục lên PKGX');\r\n        addLog({\r\n          action: 'update_product',\r\n          status: 'success',\r\n          message: `Đã đẩy thông tin danh mục: ${mapping.hrmCategoryName} → ${mapping.pkgxCatName}`,\r\n          details: { categoryId: pkgxCatId },\r\n        });\r\n        // Refresh detail if open\r\n        if (isDetailDialogOpen && selectedCategoryForDetail?.cat_id === pkgxCatId) {\r\n          handleViewDetail(pkgxCatId);\r\n        }\r\n      } else {\r\n        toast.error(response.error || 'Không thể cập nhật danh mục');\r\n      }\r\n    } catch (error) {\r\n      toast.error('Lỗi khi đẩy thông tin danh mục');\r\n    } finally {\r\n      setIsPushing(false);\r\n    }\r\n  };\r\n  \r\n  const handleOpenDialog = (mapping?: PkgxCategoryMapping) => {\r\n    if (mapping) {\r\n      setEditingMapping(mapping);\r\n      setSelectedHrmCategory(mapping.hrmCategorySystemId);\r\n      setSelectedPkgxCategory(mapping.pkgxCatId.toString());\r\n    } else {\r\n      setEditingMapping(null);\r\n      setSelectedHrmCategory('');\r\n      setSelectedPkgxCategory('');\r\n    }\r\n    setIsDialogOpen(true);\r\n  };\r\n  \r\n  const handleCloseDialog = () => {\r\n    setIsDialogOpen(false);\r\n    setEditingMapping(null);\r\n    setSelectedHrmCategory('');\r\n    setSelectedPkgxCategory('');\r\n    setShowWarningConfirm(false);\r\n    validation.clearValidation();\r\n  };\r\n  \r\n  // Validate when form values change\r\n  React.useEffect(() => {\r\n    if (isDialogOpen && (selectedHrmCategory || selectedPkgxCategory)) {\r\n      const input: CategoryMappingInput = {\r\n        hrmCategorySystemId: selectedHrmCategory || '',\r\n        hrmCategoryName: hrmCategories.find(c => c.systemId === selectedHrmCategory)?.name || '',\r\n        pkgxCatId: selectedPkgxCategory ? parseInt(selectedPkgxCategory) : '',\r\n        pkgxCatName: settings.categories.find(c => c.id === parseInt(selectedPkgxCategory))?.name || '',\r\n      };\r\n      validation.validateAsync(input);\r\n    }\r\n  }, [selectedHrmCategory, selectedPkgxCategory, isDialogOpen]);\r\n  \r\n  const handleSave = () => {\r\n    // Build input for validation\r\n    const input: CategoryMappingInput = {\r\n      hrmCategorySystemId: selectedHrmCategory || '',\r\n      hrmCategoryName: hrmCategories.find(c => c.systemId === selectedHrmCategory)?.name || '',\r\n      pkgxCatId: selectedPkgxCategory ? parseInt(selectedPkgxCategory) : '',\r\n      pkgxCatName: settings.categories.find(c => c.id === parseInt(selectedPkgxCategory))?.name || '',\r\n    };\r\n    \r\n    // Run final validation\r\n    const result = validation.validate(input);\r\n    \r\n    // Block if there are errors\r\n    if (!result.isValid) {\r\n      toast.error(result.errors[0]?.message || 'Vui lòng kiểm tra lại thông tin');\r\n      return;\r\n    }\r\n    \r\n    // Show warning confirmation if there are warnings and not yet confirmed\r\n    if (result.warnings.length > 0 && !showWarningConfirm) {\r\n      setShowWarningConfirm(true);\r\n      return;\r\n    }\r\n    \r\n    const hrmCategory = hrmCategories.find((c) => c.systemId === selectedHrmCategory);\r\n    const pkgxCategory = settings.categories.find((c) => c.id === parseInt(selectedPkgxCategory));\r\n    \r\n    if (!hrmCategory || !pkgxCategory) {\r\n      toast.error('Không tìm thấy danh mục');\r\n      return;\r\n    }\r\n    \r\n    if (editingMapping) {\r\n      updateCategoryMapping(editingMapping.id, {\r\n        hrmCategorySystemId: hrmCategory.systemId,\r\n        hrmCategoryName: hrmCategory.name,\r\n        pkgxCatId: pkgxCategory.id,\r\n        pkgxCatName: pkgxCategory.name,\r\n      });\r\n      addLog({\r\n        action: 'save_mapping',\r\n        status: 'success',\r\n        message: `Cập nhật mapping danh mục: ${hrmCategory.name} → ${pkgxCategory.name}`,\r\n        details: { categoryId: pkgxCategory.id },\r\n      });\r\n      toast.success('Đã cập nhật mapping danh mục');\r\n    } else {\r\n      addCategoryMapping({\r\n        id: `catmap-${Date.now()}`,\r\n        hrmCategorySystemId: hrmCategory.systemId,\r\n        hrmCategoryName: hrmCategory.name,\r\n        pkgxCatId: pkgxCategory.id,\r\n        pkgxCatName: pkgxCategory.name,\r\n      });\r\n      addLog({\r\n        action: 'save_mapping',\r\n        status: 'success',\r\n        message: `Thêm mapping danh mục: ${hrmCategory.name} → ${pkgxCategory.name}`,\r\n        details: { categoryId: pkgxCategory.id },\r\n      });\r\n      toast.success('Đã thêm mapping danh mục');\r\n    }\r\n    \r\n    handleCloseDialog();\r\n  };\r\n  \r\n  const handleDelete = (id: string) => {\r\n    const mapping = settings.categoryMappings.find(m => m.id === id);\r\n    deleteCategoryMapping(id);\r\n    if (mapping) {\r\n      addLog({\r\n        action: 'save_mapping',\r\n        status: 'info',\r\n        message: `Xóa mapping danh mục: ${mapping.hrmCategoryName}`,\r\n        details: { categoryId: mapping.pkgxCatId },\r\n      });\r\n    }\r\n    toast.success('Đã xóa mapping danh mục');\r\n  };\r\n  \r\n  const handleSyncFromPkgx = async () => {\r\n    setIsSyncing(true);\r\n    try {\r\n      await syncCategoriesFromPkgx();\r\n      toast.success('Đã đồng bộ danh mục từ PKGX');\r\n    } catch (error) {\r\n      toast.error(error instanceof Error ? error.message : 'Lỗi khi đồng bộ danh mục');\r\n    } finally {\r\n      setIsSyncing(false);\r\n    }\r\n  };\r\n  \r\n  // Mobile card renderers\r\n  const renderPkgxMobileCard = (row: PkgxCategoryRow) => (\r\n    <div className=\"p-4 space-y-3\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <div>\r\n          <div className=\"font-medium\">{row.name}</div>\r\n          <div className=\"text-sm text-muted-foreground\">ID: {row.id}</div>\r\n        </div>\r\n        {row.mappedToHrm ? (\r\n          <Badge variant=\"default\" className=\"bg-green-500 shrink-0\">\r\n            <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n            Đã mapping\r\n          </Badge>\r\n        ) : (\r\n          <Badge variant=\"secondary\" className=\"shrink-0\">Chưa mapping</Badge>\r\n        )}\r\n      </div>\r\n      {row.mappedToHrm && (\r\n        <div className=\"text-sm\">\r\n          <span className=\"text-muted-foreground\">HRM: </span>\r\n          <span>{row.mappedToHrm}</span>\r\n        </div>\r\n      )}\r\n      {!row.mappedToHrm && (\r\n        <Button\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          className=\"w-full\"\r\n          onClick={() => handleQuickMap(row)}\r\n        >\r\n          <Link className=\"h-4 w-4 mr-2\" />\r\n          Mapping nhanh\r\n        </Button>\r\n      )}\r\n    </div>\r\n  );\r\n  \r\n  const renderMappingMobileCard = (row: MappingRow) => (\r\n    <div className=\"p-4 space-y-3\">\r\n      <div>\r\n        <div className=\"font-medium\">{row.hrmCategoryName}</div>\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          → {row.pkgxCatName} (ID: {row.pkgxCatId})\r\n        </div>\r\n      </div>\r\n      <div className=\"flex gap-2\">\r\n        <Button variant=\"outline\" size=\"sm\" className=\"flex-1\" onClick={() => handleOpenDialog(row)}>\r\n          <Pencil className=\"h-4 w-4 mr-2\" />\r\n          Sửa\r\n        </Button>\r\n        <Button variant=\"outline\" size=\"sm\" className=\"flex-1\" onClick={() => handleDelete(row.id)}>\r\n          <Trash2 className=\"h-4 w-4 mr-2 text-destructive\" />\r\n          Xóa\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n  \r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n            <div>\r\n              <CardTitle className=\"text-lg\">Mapping danh mục sản phẩm</CardTitle>\r\n              <CardDescription>\r\n                Liên kết danh mục HRM với danh mục PKGX để đồng bộ sản phẩm\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <Button onClick={handleSyncFromPkgx} disabled={isSyncing} variant=\"outline\">\r\n                {isSyncing ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <RefreshCw className=\"h-4 w-4 mr-2\" />}\r\n                Đồng bộ từ PKGX\r\n              </Button>\r\n              <Button onClick={() => handleOpenDialog()}>\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                Thêm mapping\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-2\">\r\n              <div className=\"relative flex-1\">\r\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Tìm kiếm danh mục...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-9\"\r\n                />\r\n              </div>\r\n              <div className=\"text-sm text-muted-foreground whitespace-nowrap text-center sm:text-right\">\r\n                {settings.categories.length} danh mục PKGX | {settings.categoryMappings.length} mapping\r\n              </div>\r\n            </div>\r\n            \r\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n              <TabsList>\r\n                <TabsTrigger value=\"pkgx-categories\">\r\n                  <FolderTree className=\"h-4 w-4 mr-2\" />\r\n                  Danh mục PKGX ({settings.categories.length})\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"mappings\">\r\n                  <Link className=\"h-4 w-4 mr-2\" />\r\n                  Mapping ({settings.categoryMappings.length})\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"pkgx-categories\" className=\"mt-4\">\r\n                {settings.categories.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-muted-foreground\">\r\n                    <FolderTree className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>Chưa có danh mục từ PKGX.</p>\r\n                    <p className=\"text-sm mt-1\">Bấm \"Đồng bộ từ PKGX\" để lấy danh sách.</p>\r\n                  </div>\r\n                ) : (\r\n                  <ResponsiveDataTable\r\n                    columns={pkgxColumns}\r\n                    data={paginatedPkgxData}\r\n                    renderMobileCard={renderPkgxMobileCard}\r\n                    pageCount={Math.ceil(pkgxCategoriesData.length / pagination.pageSize)}\r\n                    pagination={pagination}\r\n                    setPagination={setPagination}\r\n                    rowCount={pkgxCategoriesData.length}\r\n                    sorting={sorting}\r\n                    setSorting={setSorting}\r\n                    rowSelection={rowSelection}\r\n                    setRowSelection={setRowSelection}\r\n                    bulkActions={pkgxBulkActions}\r\n                    allSelectedRows={allSelectedPkgxRows}\r\n                    emptyTitle=\"Không tìm thấy danh mục\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"mappings\" className=\"mt-4\">\r\n                {settings.categoryMappings.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-muted-foreground\">\r\n                    <Link className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>Chưa có mapping nào.</p>\r\n                    <p className=\"text-sm mt-1\">Bấm \"Thêm mapping\" để bắt đầu.</p>\r\n                  </div>\r\n                ) : (\r\n                  <ResponsiveDataTable\r\n                    columns={mappingColumns}\r\n                    data={paginatedMappingsData}\r\n                    renderMobileCard={renderMappingMobileCard}\r\n                    pageCount={Math.ceil(mappingsData.length / pagination.pageSize)}\r\n                    pagination={pagination}\r\n                    setPagination={setPagination}\r\n                    rowCount={mappingsData.length}\r\n                    sorting={sorting}\r\n                    setSorting={setSorting}\r\n                    emptyTitle=\"Không tìm thấy mapping\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Mapping Dialog - Using shared PkgxMappingDialog component */}\r\n      <PkgxMappingDialog\r\n        open={isDialogOpen}\r\n        onOpenChange={setIsDialogOpen}\r\n        type=\"category\"\r\n        isEditing={!!editingMapping}\r\n        hrmItems={hrmCategories.map((c) => ({\r\n          id: c.systemId,\r\n          name: c.path || c.name,\r\n        }))}\r\n        selectedHrmId={selectedHrmCategory}\r\n        onSelectHrmId={setSelectedHrmCategory}\r\n        pkgxItems={settings.categories.map((c) => ({\r\n          id: c.id.toString(),\r\n          name: c.name,\r\n          subText: `ID: ${c.id}`,\r\n        }))}\r\n        selectedPkgxId={selectedPkgxCategory}\r\n        onSelectPkgxId={setSelectedPkgxCategory}\r\n        pkgxSuggestions={validation.suggestions.map(s => ({\r\n          item: { id: s.category.id.toString(), name: s.category.name },\r\n          score: s.score,\r\n        }))}\r\n        validation={validation.validationResult}\r\n        hasErrors={validation.hasErrors}\r\n        isValidating={validation.isValidating}\r\n        showWarningConfirm={showWarningConfirm}\r\n        onConfirm={handleSave}\r\n        onCancel={handleCloseDialog}\r\n      />\r\n      \r\n      {/* Category Detail Dialog */}\r\n      <Dialog open={isDetailDialogOpen} onOpenChange={setIsDetailDialogOpen}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <FolderTree className=\"h-5 w-5\" />\r\n              Chi tiết danh mục PKGX\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {selectedCategoryForDetail ? `ID: ${selectedCategoryForDetail.cat_id}` : 'Đang tải...'}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          \r\n          {isLoadingDetail ? (\r\n            <div className=\"flex items-center justify-center py-8\">\r\n              <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\r\n            </div>\r\n          ) : selectedCategoryForDetail ? (\r\n            <ScrollArea className=\"max-h-[60vh] pr-4\">\r\n              <div className=\"space-y-4\">\r\n                {/* Basic info */}\r\n                <div className=\"space-y-2\">\r\n                  <Label className=\"text-sm font-medium\">Tên danh mục</Label>\r\n                  <div className=\"p-2 border rounded text-sm font-medium\">\r\n                    {selectedCategoryForDetail.cat_name}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-xs text-muted-foreground\">Parent ID</Label>\r\n                    <div className=\"p-2 border rounded text-sm\">\r\n                      {selectedCategoryForDetail.parent_id || 'Không có (Root)'}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-xs text-muted-foreground\">Thứ tự</Label>\r\n                    <div className=\"p-2 border rounded text-sm\">\r\n                      {selectedCategoryForDetail.sort_order}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* SEO Info */}\r\n                <div className=\"space-y-3\">\r\n                  <Label className=\"text-sm font-medium\">Thông tin SEO</Label>\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Alias (Slug)</Label>\r\n                      <div className=\"p-2 border rounded text-sm\">\r\n                        {selectedCategoryForDetail.cat_alias || '-'}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Keywords</Label>\r\n                      <div className=\"p-2 border rounded text-sm\">\r\n                        {selectedCategoryForDetail.keywords || '-'}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* Description */}\r\n                <div className=\"space-y-1\">\r\n                  <Label className=\"text-sm font-medium\">Mô tả danh mục</Label>\r\n                  {selectedCategoryForDetail.cat_desc ? (\r\n                    <div \r\n                      className=\"p-3 border rounded text-sm max-h-40 overflow-y-auto bg-muted/30\"\r\n                      dangerouslySetInnerHTML={{ __html: selectedCategoryForDetail.cat_desc }}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"p-2 border rounded text-sm text-muted-foreground\">Chưa có mô tả</div>\r\n                  )}\r\n                </div>\r\n                \r\n                {/* Mapping status */}\r\n                {findMapping(selectedCategoryForDetail.cat_id) && (\r\n                  <div className=\"p-3 bg-green-50 border border-green-200 rounded-lg\">\r\n                    <div className=\"flex items-center gap-2 text-green-700\">\r\n                      <CheckCircle2 className=\"h-4 w-4\" />\r\n                      <span className=\"font-medium\">Đã mapping với HRM:</span>\r\n                      <span>{findMapping(selectedCategoryForDetail.cat_id)?.hrmCategoryName}</span>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </ScrollArea>\r\n          ) : null}\r\n          \r\n          <DialogFooter className=\"gap-2\">\r\n            {selectedCategoryForDetail && (\r\n              <>\r\n                {findMapping(selectedCategoryForDetail.cat_id) && (\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    size=\"sm\"\r\n                    onClick={() => handlePushCategory(selectedCategoryForDetail.cat_id)}\r\n                    disabled={isPushing}\r\n                  >\r\n                    {isPushing ? <Loader2 className=\"h-4 w-4 animate-spin mr-2\" /> : <Upload className=\"h-4 w-4 mr-2\" />}\r\n                    Đẩy HRM → PKGX\r\n                  </Button>\r\n                )}\r\n                <Button \r\n                  variant=\"outline\" \r\n                  size=\"sm\"\r\n                  onClick={() => window.open(`https://phukiengiaxuong.com.vn/admin/category.php?act=edit&cat_id=${selectedCategoryForDetail.cat_id}`, '_blank')}\r\n                >\r\n                  <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n                  Xem trên PKGX\r\n                </Button>\r\n              </>\r\n            )}\r\n            <Button variant=\"outline\" onClick={() => setIsDetailDialogOpen(false)}>\r\n              Đóng\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      {/* Confirmation Dialog for sync actions - using shared component */}\r\n      <PkgxSyncConfirmDialog\r\n        confirmAction={entitySync.confirmAction}\r\n        isSyncing={entitySync.isSyncing}\r\n        onConfirm={entitySync.executeAction}\r\n        onCancel={entitySync.cancelConfirm}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2748, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/brand-mapping-tab.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Input } from '../../../../components/ui/input';\r\nimport { Badge } from '../../../../components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../../../../components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '../../../../components/ui/dialog';\r\nimport { Label } from '../../../../components/ui/label';\r\nimport { ScrollArea } from '../../../../components/ui/scroll-area';\r\nimport { Plus, Pencil, Trash2, RefreshCw, Search, Loader2, Award, Link, Unlink, CheckCircle2, MoreHorizontal, ExternalLink, Upload, AlignLeft, Globe, Link2 } from 'lucide-react';\r\nimport { Checkbox } from '../../../../components/ui/checkbox';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '../../../../components/ui/dropdown-menu';\r\nimport { getBrandById, updateBrand } from '../../../../lib/pkgx/api-service';\r\nimport { toast } from 'sonner';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport { useBrandStore } from '../../inventory/brand-store';\r\nimport { ResponsiveDataTable } from '../../../../components/data-table/responsive-data-table';\r\nimport type { ColumnDef } from '../../../../components/data-table/types';\r\nimport type { PkgxBrandMapping, PkgxBrand, PkgxBrandFromApi } from '../types';\r\nimport { useBrandMappingValidation, usePkgxEntitySync } from '../hooks';\r\nimport type { HrmBrandData } from '../hooks';\r\nimport type { BrandMappingInput } from '../validation';\r\nimport { PkgxMappingDialog } from '../../../../components/shared/pkgx-mapping-dialog';\r\nimport { PkgxSyncConfirmDialog } from './pkgx-sync-confirm-dialog';\r\n\r\n// Extended type for PKGX brands table\r\ninterface PkgxBrandRow extends PkgxBrand {\r\n  systemId: string;\r\n  mappedToHrm?: string;\r\n}\r\n\r\n// Extended type for mappings table\r\ninterface MappingRow extends PkgxBrandMapping {\r\n  systemId: string;\r\n}\r\n\r\nexport function BrandMappingTab() {\r\n  const { \r\n    settings, \r\n    addBrandMapping, \r\n    updateBrandMapping, \r\n    deleteBrandMapping,\r\n    syncBrandsFromPkgx,\r\n    addLog,\r\n  } = usePkgxSettingsStore();\r\n  const brandStore = useBrandStore();\r\n  \r\n  const [searchTerm, setSearchTerm] = React.useState('');\r\n  const [activeTab, setActiveTab] = React.useState('pkgx-brands');\r\n  const [isDialogOpen, setIsDialogOpen] = React.useState(false);\r\n  const [editingMapping, setEditingMapping] = React.useState<PkgxBrandMapping | null>(null);\r\n  const [isSyncing, setIsSyncing] = React.useState(false);\r\n  \r\n  // Detail dialog state\r\n  const [isDetailDialogOpen, setIsDetailDialogOpen] = React.useState(false);\r\n  const [selectedBrandForDetail, setSelectedBrandForDetail] = React.useState<PkgxBrandFromApi | null>(null);\r\n  const [isLoadingDetail, setIsLoadingDetail] = React.useState(false);\r\n  const [isPushing, setIsPushing] = React.useState(false);\r\n  \r\n  // Table state\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 20 });\r\n  const [sorting, setSorting] = React.useState<{ id: string; desc: boolean }>({ id: 'id', desc: false });\r\n  const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({});\r\n  \r\n  // Form state\r\n  const [selectedHrmBrand, setSelectedHrmBrand] = React.useState('');\r\n  const [selectedPkgxBrand, setSelectedPkgxBrand] = React.useState('');\r\n  const [showWarningConfirm, setShowWarningConfirm] = React.useState(false);\r\n  \r\n  // Use shared PKGX entity sync hook\r\n  const entitySync = usePkgxEntitySync({\r\n    entityType: 'brand',\r\n    onLog: addLog,\r\n  });\r\n  \r\n  const hrmBrands = React.useMemo(\r\n    () => brandStore.getActive().sort((a, b) => a.name.localeCompare(b.name)),\r\n    [brandStore]\r\n  );\r\n  \r\n  // Validation hook\r\n  const validation = useBrandMappingValidation({\r\n    existingMappings: settings.brandMappings,\r\n    hrmBrands: hrmBrands,\r\n    pkgxBrands: settings.brands,\r\n    editingMappingId: editingMapping?.id,\r\n    debounceMs: 300,\r\n  });\r\n  \r\n  // Find if PKGX brand is mapped\r\n  const findMapping = React.useCallback((pkgxBrandId: number) => {\r\n    return settings.brandMappings.find(m => m.pkgxBrandId === pkgxBrandId);\r\n  }, [settings.brandMappings]);\r\n  \r\n  // PKGX Brands data for table\r\n  const pkgxBrandsData = React.useMemo((): PkgxBrandRow[] => {\r\n    let filtered = settings.brands;\r\n    if (searchTerm) {\r\n      const term = searchTerm.toLowerCase();\r\n      filtered = settings.brands.filter(b => \r\n        b.name.toLowerCase().includes(term) ||\r\n        b.id.toString().includes(term)\r\n      );\r\n    }\r\n    return filtered.map(b => ({\r\n      ...b,\r\n      systemId: b.id.toString(),\r\n      mappedToHrm: findMapping(b.id)?.hrmBrandName,\r\n    }));\r\n  }, [settings.brands, searchTerm, findMapping]);\r\n  \r\n  // Mappings data for table\r\n  const mappingsData = React.useMemo((): MappingRow[] => {\r\n    let filtered = settings.brandMappings;\r\n    if (searchTerm) {\r\n      const term = searchTerm.toLowerCase();\r\n      filtered = settings.brandMappings.filter(m =>\r\n        m.hrmBrandName.toLowerCase().includes(term) ||\r\n        m.pkgxBrandName.toLowerCase().includes(term)\r\n      );\r\n    }\r\n    return filtered.map(m => ({\r\n      ...m,\r\n      systemId: m.id,\r\n    }));\r\n  }, [settings.brandMappings, searchTerm]);\r\n  \r\n  // Paginated data\r\n  const paginatedPkgxData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    return pkgxBrandsData.slice(start, start + pagination.pageSize);\r\n  }, [pkgxBrandsData, pagination]);\r\n  \r\n  const paginatedMappingsData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    return mappingsData.slice(start, start + pagination.pageSize);\r\n  }, [mappingsData, pagination]);\r\n  \r\n  // All selected rows and bulk actions for PKGX brands table\r\n  const allSelectedPkgxRows = React.useMemo(() => \r\n    paginatedPkgxData.filter(p => rowSelection[p.systemId]),\r\n  [paginatedPkgxData, rowSelection]);\r\n  \r\n  // Get selected PKGX brands that are NOT mapped (for bulk mapping)\r\n  const selectedUnmappedBrands = React.useMemo(() => \r\n    allSelectedPkgxRows.filter(b => !b.mappedToHrm),\r\n  [allSelectedPkgxRows]);\r\n  \r\n  // Get selected PKGX brands that ARE mapped (for bulk unlink)\r\n  const selectedMappedBrands = React.useMemo(() => \r\n    allSelectedPkgxRows.filter(b => b.mappedToHrm),\r\n  [allSelectedPkgxRows]);\r\n  \r\n  // Bulk actions for PKGX brands table\r\n  const pkgxBulkActions = React.useMemo(() => [\r\n    {\r\n      label: `Hủy mapping (${selectedMappedBrands.length})`,\r\n      icon: Unlink,\r\n      variant: 'destructive' as const,\r\n      disabled: selectedMappedBrands.length === 0,\r\n      onSelect: () => {\r\n        if (selectedMappedBrands.length === 0) {\r\n          toast.error('Không có thương hiệu đã mapping nào được chọn');\r\n          return;\r\n        }\r\n        // Bulk delete mappings\r\n        selectedMappedBrands.forEach(brand => {\r\n          const mapping = findMapping(brand.id);\r\n          if (mapping) {\r\n            deleteBrandMapping(mapping.id);\r\n          }\r\n        });\r\n        toast.success(`Đã hủy mapping ${selectedMappedBrands.length} thương hiệu`);\r\n        setRowSelection({});\r\n      },\r\n    },\r\n  ], [selectedMappedBrands, findMapping, deleteBrandMapping]);\r\n  \r\n  // PKGX Brands columns\r\n  const pkgxColumns: ColumnDef<PkgxBrandRow>[] = React.useMemo(() => [\r\n    {\r\n      id: 'select',\r\n      header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n        <Checkbox\r\n          checked={isAllPageRowsSelected ? true : (isSomePageRowsSelected ? 'indeterminate' : false)}\r\n          onCheckedChange={(checked) => onToggleAll?.(checked === true)}\r\n          aria-label=\"Select all\"\r\n        />\r\n      ),\r\n      cell: ({ row, isSelected, onToggleSelect }) => (\r\n        <Checkbox\r\n          checked={isSelected}\r\n          onCheckedChange={() => onToggleSelect(!isSelected)}\r\n          aria-label=\"Select row\"\r\n          onClick={(e) => e.stopPropagation()}\r\n        />\r\n      ),\r\n      size: 48,\r\n      enableSorting: false,\r\n      meta: { displayName: 'Chọn', sticky: 'left' },\r\n    },\r\n    {\r\n      id: 'id',\r\n      accessorKey: 'id',\r\n      header: 'ID',\r\n      size: 70,\r\n      cell: ({ row }) => <span className=\"font-mono text-xs\">{row.id}</span>,\r\n    },\r\n    {\r\n      id: 'name',\r\n      accessorKey: 'name',\r\n      header: 'Thương hiệu PKGX',\r\n      cell: ({ row }) => <span className=\"font-medium\">{row.name}</span>,\r\n    },\r\n    {\r\n      id: 'mappedToHrm',\r\n      header: 'Mapping HRM',\r\n      cell: ({ row }) => (\r\n        row.mappedToHrm ? (\r\n          <Badge variant=\"default\" className=\"bg-green-500\">\r\n            <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n            {row.mappedToHrm}\r\n          </Badge>\r\n        ) : (\r\n          <Badge variant=\"secondary\">Chưa mapping</Badge>\r\n        )\r\n      ),\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: '',\r\n      size: 50,\r\n      cell: ({ row }) => {\r\n        // Get HRM brand for sync actions\r\n        const mapping = findMapping(row.id);\r\n        const hrmBrand = mapping ? hrmBrands.find(b => b.systemId === mapping.hrmBrandSystemId) : null;\r\n        \r\n        // Helper to trigger sync with proper HRM data\r\n        const triggerSync = (actionKey: 'sync_all' | 'sync_basic' | 'sync_seo' | 'sync_description') => {\r\n          if (!mapping || !hrmBrand) {\r\n            toast.error('Thương hiệu chưa được liên kết với HRM');\r\n            return;\r\n          }\r\n          const hrmData: HrmBrandData = {\r\n            systemId: hrmBrand.systemId,\r\n            name: hrmBrand.name,\r\n            website: hrmBrand.website,\r\n            seoKeywords: hrmBrand.seoKeywords,\r\n            seoTitle: hrmBrand.seoTitle,\r\n            metaDescription: hrmBrand.metaDescription,\r\n            shortDescription: hrmBrand.shortDescription,\r\n            longDescription: hrmBrand.longDescription,\r\n            websiteSeo: hrmBrand.websiteSeo,\r\n          };\r\n          entitySync.triggerSyncAction(actionKey, row.id, hrmData, row.name);\r\n        };\r\n        \r\n        return (\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n              {row.mappedToHrm ? (\r\n                <>\r\n                  {/* Sync All */}\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_all')}\r\n                    className=\"font-medium\"\r\n                    title=\"Đồng bộ: Tên, Website, Keywords, Meta Title, Meta Desc, Mô tả ngắn, Mô tả dài\"\r\n                  >\r\n                    <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                    Đồng bộ tất cả\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuSeparator />\r\n                  \r\n                  {/* Individual sync actions */}\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_basic')}\r\n                    title=\"Đồng bộ: Tên thương hiệu, Website URL\"\r\n                  >\r\n                    <Globe className=\"h-4 w-4 mr-2\" />\r\n                    Thông tin cơ bản\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_seo')}\r\n                    title=\"Đồng bộ: Keywords, Meta Title, Meta Desc\"\r\n                  >\r\n                    <Search className=\"h-4 w-4 mr-2\" />\r\n                    SEO\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_description')}\r\n                    title=\"Đồng bộ: Mô tả ngắn (Short Desc), Mô tả dài (Long Desc)\"\r\n                  >\r\n                    <AlignLeft className=\"h-4 w-4 mr-2\" />\r\n                    Mô tả\r\n                  </DropdownMenuItem>\r\n                  \r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem onClick={() => window.open(`https://phukiengiaxuong.com.vn/admin/brand.php?act=edit&brand_id=${row.id}`, '_blank')}>\r\n                    <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n                    Xem trên PKGX\r\n                  </DropdownMenuItem>\r\n                  \r\n                  {/* Hủy liên kết */}\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem \r\n                    onClick={() => entitySync.handleConfirm(\r\n                      'Hủy liên kết PKGX',\r\n                      `Bạn có chắc muốn hủy liên kết thương hiệu \"${row.name}\" với PKGX?`,\r\n                      () => handleUnlinkBrand(row.id)\r\n                    )}\r\n                    className=\"text-destructive focus:text-destructive\"\r\n                  >\r\n                    <Unlink className=\"h-4 w-4 mr-2\" />\r\n                    Hủy liên kết\r\n                  </DropdownMenuItem>\r\n                </>\r\n              ) : (\r\n                /* Not linked - show link option */\r\n                <>\r\n                  <DropdownMenuItem onClick={() => handleQuickMap(row)}>\r\n                    <Link2 className=\"h-4 w-4 mr-2\" />\r\n                    Liên kết với HRM\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        );\r\n      },\r\n    },\r\n  ], [hrmBrands, findMapping, entitySync]);\r\n  \r\n  // Mappings columns\r\n  const mappingColumns: ColumnDef<MappingRow>[] = React.useMemo(() => [\r\n    {\r\n      id: 'hrmBrandName',\r\n      accessorKey: 'hrmBrandName',\r\n      header: 'Thương hiệu HRM',\r\n      cell: ({ row }) => <span className=\"font-medium\">{row.hrmBrandName}</span>,\r\n    },\r\n    {\r\n      id: 'pkgxBrandName',\r\n      accessorKey: 'pkgxBrandName',\r\n      header: 'Thương hiệu PKGX',\r\n      cell: ({ row }) => <span>{row.pkgxBrandName}</span>,\r\n    },\r\n    {\r\n      id: 'pkgxBrandId',\r\n      accessorKey: 'pkgxBrandId',\r\n      header: 'ID PKGX',\r\n      size: 80,\r\n      cell: ({ row }) => <span className=\"font-mono text-muted-foreground\">{row.pkgxBrandId}</span>,\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: 'Hành động',\r\n      size: 100,\r\n      cell: ({ row }) => (\r\n        <div className=\"flex justify-end gap-1\">\r\n          <Button variant=\"ghost\" size=\"sm\" onClick={() => handleOpenDialog(row)}>\r\n            <Pencil className=\"h-4 w-4\" />\r\n          </Button>\r\n          <Button variant=\"ghost\" size=\"sm\" onClick={() => handleDelete(row.id)}>\r\n            <Trash2 className=\"h-4 w-4 text-destructive\" />\r\n          </Button>\r\n        </div>\r\n      ),\r\n    },\r\n  ], []);\r\n  \r\n  const handleQuickMap = (pkgxBrand: PkgxBrandRow) => {\r\n    setSelectedPkgxBrand(pkgxBrand.id.toString());\r\n    setSelectedHrmBrand('');\r\n    setEditingMapping(null);\r\n    setIsDialogOpen(true);\r\n  };\r\n  \r\n  const handleUnlinkBrand = (pkgxBrandId: number) => {\r\n    const mapping = findMapping(pkgxBrandId);\r\n    if (mapping) {\r\n      deleteBrandMapping(mapping.id);\r\n      addLog({\r\n        action: 'unlink_mapping',\r\n        status: 'success',\r\n        message: `Đã hủy liên kết thương hiệu: ${mapping.hrmBrandName} ↔ ${mapping.pkgxBrandName}`,\r\n        details: { brandId: pkgxBrandId },\r\n      });\r\n      toast.success('Đã hủy liên kết thương hiệu');\r\n    }\r\n  };\r\n  \r\n  const handleOpenDialog = (mapping?: PkgxBrandMapping) => {\r\n    if (mapping) {\r\n      setEditingMapping(mapping);\r\n      setSelectedHrmBrand(mapping.hrmBrandSystemId);\r\n      setSelectedPkgxBrand(mapping.pkgxBrandId.toString());\r\n    } else {\r\n      setEditingMapping(null);\r\n      setSelectedHrmBrand('');\r\n      setSelectedPkgxBrand('');\r\n    }\r\n    setIsDialogOpen(true);\r\n  };\r\n  \r\n  const handleCloseDialog = () => {\r\n    setIsDialogOpen(false);\r\n    setEditingMapping(null);\r\n    setSelectedHrmBrand('');\r\n    setSelectedPkgxBrand('');\r\n    setShowWarningConfirm(false);\r\n    validation.clearValidation();\r\n  };\r\n  \r\n  // Validate when form values change\r\n  React.useEffect(() => {\r\n    if (isDialogOpen && (selectedHrmBrand || selectedPkgxBrand)) {\r\n      const input: BrandMappingInput = {\r\n        hrmBrandSystemId: selectedHrmBrand || '',\r\n        hrmBrandName: hrmBrands.find(b => b.systemId === selectedHrmBrand)?.name || '',\r\n        pkgxBrandId: selectedPkgxBrand ? parseInt(selectedPkgxBrand) : '',\r\n        pkgxBrandName: settings.brands.find(b => b.id === parseInt(selectedPkgxBrand))?.name || '',\r\n      };\r\n      validation.validateAsync(input);\r\n    }\r\n  }, [selectedHrmBrand, selectedPkgxBrand, isDialogOpen]);\r\n  \r\n  const handleSave = () => {\r\n    // Build input for validation\r\n    const input: BrandMappingInput = {\r\n      hrmBrandSystemId: selectedHrmBrand || '',\r\n      hrmBrandName: hrmBrands.find(b => b.systemId === selectedHrmBrand)?.name || '',\r\n      pkgxBrandId: selectedPkgxBrand ? parseInt(selectedPkgxBrand) : '',\r\n      pkgxBrandName: settings.brands.find(b => b.id === parseInt(selectedPkgxBrand))?.name || '',\r\n    };\r\n    \r\n    // Run final validation\r\n    const result = validation.validate(input);\r\n    \r\n    // Block if there are errors\r\n    if (!result.isValid) {\r\n      toast.error(result.errors[0]?.message || 'Vui lòng kiểm tra lại thông tin');\r\n      return;\r\n    }\r\n    \r\n    // Show warning confirmation if there are warnings and not yet confirmed\r\n    if (result.warnings.length > 0 && !showWarningConfirm) {\r\n      setShowWarningConfirm(true);\r\n      return;\r\n    }\r\n    \r\n    const hrmBrand = hrmBrands.find((b) => b.systemId === selectedHrmBrand);\r\n    const pkgxBrand = settings.brands.find((b) => b.id === parseInt(selectedPkgxBrand));\r\n    \r\n    if (!hrmBrand || !pkgxBrand) {\r\n      toast.error('Không tìm thấy thương hiệu');\r\n      return;\r\n    }\r\n    \r\n    if (editingMapping) {\r\n      updateBrandMapping(editingMapping.id, {\r\n        hrmBrandSystemId: hrmBrand.systemId,\r\n        hrmBrandName: hrmBrand.name,\r\n        pkgxBrandId: pkgxBrand.id,\r\n        pkgxBrandName: pkgxBrand.name,\r\n      });\r\n      addLog({\r\n        action: 'save_mapping',\r\n        status: 'success',\r\n        message: `Cập nhật mapping thương hiệu: ${hrmBrand.name} → ${pkgxBrand.name}`,\r\n        details: { brandId: pkgxBrand.id },\r\n      });\r\n      toast.success('Đã cập nhật mapping thương hiệu');\r\n    } else {\r\n      addBrandMapping({\r\n        id: `brandmap-${Date.now()}`,\r\n        hrmBrandSystemId: hrmBrand.systemId,\r\n        hrmBrandName: hrmBrand.name,\r\n        pkgxBrandId: pkgxBrand.id,\r\n        pkgxBrandName: pkgxBrand.name,\r\n      });\r\n      addLog({\r\n        action: 'save_mapping',\r\n        status: 'success',\r\n        message: `Thêm mapping thương hiệu: ${hrmBrand.name} → ${pkgxBrand.name}`,\r\n        details: { brandId: pkgxBrand.id },\r\n      });\r\n      toast.success('Đã thêm mapping thương hiệu');\r\n    }\r\n    \r\n    handleCloseDialog();\r\n  };\r\n  \r\n  const handleDelete = (id: string) => {\r\n    const mapping = settings.brandMappings.find(m => m.id === id);\r\n    deleteBrandMapping(id);\r\n    if (mapping) {\r\n      addLog({\r\n        action: 'save_mapping',\r\n        status: 'info',\r\n        message: `Xóa mapping thương hiệu: ${mapping.hrmBrandName}`,\r\n        details: { brandId: mapping.pkgxBrandId },\r\n      });\r\n    }\r\n    toast.success('Đã xóa mapping thương hiệu');\r\n  };\r\n  \r\n  const handleSyncFromPkgx = async () => {\r\n    setIsSyncing(true);\r\n    try {\r\n      await syncBrandsFromPkgx();\r\n      toast.success('Đã đồng bộ thương hiệu từ PKGX');\r\n    } catch (error) {\r\n      toast.error(error instanceof Error ? error.message : 'Lỗi khi đồng bộ thương hiệu');\r\n    } finally {\r\n      setIsSyncing(false);\r\n    }\r\n  };\r\n  \r\n  // View brand detail\r\n  const handleViewDetail = async (pkgxBrandId: number) => {\r\n    setIsLoadingDetail(true);\r\n    setIsDetailDialogOpen(true);\r\n    try {\r\n      const response = await getBrandById(pkgxBrandId);\r\n      if (response.success && response.data) {\r\n        setSelectedBrandForDetail(response.data);\r\n      } else {\r\n        toast.error('Không tìm thấy thương hiệu');\r\n        setIsDetailDialogOpen(false);\r\n      }\r\n    } catch (error) {\r\n      toast.error('Không thể tải thông tin thương hiệu');\r\n      setIsDetailDialogOpen(false);\r\n    } finally {\r\n      setIsLoadingDetail(false);\r\n    }\r\n  };\r\n  \r\n  // Push brand from HRM to PKGX\r\n  const handlePushBrand = async (pkgxBrandId: number) => {\r\n    const mapping = findMapping(pkgxBrandId);\r\n    if (!mapping) {\r\n      toast.error('Thương hiệu chưa được mapping với HRM');\r\n      return;\r\n    }\r\n    \r\n    const hrmBrand = hrmBrands.find(b => b.systemId === mapping.hrmBrandSystemId);\r\n    if (!hrmBrand) {\r\n      toast.error('Không tìm thấy thương hiệu HRM');\r\n      return;\r\n    }\r\n    \r\n    setIsPushing(true);\r\n    try {\r\n      await updateBrand(pkgxBrandId, {\r\n        brand_name: hrmBrand.name,\r\n        brand_desc: hrmBrand.description || '',\r\n        site_url: '',\r\n      });\r\n      \r\n      // Refresh detail\r\n      const response = await getBrandById(pkgxBrandId);\r\n      if (response.success && response.data) {\r\n        setSelectedBrandForDetail(response.data);\r\n      }\r\n      \r\n      addLog({\r\n        action: 'sync_all',\r\n        status: 'success',\r\n        message: `Đẩy thương hiệu từ HRM sang PKGX: ${hrmBrand.name}`,\r\n        details: { brandId: pkgxBrandId },\r\n      });\r\n      toast.success('Đã đẩy thông tin thương hiệu sang PKGX');\r\n    } catch (error) {\r\n      toast.error(error instanceof Error ? error.message : 'Lỗi khi đẩy thương hiệu');\r\n    } finally {\r\n      setIsPushing(false);\r\n    }\r\n  };\r\n  \r\n  // Mobile card renderers\r\n  const renderPkgxMobileCard = (row: PkgxBrandRow) => (\r\n    <div className=\"p-4 space-y-3\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <div>\r\n          <div className=\"font-medium\">{row.name}</div>\r\n          <div className=\"text-sm text-muted-foreground\">ID: {row.id}</div>\r\n        </div>\r\n        {row.mappedToHrm ? (\r\n          <Badge variant=\"default\" className=\"bg-green-500 shrink-0\">\r\n            <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n            Đã mapping\r\n          </Badge>\r\n        ) : (\r\n          <Badge variant=\"secondary\" className=\"shrink-0\">Chưa mapping</Badge>\r\n        )}\r\n      </div>\r\n      {row.mappedToHrm && (\r\n        <div className=\"text-sm\">\r\n          <span className=\"text-muted-foreground\">HRM: </span>\r\n          <span>{row.mappedToHrm}</span>\r\n        </div>\r\n      )}\r\n      {!row.mappedToHrm && (\r\n        <Button\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          className=\"w-full\"\r\n          onClick={() => handleQuickMap(row)}\r\n        >\r\n          <Link className=\"h-4 w-4 mr-2\" />\r\n          Mapping nhanh\r\n        </Button>\r\n      )}\r\n    </div>\r\n  );\r\n  \r\n  const renderMappingMobileCard = (row: MappingRow) => (\r\n    <div className=\"p-4 space-y-3\">\r\n      <div>\r\n        <div className=\"font-medium\">{row.hrmBrandName}</div>\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          → {row.pkgxBrandName} (ID: {row.pkgxBrandId})\r\n        </div>\r\n      </div>\r\n      <div className=\"flex gap-2\">\r\n        <Button variant=\"outline\" size=\"sm\" className=\"flex-1\" onClick={() => handleOpenDialog(row)}>\r\n          <Pencil className=\"h-4 w-4 mr-2\" />\r\n          Sửa\r\n        </Button>\r\n        <Button variant=\"outline\" size=\"sm\" className=\"flex-1\" onClick={() => handleDelete(row.id)}>\r\n          <Trash2 className=\"h-4 w-4 mr-2 text-destructive\" />\r\n          Xóa\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n  \r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n            <div>\r\n              <CardTitle className=\"text-lg\">Mapping thương hiệu</CardTitle>\r\n              <CardDescription>\r\n                Liên kết thương hiệu HRM với thương hiệu PKGX để đồng bộ sản phẩm\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <Button onClick={handleSyncFromPkgx} disabled={isSyncing} variant=\"outline\">\r\n                {isSyncing ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <RefreshCw className=\"h-4 w-4 mr-2\" />}\r\n                Đồng bộ từ PKGX\r\n              </Button>\r\n              <Button onClick={() => handleOpenDialog()}>\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                Thêm mapping\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-2\">\r\n              <div className=\"relative flex-1\">\r\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Tìm kiếm thương hiệu...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-9\"\r\n                />\r\n              </div>\r\n              <div className=\"text-sm text-muted-foreground whitespace-nowrap text-center sm:text-right\">\r\n                {settings.brands.length} thương hiệu PKGX | {settings.brandMappings.length} mapping\r\n              </div>\r\n            </div>\r\n            \r\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n              <TabsList>\r\n                <TabsTrigger value=\"pkgx-brands\">\r\n                  <Award className=\"h-4 w-4 mr-2\" />\r\n                  Thương hiệu PKGX ({settings.brands.length})\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"mappings\">\r\n                  <Link className=\"h-4 w-4 mr-2\" />\r\n                  Mapping ({settings.brandMappings.length})\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"pkgx-brands\" className=\"mt-4\">\r\n                {settings.brands.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-muted-foreground\">\r\n                    <Award className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>Chưa có thương hiệu từ PKGX.</p>\r\n                    <p className=\"text-sm mt-1\">Bấm \"Đồng bộ từ PKGX\" để lấy danh sách.</p>\r\n                  </div>\r\n                ) : (\r\n                  <ResponsiveDataTable\r\n                    columns={pkgxColumns}\r\n                    data={paginatedPkgxData}\r\n                    renderMobileCard={renderPkgxMobileCard}\r\n                    pageCount={Math.ceil(pkgxBrandsData.length / pagination.pageSize)}\r\n                    pagination={pagination}\r\n                    setPagination={setPagination}\r\n                    rowCount={pkgxBrandsData.length}\r\n                    sorting={sorting}\r\n                    setSorting={setSorting}\r\n                    rowSelection={rowSelection}\r\n                    setRowSelection={setRowSelection}\r\n                    bulkActions={pkgxBulkActions}\r\n                    allSelectedRows={allSelectedPkgxRows}\r\n                    emptyTitle=\"Không tìm thấy thương hiệu\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"mappings\" className=\"mt-4\">\r\n                {settings.brandMappings.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-muted-foreground\">\r\n                    <Link className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>Chưa có mapping nào.</p>\r\n                    <p className=\"text-sm mt-1\">Bấm \"Thêm mapping\" để bắt đầu.</p>\r\n                  </div>\r\n                ) : (\r\n                  <ResponsiveDataTable\r\n                    columns={mappingColumns}\r\n                    data={paginatedMappingsData}\r\n                    renderMobileCard={renderMappingMobileCard}\r\n                    pageCount={Math.ceil(mappingsData.length / pagination.pageSize)}\r\n                    pagination={pagination}\r\n                    setPagination={setPagination}\r\n                    rowCount={mappingsData.length}\r\n                    sorting={sorting}\r\n                    setSorting={setSorting}\r\n                    emptyTitle=\"Không tìm thấy mapping\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Mapping Dialog - Using shared PkgxMappingDialog component */}\r\n      <PkgxMappingDialog\r\n        open={isDialogOpen}\r\n        onOpenChange={setIsDialogOpen}\r\n        type=\"brand\"\r\n        isEditing={!!editingMapping}\r\n        hrmItems={hrmBrands.map((b) => ({\r\n          id: b.systemId,\r\n          name: b.name,\r\n        }))}\r\n        selectedHrmId={selectedHrmBrand}\r\n        onSelectHrmId={setSelectedHrmBrand}\r\n        pkgxItems={settings.brands.map((b) => ({\r\n          id: b.id.toString(),\r\n          name: b.name,\r\n          subText: `ID: ${b.id}`,\r\n        }))}\r\n        selectedPkgxId={selectedPkgxBrand}\r\n        onSelectPkgxId={setSelectedPkgxBrand}\r\n        pkgxSuggestions={validation.suggestions.map(s => ({\r\n          item: { id: s.brand.id.toString(), name: s.brand.name },\r\n          score: s.score,\r\n        }))}\r\n        validation={validation.validationResult}\r\n        hasErrors={validation.hasErrors}\r\n        isValidating={validation.isValidating}\r\n        showWarningConfirm={showWarningConfirm}\r\n        onConfirm={handleSave}\r\n        onCancel={handleCloseDialog}\r\n      />\r\n      \r\n      {/* Brand Detail Dialog */}\r\n      <Dialog open={isDetailDialogOpen} onOpenChange={setIsDetailDialogOpen}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Award className=\"h-5 w-5\" />\r\n              Chi tiết thương hiệu PKGX\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              Thông tin chi tiết và SEO của thương hiệu\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          \r\n          {isLoadingDetail ? (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n          ) : selectedBrandForDetail ? (\r\n            <ScrollArea className=\"max-h-[60vh]\">\r\n              <div className=\"space-y-6 pr-4\">\r\n                {/* Basic Info */}\r\n                <div className=\"space-y-3\">\r\n                  <h4 className=\"font-medium text-sm text-muted-foreground uppercase tracking-wide\">\r\n                    Thông tin cơ bản\r\n                  </h4>\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">ID:</span>\r\n                      <span className=\"ml-2 font-mono\">{selectedBrandForDetail.brand_id}</span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Tên:</span>\r\n                      <span className=\"ml-2 font-medium\">{selectedBrandForDetail.brand_name}</span>\r\n                    </div>\r\n                    {selectedBrandForDetail.brand_logo && (\r\n                      <div className=\"col-span-2\">\r\n                        <span className=\"text-muted-foreground\">Logo:</span>\r\n                        <img \r\n                          src={selectedBrandForDetail.brand_logo} \r\n                          alt={selectedBrandForDetail.brand_name}\r\n                          className=\"mt-2 h-16 object-contain\"\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* SEO Info */}\r\n                <div className=\"space-y-3\">\r\n                  <h4 className=\"font-medium text-sm text-muted-foreground uppercase tracking-wide\">\r\n                    SEO & Mô tả\r\n                  </h4>\r\n                  <div className=\"space-y-3 text-sm\">\r\n                    <div>\r\n                      <span className=\"text-muted-foreground block mb-1\">Website:</span>\r\n                      {selectedBrandForDetail.site_url ? (\r\n                        <a \r\n                          href={selectedBrandForDetail.site_url} \r\n                          target=\"_blank\" \r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"text-primary hover:underline\"\r\n                        >\r\n                          {selectedBrandForDetail.site_url}\r\n                        </a>\r\n                      ) : (\r\n                        <span className=\"text-muted-foreground italic\">Chưa có</span>\r\n                      )}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-muted-foreground block mb-1\">Mô tả:</span>\r\n                      {selectedBrandForDetail.brand_desc ? (\r\n                        <div \r\n                          className=\"prose prose-sm dark:prose-invert max-w-none bg-muted/30 rounded-md p-3\"\r\n                          dangerouslySetInnerHTML={{ __html: selectedBrandForDetail.brand_desc }}\r\n                        />\r\n                      ) : (\r\n                        <span className=\"text-muted-foreground italic\">Chưa có mô tả</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* Mapping Info */}\r\n                <div className=\"space-y-3\">\r\n                  <h4 className=\"font-medium text-sm text-muted-foreground uppercase tracking-wide\">\r\n                    Trạng thái mapping\r\n                  </h4>\r\n                  {findMapping(selectedBrandForDetail.brand_id) ? (\r\n                    <div className=\"bg-green-500/10 border border-green-500/20 rounded-md p-3\">\r\n                      <Badge variant=\"default\" className=\"bg-green-500 mb-2\">\r\n                        <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n                        Đã mapping\r\n                      </Badge>\r\n                      <p className=\"text-sm\">\r\n                        HRM: <span className=\"font-medium\">{findMapping(selectedBrandForDetail.brand_id)?.hrmBrandName}</span>\r\n                      </p>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"bg-muted/50 rounded-md p-3\">\r\n                      <Badge variant=\"secondary\">Chưa mapping</Badge>\r\n                      <p className=\"text-sm text-muted-foreground mt-2\">\r\n                        Thương hiệu này chưa được liên kết với HRM\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </ScrollArea>\r\n          ) : null}\r\n          \r\n          <DialogFooter className=\"gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => window.open(`https://phukiengiaxuong.com.vn/admin/brand.php?act=edit&brand_id=${selectedBrandForDetail?.brand_id}`, '_blank')}\r\n              disabled={!selectedBrandForDetail}\r\n            >\r\n              <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n              Xem trên PKGX\r\n            </Button>\r\n            {selectedBrandForDetail && findMapping(selectedBrandForDetail.brand_id) && (\r\n              <Button\r\n                onClick={() => handlePushBrand(selectedBrandForDetail.brand_id)}\r\n                disabled={isPushing}\r\n              >\r\n                {isPushing ? (\r\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                ) : (\r\n                  <Upload className=\"h-4 w-4 mr-2\" />\r\n                )}\r\n                Đẩy HRM → PKGX\r\n              </Button>\r\n            )}\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      {/* Confirmation Dialog for sync actions - using shared component */}\r\n      <PkgxSyncConfirmDialog\r\n        confirmAction={entitySync.confirmAction}\r\n        isSyncing={entitySync.isSyncing}\r\n        onConfirm={entitySync.executeAction}\r\n        onCancel={entitySync.cancelConfirm}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4659, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/price-mapping-tab.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Label } from '../../../../components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../../components/ui/select';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Save } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport { usePricingPolicyStore } from '../../pricing/store';\r\nimport { PKGX_PRICE_FIELDS } from '../constants';\r\nimport type { SystemId } from '../../../../lib/id-types';\r\n\r\nexport function PriceMappingTab() {\r\n  const { settings, updatePriceMapping, addLog } = usePkgxSettingsStore();\r\n  const pricingPolicies = usePricingPolicyStore((state) => state.data);\r\n\r\n  // Filter only selling price policies\r\n  const sellingPolicies = pricingPolicies.filter((p) => p.type === 'Bán hàng' && p.isActive);\r\n\r\n  const handleChange = (field: keyof typeof settings.priceMapping, value: string) => {\r\n    updatePriceMapping(field, value === 'none' ? null : (value as SystemId));\r\n  };\r\n\r\n  const handleSave = () => {\r\n    // Log the mapping save\r\n    const mappingSummary = PKGX_PRICE_FIELDS\r\n      .filter(pf => settings.priceMapping[pf.key as keyof typeof settings.priceMapping])\r\n      .map(pf => {\r\n        const policyId = settings.priceMapping[pf.key as keyof typeof settings.priceMapping];\r\n        const policy = pricingPolicies.find(p => p.systemId === policyId);\r\n        return `${pf.field} → ${policy?.name || policyId}`;\r\n      })\r\n      .join(', ');\r\n    \r\n    addLog({\r\n      action: 'save_mapping',\r\n      status: 'success',\r\n      message: 'Đã lưu mapping bảng giá',\r\n      details: {\r\n        total: PKGX_PRICE_FIELDS.filter(pf => settings.priceMapping[pf.key as keyof typeof settings.priceMapping]).length,\r\n      }\r\n    });\r\n    \r\n    toast.success('Đã lưu mapping bảng giá');\r\n  };\r\n\r\n  const getPolicyName = (policyId: SystemId | null) => {\r\n    if (!policyId) return '-- Không áp dụng --';\r\n    const policy = pricingPolicies.find((p) => p.systemId === policyId);\r\n    return policy?.name || policyId;\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle className=\"text-lg\">Mapping Bảng giá HRM → PKGX</CardTitle>\r\n        <CardDescription>\r\n          Chọn bảng giá trong HRM tương ứng với mỗi loại giá trên PKGX\r\n        </CardDescription>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        {PKGX_PRICE_FIELDS.map((priceField) => (\r\n          <div key={priceField.key} className=\"grid grid-cols-1 md:grid-cols-2 gap-4 items-start\">\r\n            <div>\r\n              <Label className=\"text-base font-medium\">{priceField.label}</Label>\r\n              <p className=\"text-sm text-muted-foreground\">{priceField.description}</p>\r\n            </div>\r\n            <Select\r\n              value={settings.priceMapping[priceField.key as keyof typeof settings.priceMapping] || 'none'}\r\n              onValueChange={(value) => handleChange(priceField.key as keyof typeof settings.priceMapping, value)}\r\n            >\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Chọn bảng giá...\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"none\">-- Không áp dụng --</SelectItem>\r\n                {sellingPolicies.map((policy) => (\r\n                  <SelectItem key={policy.systemId} value={policy.systemId}>\r\n                    {policy.name}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        ))}\r\n\r\n        <div className=\"pt-4 border-t\">\r\n          <h4 className=\"font-medium mb-2\">Tóm tắt mapping hiện tại:</h4>\r\n          <div className=\"bg-muted p-4 rounded-lg text-sm space-y-1\">\r\n            {PKGX_PRICE_FIELDS.map((priceField) => (\r\n              <div key={priceField.key} className=\"flex justify-between\">\r\n                <span className=\"text-muted-foreground\">{priceField.field}:</span>\r\n                <span className=\"font-medium\">\r\n                  {getPolicyName(settings.priceMapping[priceField.key as keyof typeof settings.priceMapping])}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end pt-4\">\r\n          <Button onClick={handleSave}>\r\n            <Save className=\"h-4 w-4 mr-2\" />\r\n            Lưu mapping\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4930, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/product-mapping-tab.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Input } from '../../../../components/ui/input';\r\nimport { Badge } from '../../../../components/ui/badge';\r\nimport { Switch } from '../../../../components/ui/switch';\r\nimport { Checkbox } from '../../../../components/ui/checkbox';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '../../../../components/ui/dialog';\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '../../../../components/ui/alert-dialog';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../../components/ui/select';\r\nimport { Label } from '../../../../components/ui/label';\r\nimport { ScrollArea } from '../../../../components/ui/scroll-area';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../../../../components/ui/tabs';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '../../../../components/ui/dropdown-menu';\r\nimport { Search, ExternalLink, Link, Unlink, RefreshCw, Loader2, CheckCircle2, Upload, ArrowRight, Settings2, MoreHorizontal, Eye, TriangleAlert, Package, DollarSign, FileText, Link2, ImageIcon, Flame, Sparkles, Home, Star, ShoppingBag, Circle, XCircle, Trash2, AlertCircle, Lightbulb, AlertTriangle, AlignLeft, Tag, Image } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { useProductStore } from '../../../products/store';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport { getProducts as fetchPkgxProducts, updateProduct as updatePkgxProduct, getProductById as fetchPkgxProductById, getProductGallery as fetchPkgxGallery } from '../../../../lib/pkgx/api-service';\r\nimport type { PkgxProduct, PkgxGalleryImage } from '../types';\r\nimport type { SystemId } from '../../../../lib/id-types';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '../../../../components/ui/tooltip';\r\nimport { ResponsiveDataTable } from '../../../../components/data-table/responsive-data-table';\r\nimport { useAuth, getCurrentUserName } from '../../../../contexts/auth-context';\r\nimport { Alert, AlertDescription, AlertTitle } from '../../../../components/ui/alert';\r\nimport { useProductMappingValidation } from '../hooks/use-product-mapping-validation';\r\nimport { usePkgxEntitySync } from '../hooks';\r\nimport type { HrmProductData } from '../hooks';\r\nimport type { ProductMappingInput } from '../validation/product-mapping-validation';\r\nimport { PkgxMappingDialog } from '../../../../components/shared/pkgx-mapping-dialog';\r\nimport { PkgxSyncConfirmDialog } from './pkgx-sync-confirm-dialog';\r\nimport type { ColumnDef } from '../../../../components/data-table/types';\r\n\r\n// ========================================\r\n// Mobile Dropdown Helper Component\r\n// ========================================\r\ninterface MobileProductDropdownProps {\r\n  row: PkgxProductRow;\r\n  entitySync: ReturnType<typeof usePkgxEntitySync>;\r\n  onViewOnPkgx: (goodsId: number) => void;\r\n  onOpenLinkDialog: (row: PkgxProduct) => void;\r\n  onOpenUnlinkDialog: (row: PkgxProduct) => void;\r\n}\r\n\r\nfunction MobileProductDropdown({ row, entitySync, onViewOnPkgx, onOpenLinkDialog, onOpenUnlinkDialog }: MobileProductDropdownProps) {\r\n  // Helper to build HRM product data for sync\r\n  const buildHrmData = (): HrmProductData | null => {\r\n    if (!row.linkedHrmProduct) return null;\r\n    return {\r\n      systemId: row.linkedHrmProduct.systemId,\r\n      name: row.linkedHrmProduct.name,\r\n      sku: row.linkedHrmProduct.sku,\r\n      sellingPrice: row.linkedHrmProduct.sellingPrice,\r\n      costPrice: row.linkedHrmProduct.costPrice,\r\n      dealPrice: row.linkedHrmProduct.dealPrice,\r\n      quantity: row.linkedHrmProduct.quantity,\r\n      seoKeywords: row.linkedHrmProduct.seoKeywords,\r\n      ktitle: row.linkedHrmProduct.ktitle,\r\n      seoDescription: row.linkedHrmProduct.seoDescription,\r\n      shortDescription: row.linkedHrmProduct.shortDescription,\r\n      description: row.linkedHrmProduct.description,\r\n      isBest: row.linkedHrmProduct.isBest,\r\n      isNew: row.linkedHrmProduct.isNew,\r\n      isHot: row.linkedHrmProduct.isHot,\r\n      isHome: row.linkedHrmProduct.isHome,\r\n      categorySystemId: row.linkedHrmProduct.categorySystemId,\r\n      brandSystemId: row.linkedHrmProduct.brandSystemId,\r\n    };\r\n  };\r\n  \r\n  // Helper to trigger sync with proper HRM data\r\n  const triggerSync = (actionKey: 'sync_all' | 'sync_basic' | 'sync_seo' | 'sync_description' | 'sync_price' | 'sync_inventory' | 'sync_flags') => {\r\n    const hrmData = buildHrmData();\r\n    if (!hrmData) {\r\n      toast.error('Sản phẩm chưa được liên kết với HRM');\r\n      return;\r\n    }\r\n    entitySync.triggerSyncAction(actionKey, row.goods_id, hrmData, row.goods_name);\r\n  };\r\n  \r\n  return (\r\n    <DropdownMenu>\r\n      <DropdownMenuTrigger asChild>\r\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n          <MoreHorizontal className=\"h-4 w-4\" />\r\n        </Button>\r\n      </DropdownMenuTrigger>\r\n      <DropdownMenuContent align=\"end\">\r\n        {row.linkedHrmProduct ? (\r\n          <>\r\n            {/* Sync All */}\r\n            <DropdownMenuItem \r\n              onClick={() => triggerSync('sync_all')}\r\n              className=\"font-medium\"\r\n            >\r\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n              Đồng bộ tất cả\r\n            </DropdownMenuItem>\r\n            <DropdownMenuSeparator />\r\n            <DropdownMenuItem onClick={() => triggerSync('sync_basic')}>\r\n              <FileText className=\"h-4 w-4 mr-2\" />\r\n              Thông tin cơ bản\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={() => triggerSync('sync_price')}>\r\n              <DollarSign className=\"h-4 w-4 mr-2\" />\r\n              Giá\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={() => triggerSync('sync_inventory')}>\r\n              <Package className=\"h-4 w-4 mr-2\" />\r\n              Tồn kho\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={() => triggerSync('sync_seo')}>\r\n              <Search className=\"h-4 w-4 mr-2\" />\r\n              SEO\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={() => triggerSync('sync_description')}>\r\n              <AlignLeft className=\"h-4 w-4 mr-2\" />\r\n              Mô tả\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={() => triggerSync('sync_flags')}>\r\n              <Tag className=\"h-4 w-4 mr-2\" />\r\n              Flags\r\n            </DropdownMenuItem>\r\n            \r\n            <DropdownMenuSeparator />\r\n            <DropdownMenuItem onClick={() => onViewOnPkgx(row.goods_id)}>\r\n              <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n              Xem trên PKGX\r\n            </DropdownMenuItem>\r\n            \r\n            <DropdownMenuSeparator />\r\n            <DropdownMenuItem \r\n              onClick={() => onOpenUnlinkDialog(row)}\r\n              className=\"text-destructive focus:text-destructive\"\r\n            >\r\n              <Unlink className=\"h-4 w-4 mr-2\" />\r\n              Hủy liên kết\r\n            </DropdownMenuItem>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <DropdownMenuItem onClick={() => onOpenLinkDialog(row)}>\r\n              <Link2 className=\"h-4 w-4 mr-2\" />\r\n              Liên kết với HRM\r\n            </DropdownMenuItem>\r\n          </>\r\n        )}\r\n      </DropdownMenuContent>\r\n    </DropdownMenu>\r\n  );\r\n}\r\n\r\n// ========================================\r\n// PKGX Sync Fields Configuration\r\n// ========================================\r\n// \r\n// QUAN TRỌNG - Cấu trúc ID:\r\n// - goods_id (PKGX): PRIMARY KEY - Dùng cho TẤT CẢ API calls (update, delete, link)\r\n// - goods_sn (PKGX) = sku (HRM): Mã SKU sản phẩm, có thể sync 2 chiều\r\n// - pkgxId (HRM Product): Lưu trữ goods_id để link sản phẩm\r\n//\r\n// Sync fields configuration - HRM to PKGX (push only)\r\n// Giá sử dụng cấu hình từ tab \"Mapping giá\" (không chọn từng trường)\r\nconst PUSH_SYNC_FIELDS = [\r\n  // Thông tin cơ bản\r\n  { key: 'goods_name', label: 'Tên sản phẩm', hrmField: 'name', group: 'basic' },\r\n  { key: 'goods_sn', label: 'Mã SKU', hrmField: 'sku', group: 'basic' },\r\n  { key: 'goods_brief', label: 'Mô tả ngắn', hrmField: 'shortDescription', group: 'basic' },\r\n  { key: 'goods_desc', label: 'Mô tả chi tiết', hrmField: 'description', group: 'basic' },\r\n  \r\n  // Giá cả - Một toggle cho tất cả, sử dụng mapping từ tab Mapping giá\r\n  { key: 'sync_prices', label: 'Đồng bộ giá (theo cấu hình Mapping giá)', hrmField: 'prices', group: 'price', isSpecial: true },\r\n  \r\n  // Tồn kho\r\n  { key: 'goods_number', label: 'Số lượng tồn', hrmField: 'quantity', group: 'inventory' },\r\n  \r\n  // Phân loại\r\n  { key: 'cat_id', label: 'Danh mục', hrmField: 'categoryId', group: 'classification' },\r\n  { key: 'brand_id', label: 'Thương hiệu', hrmField: 'brandId', group: 'classification' },\r\n  \r\n  // SEO\r\n  { key: 'keywords', label: 'Từ khóa SEO', hrmField: 'seoKeywords', group: 'seo' },\r\n  { key: 'meta_title', label: 'Tiêu đề SEO', hrmField: 'ktitle', group: 'seo' },\r\n  { key: 'meta_desc', label: 'Mô tả SEO', hrmField: 'seoDescription', group: 'seo' },\r\n  \r\n  // Trạng thái hiển thị\r\n  { key: 'best', label: 'SP tốt nhất', hrmField: 'isBest', group: 'display' },\r\n  { key: 'hot', label: 'SP hot', hrmField: 'isHot', group: 'display' },\r\n  { key: 'new', label: 'SP mới', hrmField: 'isNew', group: 'display' },\r\n  { key: 'ishome', label: 'Hiển thị trang chủ', hrmField: 'isHome', group: 'display' },\r\n  \r\n  // Ghi chú\r\n  { key: 'seller_note', label: 'Ghi chú người bán', hrmField: 'sellerNote', group: 'other' },\r\n] as const;\r\n\r\ntype PushSyncFieldKey = typeof PUSH_SYNC_FIELDS[number]['key'];\r\n\r\n// Extended type for table display - MUST have systemId for ResponsiveDataTable\r\ninterface PkgxProductRow extends PkgxProduct {\r\n  systemId: string; // Required by ResponsiveDataTable - use goods_id.toString()\r\n  linkedHrmProduct?: {\r\n    systemId: string;\r\n    name: string;\r\n    id: string;\r\n    sku?: string;\r\n    // Giá cả\r\n    sellingPrice?: number;\r\n    costPrice?: number;\r\n    partnerPrice?: number;\r\n    acePrice?: number;\r\n    dealPrice?: number;\r\n    // Tồn kho\r\n    quantity?: number;\r\n    // Nội dung\r\n    description?: string;\r\n    shortDescription?: string;\r\n    // SEO\r\n    seoDescription?: string;\r\n    seoKeywords?: string;\r\n    ktitle?: string;\r\n    // Phân loại\r\n    categorySystemId?: SystemId;\r\n    brandSystemId?: SystemId;\r\n    // Trạng thái\r\n    isBest?: boolean;\r\n    isHot?: boolean;\r\n    isNew?: boolean;\r\n    isHome?: boolean;\r\n    // Khác\r\n    sellerNote?: string;\r\n  };\r\n}\r\n\r\nexport function ProductMappingTab() {\r\n  // Router & Auth\r\n  const router = useRouter();\r\n  const { user } = useAuth();\r\n  \r\n  // Stores\r\n  const { settings, addLog, getPkgxCatIdByHrmCategory, getPkgxBrandIdByHrmBrand, setPkgxProducts } = usePkgxSettingsStore();\r\n  const productStore = useProductStore();\r\n  \r\n  const [searchTerm, setSearchTerm] = React.useState('');\r\n  const [isSyncing, setIsSyncing] = React.useState(false);\r\n  \r\n  // Sử dụng pkgxProducts từ store (dùng chung với Link Dialog)\r\n  const pkgxProducts = settings.pkgxProducts || [];\r\n  \r\n  // Auto-fetch khi vào tab nếu chưa có data và PKGX đã được cấu hình\r\n  const hasAutoFetched = React.useRef(false);\r\n  \r\n  // Helper function để build URL ảnh PKGX\r\n  const buildPkgxImageUrl = React.useCallback((imagePath: string | undefined | null): string => {\r\n    if (!imagePath) return '';\r\n    if (imagePath.startsWith('http')) return imagePath;\r\n    // Xóa / ở đầu nếu có và build URL đầy đủ với /cdn/\r\n    const cleanPath = imagePath.replace(/^\\/+/, '');\r\n    return `https://phukiengiaxuong.com.vn/cdn/${cleanPath}`;\r\n  }, []);\r\n  \r\n  // Product detail dialog state\r\n  const [isDetailDialogOpen, setIsDetailDialogOpen] = React.useState(false);\r\n  const [selectedProductForDetail, setSelectedProductForDetail] = React.useState<PkgxProductRow | null>(null);\r\n  const [isLoadingProductDetail, setIsLoadingProductDetail] = React.useState(false);\r\n  \r\n  // Gallery state\r\n  const [galleryImages, setGalleryImages] = React.useState<PkgxGalleryImage[]>([]);\r\n  const [isLoadingGallery, setIsLoadingGallery] = React.useState(false);\r\n  \r\n  // Link dialog state\r\n  const [selectedPkgxProduct, setSelectedPkgxProduct] = React.useState<PkgxProduct | null>(null);\r\n  const [isLinkDialogOpen, setIsLinkDialogOpen] = React.useState(false);\r\n  const [selectedHrmProductId, setSelectedHrmProductId] = React.useState('');\r\n  const [showWarningConfirm, setShowWarningConfirm] = React.useState(false);\r\n  \r\n  // Unlink dialog state\r\n  const [isUnlinkDialogOpen, setIsUnlinkDialogOpen] = React.useState(false);\r\n  const [productToUnlink, setProductToUnlink] = React.useState<{ pkgxProduct: PkgxProduct; hrmProduct: any } | null>(null);\r\n  \r\n  // Row selection state\r\n  const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({});\r\n  \r\n  // Bulk unlink dialog state\r\n  const [isBulkUnlinkDialogOpen, setIsBulkUnlinkDialogOpen] = React.useState(false);\r\n  \r\n  // Use shared PKGX entity sync hook\r\n  const entitySync = usePkgxEntitySync({\r\n    entityType: 'product',\r\n    onLog: addLog,\r\n    getPkgxCatIdByHrmCategory,\r\n    getPkgxBrandIdByHrmBrand,\r\n  });\r\n  \r\n  // Sync dialog state - Push (HRM to PKGX) - Default basic fields + prices\r\n  const [isPushDialogOpen, setIsPushDialogOpen] = React.useState(false);\r\n  const [productToPush, setProductToPush] = React.useState<PkgxProductRow | null>(null);\r\n  const [selectedPushFields, setSelectedPushFields] = React.useState<PushSyncFieldKey[]>(['goods_name', 'sync_prices', 'goods_number']);\r\n  const [isPushingProduct, setIsPushingProduct] = React.useState(false);\r\n  \r\n  // HRM products - sử dụng productStore.data trực tiếp để đảm bảo reactive\r\n  const hrmProducts = React.useMemo(\r\n    () => productStore.data.filter(p => !p.isDeleted).sort((a, b) => a.name.localeCompare(b.name)),\r\n    [productStore.data]\r\n  );\r\n  \r\n  // Validation hook\r\n  const validation = useProductMappingValidation({\r\n    hrmProducts: hrmProducts.map(p => ({\r\n      systemId: p.systemId,\r\n      name: p.name,\r\n      id: p.id,\r\n      pkgxId: p.pkgxId,\r\n      status: p.status,\r\n    })),\r\n    pkgxProducts: pkgxProducts,\r\n    editingProductId: undefined,\r\n    debounceMs: 300,\r\n  });\r\n  \r\n  // Count of linked HRM products\r\n  const linkedCount = React.useMemo(\r\n    () => hrmProducts.filter((p) => p.pkgxId).length,\r\n    [hrmProducts]\r\n  );\r\n  \r\n  // Find HRM product linked to a PKGX product\r\n  // FIX: Sử dụng == thay vì === để handle cả string và number (localStorage có thể lưu string)\r\n  const findLinkedHrmProduct = React.useCallback((pkgxId: number) => {\r\n    return hrmProducts.find((p) => p.pkgxId == pkgxId);\r\n  }, [hrmProducts]);\r\n  \r\n  // Filter and transform PKGX products\r\n  const tableData = React.useMemo((): PkgxProductRow[] => {\r\n    let filtered = pkgxProducts;\r\n    if (searchTerm) {\r\n      const term = searchTerm.toLowerCase();\r\n      filtered = pkgxProducts.filter(\r\n        (p) =>\r\n          p.goods_name.toLowerCase().includes(term) ||\r\n          p.goods_sn?.toLowerCase().includes(term) ||\r\n          p.goods_id.toString().includes(term)\r\n      );\r\n    }\r\n    \r\n    return filtered.map((p) => {\r\n      const linked = findLinkedHrmProduct(p.goods_id);\r\n      // Calculate total inventory from all branches\r\n      const totalInventory = linked \r\n        ? Object.values(linked.inventoryByBranch || {}).reduce((sum, qty) => sum + qty, 0)\r\n        : 0;\r\n      \r\n      return {\r\n        ...p,\r\n        linkedHrmProduct: linked ? {\r\n          systemId: linked.systemId,\r\n          name: linked.name,\r\n          id: linked.id,\r\n          sku: (linked as any).sku,\r\n          // Giá cả\r\n          sellingPrice: linked.sellingPrice,\r\n          costPrice: linked.costPrice,\r\n          partnerPrice: (linked as any).partnerPrice,\r\n          acePrice: (linked as any).acePrice,\r\n          dealPrice: (linked as any).dealPrice,\r\n          // Tồn kho\r\n          quantity: totalInventory,\r\n          // Nội dung\r\n          description: linked.description,\r\n          shortDescription: linked.shortDescription,\r\n          // SEO\r\n          seoDescription: linked.seoDescription,\r\n          seoKeywords: (linked as any).seoKeywords,\r\n          ktitle: linked.ktitle,\r\n          // Phân loại\r\n          categorySystemId: linked.categorySystemId,\r\n          brandSystemId: linked.brandSystemId,\r\n          // Trạng thái\r\n          isBest: (linked as any).isBest,\r\n          isHot: (linked as any).isHot,\r\n          isNew: (linked as any).isNew,\r\n          isHome: (linked as any).isHome,\r\n          // Khác\r\n          sellerNote: (linked as any).sellerNote,\r\n        } : undefined,\r\n        // Required by ResponsiveDataTable\r\n        systemId: p.goods_id.toString(),\r\n      };\r\n    });\r\n  }, [pkgxProducts, searchTerm, findLinkedHrmProduct]);\r\n  \r\n  // Pagination state for ResponsiveDataTable\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 20 });\r\n  const [sorting, setSorting] = React.useState<{ id: string; desc: boolean }>({ id: 'goods_id', desc: true });\r\n  \r\n  // Paginated data for ResponsiveDataTable\r\n  const pageCount = Math.ceil(tableData.length / pagination.pageSize);\r\n  const paginatedData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    return tableData.slice(start, start + pagination.pageSize);\r\n  }, [tableData, pagination]);\r\n  \r\n  // Reset page when search changes\r\n  React.useEffect(() => {\r\n    setPagination(prev => ({ ...prev, pageIndex: 0 }));\r\n  }, [searchTerm]);\r\n  \r\n  // Column definitions for ResponsiveDataTable\r\n  const columns = React.useMemo((): ColumnDef<PkgxProductRow>[] => [\r\n    // Checkbox column\r\n    {\r\n      id: 'select',\r\n      header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n        <Checkbox\r\n          checked={isAllPageRowsSelected ? true : isSomePageRowsSelected ? \"indeterminate\" : false}\r\n          onCheckedChange={(value) => onToggleAll?.(!!value)}\r\n          aria-label=\"Select all\"\r\n        />\r\n      ),\r\n      cell: ({ onToggleSelect, isSelected }) => (\r\n        <Checkbox\r\n          checked={isSelected}\r\n          onCheckedChange={onToggleSelect}\r\n          aria-label=\"Select row\"\r\n        />\r\n      ),\r\n      size: 40,\r\n      meta: { displayName: 'Chọn', excludeFromExport: true },\r\n    },\r\n    {\r\n      id: 'goods_id',\r\n      accessorKey: 'goods_id',\r\n      header: 'ID',\r\n      size: 70,\r\n      cell: ({ row }) => (\r\n        <span className=\"font-mono text-sm text-muted-foreground\">{row.goods_id}</span>\r\n      ),\r\n      meta: { displayName: 'ID' },\r\n    },\r\n    {\r\n      id: 'goods_sn',\r\n      accessorKey: 'goods_sn',\r\n      header: 'Mã SP',\r\n      size: 100,\r\n      cell: ({ row }) => (\r\n        <span className=\"font-mono text-xs truncate block max-w-[90px]\" title={row.goods_sn || '-'}>\r\n          {row.goods_sn || '-'}\r\n        </span>\r\n      ),\r\n      meta: { displayName: 'Mã SP' },\r\n    },\r\n    {\r\n      id: 'goods_name',\r\n      accessorKey: 'goods_name',\r\n      header: 'Tên sản phẩm PKGX',\r\n      size: 300,\r\n      cell: ({ row }) => (\r\n        <button\r\n          className=\"font-medium line-clamp-2 text-left hover:text-primary hover:underline cursor-pointer\"\r\n          title={`Click để xem chi tiết: ${row.goods_name}`}\r\n          onClick={() => handleOpenDetailDialog(row)}\r\n        >\r\n          {row.goods_name}\r\n        </button>\r\n      ),\r\n      meta: { displayName: 'Tên sản phẩm PKGX' },\r\n    },\r\n    {\r\n      id: 'linkedHrmProduct',\r\n      header: 'Sản phẩm HRM',\r\n      size: 200,\r\n      cell: ({ row }) => (\r\n        row.linkedHrmProduct ? (\r\n          <button \r\n            className=\"text-sm truncate block max-w-[190px] text-left hover:text-primary hover:underline cursor-pointer transition-colors\" \r\n            title={`Click để xem chi tiết: ${row.linkedHrmProduct.name}`}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              // Mở trang sản phẩm trong tab mới\r\n              window.open(`/products?id=${row.linkedHrmProduct.id}`, '_blank');\r\n            }}\r\n          >\r\n            {row.linkedHrmProduct.name}\r\n          </button>\r\n        ) : (\r\n          <span className=\"text-sm text-muted-foreground\">Chưa liên kết</span>\r\n        )\r\n      ),\r\n      meta: { displayName: 'Sản phẩm HRM' },\r\n    },\r\n    {\r\n      id: 'status',\r\n      header: 'Trạng thái',\r\n      size: 110,\r\n      cell: ({ row }) => (\r\n        <div className=\"text-center\">\r\n          {row.linkedHrmProduct ? (\r\n            <Badge variant=\"default\" className=\"bg-green-500 text-xs\">\r\n              <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n              Đã liên kết\r\n            </Badge>\r\n          ) : (\r\n            <Badge variant=\"secondary\" className=\"text-xs\">\r\n              Chưa liên kết\r\n            </Badge>\r\n          )}\r\n        </div>\r\n      ),\r\n      meta: { displayName: 'Trạng thái' },\r\n    },\r\n    {\r\n      id: 'actions',\r\n      header: '',\r\n      size: 50,\r\n      cell: ({ row }) => {\r\n        // Helper to build HRM product data for sync\r\n        const buildHrmData = (): HrmProductData | null => {\r\n          if (!row.linkedHrmProduct) return null;\r\n          return {\r\n            systemId: row.linkedHrmProduct.systemId,\r\n            name: row.linkedHrmProduct.name,\r\n            sku: row.linkedHrmProduct.sku,\r\n            sellingPrice: row.linkedHrmProduct.sellingPrice,\r\n            costPrice: row.linkedHrmProduct.costPrice,\r\n            dealPrice: row.linkedHrmProduct.dealPrice,\r\n            quantity: row.linkedHrmProduct.quantity,\r\n            seoKeywords: row.linkedHrmProduct.seoKeywords,\r\n            ktitle: row.linkedHrmProduct.ktitle,\r\n            seoDescription: row.linkedHrmProduct.seoDescription,\r\n            shortDescription: row.linkedHrmProduct.shortDescription,\r\n            description: row.linkedHrmProduct.description,\r\n            isBest: row.linkedHrmProduct.isBest,\r\n            isNew: row.linkedHrmProduct.isNew,\r\n            isHot: row.linkedHrmProduct.isHot,\r\n            isHome: row.linkedHrmProduct.isHome,\r\n            categorySystemId: row.linkedHrmProduct.categorySystemId,\r\n            brandSystemId: row.linkedHrmProduct.brandSystemId,\r\n          };\r\n        };\r\n        \r\n        // Helper to trigger sync with proper HRM data\r\n        const triggerSync = (actionKey: 'sync_all' | 'sync_basic' | 'sync_seo' | 'sync_description' | 'sync_price' | 'sync_inventory' | 'sync_flags') => {\r\n          const hrmData = buildHrmData();\r\n          if (!hrmData) {\r\n            toast.error('Sản phẩm chưa được liên kết với HRM');\r\n            return;\r\n          }\r\n          entitySync.triggerSyncAction(actionKey, row.goods_id, hrmData, row.goods_name);\r\n        };\r\n        \r\n        return (\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n              {row.linkedHrmProduct ? (\r\n                <>\r\n                  {/* Sync All - Most important action */}\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_all')}\r\n                    className=\"font-medium\"\r\n                    title=\"Đồng bộ tên, SKU, giá, tồn kho, SEO, mô tả, flags\"\r\n                  >\r\n                    <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                    Đồng bộ tất cả\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuSeparator />\r\n                  \r\n                  {/* Individual sync actions */}\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_basic')}\r\n                    title=\"Tên sản phẩm, mã SKU, danh mục, thương hiệu\"\r\n                  >\r\n                    <FileText className=\"h-4 w-4 mr-2\" />\r\n                    Thông tin cơ bản\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_price')}\r\n                    title=\"Giá bán, giá thị trường, giá khuyến mãi\"\r\n                  >\r\n                    <DollarSign className=\"h-4 w-4 mr-2\" />\r\n                    Giá\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_inventory')}\r\n                    title=\"Tổng số lượng tồn kho từ tất cả chi nhánh\"\r\n                  >\r\n                    <Package className=\"h-4 w-4 mr-2\" />\r\n                    Tồn kho\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_seo')}\r\n                    title=\"Keywords, Meta Title, Meta Description\"\r\n                  >\r\n                    <Search className=\"h-4 w-4 mr-2\" />\r\n                    SEO\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_description')}\r\n                    title=\"Mô tả ngắn (goods_brief), mô tả chi tiết (goods_desc)\"\r\n                  >\r\n                    <AlignLeft className=\"h-4 w-4 mr-2\" />\r\n                    Mô tả\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => triggerSync('sync_flags')}\r\n                    title=\"Nổi bật (best), Hot, Mới (new), Trang chủ\"\r\n                  >\r\n                    <Tag className=\"h-4 w-4 mr-2\" />\r\n                    Flags\r\n                  </DropdownMenuItem>\r\n                  \r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem onClick={() => handleViewOnPkgx(row.goods_id)}>\r\n                    <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n                    Xem trên PKGX\r\n                  </DropdownMenuItem>\r\n                  \r\n                  {/* Hủy liên kết */}\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem \r\n                    onClick={() => entitySync.handleConfirm(\r\n                      'Hủy liên kết PKGX',\r\n                      `Bạn có chắc muốn hủy liên kết sản phẩm \"${row.goods_name}\" với HRM?`,\r\n                      () => handleOpenUnlinkDialog(row)\r\n                    )}\r\n                    className=\"text-destructive focus:text-destructive\"\r\n                  >\r\n                    <Unlink className=\"h-4 w-4 mr-2\" />\r\n                    Hủy liên kết\r\n                  </DropdownMenuItem>\r\n                </>\r\n              ) : (\r\n                /* Not linked - show link option */\r\n                <>\r\n                  <DropdownMenuItem onClick={() => handleOpenLinkDialog(row)}>\r\n                    <Link2 className=\"h-4 w-4 mr-2\" />\r\n                    Liên kết với HRM\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        );\r\n      },\r\n      meta: { displayName: '', excludeFromExport: true },\r\n    },\r\n  ], [hrmProducts, getPkgxCatIdByHrmCategory, getPkgxBrandIdByHrmBrand, entitySync]);\r\n  \r\n  // Mobile card renderer\r\n  const renderMobileCard = React.useCallback((row: PkgxProductRow, index: number) => (\r\n    <div className=\"p-4 space-y-3\">\r\n      <div className=\"flex items-start justify-between gap-2\">\r\n        <button \r\n          className=\"flex-1 min-w-0 text-left\"\r\n          onClick={() => handleOpenDetailDialog(row)}\r\n        >\r\n          <div className=\"font-medium line-clamp-2 hover:text-primary hover:underline\">{row.goods_name}</div>\r\n          <div className=\"text-xs text-muted-foreground mt-1\">\r\n            ID: {row.goods_id} | Mã: {row.goods_sn || '-'}\r\n          </div>\r\n        </button>\r\n        <div className=\"flex items-center gap-2\">\r\n          {row.linkedHrmProduct ? (\r\n            <Badge variant=\"default\" className=\"bg-green-500 text-xs shrink-0\">\r\n              <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n              Đã liên kết\r\n            </Badge>\r\n          ) : (\r\n            <Badge variant=\"secondary\" className=\"text-xs shrink-0\">Chưa liên kết</Badge>\r\n          )}\r\n          <MobileProductDropdown \r\n            row={row} \r\n            entitySync={entitySync}\r\n            onViewOnPkgx={handleViewOnPkgx}\r\n            onOpenLinkDialog={handleOpenLinkDialog}\r\n            onOpenUnlinkDialog={handleOpenUnlinkDialog}\r\n          />\r\n        </div>\r\n      </div>\r\n      \r\n      {row.linkedHrmProduct && (\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          <span className=\"font-medium text-foreground\">HRM:</span>{' '}\r\n          <button\r\n            className=\"hover:text-primary hover:underline cursor-pointer transition-colors\"\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              window.open(`/products?id=${row.linkedHrmProduct.id}`, '_blank');\r\n            }}\r\n          >\r\n            {row.linkedHrmProduct.name}\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  ), [hrmProducts, getPkgxCatIdByHrmCategory, getPkgxBrandIdByHrmBrand]);\r\n  \r\n  // Handlers\r\n  const handleOpenDetailDialog = React.useCallback(async (row: PkgxProductRow) => {\r\n    setSelectedProductForDetail(row);\r\n    setIsDetailDialogOpen(true);\r\n    setGalleryImages([]); // Reset gallery\r\n    \r\n    // Fetch gallery ảnh\r\n    setIsLoadingGallery(true);\r\n    try {\r\n      const result = await fetchPkgxGallery(row.goods_id);\r\n      if (result.success && result.data) {\r\n        setGalleryImages(result.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching gallery:', error);\r\n    } finally {\r\n      setIsLoadingGallery(false);\r\n    }\r\n  }, []);\r\n  \r\n  const handleViewOnPkgx = React.useCallback((goodsId: number) => {\r\n    window.open(`https://phukiengiaxuong.com.vn/admin/goods.php?act=edit&goods_id=${goodsId}`, '_blank');\r\n  }, []);\r\n  \r\n  const handleOpenLinkDialog = React.useCallback((pkgxProduct: PkgxProduct) => {\r\n    setSelectedPkgxProduct(pkgxProduct);\r\n    // Auto-suggest matching products\r\n    validation.updateSuggestions(pkgxProduct);\r\n    // Try to find exact match by SKU first, then by name\r\n    const matchedProduct = hrmProducts.find(\r\n      (p) => p.id === pkgxProduct.goods_sn || p.name === pkgxProduct.goods_name\r\n    );\r\n    setSelectedHrmProductId(matchedProduct?.systemId || '');\r\n    setShowWarningConfirm(false);\r\n    validation.clearValidation();\r\n    setIsLinkDialogOpen(true);\r\n  }, [hrmProducts, validation]);\r\n  \r\n  const handleCloseLinkDialog = React.useCallback(() => {\r\n    setIsLinkDialogOpen(false);\r\n    setSelectedPkgxProduct(null);\r\n    setSelectedHrmProductId('');\r\n    setShowWarningConfirm(false);\r\n    validation.clearValidation();\r\n  }, [validation]);\r\n  \r\n  const handleOpenUnlinkDialog = React.useCallback((pkgxProduct: PkgxProduct) => {\r\n    const hrmProduct = findLinkedHrmProduct(pkgxProduct.goods_id);\r\n    if (hrmProduct) {\r\n      setProductToUnlink({ pkgxProduct, hrmProduct });\r\n      setIsUnlinkDialogOpen(true);\r\n    }\r\n  }, [findLinkedHrmProduct]);\r\n  \r\n  // Get selected products that are linked (for bulk unlink)\r\n  const selectedLinkedProducts = React.useMemo(() => {\r\n    const selectedIds = Object.keys(rowSelection).filter(id => rowSelection[id]);\r\n    return paginatedData.filter(p => selectedIds.includes(p.systemId) && p.linkedHrmProduct);\r\n  }, [rowSelection, paginatedData]);\r\n  \r\n  // All selected rows for bulk actions\r\n  const allSelectedRows = React.useMemo(() => \r\n    paginatedData.filter(p => rowSelection[p.systemId]),\r\n  [paginatedData, rowSelection]);\r\n  \r\n  // Bulk actions for ResponsiveDataTable\r\n  const bulkActions = React.useMemo(() => [\r\n    {\r\n      label: 'Hủy liên kết',\r\n      icon: Unlink,\r\n      variant: 'destructive' as const,\r\n      disabled: selectedLinkedProducts.length === 0,\r\n      onSelect: () => {\r\n        if (selectedLinkedProducts.length === 0) {\r\n          toast.error('Không có sản phẩm đã liên kết nào được chọn');\r\n          return;\r\n        }\r\n        setIsBulkUnlinkDialogOpen(true);\r\n      },\r\n    },\r\n  ], [selectedLinkedProducts]);\r\n  \r\n  const handleConfirmBulkUnlink = React.useCallback(() => {\r\n    let successCount = 0;\r\n    selectedLinkedProducts.forEach(product => {\r\n      if (product.linkedHrmProduct) {\r\n        productStore.update(product.linkedHrmProduct.systemId as SystemId, { pkgxId: undefined });\r\n        successCount++;\r\n      }\r\n    });\r\n    \r\n    setIsBulkUnlinkDialogOpen(false);\r\n    setRowSelection({});\r\n    toast.success(`Đã hủy liên kết ${successCount} sản phẩm`);\r\n    \r\n    addLog({\r\n      action: 'batch_unlink',\r\n      status: 'success',\r\n      message: `Đã hủy liên kết ${successCount} sản phẩm`,\r\n      details: { total: successCount },\r\n    });\r\n  }, [selectedLinkedProducts, productStore, addLog]);\r\n  \r\n  const handleOpenPushDialog = React.useCallback((row: PkgxProductRow) => {\r\n    setProductToPush(row);\r\n    // Reset to default fields when opening dialog\r\n    setSelectedPushFields(['goods_name', 'sync_prices', 'goods_number']);\r\n    setIsPushDialogOpen(true);\r\n  }, []);\r\n  \r\n  const handleTogglePushField = (field: PushSyncFieldKey) => {\r\n    setSelectedPushFields(prev => \r\n      prev.includes(field) \r\n        ? prev.filter(f => f !== field)\r\n        : [...prev, field]\r\n    );\r\n  };\r\n  \r\n  const handleSelectAllPushFields = () => {\r\n    if (selectedPushFields.length === PUSH_SYNC_FIELDS.length) {\r\n      setSelectedPushFields([]);\r\n    } else {\r\n      setSelectedPushFields(PUSH_SYNC_FIELDS.map(f => f.key));\r\n    }\r\n  };\r\n  \r\n  // Sync products from PKGX (limit 100 to fit localStorage)\r\n  const handleSyncFromPkgx = async () => {\r\n    setIsSyncing(true);\r\n    const startTime = Date.now();\r\n    try {\r\n      toast.info('Đang tải sản phẩm từ PKGX...');\r\n      const response = await fetchPkgxProducts(1, 100);\r\n      if (response.success && response.data && !response.data.error) {\r\n        // Lưu vào store để dùng chung với Link Dialog\r\n        setPkgxProducts(response.data.data);\r\n        setPagination(prev => ({ ...prev, pageIndex: 0 }));\r\n        \r\n        addLog({\r\n          action: 'get_products',\r\n          status: 'success',\r\n          message: `Đã lấy ${response.data.data.length}/${response.data.pagination.total_items} sản phẩm từ PKGX`,\r\n          details: { \r\n            total: response.data.pagination.total_items,\r\n            responseTime: Date.now() - startTime,\r\n          },\r\n        });\r\n        toast.success(`Đã lấy ${response.data.data.length}/${response.data.pagination.total_items} sản phẩm từ PKGX`);\r\n      } else {\r\n        throw new Error(response.error || 'Không thể lấy danh sách sản phẩm');\r\n      }\r\n    } catch (error) {\r\n      addLog({\r\n        action: 'get_products',\r\n        status: 'error',\r\n        message: 'Lỗi khi lấy sản phẩm từ PKGX',\r\n        details: { \r\n          error: error instanceof Error ? error.message : String(error),\r\n          responseTime: Date.now() - startTime,\r\n        },\r\n      });\r\n      toast.error(error instanceof Error ? error.message : 'Lỗi khi lấy sản phẩm từ PKGX');\r\n    } finally {\r\n      setIsSyncing(false);\r\n    }\r\n  };\r\n  \r\n  // Refresh single product from PKGX\r\n  const handleRefreshSingleProduct = async (goodsId: number) => {\r\n    setIsLoadingProductDetail(true);\r\n    try {\r\n      const response = await fetchPkgxProductById(goodsId);\r\n      if (response.success && response.data) {\r\n        // Update the product in the list\r\n        const updatedProducts = pkgxProducts.map(p => \r\n          p.goods_id === goodsId ? response.data! : p\r\n        );\r\n        setPkgxProducts(updatedProducts);\r\n        \r\n        // Also update the selected product for detail if it's open\r\n        if (selectedProductForDetail?.goods_id === goodsId) {\r\n          const linked = findLinkedHrmProduct(goodsId);\r\n          const totalInventory = linked \r\n            ? Object.values(linked.inventoryByBranch || {}).reduce((sum, qty) => sum + qty, 0)\r\n            : 0;\r\n          \r\n          setSelectedProductForDetail({\r\n            ...response.data,\r\n            linkedHrmProduct: linked ? {\r\n              systemId: linked.systemId,\r\n              name: linked.name,\r\n              id: linked.id,\r\n              sku: (linked as any).sku,\r\n              sellingPrice: linked.sellingPrice,\r\n              costPrice: linked.costPrice,\r\n              partnerPrice: (linked as any).partnerPrice,\r\n              acePrice: (linked as any).acePrice,\r\n              dealPrice: (linked as any).dealPrice,\r\n              quantity: totalInventory,\r\n              description: linked.description,\r\n              shortDescription: linked.shortDescription,\r\n              seoDescription: linked.seoDescription,\r\n              seoKeywords: (linked as any).seoKeywords,\r\n              ktitle: linked.ktitle,\r\n              categorySystemId: linked.categorySystemId,\r\n              brandSystemId: linked.brandSystemId,\r\n              isBest: (linked as any).isBest,\r\n              isHot: (linked as any).isHot,\r\n              isNew: (linked as any).isNew,\r\n              isHome: (linked as any).isHome,\r\n              sellerNote: (linked as any).sellerNote,\r\n            } : undefined,\r\n            systemId: response.data.goods_id.toString(),\r\n          });\r\n        }\r\n        \r\n        toast.success('Đã cập nhật thông tin sản phẩm');\r\n        return true;\r\n      } else {\r\n        toast.error(response.error || 'Không thể lấy thông tin sản phẩm');\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      toast.error('Lỗi khi lấy thông tin sản phẩm');\r\n      return false;\r\n    } finally {\r\n      setIsLoadingProductDetail(false);\r\n    }\r\n  };\r\n  \r\n  // Validate when form values change\r\n  React.useEffect(() => {\r\n    if (isLinkDialogOpen && selectedPkgxProduct && selectedHrmProductId) {\r\n      const hrmProduct = hrmProducts.find(p => p.systemId === selectedHrmProductId);\r\n      const input: ProductMappingInput = {\r\n        hrmProductSystemId: selectedHrmProductId || '',\r\n        hrmProductName: hrmProduct?.name || '',\r\n        hrmProductSku: hrmProduct?.id,\r\n        pkgxProductId: selectedPkgxProduct.goods_id,\r\n        pkgxProductName: selectedPkgxProduct.goods_name,\r\n        pkgxProductSku: selectedPkgxProduct.goods_sn,\r\n      };\r\n      validation.validateAsync(input);\r\n    }\r\n  }, [selectedHrmProductId, selectedPkgxProduct, isLinkDialogOpen, hrmProducts, validation]);\r\n  \r\n  // Confirm link\r\n  const handleConfirmLink = () => {\r\n    if (!selectedPkgxProduct) {\r\n      toast.error('Vui lòng chọn sản phẩm PKGX');\r\n      return;\r\n    }\r\n    \r\n    // Build input for validation\r\n    const hrmProduct = hrmProducts.find(p => p.systemId === selectedHrmProductId);\r\n    const input: ProductMappingInput = {\r\n      hrmProductSystemId: selectedHrmProductId || '',\r\n      hrmProductName: hrmProduct?.name || '',\r\n      hrmProductSku: hrmProduct?.id,\r\n      pkgxProductId: selectedPkgxProduct.goods_id,\r\n      pkgxProductName: selectedPkgxProduct.goods_name,\r\n      pkgxProductSku: selectedPkgxProduct.goods_sn,\r\n    };\r\n    \r\n    // Run final validation\r\n    const result = validation.validate(input);\r\n    \r\n    // Block if there are errors\r\n    if (!result.isValid) {\r\n      toast.error(result.errors[0]?.message || 'Vui lòng kiểm tra lại thông tin');\r\n      return;\r\n    }\r\n    \r\n    // Show warning confirmation if there are warnings and not yet confirmed\r\n    if (result.warnings.length > 0 && !showWarningConfirm) {\r\n      setShowWarningConfirm(true);\r\n      return;\r\n    }\r\n    \r\n    if (!hrmProduct) {\r\n      toast.error('Không tìm thấy sản phẩm HRM');\r\n      return;\r\n    }\r\n    \r\n    productStore.update(selectedHrmProductId as any, { pkgxId: selectedPkgxProduct.goods_id });\r\n    toast.success(`Đã liên kết \"${selectedPkgxProduct.goods_name}\" với sản phẩm HRM`);\r\n    \r\n    addLog({\r\n      action: 'link_product',\r\n      status: 'success',\r\n      message: `Đã liên kết: ${hrmProduct.name} ↔ ${selectedPkgxProduct.goods_name}`,\r\n      details: { \r\n        pkgxId: selectedPkgxProduct.goods_id, \r\n        productId: selectedHrmProductId, \r\n        productName: hrmProduct.name,\r\n      },\r\n    });\r\n    \r\n    handleCloseLinkDialog();\r\n  };\r\n  \r\n  // Confirm unlink\r\n  const handleConfirmUnlink = () => {\r\n    if (productToUnlink?.hrmProduct) {\r\n      productStore.update(productToUnlink.hrmProduct.systemId, { pkgxId: undefined });\r\n      toast.success(`Đã hủy liên kết sản phẩm`);\r\n      \r\n      addLog({\r\n        action: 'unlink_product',\r\n        status: 'success',\r\n        message: `Đã hủy liên kết: ${productToUnlink.hrmProduct.name}`,\r\n        details: { \r\n          pkgxId: productToUnlink.pkgxProduct.goods_id, \r\n          productId: productToUnlink.hrmProduct.systemId,\r\n          productName: productToUnlink.hrmProduct.name,\r\n        },\r\n      });\r\n    }\r\n    setIsUnlinkDialogOpen(false);\r\n    setProductToUnlink(null);\r\n  };\r\n  \r\n  // Confirm push (Push: HRM → PKGX)\r\n  const handleConfirmPush = async () => {\r\n    if (!productToPush || !productToPush.linkedHrmProduct || selectedPushFields.length === 0) {\r\n      toast.error('Vui lòng chọn ít nhất một trường để đồng bộ');\r\n      return;\r\n    }\r\n    \r\n    setIsPushingProduct(true);\r\n    \r\n    try {\r\n      const hrm = productToPush.linkedHrmProduct;\r\n      const pushData: Record<string, any> = {};\r\n      \r\n      for (const field of selectedPushFields) {\r\n        switch (field) {\r\n          // Thông tin cơ bản\r\n          case 'goods_name':\r\n            pushData.goods_name = hrm.name;\r\n            break;\r\n          case 'goods_sn':\r\n            if (hrm.sku) pushData.goods_sn = hrm.sku;\r\n            break;\r\n          case 'goods_brief':\r\n            pushData.goods_brief = hrm.shortDescription || '';\r\n            break;\r\n          case 'goods_desc':\r\n            pushData.goods_desc = hrm.description || '';\r\n            break;\r\n            \r\n          // Giá cả - CHỈ đồng bộ nếu đã cấu hình mapping giá\r\n          case 'sync_prices': {\r\n            const { priceMapping } = settings;\r\n            const hasPriceMapping = priceMapping.shopPrice || priceMapping.marketPrice || priceMapping.partnerPrice || priceMapping.acePrice || priceMapping.dealPrice;\r\n            \r\n            if (!hasPriceMapping) {\r\n              toast.warning('Chưa cấu hình Mapping giá. Vui lòng vào tab \"Mapping giá\" để thiết lập trước khi đồng bộ giá.');\r\n            } else {\r\n              // Chỉ push giá nếu có mapping tương ứng\r\n              if (priceMapping.shopPrice && hrm.sellingPrice) {\r\n                pushData.shop_price = hrm.sellingPrice;\r\n              }\r\n              if (priceMapping.partnerPrice && hrm.partnerPrice) {\r\n                pushData.partner_price = hrm.partnerPrice;\r\n              }\r\n              if (priceMapping.acePrice && hrm.acePrice) {\r\n                pushData.ace_price = hrm.acePrice;\r\n              }\r\n              if (priceMapping.dealPrice && hrm.dealPrice) {\r\n                pushData.deal_price = hrm.dealPrice;\r\n              }\r\n            }\r\n            break;\r\n          }\r\n            \r\n          // Tồn kho\r\n          case 'goods_number':\r\n            pushData.goods_number = hrm.quantity || 0;\r\n            break;\r\n            \r\n          // Phân loại\r\n          case 'cat_id':\r\n            if (hrm.categorySystemId) {\r\n              const pkgxCatId = getPkgxCatIdByHrmCategory(hrm.categorySystemId);\r\n              if (pkgxCatId) {\r\n                pushData.cat_id = pkgxCatId;\r\n              }\r\n            }\r\n            break;\r\n          case 'brand_id':\r\n            if (hrm.brandSystemId) {\r\n              const pkgxBrandId = getPkgxBrandIdByHrmBrand(hrm.brandSystemId);\r\n              if (pkgxBrandId) {\r\n                pushData.brand_id = pkgxBrandId;\r\n              }\r\n            }\r\n            break;\r\n            \r\n          // SEO\r\n          case 'keywords':\r\n            pushData.keywords = hrm.seoKeywords || hrm.seoDescription || '';\r\n            break;\r\n          case 'meta_title':\r\n            pushData.meta_title = hrm.ktitle || hrm.name || '';\r\n            break;\r\n          case 'meta_desc':\r\n            pushData.meta_desc = hrm.seoDescription || '';\r\n            break;\r\n            \r\n          // Trạng thái hiển thị\r\n          case 'best':\r\n            pushData.best = hrm.isBest ? 1 : 0;\r\n            break;\r\n          case 'hot':\r\n            pushData.hot = hrm.isHot ? 1 : 0;\r\n            break;\r\n          case 'new':\r\n            pushData.new = hrm.isNew ? 1 : 0;\r\n            break;\r\n          case 'ishome':\r\n            pushData.ishome = hrm.isHome ? 1 : 0;\r\n            break;\r\n            \r\n          // Ghi chú\r\n          case 'seller_note':\r\n            pushData.seller_note = hrm.sellerNote || '';\r\n            break;\r\n        }\r\n      }\r\n      \r\n      // Call API to update PKGX\r\n      const response = await updatePkgxProduct(productToPush.goods_id, pushData);\r\n      \r\n      if (response.success) {\r\n        addLog({\r\n          action: 'update_product',\r\n          status: 'success',\r\n          message: `Đã đẩy ${selectedPushFields.length} trường từ HRM → PKGX`,\r\n          details: {\r\n            pkgxId: productToPush.goods_id,\r\n            productId: hrm.systemId,\r\n            productName: hrm.name,\r\n          },\r\n        });\r\n        \r\n        toast.success(`Đã đẩy ${selectedPushFields.length} trường lên PKGX`);\r\n        \r\n        // Only refresh the single product\r\n        await handleRefreshSingleProduct(productToPush.goods_id);\r\n        \r\n        setIsPushDialogOpen(false);\r\n        setProductToPush(null);\r\n      } else {\r\n        throw new Error(response.error || 'Không thể cập nhật sản phẩm trên PKGX');\r\n      }\r\n    } catch (error) {\r\n      toast.error(error instanceof Error ? error.message : 'Lỗi khi đẩy dữ liệu lên PKGX');\r\n      addLog({\r\n        action: 'update_product',\r\n        status: 'error',\r\n        message: 'Lỗi khi đẩy dữ liệu lên PKGX',\r\n        details: { error: error instanceof Error ? error.message : String(error) },\r\n      });\r\n    } finally {\r\n      setIsPushingProduct(false);\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n            <div>\r\n              <CardTitle className=\"text-lg\">Sản phẩm đã liên kết</CardTitle>\r\n              <CardDescription>\r\n                Đồng bộ và liên kết sản phẩm PKGX với sản phẩm HRM\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <Button onClick={handleSyncFromPkgx} disabled={isSyncing}>\r\n                {isSyncing ? <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" /> : <RefreshCw className=\"h-4 w-4 mr-2\" />}\r\n                Đồng bộ từ PKGX\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {/* Search and stats */}\r\n            <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-3\">\r\n              <div className=\"relative flex-1\">\r\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Tìm kiếm sản phẩm PKGX...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-9\"\r\n                />\r\n              </div>\r\n              <div className=\"text-sm text-muted-foreground whitespace-nowrap text-center sm:text-right\">\r\n                {pkgxProducts.length} SP | {linkedCount} đã liên kết\r\n                {settings.pkgxProductsLastFetch && (\r\n                  <span className=\"ml-2 text-xs opacity-70\">\r\n                    ({new Date(settings.pkgxProductsLastFetch).toLocaleString('vi-VN')})\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Tabs - PKGX Products and Linked/Mapping */}\r\n            <Tabs defaultValue=\"pkgx-products\" className=\"w-full\">\r\n              <TabsList>\r\n                <TabsTrigger value=\"pkgx-products\">\r\n                  <Package className=\"h-4 w-4 mr-2\" />\r\n                  Sản phẩm PKGX ({pkgxProducts.length})\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"linked\">\r\n                  <Link className=\"h-4 w-4 mr-2\" />\r\n                  Đã liên kết ({linkedCount})\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"pkgx-products\" className=\"mt-4\">\r\n                {/* Warning if not enabled */}\r\n                {!settings.enabled && (\r\n                  <div className=\"flex items-center gap-2 rounded-lg border border-yellow-200 bg-yellow-50 p-3 text-sm text-yellow-800 mb-4\">\r\n                    <TriangleAlert className=\"h-4 w-4 flex-shrink-0\" />\r\n                    <p>Tích hợp PKGX chưa được bật. Vui lòng bật trong tab \"Cấu hình chung\".</p>\r\n                  </div>\r\n                )}\r\n                \r\n                {pkgxProducts.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-muted-foreground\">\r\n                    <Package className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>Chưa có sản phẩm từ PKGX.</p>\r\n                    <p className=\"text-sm mt-1\">Bấm \"Đồng bộ từ PKGX\" để lấy danh sách.</p>\r\n                  </div>\r\n                ) : (\r\n                  <ResponsiveDataTable<PkgxProductRow>\r\n                    columns={columns}\r\n                    data={paginatedData}\r\n                    pageCount={pageCount}\r\n                    pagination={pagination}\r\n                    setPagination={setPagination}\r\n                    rowCount={tableData.length}\r\n                    sorting={sorting}\r\n                    setSorting={setSorting}\r\n                    rowSelection={rowSelection}\r\n                    setRowSelection={setRowSelection}\r\n                    renderMobileCard={renderMobileCard}\r\n                    isLoading={isSyncing}\r\n                    bulkActions={bulkActions}\r\n                    allSelectedRows={allSelectedRows}\r\n                    emptyTitle=\"Không tìm thấy sản phẩm\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"linked\" className=\"mt-4\">\r\n                {linkedCount === 0 ? (\r\n                  <div className=\"text-center py-8 text-muted-foreground\">\r\n                    <Link className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                    <p>Chưa có sản phẩm nào được liên kết.</p>\r\n                    <p className=\"text-sm mt-1\">Chọn sản phẩm trong tab \"Sản phẩm PKGX\" và liên kết với HRM.</p>\r\n                  </div>\r\n                ) : (\r\n                  <ResponsiveDataTable<PkgxProductRow>\r\n                    columns={columns}\r\n                    data={paginatedData.filter(p => p.linkedHrmProduct)}\r\n                    pageCount={Math.ceil(tableData.filter(p => p.linkedHrmProduct).length / pagination.pageSize)}\r\n                    pagination={pagination}\r\n                    setPagination={setPagination}\r\n                    rowCount={tableData.filter(p => p.linkedHrmProduct).length}\r\n                    sorting={sorting}\r\n                    setSorting={setSorting}\r\n                    rowSelection={rowSelection}\r\n                    setRowSelection={setRowSelection}\r\n                    renderMobileCard={renderMobileCard}\r\n                    isLoading={isSyncing}\r\n                    bulkActions={bulkActions}\r\n                    allSelectedRows={allSelectedRows.filter(p => p.linkedHrmProduct)}\r\n                    emptyTitle=\"Không tìm thấy sản phẩm đã liên kết\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Link Dialog - Using shared PkgxMappingDialog component */}\r\n      <PkgxMappingDialog\r\n        open={isLinkDialogOpen}\r\n        onOpenChange={handleCloseLinkDialog}\r\n        type=\"product\"\r\n        hrmItems={hrmProducts\r\n          .filter((p) => !p.pkgxId || (selectedPkgxProduct && p.pkgxId === selectedPkgxProduct.goods_id))\r\n          .map((p) => ({\r\n            id: p.systemId,\r\n            name: p.name,\r\n            subText: p.id,\r\n          }))}\r\n        selectedHrmId={selectedHrmProductId}\r\n        onSelectHrmId={setSelectedHrmProductId}\r\n        pkgxItems={pkgxProducts.map((p) => ({\r\n          id: p.goods_id.toString(),\r\n          name: p.goods_name,\r\n          subText: `ID: ${p.goods_id}`,\r\n        }))}\r\n        selectedPkgxId={selectedPkgxProduct?.goods_id.toString() || ''}\r\n        onSelectPkgxId={(id) => {\r\n          const pkgx = pkgxProducts.find(p => p.goods_id.toString() === id);\r\n          if (pkgx) {\r\n            setSelectedPkgxProduct(pkgx);\r\n            validation.updateSuggestions(pkgx);\r\n          }\r\n        }}\r\n        pkgxSuggestions={validation.suggestions.map(s => ({\r\n          item: { id: s.product.systemId, name: s.product.name, subText: s.product.id },\r\n          score: s.score,\r\n          matchType: s.matchType,\r\n        }))}\r\n        validation={validation.validationResult}\r\n        hasErrors={validation.hasErrors}\r\n        isValidating={validation.isValidating}\r\n        showWarningConfirm={showWarningConfirm}\r\n        onConfirm={handleConfirmLink}\r\n        onCancel={handleCloseLinkDialog}\r\n      />\r\n      \r\n      {/* Unlink Dialog */}\r\n      <Dialog open={isUnlinkDialogOpen} onOpenChange={setIsUnlinkDialogOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Xác nhận hủy liên kết</DialogTitle>\r\n            <DialogDescription>\r\n              Bạn có chắc muốn hủy liên kết sản phẩm này?\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          \r\n          {productToUnlink && (\r\n            <div className=\"space-y-2 py-4\">\r\n              <p className=\"text-sm\">\r\n                <span className=\"font-medium\">PKGX:</span> {productToUnlink.pkgxProduct.goods_name}\r\n              </p>\r\n              <p className=\"text-sm\">\r\n                <span className=\"font-medium\">HRM:</span> {productToUnlink.hrmProduct.name}\r\n              </p>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Sau khi hủy, sản phẩm sẽ không còn được đồng bộ với PKGX.\r\n              </p>\r\n            </div>\r\n          )}\r\n          \r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setIsUnlinkDialogOpen(false)}>\r\n              Hủy\r\n            </Button>\r\n            <Button variant=\"destructive\" onClick={handleConfirmUnlink}>\r\n              <Unlink className=\"h-4 w-4 mr-2\" />\r\n              Hủy liên kết\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      {/* Push Dialog - Push (HRM → PKGX) */}\r\n      <Dialog open={isPushDialogOpen} onOpenChange={setIsPushDialogOpen}>\r\n        <DialogContent className=\"max-w-2xl max-h-[90vh]\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Upload className=\"h-5 w-5 text-green-600\" />\r\n              Đẩy dữ liệu từ HRM → PKGX\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              Chọn các trường cần đẩy từ HRM lên cập nhật PKGX\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          \r\n          {productToPush && (\r\n            <div className=\"space-y-4 py-4\">\r\n              {/* Product info */}\r\n              <div className=\"flex items-center gap-3 p-3 rounded-lg bg-green-50 border border-green-200\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"text-sm font-medium text-green-600\">HRM (Nguồn)</div>\r\n                  <div className=\"text-sm truncate\">{productToPush.linkedHrmProduct?.name}</div>\r\n                </div>\r\n                <ArrowRight className=\"h-4 w-4 text-green-600 shrink-0\" />\r\n                <div className=\"flex-1\">\r\n                  <div className=\"text-sm font-medium text-muted-foreground\">PKGX (Đích)</div>\r\n                  <div className=\"text-sm truncate\">{productToPush.goods_name}</div>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Field selection - Flat grid with tooltip and validation */}\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <Label className=\"text-sm font-medium\">Chọn trường cần đẩy lên:</Label>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={handleSelectAllPushFields}\r\n                    className=\"text-xs h-7\"\r\n                  >\r\n                    {selectedPushFields.length === PUSH_SYNC_FIELDS.length ? 'Bỏ chọn tất cả' : 'Chọn tất cả'}\r\n                  </Button>\r\n                </div>\r\n                \r\n                <ScrollArea className=\"h-[350px] pr-4\">\r\n                  <TooltipProvider delayDuration={200}>\r\n                    <div className=\"grid grid-cols-4 gap-2\">\r\n                      {PUSH_SYNC_FIELDS.map((field) => {\r\n                        // Check if this is a special field (sync_prices)\r\n                        const isSpecialField = (field as any).isSpecial === true;\r\n                        \r\n                        // Get HRM value for this field\r\n                        const hrmValue = isSpecialField \r\n                          ? 'Sử dụng cấu hình từ tab Mapping giá'\r\n                          : productToPush?.linkedHrmProduct?.[field.hrmField as keyof typeof productToPush.linkedHrmProduct];\r\n                        const hasValue = isSpecialField || (hrmValue !== undefined && hrmValue !== null && hrmValue !== '');\r\n                        \r\n                        // Format display value\r\n                        const displayValue = (() => {\r\n                          if (isSpecialField) return 'Theo cấu hình Mapping giá';\r\n                          if (!hasValue) return 'Chưa có dữ liệu';\r\n                          if (typeof hrmValue === 'boolean') return hrmValue ? 'Có' : 'Không';\r\n                          if (typeof hrmValue === 'number') {\r\n                            return hrmValue.toLocaleString('vi-VN');\r\n                          }\r\n                          if (typeof hrmValue === 'string') {\r\n                            return hrmValue.length > 50 ? hrmValue.substring(0, 50) + '...' : hrmValue;\r\n                          }\r\n                          return String(hrmValue);\r\n                        })();\r\n                        \r\n                        return (\r\n                          <Tooltip key={field.key}>\r\n                            <TooltipTrigger asChild>\r\n                              <div \r\n                                className={`flex items-center justify-between p-2 rounded border hover:bg-muted/50 ${\r\n                                  isSpecialField ? 'col-span-2 bg-blue-50 border-blue-200' :\r\n                                  !hasValue ? 'border-dashed opacity-60' : ''\r\n                                }`}\r\n                              >\r\n                                <div className=\"flex items-center gap-1 min-w-0 flex-1\">\r\n                                  <span className=\"text-xs truncate\">{field.label}</span>\r\n                                  {isSpecialField && <Settings2 className=\"h-3 w-3 text-blue-500 shrink-0\" />}\r\n                                </div>\r\n                                <Switch \r\n                                  checked={selectedPushFields.includes(field.key)} \r\n                                  onCheckedChange={() => handleTogglePushField(field.key)} \r\n                                />\r\n                              </div>\r\n                            </TooltipTrigger>\r\n                            <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                              <div className=\"text-xs space-y-1\">\r\n                                <div className=\"font-medium\">{field.label}</div>\r\n                                {isSpecialField ? (\r\n                                  <div className=\"text-blue-600\">\r\n                                    Giá sẽ được đồng bộ theo cấu hình trong tab \"Mapping giá\"\r\n                                    <br />\r\n                                    (shop_price, market_price, partner_price, ace_price, deal_price)\r\n                                  </div>\r\n                                ) : (\r\n                                  <div className=\"text-muted-foreground\">\r\n                                    HRM ({field.hrmField}): <span className={hasValue ? 'text-green-600' : 'text-orange-500'}>{displayValue}</span>\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </TooltipProvider>\r\n                </ScrollArea>\r\n              </div>\r\n              \r\n              {/* Selected count */}\r\n              <div className=\"text-sm text-muted-foreground text-center\">\r\n                Đã chọn {selectedPushFields.length} / {PUSH_SYNC_FIELDS.length} trường\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setIsPushDialogOpen(false)}>\r\n              Hủy\r\n            </Button>\r\n            <Button \r\n              onClick={handleConfirmPush} \r\n              disabled={selectedPushFields.length === 0 || isPushingProduct}\r\n              className=\"bg-green-600 hover:bg-green-700\"\r\n            >\r\n              {isPushingProduct ? (\r\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n              ) : (\r\n                <Upload className=\"h-4 w-4 mr-2\" />\r\n              )}\r\n              Đẩy lên PKGX ({selectedPushFields.length} trường)\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      {/* Product Detail Dialog - Tabbed design */}\r\n      <Dialog open={isDetailDialogOpen} onOpenChange={setIsDetailDialogOpen}>\r\n        <DialogContent className=\"max-w-5xl max-h-[90vh] overflow-hidden flex flex-col\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              {selectedProductForDetail?.goods_thumb && (\r\n                <img \r\n                  src={buildPkgxImageUrl(selectedProductForDetail.goods_thumb)}\r\n                  alt=\"\"\r\n                  className=\"w-12 h-12 object-contain rounded border\"\r\n                  onError={(e) => { (e.target as HTMLImageElement).style.display = 'none'; }}\r\n                />\r\n              )}\r\n              <div>\r\n                <span className=\"line-clamp-1\">{selectedProductForDetail?.goods_name}</span>\r\n                <DialogDescription className=\"font-normal\">\r\n                  ID: {selectedProductForDetail?.goods_id} | SKU: {selectedProductForDetail?.goods_sn || '-'} | Slug: {selectedProductForDetail?.slug || '-'}\r\n                </DialogDescription>\r\n              </div>\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          \r\n          {selectedProductForDetail && (\r\n            <Tabs defaultValue=\"basic\" className=\"flex-1 flex flex-col overflow-hidden\">\r\n              <TabsList className=\"grid w-full grid-cols-4\">\r\n                <TabsTrigger value=\"basic\" className=\"text-xs\">\r\n                  <Package className=\"h-3 w-3 mr-1\" />\r\n                  Cơ bản\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"price\" className=\"text-xs\">\r\n                  <DollarSign className=\"h-3 w-3 mr-1\" />\r\n                  Giá & Kho\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"seo\" className=\"text-xs\">\r\n                  <FileText className=\"h-3 w-3 mr-1\" />\r\n                  Nội dung & SEO\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"images\" className=\"text-xs\">\r\n                  <ImageIcon className=\"h-3 w-3 mr-1\" />\r\n                  Hình ảnh\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              \r\n              {/* Tab: Thông tin cơ bản */}\r\n              <TabsContent value=\"basic\" className=\"flex-1 overflow-auto mt-4\">\r\n                <ScrollArea className=\"h-[350px] pr-4\">\r\n                <div className=\"space-y-4\">\r\n                  {/* Status flags + HRM Link - Cùng hàng */}\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    {/* Trạng thái hiển thị */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">Trạng thái hiển thị</Label>\r\n                      <div className=\"flex flex-wrap gap-1.5\">\r\n                        <Badge variant={selectedProductForDetail.is_on_sale == 1 ? 'default' : 'secondary'} className=\"gap-1\">\r\n                          {selectedProductForDetail.is_on_sale == 1 ? <CheckCircle2 className=\"h-3 w-3\" /> : <Circle className=\"h-3 w-3\" />}\r\n                          Đăng bán\r\n                        </Badge>\r\n                        <Badge variant={selectedProductForDetail.is_best == 1 ? 'default' : 'secondary'} className=\"gap-1\">\r\n                          {selectedProductForDetail.is_best == 1 ? <Star className=\"h-3 w-3\" /> : <Circle className=\"h-3 w-3\" />}\r\n                          Best\r\n                        </Badge>\r\n                        <Badge variant={selectedProductForDetail.is_hot == 1 ? 'destructive' : 'secondary'} className=\"gap-1\">\r\n                          {selectedProductForDetail.is_hot == 1 ? <Flame className=\"h-3 w-3\" /> : <Circle className=\"h-3 w-3\" />}\r\n                          Hot\r\n                        </Badge>\r\n                        <Badge variant={selectedProductForDetail.is_new == 1 ? 'default' : 'secondary'} className={`gap-1 ${selectedProductForDetail.is_new == 1 ? 'bg-purple-500 hover:bg-purple-600' : ''}`}>\r\n                          {selectedProductForDetail.is_new == 1 ? <Sparkles className=\"h-3 w-3\" /> : <Circle className=\"h-3 w-3\" />}\r\n                          New\r\n                        </Badge>\r\n                        <Badge variant={selectedProductForDetail.is_home == 1 ? 'outline' : 'secondary'} className={`gap-1 ${selectedProductForDetail.is_home == 1 ? 'border-orange-500 text-orange-600' : ''}`}>\r\n                          {selectedProductForDetail.is_home == 1 ? <Home className=\"h-3 w-3\" /> : <Circle className=\"h-3 w-3\" />}\r\n                          Home\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Liên kết HRM */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">Liên kết HRM</Label>\r\n                      {selectedProductForDetail.linkedHrmProduct ? (\r\n                        <button\r\n                          onClick={() => {\r\n                            setIsDetailDialogOpen(false);\r\n                            router.push(`/products?id=${selectedProductForDetail.linkedHrmProduct!.id}`);\r\n                          }}\r\n                          className=\"w-full p-2 border rounded bg-green-50 border-green-200 hover:bg-green-100 transition-colors text-left\"\r\n                        >\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <CheckCircle2 className=\"h-4 w-4 text-green-600 flex-shrink-0\" />\r\n                            <span className=\"font-medium text-green-700 truncate text-sm\">{selectedProductForDetail.linkedHrmProduct.name}</span>\r\n                            <ArrowRight className=\"h-3 w-3 text-green-600 flex-shrink-0 ml-auto\" />\r\n                          </div>\r\n                          <div className=\"flex gap-3 mt-1 text-xs text-muted-foreground\">\r\n                            <span>SKU: {selectedProductForDetail.linkedHrmProduct.sku || '-'}</span>\r\n                            <span>Tồn: {selectedProductForDetail.linkedHrmProduct.quantity || 0}</span>\r\n                          </div>\r\n                        </button>\r\n                      ) : (\r\n                        <div className=\"p-2 border rounded text-center text-sm text-muted-foreground flex items-center justify-center gap-2\">\r\n                          <XCircle className=\"h-4 w-4\" />\r\n                          Chưa liên kết\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Classification */}\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Danh mục</Label>\r\n                      <div className=\"p-2 border rounded text-sm\">\r\n                        ID: {selectedProductForDetail.cat_id || '-'}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Thương hiệu</Label>\r\n                      <div className=\"p-2 border rounded text-sm\">\r\n                        ID: {selectedProductForDetail.brand_id || '-'}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Timestamps */}\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Ngày tạo</Label>\r\n                      <div className=\"p-2 border rounded\">\r\n                        {selectedProductForDetail.add_time \r\n                          ? new Date(selectedProductForDetail.add_time * 1000).toLocaleString('vi-VN')\r\n                          : '-'}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Cập nhật</Label>\r\n                      <div className=\"p-2 border rounded\">\r\n                        {selectedProductForDetail.last_update \r\n                          ? new Date(selectedProductForDetail.last_update * 1000).toLocaleString('vi-VN')\r\n                          : '-'}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Seller note */}\r\n                  {selectedProductForDetail.seller_note && (\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-xs text-muted-foreground\">Ghi chú người bán</Label>\r\n                      <div className=\"p-2 border rounded text-sm\">{selectedProductForDetail.seller_note}</div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                </ScrollArea>\r\n              </TabsContent>\r\n              \r\n              {/* Tab: Giá & Tồn kho */}\r\n              <TabsContent value=\"price\" className=\"flex-1 overflow-auto mt-4\">\r\n                <ScrollArea className=\"h-[350px] pr-4\">\r\n                <div className=\"space-y-4\">\r\n                  {/* Prices */}\r\n                  <div className=\"space-y-2\">\r\n                    <Label className=\"text-sm font-medium\">Giá bán PKGX</Label>\r\n                    <div className=\"grid grid-cols-5 gap-2 text-sm\">\r\n                      <div className=\"p-3 border rounded text-center\">\r\n                        <div className=\"text-xs text-muted-foreground\">Shop</div>\r\n                        <div className=\"font-bold text-green-600\">{Number(selectedProductForDetail.shop_price || 0).toLocaleString('vi-VN')}đ</div>\r\n                      </div>\r\n                      <div className=\"p-3 border rounded text-center\">\r\n                        <div className=\"text-xs text-muted-foreground\">Thị trường</div>\r\n                        <div>{Number(selectedProductForDetail.market_price || 0).toLocaleString('vi-VN')}đ</div>\r\n                      </div>\r\n                      <div className=\"p-3 border rounded text-center\">\r\n                        <div className=\"text-xs text-muted-foreground\">Đối tác</div>\r\n                        <div>{Number(selectedProductForDetail.partner_price || 0).toLocaleString('vi-VN')}đ</div>\r\n                      </div>\r\n                      <div className=\"p-3 border rounded text-center\">\r\n                        <div className=\"text-xs text-muted-foreground\">ACE</div>\r\n                        <div>{Number(selectedProductForDetail.ace_price || 0).toLocaleString('vi-VN')}đ</div>\r\n                      </div>\r\n                      <div className=\"p-3 border rounded text-center\">\r\n                        <div className=\"text-xs text-muted-foreground\">Deal</div>\r\n                        <div>{Number(selectedProductForDetail.deal_price || 0).toLocaleString('vi-VN')}đ</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Inventory */}\r\n                  <div className=\"space-y-2\">\r\n                    <Label className=\"text-sm font-medium\">Tồn kho</Label>\r\n                    <div className=\"p-4 border rounded\">\r\n                      <div className=\"text-3xl font-bold\">{selectedProductForDetail.goods_number || 0}</div>\r\n                      <div className=\"text-xs text-muted-foreground\">sản phẩm trong kho PKGX</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                </ScrollArea>\r\n              </TabsContent>\r\n              \r\n              {/* Tab: Nội dung & SEO */}\r\n              <TabsContent value=\"seo\" className=\"flex-1 overflow-auto mt-4\">\r\n                <ScrollArea className=\"h-[350px] pr-4\">\r\n                  <div className=\"space-y-4\">\r\n                    {/* SEO Fields */}\r\n                    <div className=\"space-y-3\">\r\n                      <Label className=\"text-sm font-medium\">Thông tin SEO</Label>\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"space-y-1\">\r\n                          <Label className=\"text-xs text-muted-foreground\">Meta Title</Label>\r\n                          <div className=\"p-2 border rounded text-sm\">{selectedProductForDetail.meta_title || '-'}</div>\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                          <Label className=\"text-xs text-muted-foreground\">Keywords</Label>\r\n                          <div className=\"p-2 border rounded text-sm\">{selectedProductForDetail.keywords || '-'}</div>\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                          <Label className=\"text-xs text-muted-foreground\">Meta Description</Label>\r\n                          <div className=\"p-2 border rounded text-sm max-h-20 overflow-y-auto\">{selectedProductForDetail.meta_desc || '-'}</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Short description */}\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-sm font-medium\">Mô tả ngắn</Label>\r\n                      <div className=\"p-2 border rounded text-sm max-h-24 overflow-y-auto\">\r\n                        {selectedProductForDetail.goods_brief || '-'}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Long description */}\r\n                    <div className=\"space-y-1\">\r\n                      <Label className=\"text-sm font-medium\">Mô tả chi tiết</Label>\r\n                      <div \r\n                        className=\"p-3 border rounded text-sm max-h-60 overflow-y-auto bg-muted/30\"\r\n                        dangerouslySetInnerHTML={{ __html: selectedProductForDetail.goods_desc || '<span class=\"text-muted-foreground\">Không có mô tả</span>' }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </ScrollArea>\r\n              </TabsContent>\r\n              \r\n              {/* Tab: Hình ảnh */}\r\n              <TabsContent value=\"images\" className=\"flex-1 overflow-auto mt-4\">\r\n                <ScrollArea className=\"h-[350px] pr-4\">\r\n                  <div className=\"space-y-4\">\r\n                    {/* Ảnh đại diện - dùng iframe để bypass CORS */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">Ảnh sản phẩm</Label>\r\n                      <div className=\"grid grid-cols-3 gap-3\">\r\n                        {selectedProductForDetail.original_img && (\r\n                          <div className=\"space-y-1\">\r\n                            <Label className=\"text-xs text-muted-foreground\">Ảnh gốc</Label>\r\n                            <a \r\n                              href={buildPkgxImageUrl(selectedProductForDetail.original_img)}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"block border rounded p-2 hover:border-primary transition-colors bg-white\"\r\n                            >\r\n                              <div className=\"w-full h-28 flex items-center justify-center overflow-hidden\">\r\n                                <img \r\n                                  src={buildPkgxImageUrl(selectedProductForDetail.original_img)}\r\n                                  alt=\"Original\"\r\n                                  className=\"max-w-full max-h-full object-contain\"\r\n                                  loading=\"lazy\"\r\n                                  referrerPolicy=\"no-referrer\"\r\n                                  onError={(e) => { \r\n                                    const target = e.target as HTMLImageElement;\r\n                                    target.style.display = 'none';\r\n                                    target.parentElement!.innerHTML = '<div class=\"text-xs text-muted-foreground text-center py-8\">Click để xem</div>';\r\n                                  }}\r\n                                />\r\n                              </div>\r\n                              <div className=\"text-xs text-center text-primary mt-1\">Xem ảnh gốc</div>\r\n                            </a>\r\n                          </div>\r\n                        )}\r\n                        {selectedProductForDetail.goods_img && (\r\n                          <div className=\"space-y-1\">\r\n                            <Label className=\"text-xs text-muted-foreground\">Ảnh SP</Label>\r\n                            <a \r\n                              href={buildPkgxImageUrl(selectedProductForDetail.goods_img)}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"block border rounded p-2 hover:border-primary transition-colors bg-white\"\r\n                            >\r\n                              <div className=\"w-full h-28 flex items-center justify-center overflow-hidden\">\r\n                                <img \r\n                                  src={buildPkgxImageUrl(selectedProductForDetail.goods_img)}\r\n                                  alt=\"Goods\"\r\n                                  className=\"max-w-full max-h-full object-contain\"\r\n                                  loading=\"lazy\"\r\n                                  referrerPolicy=\"no-referrer\"\r\n                                  onError={(e) => { \r\n                                    const target = e.target as HTMLImageElement;\r\n                                    target.style.display = 'none';\r\n                                    target.parentElement!.innerHTML = '<div class=\"text-xs text-muted-foreground text-center py-8\">Click để xem</div>';\r\n                                  }}\r\n                                />\r\n                              </div>\r\n                              <div className=\"text-xs text-center text-primary mt-1\">Xem ảnh SP</div>\r\n                            </a>\r\n                          </div>\r\n                        )}\r\n                        {selectedProductForDetail.goods_thumb && (\r\n                          <div className=\"space-y-1\">\r\n                            <Label className=\"text-xs text-muted-foreground\">Thumbnail</Label>\r\n                            <a \r\n                              href={buildPkgxImageUrl(selectedProductForDetail.goods_thumb)}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"block border rounded p-2 hover:border-primary transition-colors bg-white\"\r\n                            >\r\n                              <div className=\"w-full h-28 flex items-center justify-center overflow-hidden\">\r\n                                <img \r\n                                  src={buildPkgxImageUrl(selectedProductForDetail.goods_thumb)}\r\n                                  alt=\"Thumbnail\"\r\n                                  className=\"max-w-full max-h-full object-contain\"\r\n                                  loading=\"lazy\"\r\n                                  referrerPolicy=\"no-referrer\"\r\n                                  onError={(e) => { \r\n                                    const target = e.target as HTMLImageElement;\r\n                                    target.style.display = 'none';\r\n                                    target.parentElement!.innerHTML = '<div class=\"text-xs text-muted-foreground text-center py-8\">Click để xem</div>';\r\n                                  }}\r\n                                />\r\n                              </div>\r\n                              <div className=\"text-xs text-center text-primary mt-1\">Xem thumbnail</div>\r\n                            </a>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {!selectedProductForDetail.original_img && !selectedProductForDetail.goods_img && !selectedProductForDetail.goods_thumb && (\r\n                        <div className=\"text-sm text-muted-foreground p-4 border rounded text-center\">\r\n                          Chưa có ảnh sản phẩm\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    {/* Đường dẫn ảnh - có thể copy */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">Đường dẫn ảnh (click để mở)</Label>\r\n                      <div className=\"space-y-2 text-xs\">\r\n                        {selectedProductForDetail.original_img && (\r\n                          <a \r\n                            href={buildPkgxImageUrl(selectedProductForDetail.original_img)}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"flex items-center gap-2 p-2 border rounded bg-muted/30 hover:bg-muted transition-colors break-all\"\r\n                          >\r\n                            <ExternalLink className=\"h-3 w-3 flex-shrink-0 text-muted-foreground\" />\r\n                            <span className=\"text-muted-foreground font-medium\">Original:</span>\r\n                            <span className=\"text-primary underline\">{selectedProductForDetail.original_img}</span>\r\n                          </a>\r\n                        )}\r\n                        {selectedProductForDetail.goods_img && (\r\n                          <a \r\n                            href={buildPkgxImageUrl(selectedProductForDetail.goods_img)}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"flex items-center gap-2 p-2 border rounded bg-muted/30 hover:bg-muted transition-colors break-all\"\r\n                          >\r\n                            <ExternalLink className=\"h-3 w-3 flex-shrink-0 text-muted-foreground\" />\r\n                            <span className=\"text-muted-foreground font-medium\">Goods:</span>\r\n                            <span className=\"text-primary underline\">{selectedProductForDetail.goods_img}</span>\r\n                          </a>\r\n                        )}\r\n                        {selectedProductForDetail.goods_thumb && (\r\n                          <a \r\n                            href={buildPkgxImageUrl(selectedProductForDetail.goods_thumb)}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"flex items-center gap-2 p-2 border rounded bg-muted/30 hover:bg-muted transition-colors break-all\"\r\n                          >\r\n                            <ExternalLink className=\"h-3 w-3 flex-shrink-0 text-muted-foreground\" />\r\n                            <span className=\"text-muted-foreground font-medium\">Thumb:</span>\r\n                            <span className=\"text-primary underline\">{selectedProductForDetail.goods_thumb}</span>\r\n                          </a>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Album ảnh */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">\r\n                        Album ảnh {galleryImages.length > 0 && `(${galleryImages.length})`}\r\n                      </Label>\r\n                      {isLoadingGallery ? (\r\n                        <div className=\"flex items-center justify-center p-4 border rounded\">\r\n                          <Loader2 className=\"h-5 w-5 animate-spin text-muted-foreground\" />\r\n                          <span className=\"ml-2 text-sm text-muted-foreground\">Đang tải gallery...</span>\r\n                        </div>\r\n                      ) : galleryImages.length > 0 ? (\r\n                        <div className=\"grid grid-cols-4 gap-2\">\r\n                          {galleryImages.map((img, index) => (\r\n                            <a\r\n                              key={img.img_id || index}\r\n                              href={buildPkgxImageUrl(img.img_url || img.img_original)}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"block border rounded p-1 hover:border-primary transition-colors bg-white\"\r\n                            >\r\n                              <div className=\"w-full h-20 flex items-center justify-center overflow-hidden\">\r\n                                <img\r\n                                  src={buildPkgxImageUrl(img.thumb_url || img.img_url)}\r\n                                  alt={img.img_desc || `Gallery ${index + 1}`}\r\n                                  className=\"max-w-full max-h-full object-contain\"\r\n                                  loading=\"lazy\"\r\n                                  onError={(e) => {\r\n                                    const target = e.target as HTMLImageElement;\r\n                                    target.style.display = 'none';\r\n                                    target.parentElement!.innerHTML = '<div class=\"text-xs text-muted-foreground text-center py-4\">Lỗi</div>';\r\n                                  }}\r\n                                />\r\n                              </div>\r\n                            </a>\r\n                          ))}\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"text-sm text-muted-foreground p-4 border rounded text-center\">\r\n                          <p>Chưa có ảnh trong album</p>\r\n                          <p className=\"text-xs mt-1 opacity-70\">\r\n                            Sản phẩm này chưa có ảnh gallery hoặc gallery trống\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </ScrollArea>\r\n              </TabsContent>\r\n            </Tabs>\r\n          )}\r\n          \r\n          <DialogFooter className=\"mt-4 flex-wrap gap-2\">\r\n            {selectedProductForDetail && (\r\n              <>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={() => handleViewOnPkgx(selectedProductForDetail.goods_id)}>\r\n                  <ExternalLink className=\"h-4 w-4 mr-2\" />\r\n                  Xem trên PKGX\r\n                </Button>\r\n                {selectedProductForDetail.linkedHrmProduct && (\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    size=\"sm\" \r\n                    className=\"text-destructive hover:text-destructive\"\r\n                    onClick={() => {\r\n                      setIsDetailDialogOpen(false);\r\n                      handleOpenUnlinkDialog(selectedProductForDetail);\r\n                    }}\r\n                  >\r\n                    <Unlink className=\"h-4 w-4 mr-2\" />\r\n                    Hủy liên kết\r\n                  </Button>\r\n                )}\r\n              </>\r\n            )}\r\n            <Button variant=\"outline\" onClick={() => setIsDetailDialogOpen(false)}>\r\n              Đóng\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n      \r\n      {/* Bulk Unlink Confirm Dialog */}\r\n      <AlertDialog open={isBulkUnlinkDialogOpen} onOpenChange={setIsBulkUnlinkDialogOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Hủy liên kết {selectedLinkedProducts.length} sản phẩm?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Bạn có chắc muốn hủy liên kết {selectedLinkedProducts.length} sản phẩm đã chọn với HRM? \r\n              Hành động này sẽ xóa liên kết giữa sản phẩm PKGX và HRM, không xóa dữ liệu sản phẩm.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleConfirmBulkUnlink} className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\">\r\n              Xác nhận hủy liên kết\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n      \r\n      {/* Confirmation Dialog for sync actions - using shared component */}\r\n      <PkgxSyncConfirmDialog\r\n        confirmAction={entitySync.confirmAction}\r\n        isSyncing={entitySync.isSyncing}\r\n        onConfirm={entitySync.executeAction}\r\n        onCancel={entitySync.cancelConfirm}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9268, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/sync-settings-tab.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Switch } from '../../../../components/ui/switch';\r\nimport { Label } from '../../../../components/ui/label';\r\nimport { Badge } from '../../../../components/ui/badge';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../../components/ui/select';\r\nimport { Play, Pause, FileText, CheckCircle2, AlertCircle, Loader2 } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport { SYNC_INTERVAL_OPTIONS } from '../types';\r\n\r\nexport function SyncSettingsTab() {\r\n  const { settings, updateSyncSetting, setLastSyncAt, setLastSyncResult, addLog } = usePkgxSettingsStore();\r\n  const { syncSettings, lastSyncAt, lastSyncResult, apiKey, apiUrl } = settings;\r\n  const [isSyncing, setIsSyncing] = React.useState(false);\r\n\r\n  const handleManualSync = async () => {\r\n    if (!apiUrl || !apiKey) {\r\n      toast.error('Vui lòng cấu hình API URL và API Key trước!');\r\n      return;\r\n    }\r\n\r\n    setIsSyncing(true);\r\n    const startTime = Date.now();\r\n    toast.info('Đang đồng bộ dữ liệu...');\r\n    \r\n    try {\r\n      // TODO: Implement actual sync logic with real API\r\n      await new Promise((resolve) => setTimeout(resolve, 2000));\r\n      \r\n      const responseTime = Date.now() - startTime;\r\n      const result = { status: 'success' as const, total: 150, success: 150, failed: 0 };\r\n      \r\n      setLastSyncAt(new Date().toISOString());\r\n      setLastSyncResult(result);\r\n      \r\n      addLog({\r\n        action: 'sync_all',\r\n        status: 'success',\r\n        message: 'Đồng bộ tất cả dữ liệu thành công',\r\n        details: {\r\n          total: result.total,\r\n          success: result.success,\r\n          failed: result.failed,\r\n          responseTime,\r\n          url: apiUrl,\r\n          method: 'POST',\r\n        }\r\n      });\r\n      \r\n      toast.success('Đồng bộ thành công!');\r\n    } catch (error) {\r\n      const responseTime = Date.now() - startTime;\r\n      const errorMessage = error instanceof Error ? error.message : 'Lỗi không xác định';\r\n      \r\n      setLastSyncResult({ status: 'error', total: 0, success: 0, failed: 0 });\r\n      \r\n      addLog({\r\n        action: 'sync_all',\r\n        status: 'error',\r\n        message: 'Lỗi đồng bộ dữ liệu',\r\n        details: {\r\n          error: errorMessage,\r\n          responseTime,\r\n          url: apiUrl,\r\n          method: 'POST',\r\n        }\r\n      });\r\n      \r\n      toast.error('Lỗi đồng bộ: ' + errorMessage);\r\n    } finally {\r\n      setIsSyncing(false);\r\n    }\r\n  };\r\n\r\n  const handleToggleAutoSync = (checked: boolean) => {\r\n    updateSyncSetting('autoSyncEnabled', checked);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'info',\r\n      message: checked ? 'Đã bật Auto Sync' : 'Đã tắt Auto Sync',\r\n      details: {}\r\n    });\r\n    toast.success(checked ? 'Đã bật Auto Sync' : 'Đã tắt Auto Sync');\r\n  };\r\n\r\n  const handleToggleSyncInventory = (checked: boolean) => {\r\n    updateSyncSetting('syncInventory', checked);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'info',\r\n      message: checked ? 'Đã bật đồng bộ tồn kho' : 'Đã tắt đồng bộ tồn kho',\r\n      details: {}\r\n    });\r\n  };\r\n\r\n  const handleToggleSyncPrice = (checked: boolean) => {\r\n    updateSyncSetting('syncPrice', checked);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'info',\r\n      message: checked ? 'Đã bật đồng bộ giá' : 'Đã tắt đồng bộ giá',\r\n      details: {}\r\n    });\r\n  };\r\n\r\n  const handleToggleSyncSeo = (checked: boolean) => {\r\n    updateSyncSetting('syncSeo', checked);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'info',\r\n      message: checked ? 'Đã bật đồng bộ SEO' : 'Đã tắt đồng bộ SEO',\r\n      details: {}\r\n    });\r\n  };\r\n\r\n  const handleToggleSyncOnUpdate = (checked: boolean) => {\r\n    updateSyncSetting('syncOnProductUpdate', checked);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'info',\r\n      message: checked ? 'Đã bật đồng bộ khi cập nhật SP' : 'Đã tắt đồng bộ khi cập nhật SP',\r\n      details: {}\r\n    });\r\n  };\r\n\r\n  const handleToggleNotify = (checked: boolean) => {\r\n    updateSyncSetting('notifyOnError', checked);\r\n    addLog({\r\n      action: 'save_config',\r\n      status: 'info',\r\n      message: checked ? 'Đã bật thông báo lỗi' : 'Đã tắt thông báo lỗi',\r\n      details: {}\r\n    });\r\n  };\r\n\r\n  const getNextSyncTime = () => {\r\n    if (!lastSyncAt || !syncSettings.autoSyncEnabled) return null;\r\n    const lastSync = new Date(lastSyncAt);\r\n    const nextSync = new Date(lastSync.getTime() + syncSettings.intervalMinutes * 60 * 1000);\r\n    return nextSync;\r\n  };\r\n\r\n  const nextSync = getNextSyncTime();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Schedule Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Lịch đồng bộ tự động</CardTitle>\r\n          <CardDescription>Cài đặt thời gian và tần suất đồng bộ</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <Label className=\"text-base\">Bật Auto Sync</Label>\r\n              <p className=\"text-sm text-muted-foreground\">Tự động đồng bộ dữ liệu theo lịch</p>\r\n            </div>\r\n            <Switch\r\n              checked={syncSettings.autoSyncEnabled}\r\n              onCheckedChange={handleToggleAutoSync}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <Label>Tần suất đồng bộ</Label>\r\n            <Select\r\n              value={syncSettings.intervalMinutes.toString()}\r\n              onValueChange={(value) => updateSyncSetting('intervalMinutes', parseInt(value, 10))}\r\n              disabled={!syncSettings.autoSyncEnabled}\r\n            >\r\n              <SelectTrigger className=\"w-[180px]\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {SYNC_INTERVAL_OPTIONS.map((option) => (\r\n                  <SelectItem key={option.value} value={option.value.toString()}>\r\n                    {option.label}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Data Types Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Loại dữ liệu đồng bộ</CardTitle>\r\n          <CardDescription>Chọn những thông tin cần đồng bộ lên PKGX</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <Label className=\"text-base\">Đồng bộ tồn kho</Label>\r\n              <p className=\"text-sm text-muted-foreground\">Tổng tồn kho tất cả chi nhánh</p>\r\n            </div>\r\n            <Switch\r\n              checked={syncSettings.syncInventory}\r\n              onCheckedChange={handleToggleSyncInventory}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <Label className=\"text-base\">Đồng bộ giá</Label>\r\n              <p className=\"text-sm text-muted-foreground\">Theo mapping bảng giá đã cấu hình</p>\r\n            </div>\r\n            <Switch\r\n              checked={syncSettings.syncPrice}\r\n              onCheckedChange={handleToggleSyncPrice}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <Label className=\"text-base\">Đồng bộ SEO</Label>\r\n              <p className=\"text-sm text-muted-foreground\">meta_title, meta_desc, keywords</p>\r\n            </div>\r\n            <Switch\r\n              checked={syncSettings.syncSeo}\r\n              onCheckedChange={handleToggleSyncSeo}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <Label className=\"text-base\">Sync ngay khi cập nhật sản phẩm</Label>\r\n              <p className=\"text-sm text-muted-foreground\">Đồng bộ real-time khi sửa SP trong HRM</p>\r\n            </div>\r\n            <Switch\r\n              checked={syncSettings.syncOnProductUpdate}\r\n              onCheckedChange={handleToggleSyncOnUpdate}\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Notification Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Thông báo</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <Label className=\"text-base\">Thông báo khi có lỗi sync</Label>\r\n              <p className=\"text-sm text-muted-foreground\">Nhận thông báo khi đồng bộ thất bại</p>\r\n            </div>\r\n            <Switch\r\n              checked={syncSettings.notifyOnError}\r\n              onCheckedChange={handleToggleNotify}\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Status Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Trạng thái đồng bộ</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div className=\"p-4 bg-muted rounded-lg\">\r\n              <p className=\"text-sm text-muted-foreground\">Lần sync cuối</p>\r\n              <p className=\"font-medium\">\r\n                {lastSyncAt ? new Date(lastSyncAt).toLocaleString('vi-VN') : 'Chưa có'}\r\n              </p>\r\n            </div>\r\n            <div className=\"p-4 bg-muted rounded-lg\">\r\n              <p className=\"text-sm text-muted-foreground\">Kết quả</p>\r\n              {lastSyncResult ? (\r\n                <div className=\"flex items-center gap-2\">\r\n                  {lastSyncResult.status === 'success' ? (\r\n                    <Badge className=\"bg-green-500\"><CheckCircle2 className=\"h-3 w-3 mr-1\" />Thành công</Badge>\r\n                  ) : (\r\n                    <Badge variant=\"destructive\"><AlertCircle className=\"h-3 w-3 mr-1\" />Có lỗi</Badge>\r\n                  )}\r\n                  <span className=\"text-sm\">{lastSyncResult.success}/{lastSyncResult.total}</span>\r\n                </div>\r\n              ) : (\r\n                <p className=\"font-medium\">--</p>\r\n              )}\r\n            </div>\r\n            <div className=\"p-4 bg-muted rounded-lg\">\r\n              <p className=\"text-sm text-muted-foreground\">Lần sync tiếp theo</p>\r\n              <p className=\"font-medium\">\r\n                {nextSync ? nextSync.toLocaleString('vi-VN') : 'Không có'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 pt-4\">\r\n            <Button onClick={handleManualSync} disabled={isSyncing}>\r\n              {isSyncing ? (\r\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n              ) : (\r\n                <Play className=\"h-4 w-4 mr-2\" />\r\n              )}\r\n              {isSyncing ? 'Đang sync...' : 'Sync ngay'}\r\n            </Button>\r\n            <Button variant=\"outline\">\r\n              <FileText className=\"h-4 w-4 mr-2\" />\r\n              Xem log\r\n            </Button>\r\n            {syncSettings.autoSyncEnabled && (\r\n              <Button variant=\"outline\" onClick={() => handleToggleAutoSync(false)}>\r\n                <Pause className=\"h-4 w-4 mr-2\" />\r\n                Tạm dừng\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10096, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/log-tab.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../../../components/ui/card';\r\nimport { Button } from '../../../../components/ui/button';\r\nimport { Input } from '../../../../components/ui/input';\r\nimport { Badge } from '../../../../components/ui/badge';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../../../components/ui/select';\r\nimport { ResponsiveDataTable } from '../../../../components/data-table/responsive-data-table';\r\nimport { PageFilters } from '../../../../components/layout/page-filters';\r\nimport type { ColumnDef } from '../../../../components/data-table/types';\r\nimport { Search, CheckCircle2, XCircle, AlertCircle, RefreshCw, Globe, Link, Unlink, Save, Settings, DollarSign, Package, FileText, Info, User, Image } from 'lucide-react';\r\nimport { usePkgxSettingsStore } from '../store';\r\nimport type { PkgxSyncLog } from '../types';\r\n\r\n// Extended type with systemId for ResponsiveDataTable\r\ntype PkgxSyncLogWithSystemId = PkgxSyncLog & { systemId: string };\r\n\r\nexport function LogTab() {\r\n  const { settings } = usePkgxSettingsStore();\r\n  \r\n  const [searchTerm, setSearchTerm] = React.useState('');\r\n  const [statusFilter, setStatusFilter] = React.useState<'all' | 'success' | 'error' | 'partial' | 'info'>('all');\r\n  const [actionFilter, setActionFilter] = React.useState<string>('all');\r\n  \r\n  // Pagination state\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 20 });\r\n  const [sorting, setSorting] = React.useState<{ id: string; desc: boolean }>({ id: 'timestamp', desc: true });\r\n  const [columnVisibility, setColumnVisibility] = React.useState<Record<string, boolean>>({});\r\n  const [columnOrder, setColumnOrder] = React.useState<string[]>([]);\r\n  const [pinnedColumns, setPinnedColumns] = React.useState<string[]>([]);\r\n  \r\n  // Convert logs to include systemId\r\n  const allLogs = React.useMemo((): PkgxSyncLogWithSystemId[] => {\r\n    return settings.logs.map(log => ({\r\n      ...log,\r\n      systemId: log.id,\r\n    }));\r\n  }, [settings.logs]);\r\n  \r\n  const filteredLogs = React.useMemo(() => {\r\n    let logs = allLogs;\r\n    \r\n    // Filter by status\r\n    if (statusFilter !== 'all') {\r\n      logs = logs.filter((log) => log.status === statusFilter);\r\n    }\r\n    \r\n    // Filter by action\r\n    if (actionFilter !== 'all') {\r\n      logs = logs.filter((log) => log.action === actionFilter);\r\n    }\r\n    \r\n    // Filter by search term\r\n    if (searchTerm) {\r\n      const term = searchTerm.toLowerCase();\r\n      logs = logs.filter(\r\n        (log) =>\r\n          log.message.toLowerCase().includes(term) ||\r\n          log.action.toLowerCase().includes(term) ||\r\n          (log.userName && log.userName.toLowerCase().includes(term))\r\n      );\r\n    }\r\n    \r\n    return logs;\r\n  }, [allLogs, statusFilter, actionFilter, searchTerm]);\r\n  \r\n  // Sorted data\r\n  const sortedData = React.useMemo(() => {\r\n    const sorted = [...filteredLogs];\r\n    if (sorting.id) {\r\n      sorted.sort((a, b) => {\r\n        const aVal = (a as unknown as Record<string, unknown>)[sorting.id];\r\n        const bVal = (b as unknown as Record<string, unknown>)[sorting.id];\r\n        \r\n        if (aVal === bVal) return 0;\r\n        if (aVal === null || aVal === undefined) return 1;\r\n        if (bVal === null || bVal === undefined) return -1;\r\n        \r\n        const comparison = String(aVal).localeCompare(String(bVal));\r\n        return sorting.desc ? -comparison : comparison;\r\n      });\r\n    }\r\n    return sorted;\r\n  }, [filteredLogs, sorting]);\r\n  \r\n  // Paginated data\r\n  const paginatedData = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    return sortedData.slice(start, start + pagination.pageSize);\r\n  }, [sortedData, pagination]);\r\n  \r\n  const pageCount = Math.ceil(sortedData.length / pagination.pageSize);\r\n  \r\n  const getStatusBadge = (status: PkgxSyncLog['status']) => {\r\n    switch (status) {\r\n      case 'success':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-green-500\">\r\n            <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n            Thành công\r\n          </Badge>\r\n        );\r\n      case 'error':\r\n        return (\r\n          <Badge variant=\"destructive\">\r\n            <XCircle className=\"h-3 w-3 mr-1\" />\r\n            Lỗi\r\n          </Badge>\r\n        );\r\n      case 'partial':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-yellow-500\">\r\n            <AlertCircle className=\"h-3 w-3 mr-1\" />\r\n            Một phần\r\n          </Badge>\r\n        );\r\n      case 'info':\r\n        return (\r\n          <Badge variant=\"secondary\">\r\n            <Info className=\"h-3 w-3 mr-1\" />\r\n            Thông tin\r\n          </Badge>\r\n        );\r\n    }\r\n  };\r\n  \r\n  const getActionIcon = (action: PkgxSyncLog['action']) => {\r\n    switch (action) {\r\n      case 'test_connection':\r\n      case 'ping':\r\n        return <Globe className=\"h-4 w-4 text-blue-500\" />;\r\n      case 'sync_price':\r\n        return <DollarSign className=\"h-4 w-4 text-green-500\" />;\r\n      case 'sync_inventory':\r\n        return <Package className=\"h-4 w-4 text-orange-500\" />;\r\n      case 'sync_seo':\r\n        return <FileText className=\"h-4 w-4 text-purple-500\" />;\r\n      case 'sync_images':\r\n      case 'bulk_sync_images':\r\n      case 'upload_image':\r\n        return <Image className=\"h-4 w-4 text-pink-500\" />;\r\n      case 'create_product':\r\n      case 'update_product':\r\n        return <RefreshCw className=\"h-4 w-4 text-cyan-500\" />;\r\n      case 'link_product':\r\n        return <Link className=\"h-4 w-4 text-blue-500\" />;\r\n      case 'unlink_product':\r\n      case 'unlink_mapping':\r\n      case 'batch_unlink':\r\n        return <Unlink className=\"h-4 w-4 text-gray-500\" />;\r\n      case 'save_config':\r\n      case 'save_mapping':\r\n        return <Save className=\"h-4 w-4 text-emerald-500\" />;\r\n      case 'sync_categories':\r\n      case 'sync_brands':\r\n      case 'get_products':\r\n      case 'sync_all':\r\n      case 'bulk_sync_all':\r\n      case 'bulk_sync_basic':\r\n      case 'bulk_sync_price':\r\n      case 'bulk_sync_inventory':\r\n      case 'bulk_sync_seo':\r\n      case 'bulk_sync_description':\r\n      case 'bulk_sync_flags':\r\n        return <RefreshCw className=\"h-4 w-4 text-indigo-500\" />;\r\n      default:\r\n        return <Settings className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n  \r\n  const getActionLabel = (action: PkgxSyncLog['action']) => {\r\n    const labels: Record<PkgxSyncLog['action'], string> = {\r\n      test_connection: 'Test kết nối',\r\n      ping: 'Ping server',\r\n      sync_all: 'Đồng bộ tất cả',\r\n      sync_price: 'Đồng bộ giá',\r\n      sync_inventory: 'Đồng bộ tồn kho',\r\n      sync_seo: 'Đồng bộ SEO',\r\n      sync_description: 'Đồng bộ mô tả',\r\n      sync_flags: 'Đồng bộ flags',\r\n      sync_basic: 'Đồng bộ cơ bản',\r\n      sync_basic_info: 'Đồng bộ cơ bản',\r\n      sync_images: 'Đồng bộ ảnh',\r\n      create_product: 'Tạo SP',\r\n      update_product: 'Cập nhật SP',\r\n      link_product: 'Liên kết SP',\r\n      unlink_product: 'Hủy liên kết',\r\n      unlink_mapping: 'Hủy mapping',\r\n      batch_unlink: 'Hủy hàng loạt',\r\n      bulk_sync_all: 'Bulk: Tất cả',\r\n      bulk_sync_basic: 'Bulk: Cơ bản',\r\n      bulk_sync_price: 'Bulk: Giá',\r\n      bulk_sync_inventory: 'Bulk: Tồn kho',\r\n      bulk_sync_seo: 'Bulk: SEO',\r\n      bulk_sync_description: 'Bulk: Mô tả',\r\n      bulk_sync_flags: 'Bulk: Flags',\r\n      bulk_sync_images: 'Bulk: Ảnh',\r\n      sync_categories: 'Đồng bộ danh mục',\r\n      sync_brands: 'Đồng bộ thương hiệu',\r\n      get_products: 'Lấy DS sản phẩm',\r\n      upload_image: 'Upload ảnh',\r\n      save_config: 'Lưu cấu hình',\r\n      save_mapping: 'Lưu mapping',\r\n    };\r\n    return labels[action] || action;\r\n  };\r\n  \r\n  const formatTimestamp = (timestamp: string) => {\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleString('vi-VN', {\r\n      year: 'numeric',\r\n      month: '2-digit',\r\n      day: '2-digit',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n      second: '2-digit',\r\n    });\r\n  };\r\n  \r\n  const getDetailsDisplay = (log: PkgxSyncLogWithSystemId) => {\r\n    if (!log.details) return null;\r\n    \r\n    return (\r\n      <div className=\"space-y-0.5 text-xs text-muted-foreground\">\r\n        {/* API details */}\r\n        {log.details.method && log.details.url && (\r\n          <div className=\"font-mono text-blue-600\">\r\n            {log.details.method} {log.details.url.length > 25 ? '...' + log.details.url.slice(-25) : log.details.url}\r\n          </div>\r\n        )}\r\n        {log.details.httpStatus && (\r\n          <div className={log.details.httpStatus >= 400 ? 'text-red-600' : 'text-green-600'}>\r\n            HTTP: {log.details.httpStatus}\r\n          </div>\r\n        )}\r\n        {log.details.responseTime !== undefined && (\r\n          <div className=\"text-gray-500\">{log.details.responseTime}ms</div>\r\n        )}\r\n        {/* Sync stats */}\r\n        {log.details.total !== undefined && (\r\n          <div>Tổng: {log.details.total}</div>\r\n        )}\r\n        {log.details.success !== undefined && log.details.success > 0 && (\r\n          <div className=\"text-green-600\">OK: {log.details.success}</div>\r\n        )}\r\n        {log.details.failed !== undefined && log.details.failed > 0 && (\r\n          <div className=\"text-red-600\">Lỗi: {log.details.failed}</div>\r\n        )}\r\n        {/* Product details */}\r\n        {log.details.productId && (\r\n          <div>SP: {log.details.productId}</div>\r\n        )}\r\n        {log.details.pkgxId && (\r\n          <div>PKGX: {log.details.pkgxId}</div>\r\n        )}\r\n        {/* Error info */}\r\n        {log.details.errorCode && (\r\n          <div className=\"text-red-600\">Mã: {log.details.errorCode}</div>\r\n        )}\r\n        {log.details.error && (\r\n          <div className=\"text-red-600 truncate max-w-[150px]\" title={log.details.error}>\r\n            {log.details.error}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Define columns\r\n  const columns: ColumnDef<PkgxSyncLogWithSystemId>[] = [\r\n    {\r\n      id: 'timestamp',\r\n      accessorKey: 'timestamp',\r\n      header: 'Thời gian',\r\n      size: 150,\r\n      cell: ({ row }) => (\r\n        <span className=\"text-xs font-mono\">\r\n          {formatTimestamp(row.timestamp)}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      id: 'action',\r\n      accessorKey: 'action',\r\n      header: 'Hành động',\r\n      size: 150,\r\n      cell: ({ row }) => (\r\n        <div className=\"flex items-center gap-2\">\r\n          {getActionIcon(row.action)}\r\n          <Badge variant=\"outline\" className=\"text-xs whitespace-nowrap\">\r\n            {getActionLabel(row.action)}\r\n          </Badge>\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      id: 'status',\r\n      accessorKey: 'status',\r\n      header: 'Trạng thái',\r\n      size: 110,\r\n      cell: ({ row }) => getStatusBadge(row.status),\r\n    },\r\n    {\r\n      id: 'message',\r\n      accessorKey: 'message',\r\n      header: 'Thông báo',\r\n      size: 280,\r\n      cell: ({ row }) => (\r\n        <span className=\"text-sm truncate block max-w-[260px]\" title={row.message}>\r\n          {row.message}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      id: 'userName',\r\n      accessorKey: 'userName',\r\n      header: 'Người thực hiện',\r\n      size: 130,\r\n      cell: ({ row }) => (\r\n        <div className=\"flex items-center gap-1.5 text-xs\">\r\n          <User className=\"h-3 w-3 text-muted-foreground\" />\r\n          <span className=\"truncate max-w-[100px]\" title={row.userName || 'Hệ thống'}>\r\n            {row.userName || 'Hệ thống'}\r\n          </span>\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      id: 'details',\r\n      accessorKey: 'details',\r\n      header: 'Chi tiết',\r\n      size: 180,\r\n      cell: ({ row }) => getDetailsDisplay(row),\r\n    },\r\n  ];\r\n\r\n  // Mobile card renderer\r\n  const renderMobileCard = (log: PkgxSyncLogWithSystemId) => (\r\n    <div className=\"p-4 space-y-3\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <div className=\"flex items-center gap-2\">\r\n          {getActionIcon(log.action)}\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            {getActionLabel(log.action)}\r\n          </Badge>\r\n        </div>\r\n        {getStatusBadge(log.status)}\r\n      </div>\r\n      \r\n      <div className=\"space-y-1.5\">\r\n        <p className=\"text-sm\">{log.message}</p>\r\n        <p className=\"text-xs text-muted-foreground font-mono\">\r\n          {formatTimestamp(log.timestamp)}\r\n        </p>\r\n      </div>\r\n      \r\n      {log.details && (\r\n        <div className=\"pt-2 border-t\">\r\n          {getDetailsDisplay(log)}\r\n        </div>\r\n      )}\r\n      \r\n      <div className=\"flex items-center justify-between pt-2 border-t\">\r\n        <div className=\"flex items-center gap-1.5 text-xs text-muted-foreground\">\r\n          <User className=\"h-3 w-3\" />\r\n          <span>{log.userName || 'Hệ thống'}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-lg\">Lịch sử đồng bộ</CardTitle>\r\n          <CardDescription>\r\n            Theo dõi hoạt động đồng bộ với PKGX\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* Filters */}\r\n          <PageFilters>\r\n            <div className=\"relative flex-1 min-w-[200px]\">\r\n              <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Tìm kiếm logs...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"pl-9\"\r\n              />\r\n            </div>\r\n            <Select value={statusFilter} onValueChange={(v: 'all' | 'success' | 'error' | 'partial' | 'info') => setStatusFilter(v)}>\r\n              <SelectTrigger className=\"w-[160px]\">\r\n                <SelectValue placeholder=\"Trạng thái\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">Tất cả trạng thái</SelectItem>\r\n                <SelectItem value=\"success\">Thành công</SelectItem>\r\n                <SelectItem value=\"error\">Lỗi</SelectItem>\r\n                <SelectItem value=\"partial\">Một phần</SelectItem>\r\n                <SelectItem value=\"info\">Thông tin</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n            <Select value={actionFilter} onValueChange={setActionFilter}>\r\n              <SelectTrigger className=\"w-[170px]\">\r\n                <SelectValue placeholder=\"Hành động\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">Tất cả hành động</SelectItem>\r\n                <SelectItem value=\"test_connection\">Test kết nối</SelectItem>\r\n                <SelectItem value=\"ping\">Ping server</SelectItem>\r\n                <SelectItem value=\"save_config\">Lưu cấu hình</SelectItem>\r\n                <SelectItem value=\"save_mapping\">Lưu mapping</SelectItem>\r\n                <SelectItem value=\"create_product\">Tạo sản phẩm</SelectItem>\r\n                <SelectItem value=\"update_product\">Cập nhật SP</SelectItem>\r\n                <SelectItem value=\"link_product\">Liên kết SP</SelectItem>\r\n                <SelectItem value=\"unlink_product\">Hủy liên kết</SelectItem>\r\n                <SelectItem value=\"sync_all\">Đồng bộ tất cả</SelectItem>\r\n                <SelectItem value=\"sync_price\">Đồng bộ giá</SelectItem>\r\n                <SelectItem value=\"sync_inventory\">Đồng bộ tồn kho</SelectItem>\r\n                <SelectItem value=\"sync_seo\">Đồng bộ SEO</SelectItem>\r\n                <SelectItem value=\"sync_images\">Đồng bộ ảnh</SelectItem>\r\n                <SelectItem value=\"sync_categories\">Đồng bộ danh mục</SelectItem>\r\n                <SelectItem value=\"sync_brands\">Đồng bộ thương hiệu</SelectItem>\r\n                <SelectItem value=\"get_products\">Lấy danh sách SP</SelectItem>\r\n                <SelectItem value=\"upload_image\">Upload ảnh</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </PageFilters>\r\n          \r\n          {/* Stats */}\r\n          <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n            <span>{filteredLogs.length} logs</span>\r\n            {filteredLogs.length !== allLogs.length && (\r\n              <span className=\"text-xs\">(tổng: {allLogs.length})</span>\r\n            )}\r\n          </div>\r\n          \r\n          {/* ResponsiveDataTable */}\r\n          <ResponsiveDataTable<PkgxSyncLogWithSystemId>\r\n            columns={columns}\r\n            data={paginatedData}\r\n            pageCount={pageCount}\r\n            pagination={pagination}\r\n            setPagination={setPagination}\r\n            rowCount={sortedData.length}\r\n            sorting={sorting}\r\n            setSorting={setSorting}\r\n            columnVisibility={columnVisibility}\r\n            setColumnVisibility={setColumnVisibility}\r\n            columnOrder={columnOrder}\r\n            setColumnOrder={setColumnOrder}\r\n            pinnedColumns={pinnedColumns}\r\n            setPinnedColumns={setPinnedColumns}\r\n            renderMobileCard={renderMobileCard}\r\n            emptyTitle=\"Chưa có hoạt động\"\r\n            emptyDescription={\r\n              searchTerm || statusFilter !== 'all' || actionFilter !== 'all'\r\n                ? 'Không tìm thấy log nào phù hợp với bộ lọc'\r\n                : 'Chưa có hoạt động đồng bộ nào'\r\n            }\r\n            emptyAction={\r\n              allLogs.length === 0 ? (\r\n                <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\r\n                  <RefreshCw className=\"h-12 w-12 text-muted-foreground/50\" />\r\n                  <p className=\"text-sm\">Bắt đầu đồng bộ để xem lịch sử hoạt động</p>\r\n                </div>\r\n              ) : undefined\r\n            }\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11212, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/pkgx/components/index.ts"],"sourcesContent":["export { GeneralConfigTab } from './general-config-tab';\r\nexport { CategoryMappingTab } from './category-mapping-tab';\r\nexport { BrandMappingTab } from './brand-mapping-tab';\r\nexport { PriceMappingTab } from './price-mapping-tab';\r\nexport { ProductMappingTab } from './product-mapping-tab';\r\nexport { SyncSettingsTab } from './sync-settings-tab';\r\nexport { LogTab } from './log-tab';\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA"}}]
}