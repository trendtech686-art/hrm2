{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/id-utils.ts"],"sourcesContent":["/**\r\n * ID Utilities\r\n * Helpers for generating and validating IDs (systemId & business id)\r\n */\r\n\r\nimport { getPrefix, type EntityType } from './smart-prefix';\r\nimport { ID_CONFIG } from './id-config';\r\n\r\n// Re-export EntityType for convenience\r\nexport type { EntityType } from './smart-prefix';\r\n\r\n/**\r\n * Generate SystemId (6 digits, immutable, internal use only)\r\n * Format: SYSTEMID_PREFIX + 6 digits (e.g., \"EMP000001\", \"CUSTOMER000001\", \"ORDER000001\")\r\n * Uses systemIdPrefix from ID_CONFIG (English full words)\r\n */\r\nexport function generateSystemId(entityType: EntityType, counter: number): string {\r\n  const config = ID_CONFIG[entityType];\r\n  if (!config) {\r\n    throw new Error(`No configuration found for entity type: ${entityType}`);\r\n  }\r\n  const prefix = config.systemIdPrefix;\r\n  const digitCount = config.digitCount || 6;\r\n  return `${prefix}${String(counter).padStart(digitCount, '0')}`;\r\n}\r\n\r\n/**\r\n * Generate Business ID (6 digits, user-facing, editable)\r\n * Format: PREFIX + 6 digits (e.g., \"NV000001\", \"KH000001\", \"CTV000001\")\r\n * All entities use same 6-digit format for consistency\r\n * \r\n * @param entityType - Entity type from smart-prefix\r\n * @param counter - Current counter value\r\n * @param customId - Optional custom ID from user input\r\n * @returns Generated ID or validated custom ID\r\n */\r\nexport function generateBusinessId(\r\n  entityType: EntityType, \r\n  counter: number,\r\n  customId?: string\r\n): string {\r\n  // If user provided custom ID, validate and return it\r\n  if (customId && customId.trim()) {\r\n    const sanitized = sanitizeBusinessId(customId);\r\n    if (!sanitized) {\r\n      throw new Error('Mã không hợp lệ! Chỉ được phép sử dụng chữ cái và số.');\r\n    }\r\n    return sanitized;\r\n  }\r\n  \r\n  // Otherwise, auto-generate\r\n  const prefix = getPrefix(entityType);\r\n  return `${prefix}${String(counter).padStart(6, '0')}`;\r\n}\r\n\r\n/**\r\n * Sanitize business ID\r\n * - Remove special characters (keep only letters and numbers)\r\n * - Convert to uppercase\r\n * - Trim whitespace\r\n * \r\n * @param id - Raw user input\r\n * @returns Sanitized ID or null if invalid\r\n */\r\nexport function sanitizeBusinessId(id: string): string | null {\r\n  if (!id || typeof id !== 'string') return null;\r\n  \r\n  // Remove all special characters, keep only alphanumeric\r\n  const cleaned = id.trim().replace(/[^a-zA-Z0-9]/g, '');\r\n  \r\n  if (!cleaned) return null;\r\n  \r\n  // Convert to uppercase for consistency\r\n  return cleaned.toUpperCase();\r\n}\r\n\r\n/**\r\n * Validate business ID uniqueness (case-insensitive)\r\n * \r\n * @param id - ID to check\r\n * @param existingIds - Array of existing IDs in the system\r\n * @param currentId - Current ID (for edit mode, to exclude self)\r\n * @returns true if unique, false if duplicate\r\n */\r\nexport function isBusinessIdUnique(\r\n  id: string,\r\n  existingIds: string[],\r\n  currentId?: string\r\n): boolean {\r\n  if (!id) return false;\r\n  \r\n  const normalizedId = id.toUpperCase();\r\n  const normalizedCurrentId = currentId?.toUpperCase();\r\n  \r\n  return !existingIds.some(existingId => {\r\n    // ✅ Filter out empty/undefined IDs\r\n    if (!existingId || existingId.trim() === '') return false;\r\n    \r\n    const normalizedExisting = existingId.toUpperCase();\r\n    // Skip self-comparison in edit mode\r\n    if (normalizedCurrentId && normalizedExisting === normalizedCurrentId) {\r\n      return false;\r\n    }\r\n    return normalizedExisting === normalizedId;\r\n  });\r\n}\r\n\r\n/**\r\n * Extract counter from system ID\r\n * Used to initialize counter when loading from localStorage\r\n * Supports both 6, 7 and 8 digits\r\n * \r\n * @param systemId - System ID to parse (e.g., \"EMP000001\", \"CUSTOMER000001\", \"WARRANTY0000001\")\r\n * @param prefix - Expected systemIdPrefix (e.g., \"EMP\", \"CUSTOMER\", \"WARRANTY\")\r\n * @returns Counter value or 0 if invalid\r\n */\r\nexport function extractCounterFromSystemId(systemId: string, prefix: string): number {\r\n  if (!systemId || typeof systemId !== 'string') return 0;\r\n  \r\n  // Try different digit counts (most entities use 6 digits, some use 7-8)\r\n  const regex8 = new RegExp(`^${prefix}(\\\\d{8})$`);\r\n  const regex7 = new RegExp(`^${prefix}(\\\\d{7})$`);\r\n  const regex6 = new RegExp(`^${prefix}(\\\\d{6})$`);\r\n  \r\n  const match8 = systemId.match(regex8);\r\n  if (match8) return parseInt(match8[1], 10);\r\n  \r\n  const match7 = systemId.match(regex7);\r\n  if (match7) return parseInt(match7[1], 10);\r\n  \r\n  const match6 = systemId.match(regex6);\r\n  if (match6) return parseInt(match6[1], 10);\r\n  \r\n  return 0;\r\n}\r\n\r\n/**\r\n * Extract counter from business ID\r\n * Used to initialize counter when loading from localStorage\r\n * \r\n * @param businessId - Business ID to parse (e.g., \"NV000001\")\r\n * @param prefix - Expected prefix (e.g., \"NV\")\r\n * @returns Counter value or 0 if invalid\r\n */\r\nexport function extractCounterFromBusinessId(businessId: string, prefix: string): number {\r\n  if (!businessId || typeof businessId !== 'string') return 0;\r\n  const regex = new RegExp(`^${prefix}(\\\\d+)$`);\r\n  const match = businessId.match(regex);\r\n  return match ? parseInt(match[1], 10) : 0;\r\n}\r\n\r\n/**\r\n * Get max counter from array of items (for systemId)\r\n * \r\n * @param items - Array of items with systemId\r\n * @param prefix - Prefix to match\r\n * @returns Maximum counter value\r\n */\r\nexport function getMaxSystemIdCounter<T extends { systemId: string }>(\r\n  items: T[],\r\n  prefix: string\r\n): number {\r\n  if (!items || !Array.isArray(items)) return 0;\r\n  \r\n  let maxCounter = 0;\r\n  \r\n  items.forEach(item => {\r\n    if (!item || !item.systemId) return;\r\n    const counter = extractCounterFromSystemId(item.systemId, prefix);\r\n    if (counter > maxCounter) {\r\n      maxCounter = counter;\r\n    }\r\n  });\r\n  \r\n  return maxCounter;\r\n}\r\n\r\n/**\r\n * Get max counter from array of items (for business id)\r\n * Only counts auto-generated IDs (PREFIX + digits)\r\n * \r\n * @param items - Array of items with id\r\n * @param prefix - Prefix to match\r\n * @returns Maximum counter value\r\n */\r\nexport function getMaxBusinessIdCounter<T extends { id: string }>(\r\n  items: T[],\r\n  prefix: string\r\n): number {\r\n  if (!items || !Array.isArray(items)) return 0;\r\n  \r\n  let maxCounter = 0;\r\n  \r\n  items.forEach(item => {\r\n    if (!item || !item.id) return;\r\n    const counter = extractCounterFromBusinessId(item.id, prefix);\r\n    if (counter > maxCounter) {\r\n      maxCounter = counter;\r\n    }\r\n  });\r\n  \r\n  return maxCounter;\r\n}\r\n\r\n/**\r\n * Format ID for display\r\n * Adds spacing for readability\r\n * \r\n * @param id - ID to format\r\n * @returns Formatted ID (e.g., \"NV-000001\", \"KH-000123\")\r\n */\r\nexport function formatIdForDisplay(id: string): string {\r\n  // Match pattern: PREFIX followed by numbers\r\n  const match = id.match(/^([A-Z]+)(\\d+)$/);\r\n  if (!match) return id;\r\n  \r\n  const [, prefix, numbers] = match;\r\n  return `${prefix}-${numbers}`;\r\n}\r\n\r\n/**\r\n * Validate ID format\r\n * Check if ID follows valid pattern (letters + numbers only)\r\n * \r\n * @param id - ID to validate\r\n * @returns true if valid format\r\n */\r\nexport function isValidIdFormat(id: string): boolean {\r\n  if (!id || typeof id !== 'string') return false;\r\n  \r\n  // Only alphanumeric characters allowed\r\n  const regex = /^[A-Z0-9]+$/i;\r\n  return regex.test(id);\r\n}\r\n\r\n/**\r\n * Generate suggested IDs based on entity type\r\n * Useful for autocomplete or placeholder text\r\n * \r\n * @param entityType - Entity type\r\n * @param counter - Current counter\r\n * @param count - Number of suggestions\r\n * @returns Array of suggested IDs\r\n */\r\nexport function generateSuggestedIds(\r\n  entityType: EntityType,\r\n  counter: number,\r\n  count: number = 3\r\n): string[] {\r\n  const suggestions: string[] = [];\r\n  const prefix = getPrefix(entityType);\r\n  \r\n  for (let i = 0; i < count; i++) {\r\n    suggestions.push(`${prefix}${String(counter + i + 1).padStart(6, '0')}`);\r\n  }\r\n  \r\n  return suggestions;\r\n}\r\n\r\n/**\r\n * ✨ Find next available business ID\r\n * Checks existing IDs and increments counter until finding a unique ID\r\n * \r\n * @param prefix - ID prefix (e.g., 'PT', 'PC', 'NV')\r\n * @param existingIds - Array of existing business IDs\r\n * @param startCounter - Starting counter value\r\n * @param digitCount - Number of digits (default: 6)\r\n * @returns Object with nextId and updatedCounter\r\n */\r\nexport function findNextAvailableBusinessId(\r\n  prefix: string,\r\n  existingIds: string[],\r\n  startCounter: number,\r\n  digitCount: number = 6\r\n): { nextId: string; updatedCounter: number } {\r\n  let counter = startCounter;\r\n  let nextId: string;\r\n  \r\n  // Keep incrementing until we find a unique ID\r\n  do {\r\n    counter++;\r\n    nextId = `${prefix}${String(counter).padStart(digitCount, '0')}`;\r\n  } while (existingIds.some(id => id === nextId));\r\n  \r\n  return {\r\n    nextId,\r\n    updatedCounter: counter\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/attendance/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { AttendanceDataRow, AttendanceDayKey, DailyRecord } from './types';\r\nimport type { SystemId } from '../../lib/id-types';\r\n\r\n// API sync helper\r\nasync function syncToAPI(action: 'save' | 'lock' | 'unlock', data: any): Promise<boolean> {\r\n  try {\r\n    const endpoint = '/api/attendance';\r\n    const method = action === 'save' ? 'POST' : 'PATCH';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ action, ...data }),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Attendance API] ${action} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Attendance API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function fetchFromAPI(monthKey: string): Promise<AttendanceDataRow[] | null> {\r\n  try {\r\n    const [year, month] = monthKey.split('-');\r\n    const fromDate = `${year}-${month}-01`;\r\n    const lastDay = new Date(parseInt(year), parseInt(month), 0).getDate();\r\n    const toDate = `${year}-${month}-${lastDay}`;\r\n    \r\n    // Attendance is filtered by month, so 500 records should cover most cases\r\n    const response = await fetch(`/api/attendance?fromDate=${fromDate}&toDate=${toDate}&limit=500`);\r\n    if (!response.ok) return null;\r\n    \r\n    const json = await response.json();\r\n    return json.data || null;\r\n  } catch (error) {\r\n    console.error('[Attendance API] fetch error:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\ntype AttendanceStoreState = {\r\n  lockedMonths: Record<string, boolean>; // key: \"YYYY-MM\"\r\n  toggleLock: (monthYear: string) => void;\r\n  lockMonth: (monthYear: string) => void;\r\n  unlockMonth: (monthYear: string) => void;\r\n  \r\n  // Data storage\r\n  attendanceData: Record<string, AttendanceDataRow[]>; // key: \"YYYY-MM\"\r\n  saveAttendanceData: (monthKey: string, data: AttendanceDataRow[]) => void;\r\n  getAttendanceData: (monthKey: string) => AttendanceDataRow[] | null;\r\n  updateEmployeeRecord: (\r\n    monthKey: string,\r\n    employeeSystemId: SystemId,\r\n    dayKey: AttendanceDayKey,\r\n    record: DailyRecord\r\n  ) => void;\r\n  \r\n  // API sync\r\n  loadFromAPI: (monthKey: string) => Promise<void>;\r\n  initialized: boolean;\r\n};\r\n\r\nexport const useAttendanceStore = create<AttendanceStoreState>()(\r\n  (set, get) => ({\r\n      lockedMonths: {},\r\n      initialized: false,\r\n      \r\n      lockMonth: (monthYear) => {\r\n        set((state) => ({\r\n          lockedMonths: {\r\n            ...state.lockedMonths,\r\n            [monthYear]: true,\r\n          },\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('lock', { monthYear }).catch(console.error);\r\n      },\r\n      unlockMonth: (monthYear) => {\r\n        set((state) => {\r\n          if (!state.lockedMonths[monthYear]) {\r\n            return state;\r\n          }\r\n          const nextLocked = { ...state.lockedMonths };\r\n          delete nextLocked[monthYear];\r\n          return { lockedMonths: nextLocked };\r\n        });\r\n        // Sync to API\r\n        syncToAPI('unlock', { monthYear }).catch(console.error);\r\n      },\r\n      toggleLock: (monthYear) => {\r\n        const isLocked = Boolean(get().lockedMonths[monthYear]);\r\n        if (isLocked) {\r\n          get().unlockMonth(monthYear);\r\n        } else {\r\n          get().lockMonth(monthYear);\r\n        }\r\n      },\r\n      \r\n      // Data management\r\n      attendanceData: {},\r\n      saveAttendanceData: (monthKey, data) => {\r\n        set((state) => ({\r\n          attendanceData: {\r\n            ...state.attendanceData,\r\n            [monthKey]: data,\r\n          },\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('save', { monthKey, data }).catch(console.error);\r\n      },\r\n      getAttendanceData: (monthKey) => {\r\n        return get().attendanceData[monthKey] || null;\r\n      },\r\n      updateEmployeeRecord: (monthKey, employeeSystemId, dayKey, record) => {\r\n        set((state) => {\r\n          const monthData = state.attendanceData[monthKey];\r\n          if (!monthData) return state;\r\n          \r\n          const updatedData = monthData.map(emp => {\r\n            if (emp.employeeSystemId === employeeSystemId) {\r\n              return { ...emp, [dayKey]: record };\r\n            }\r\n            return emp;\r\n          });\r\n          \r\n          return {\r\n            attendanceData: {\r\n              ...state.attendanceData,\r\n              [monthKey]: updatedData,\r\n            },\r\n          };\r\n        });\r\n        // Sync single record to API\r\n        syncToAPI('save', { monthKey, employeeSystemId, dayKey, record }).catch(console.error);\r\n      },\r\n      \r\n      // Load from API\r\n      loadFromAPI: async (monthKey: string) => {\r\n        const apiData = await fetchFromAPI(monthKey);\r\n        if (apiData && apiData.length > 0) {\r\n          set((state) => ({\r\n            attendanceData: {\r\n              ...state.attendanceData,\r\n              [monthKey]: apiData,\r\n            },\r\n            initialized: true,\r\n          }));\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 322, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/id-types.ts"],"sourcesContent":["/**\r\n * Type-safe ID System\r\n * \r\n * Prevents mixing systemId with business ID at compile time\r\n */\r\n\r\n// Branded types for type safety\r\nexport type SystemId = string & { readonly __brand: 'SystemId' };\r\nexport type BusinessId = string & { readonly __brand: 'BusinessId' };\r\n\r\n/**\r\n * Create a SystemId from a string\r\n * Use this when you know for sure it's a systemId\r\n */\r\nexport function asSystemId(id: string): SystemId {\r\n  return id as SystemId;\r\n}\r\n\r\n/**\r\n * Create a BusinessId from a string\r\n * Use this when you know for sure it's a business ID\r\n */\r\nexport function asBusinessId(id: string): BusinessId {\r\n  return id as BusinessId;\r\n}\r\n\r\n/**\r\n * Check if a string is a valid systemId format\r\n */\r\nexport function isSystemIdFormat(id: string): boolean {\r\n  // SystemId: 8 digits + prefix (e.g., NV00000001, VOUCHER00000123)\r\n  return /^[A-Z]+\\d{8}$/.test(id);\r\n}\r\n\r\n/**\r\n * Check if a string is a valid business ID format\r\n */\r\nexport function isBusinessIdFormat(id: string): boolean {\r\n  // Business ID: shorter, variable length (e.g., NV001, PT000001)\r\n  return /^[A-Z]+\\d{3,6}$/.test(id);\r\n}\r\n\r\n/**\r\n * Safely convert unknown ID to proper type\r\n */\r\nexport function parseId(id: string): { type: 'system' | 'business'; value: SystemId | BusinessId } {\r\n  if (isSystemIdFormat(id)) {\r\n    return { type: 'system', value: asSystemId(id) };\r\n  }\r\n  if (isBusinessIdFormat(id)) {\r\n    return { type: 'business', value: asBusinessId(id) };\r\n  }\r\n  throw new Error(`Invalid ID format: ${id}`);\r\n}\r\n\r\n/**\r\n * ID Pair - Always keep systemId and businessId together\r\n */\r\nexport interface IDPair {\r\n  systemId: SystemId;\r\n  businessId: BusinessId;\r\n}\r\n\r\n/**\r\n * Entity with dual IDs\r\n */\r\nexport interface DualIDEntity {\r\n  systemId: SystemId;\r\n  id: BusinessId;\r\n}\r\n\r\n/**\r\n * Store methods with type-safe IDs\r\n */\r\nexport interface TypeSafeStore<T extends DualIDEntity> {\r\n  /** Find by systemId (for queries, relationships) */\r\n  findBySystemId(systemId: SystemId): T | null;\r\n  \r\n  /** Find by business ID (for user input, display) */\r\n  findByBusinessId(businessId: BusinessId): T | null;\r\n  \r\n  /** Update by systemId (always use systemId for updates) */\r\n  updateBySystemId(systemId: SystemId, updates: Partial<T>): void;\r\n  \r\n  /** Delete by systemId (always use systemId for deletes) */\r\n  deleteBySystemId(systemId: SystemId): void;\r\n}\r\n\r\n/**\r\n * Route params with type-safe IDs\r\n */\r\nexport interface RouteParams {\r\n  systemId?: SystemId;\r\n  id?: BusinessId;\r\n}\r\n\r\n/**\r\n * Link builder - always uses systemId\r\n */\r\nexport function buildEntityLink(path: string, entity: DualIDEntity): string {\r\n  return path.replace(':systemId', entity.systemId);\r\n}\r\n\r\n/**\r\n * Display ID - always uses business ID\r\n */\r\nexport function getDisplayId(entity: DualIDEntity): string {\r\n  return entity.id;\r\n}\r\n\r\n/**\r\n * Runtime guard: ensures a string is valid SystemId format and casts it\r\n * Logs warning if format is invalid\r\n */\r\nexport function ensureSystemId(id: string, context?: string): SystemId {\r\n  if (!isSystemIdFormat(id)) {\r\n    console.warn(`[ensureSystemId] Invalid SystemId format: \"${id}\"${context ? ` in ${context}` : ''}`);\r\n  }\r\n  return asSystemId(id);\r\n}\r\n\r\n/**\r\n * Runtime guard: ensures a string is valid BusinessId format and casts it\r\n * Logs warning if format is invalid\r\n */\r\nexport function ensureBusinessId(id: string, context?: string): BusinessId {\r\n  if (!isBusinessIdFormat(id)) {\r\n    console.warn(`[ensureBusinessId] Invalid BusinessId format: \"${id}\"${context ? ` in ${context}` : ''}`);\r\n  }\r\n  return asBusinessId(id);\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,gCAAgC;;;;;;;;;;;;;;;;;;;;;AAQzB,SAAS,WAAW,EAAU;IACnC,OAAO;AACT;AAMO,SAAS,aAAa,EAAU;IACrC,OAAO;AACT;AAKO,SAAS,iBAAiB,EAAU;IACzC,kEAAkE;IAClE,OAAO,gBAAgB,IAAI,CAAC;AAC9B;AAKO,SAAS,mBAAmB,EAAU;IAC3C,gEAAgE;IAChE,OAAO,kBAAkB,IAAI,CAAC;AAChC;AAKO,SAAS,QAAQ,EAAU;IAChC,IAAI,iBAAiB,KAAK;QACxB,OAAO;YAAE,MAAM;YAAU,OAAO,WAAW;QAAI;IACjD;IACA,IAAI,mBAAmB,KAAK;QAC1B,OAAO;YAAE,MAAM;YAAY,OAAO,aAAa;QAAI;IACrD;IACA,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,IAAI;AAC5C;AA8CO,SAAS,gBAAgB,IAAY,EAAE,MAAoB;IAChE,OAAO,KAAK,OAAO,CAAC,aAAa,OAAO,QAAQ;AAClD;AAKO,SAAS,aAAa,MAAoB;IAC/C,OAAO,OAAO,EAAE;AAClB;AAMO,SAAS,eAAe,EAAU,EAAE,OAAgB;IACzD,IAAI,CAAC,iBAAiB,KAAK;QACzB,QAAQ,IAAI,CAAC,CAAC,2CAA2C,EAAE,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI;IACpG;IACA,OAAO,WAAW;AACpB;AAMO,SAAS,iBAAiB,EAAU,EAAE,OAAgB;IAC3D,IAAI,CAAC,mBAAmB,KAAK;QAC3B,QAAQ,IAAI,CAAC,CAAC,+CAA+C,EAAE,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI;IACxG;IACA,OAAO,aAAa;AACtB"}},
    {"offset": {"line": 401, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/payroll-batch-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type {\r\n  PayrollBatch,\r\n  PayrollBatchStatus,\r\n  PayrollAuditLog,\r\n  PayrollAuditAction,\r\n  Payslip,\r\n  PayrollComponentEntry,\r\n  PayrollTotals,\r\n  PayrollPeriod,\r\n} from '../../lib/payroll-types';\r\nimport { generateSystemId, findNextAvailableBusinessId } from '../../lib/id-utils';\r\nimport { getPrefix, type EntityType } from '../../lib/smart-prefix';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { useAttendanceStore } from '../attendance/store';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '../../lib/id-types';\r\n\r\n// API sync helpers\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', entityType: 'batch' | 'payslip', data: any): Promise<boolean> {\r\n  try {\r\n    const basePath = entityType === 'batch' ? '/api/payroll/batches' : '/api/payroll/payslips';\r\n    const endpoint = action === 'create' ? basePath : `${basePath}/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Payroll API] ${action} ${entityType} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Payroll API] ${action} ${entityType} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Type for payslip updates\r\nexport type PayslipUpdatePayload = {\r\n  components?: PayrollComponentEntry[];\r\n  totals?: PayrollTotals;\r\n};\r\n\r\nconst AUDIT_ACTION_FOR_STATUS: Record<PayrollBatchStatus, PayrollAuditAction> = {\r\n  draft: 'run',\r\n  reviewed: 'review',\r\n  locked: 'lock',\r\n  cancelled: 'run', // cancelled uses same action as draft\r\n};\r\n\r\nconst resolveActorSystemId = () => asSystemId(getCurrentUserSystemId() || 'SYSTEM00000000');\r\n\r\ntype CounterState = {\r\n  systemId: number;\r\n  businessId: number;\r\n};\r\n\r\ntype CounterMap = {\r\n  payroll: CounterState;\r\n  payslips: CounterState;\r\n  'payroll-audit-log': CounterState;\r\n};\r\n\r\ntype CreateBatchInput = {\r\n  title: string;\r\n  templateSystemId?: SystemId | undefined;\r\n  payPeriod: PayrollPeriod;\r\n  payrollDate: string;\r\n  referenceAttendanceMonthKeys?: string[] | undefined;\r\n  notes?: string | undefined;\r\n};\r\n\r\ntype CreatePayslipInput = {\r\n  employeeSystemId: SystemId;\r\n  employeeId: BusinessId;\r\n  departmentSystemId?: SystemId | undefined;\r\n  periodMonthKey: string;\r\n  components: PayrollComponentEntry[];\r\n  totals: PayrollTotals;\r\n  attendanceSnapshotSystemId?: SystemId | undefined;\r\n  deductedPenaltySystemIds?: SystemId[] | undefined;\r\n};\r\n\r\nexport type GeneratedPayslipPayload = {\r\n  employeeSystemId: SystemId;\r\n  employeeId: BusinessId;\r\n  departmentSystemId?: SystemId | undefined;\r\n  periodMonthKey: string;\r\n  components: PayrollComponentEntry[];\r\n  totals: PayrollTotals;\r\n  attendanceSnapshotSystemId?: SystemId | undefined;\r\n  deductedPenaltySystemIds?: SystemId[] | undefined;\r\n};\r\n\r\ntype LogActionInput = {\r\n  batchSystemId: SystemId;\r\n  action: PayrollAuditAction;\r\n  payload?: Record<string, unknown> | undefined;\r\n  actorSystemId?: SystemId | undefined;\r\n  actorDisplayName?: string | undefined;\r\n};\r\n\r\ntype PayrollBatchStoreState = {\r\n  batches: PayrollBatch[];\r\n  payslips: Payslip[];\r\n  auditLogs: PayrollAuditLog[];\r\n  counters: CounterMap;\r\n  initialized: boolean;\r\n  createBatch: (input: CreateBatchInput) => PayrollBatch;\r\n  createBatchWithResults: (input: CreateBatchInput, payslips: GeneratedPayslipPayload[]) => PayrollBatch;\r\n  updateBatchStatus: (systemId: SystemId, status: PayrollBatchStatus, note?: string) => void;\r\n  addPayslips: (batchSystemId: SystemId, inputs: CreatePayslipInput[]) => void;\r\n  updatePayslip: (payslipSystemId: SystemId, updates: PayslipUpdatePayload) => { success: boolean; error?: string };\r\n  removePayslipFromBatch: (payslipSystemId: SystemId) => { success: boolean; error?: string };\r\n  cancelBatch: (systemId: SystemId, reason?: string) => { success: boolean; error?: string };\r\n  logAction: (input: LogActionInput) => PayrollAuditLog;\r\n  getBatchBySystemId: (systemId: SystemId) => PayrollBatch | undefined;\r\n  getPayslipsByBatch: (batchSystemId: SystemId) => Payslip[];\r\n  getPayslipBySystemId: (systemId: SystemId) => Payslip | undefined;\r\n  loadFromAPI: () => Promise<void>;\r\n};\r\n\r\nconst initialCounters: CounterMap = {\r\n  payroll: { systemId: 0, businessId: 0 },\r\n  payslips: { systemId: 0, businessId: 0 },\r\n  'payroll-audit-log': { systemId: 0, businessId: 0 },\r\n};\r\n\r\nconst collectBusinessIds = (items: { id: string }[]) =>\r\n  items.map((item) => item.id?.toUpperCase()).filter((id): id is string => Boolean(id));\r\n\r\nconst buildDualIds = (\r\n  entityType: EntityType,\r\n  counter: CounterState,\r\n  existingIds: string[]\r\n) => {\r\n  const nextSystemCounter = counter.systemId + 1;\r\n  const systemId = asSystemId(generateSystemId(entityType, nextSystemCounter));\r\n  const { nextId, updatedCounter } = findNextAvailableBusinessId(\r\n    getPrefix(entityType),\r\n    existingIds,\r\n    counter.businessId\r\n  );\r\n\r\n  return {\r\n    systemId,\r\n    id: asBusinessId(nextId),\r\n    counter: {\r\n      systemId: nextSystemCounter,\r\n      businessId: updatedCounter,\r\n    },\r\n  };\r\n};\r\n\r\nexport const usePayrollBatchStore = create<PayrollBatchStoreState>()(\r\n  (set, get) => ({\r\n      batches: [],\r\n      payslips: [],\r\n      auditLogs: [],\r\n      counters: initialCounters,\r\n      getBatchBySystemId: (systemId) => get().batches.find((batch) => batch.systemId === systemId),\r\n      getPayslipsByBatch: (batchSystemId) => get().payslips.filter((payslip) => payslip.batchSystemId === batchSystemId),\r\n      getPayslipBySystemId: (systemId) => get().payslips.find((payslip) => payslip.systemId === systemId),\r\n      createBatch: (input) => {\r\n        set((state) => {\r\n          const actor = resolveActorSystemId();\r\n          const now = new Date().toISOString();\r\n          const dualIds = buildDualIds('payroll', state.counters.payroll, collectBusinessIds(state.batches));\r\n          const batch: PayrollBatch = {\r\n            systemId: dualIds.systemId,\r\n            id: dualIds.id,\r\n            title: input.title,\r\n            status: 'draft',\r\n            templateSystemId: input.templateSystemId,\r\n            payPeriod: input.payPeriod,\r\n            payrollDate: input.payrollDate,\r\n            referenceAttendanceMonthKeys:\r\n              input.referenceAttendanceMonthKeys?.length\r\n                ? input.referenceAttendanceMonthKeys\r\n                : [input.payPeriod.monthKey],\r\n            payslipSystemIds: [],\r\n            totalGross: 0,\r\n            totalNet: 0,\r\n            notes: input.notes,\r\n            createdAt: now,\r\n            updatedAt: now,\r\n            createdBy: actor,\r\n            updatedBy: actor,\r\n          };\r\n\r\n          const countersAfterBatch: CounterMap = {\r\n            ...state.counters,\r\n            payroll: dualIds.counter,\r\n          };\r\n\r\n          const auditResult = createAuditLogEntry({\r\n            batchSystemId: batch.systemId,\r\n            action: 'run',\r\n            payload: { title: batch.title },\r\n            actorSystemId: actor,\r\n          })({ ...state, counters: countersAfterBatch });\r\n\r\n          return {\r\n            ...state,\r\n            batches: [...state.batches, batch],\r\n            auditLogs: auditResult.auditLogs,\r\n            counters: auditResult.counters,\r\n          };\r\n        });\r\n\r\n        const createdBatch = get().batches.at(-1);\r\n        if (!createdBatch) {\r\n          throw new Error('Không thể tạo batch lương mới.');\r\n        }\r\n        return createdBatch;\r\n      },\r\n      createBatchWithResults: (input, generatedPayslips) => {\r\n        const batch = get().createBatch(input);\r\n        if (generatedPayslips.length) {\r\n          get().addPayslips(\r\n            batch.systemId,\r\n            generatedPayslips.map((payload) => ({\r\n              employeeSystemId: payload.employeeSystemId,\r\n              employeeId: payload.employeeId,\r\n              departmentSystemId: payload.departmentSystemId,\r\n              periodMonthKey: payload.periodMonthKey,\r\n              components: payload.components,\r\n              totals: payload.totals,\r\n              attendanceSnapshotSystemId: payload.attendanceSnapshotSystemId,\r\n              deductedPenaltySystemIds: payload.deductedPenaltySystemIds,\r\n            }))\r\n          );\r\n        }\r\n        return get().getBatchBySystemId(batch.systemId) ?? batch;\r\n      },\r\n      updateBatchStatus: (systemId, status, note) => {\r\n        const actor = resolveActorSystemId();\r\n        const now = new Date().toISOString();\r\n        let monthsToLock: string[] = [];\r\n        set((state) => {\r\n          const batches = state.batches.map((batch) => {\r\n            if (batch.systemId !== systemId) return batch;\r\n            if (status === 'locked') {\r\n              monthsToLock = batch.referenceAttendanceMonthKeys;\r\n            }\r\n            return {\r\n              ...batch,\r\n              status,\r\n              reviewedAt: status === 'reviewed' ? now : batch.reviewedAt,\r\n              reviewedBy: status === 'reviewed' ? actor : batch.reviewedBy,\r\n              lockedAt: status === 'locked' ? now : batch.lockedAt,\r\n              lockedBy: status === 'locked' ? actor : batch.lockedBy,\r\n              updatedAt: now,\r\n              updatedBy: actor,\r\n              notes: note ?? batch.notes,\r\n            };\r\n          });\r\n\r\n          const { auditLogs, counters } = createAuditLogEntry({\r\n            batchSystemId: systemId,\r\n            action: AUDIT_ACTION_FOR_STATUS[status],\r\n            payload: note ? { note } : undefined,\r\n            actorSystemId: actor,\r\n          })(state);\r\n\r\n          return {\r\n            ...state,\r\n            batches,\r\n            auditLogs,\r\n            counters,\r\n          };\r\n        });\r\n\r\n        if (status === 'locked' && monthsToLock.length) {\r\n          const attendanceStore = useAttendanceStore.getState();\r\n          monthsToLock.forEach((monthKey) => attendanceStore.lockMonth(monthKey));\r\n        }\r\n      },\r\n      addPayslips: (batchSystemId, inputs) => {\r\n        if (!inputs.length) return;\r\n        set((state) => {\r\n          const actor = resolveActorSystemId();\r\n          const now = new Date().toISOString();\r\n          const batch = state.batches.find((b) => b.systemId === batchSystemId);\r\n          if (!batch) {\r\n            throw new Error('Không tìm thấy batch lương.');\r\n          }\r\n\r\n          let nextCounters = { ...state.counters };\r\n          const existingPayslipIds = collectBusinessIds(state.payslips);\r\n          const newPayslips: Payslip[] = inputs.map((payload) => {\r\n            const ids = buildDualIds('payslips', nextCounters.payslips, existingPayslipIds);\r\n            nextCounters = { ...nextCounters, payslips: ids.counter };\r\n            existingPayslipIds.push(ids.id);\r\n            return {\r\n              systemId: ids.systemId,\r\n              id: ids.id,\r\n              batchSystemId,\r\n              employeeSystemId: payload.employeeSystemId,\r\n              employeeId: payload.employeeId,\r\n              departmentSystemId: payload.departmentSystemId,\r\n              periodMonthKey: payload.periodMonthKey,\r\n              attendanceSnapshotSystemId: payload.attendanceSnapshotSystemId,\r\n              components: payload.components,\r\n              totals: payload.totals,\r\n              deductedPenaltySystemIds: payload.deductedPenaltySystemIds,\r\n              createdAt: now,\r\n              updatedAt: now,\r\n              createdBy: actor,\r\n              updatedBy: actor,\r\n            };\r\n          });\r\n\r\n          const payslips = [...state.payslips, ...newPayslips];\r\n          const payslipSystemIds = [...new Set([...batch.payslipSystemIds, ...newPayslips.map((p) => p.systemId)])];\r\n          const batchPayslips = payslips.filter((slip) => payslipSystemIds.includes(slip.systemId));\r\n          const totalGross = batchPayslips.reduce((sum, slip) => sum + slip.totals.earnings, 0);\r\n          const totalNet = batchPayslips.reduce((sum, slip) => sum + slip.totals.netPay, 0);\r\n\r\n          const batches = state.batches.map((b) =>\r\n            b.systemId === batchSystemId\r\n              ? {\r\n                  ...b,\r\n                  payslipSystemIds,\r\n                  totalGross,\r\n                  totalNet,\r\n                  updatedAt: now,\r\n                  updatedBy: actor,\r\n                }\r\n              : b\r\n          );\r\n\r\n          const { auditLogs, counters } = createAuditLogEntry({\r\n            batchSystemId,\r\n            action: 'recalculate',\r\n            payload: { added: newPayslips.length },\r\n            actorSystemId: actor,\r\n          })({ ...state, counters: nextCounters });\r\n\r\n          return {\r\n            ...state,\r\n            batches,\r\n            payslips,\r\n            auditLogs,\r\n            counters,\r\n          };\r\n        });\r\n      },\r\n      updatePayslip: (payslipSystemId, updates) => {\r\n        const state = get();\r\n        const payslip = state.payslips.find((p) => p.systemId === payslipSystemId);\r\n        \r\n        if (!payslip) {\r\n          return { success: false, error: 'Không tìm thấy phiếu lương.' };\r\n        }\r\n\r\n        const batch = state.batches.find((b) => b.systemId === payslip.batchSystemId);\r\n        if (!batch) {\r\n          return { success: false, error: 'Không tìm thấy bảng lương.' };\r\n        }\r\n\r\n        if (batch.status === 'locked') {\r\n          return { success: false, error: 'Bảng lương đã khóa, không thể sửa.' };\r\n        }\r\n\r\n        const actor = resolveActorSystemId();\r\n        const now = new Date().toISOString();\r\n\r\n        set((state) => {\r\n          // Update the payslip\r\n          const updatedPayslips = state.payslips.map((p) =>\r\n            p.systemId === payslipSystemId\r\n              ? {\r\n                  ...p,\r\n                  components: updates.components ?? p.components,\r\n                  totals: updates.totals ?? p.totals,\r\n                  updatedAt: now,\r\n                  updatedBy: actor,\r\n                }\r\n              : p\r\n          );\r\n\r\n          // Recalculate batch totals\r\n          const batchPayslipIds = batch.payslipSystemIds;\r\n          const batchPayslips = updatedPayslips.filter((p) => batchPayslipIds.includes(p.systemId));\r\n          const totalGross = batchPayslips.reduce((sum, p) => sum + p.totals.earnings, 0);\r\n          const totalNet = batchPayslips.reduce((sum, p) => sum + p.totals.netPay, 0);\r\n\r\n          const updatedBatches = state.batches.map((b) =>\r\n            b.systemId === batch.systemId\r\n              ? { ...b, totalGross, totalNet, updatedAt: now, updatedBy: actor }\r\n              : b\r\n          );\r\n\r\n          // Log the action\r\n          const { auditLogs, counters } = createAuditLogEntry({\r\n            batchSystemId: batch.systemId,\r\n            action: 'recalculate',\r\n            payload: { \r\n              payslipSystemId, \r\n              employeeId: payslip.employeeId,\r\n              previousNet: payslip.totals.netPay,\r\n              newNet: updates.totals?.netPay ?? payslip.totals.netPay,\r\n            },\r\n            actorSystemId: actor,\r\n          })(state);\r\n\r\n          return {\r\n            ...state,\r\n            payslips: updatedPayslips,\r\n            batches: updatedBatches,\r\n            auditLogs,\r\n            counters,\r\n          };\r\n        });\r\n\r\n        return { success: true };\r\n      },\r\n      removePayslipFromBatch: (payslipSystemId) => {\r\n        const state = get();\r\n        const payslip = state.payslips.find((p) => p.systemId === payslipSystemId);\r\n        \r\n        if (!payslip) {\r\n          return { success: false, error: 'Không tìm thấy phiếu lương.' };\r\n        }\r\n\r\n        const batch = state.batches.find((b) => b.systemId === payslip.batchSystemId);\r\n        if (!batch) {\r\n          return { success: false, error: 'Không tìm thấy bảng lương.' };\r\n        }\r\n\r\n        if (batch.status === 'locked') {\r\n          return { success: false, error: 'Bảng lương đã khóa, không thể xóa phiếu lương.' };\r\n        }\r\n\r\n        const actor = resolveActorSystemId();\r\n        const now = new Date().toISOString();\r\n\r\n        set((state) => {\r\n          // Remove from payslips\r\n          const updatedPayslips = state.payslips.filter((p) => p.systemId !== payslipSystemId);\r\n\r\n          // Update batch\r\n          const newPayslipIds = batch.payslipSystemIds.filter((id) => id !== payslipSystemId);\r\n          const batchPayslips = updatedPayslips.filter((p) => newPayslipIds.includes(p.systemId));\r\n          const totalGross = batchPayslips.reduce((sum, p) => sum + p.totals.earnings, 0);\r\n          const totalNet = batchPayslips.reduce((sum, p) => sum + p.totals.netPay, 0);\r\n\r\n          const updatedBatches = state.batches.map((b) =>\r\n            b.systemId === batch.systemId\r\n              ? { \r\n                  ...b, \r\n                  payslipSystemIds: newPayslipIds,\r\n                  totalGross, \r\n                  totalNet, \r\n                  updatedAt: now, \r\n                  updatedBy: actor \r\n                }\r\n              : b\r\n          );\r\n\r\n          // Log the action\r\n          const { auditLogs, counters } = createAuditLogEntry({\r\n            batchSystemId: batch.systemId,\r\n            action: 'recalculate',\r\n            payload: { \r\n              removed: payslipSystemId, \r\n              employeeId: payslip.employeeId,\r\n            },\r\n            actorSystemId: actor,\r\n          })(state);\r\n\r\n          return {\r\n            ...state,\r\n            payslips: updatedPayslips,\r\n            batches: updatedBatches,\r\n            auditLogs,\r\n            counters,\r\n          };\r\n        });\r\n\r\n        return { success: true };\r\n      },\r\n      cancelBatch: (systemId, reason) => {\r\n        const state = get();\r\n        const batch = state.batches.find((b) => b.systemId === systemId);\r\n\r\n        if (!batch) {\r\n          return { success: false, error: 'Không tìm thấy bảng lương.' };\r\n        }\r\n\r\n        if (batch.status === 'locked') {\r\n          return { success: false, error: 'Bảng lương đã khóa, không thể hủy.' };\r\n        }\r\n\r\n        if (batch.status === 'cancelled') {\r\n          return { success: false, error: 'Bảng lương đã được hủy trước đó.' };\r\n        }\r\n\r\n        const actor = resolveActorSystemId();\r\n        const now = new Date().toISOString();\r\n\r\n        set((state) => {\r\n          // Update batch status to cancelled\r\n          const updatedBatches = state.batches.map((b) =>\r\n            b.systemId === systemId\r\n              ? {\r\n                  ...b,\r\n                  status: 'cancelled' as const,\r\n                  notes: reason ? `[Hủy] ${reason}` : b.notes,\r\n                  updatedAt: now,\r\n                  updatedBy: actor,\r\n                }\r\n              : b\r\n          );\r\n\r\n          // Log the action\r\n          const { auditLogs, counters } = createAuditLogEntry({\r\n            batchSystemId: systemId,\r\n            action: 'recalculate', // Using recalculate as closest action type for cancel\r\n            payload: {\r\n              cancelled: true,\r\n              reason: reason,\r\n              title: batch.title,\r\n              payslipCount: batch.payslipSystemIds.length,\r\n            },\r\n            actorSystemId: actor,\r\n          })(state);\r\n\r\n          return {\r\n            ...state,\r\n            batches: updatedBatches,\r\n            auditLogs,\r\n            counters,\r\n          };\r\n        });\r\n\r\n        return { success: true };\r\n      },\r\n      logAction: (input) => {\r\n        let createdLog: PayrollAuditLog | undefined;\r\n        set((state) => {\r\n          const { auditLogs, counters } = createAuditLogEntry(input)(state);\r\n          createdLog = auditLogs[auditLogs.length - 1];\r\n          return {\r\n            ...state,\r\n            auditLogs,\r\n            counters,\r\n          };\r\n        });\r\n        if (!createdLog) {\r\n          throw new Error('Không thể ghi nhật ký payroll.');\r\n        }\r\n        return createdLog;\r\n      },\r\n      \r\n      // Load from API\r\n      loadFromAPI: async () => {\r\n        try {\r\n          // NOTE: Use React Query hooks for paginated payroll data. This only loads initial batch.\r\n          const [batchesRes, payslipsRes] = await Promise.all([\r\n            fetch('/api/payroll/batches?limit=100'),\r\n            fetch('/api/payroll/payslips?limit=100'),\r\n          ]);\r\n          \r\n          if (batchesRes.ok && payslipsRes.ok) {\r\n            const batchesJson = await batchesRes.json();\r\n            const payslipsJson = await payslipsRes.json();\r\n            \r\n            const batches = batchesJson.data || [];\r\n            const payslips = payslipsJson.data || [];\r\n            \r\n            if (batches.length > 0 || payslips.length > 0) {\r\n              set({ batches, payslips, initialized: true });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payroll API] loadFromAPI error:', error);\r\n        }\r\n      },\r\n      initialized: false,\r\n    })\r\n);\r\n\r\nconst createAuditLogEntry = (input: LogActionInput) => (state: PayrollBatchStoreState) => {\r\n  const actor = input.actorSystemId ?? resolveActorSystemId();\r\n  const now = new Date().toISOString();\r\n  const ids = buildDualIds(\r\n    'payroll-audit-log',\r\n    state.counters['payroll-audit-log'],\r\n    collectBusinessIds(state.auditLogs)\r\n  );\r\n\r\n  const entry: PayrollAuditLog = {\r\n    systemId: ids.systemId,\r\n    id: ids.id,\r\n    batchSystemId: input.batchSystemId,\r\n    action: input.action,\r\n    actorSystemId: actor ?? asSystemId('SYSTEM00000000'),\r\n    actorDisplayName: input.actorDisplayName,\r\n    payload: input.payload,\r\n    createdAt: now,\r\n  };\r\n\r\n  return {\r\n    auditLogs: [...state.auditLogs, entry],\r\n    counters: {\r\n      ...state.counters,\r\n      'payroll-audit-log': ids.counter,\r\n    },\r\n  };\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 941, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"../../lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border border-border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-h3 font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,0EACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 1048, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/stats-card.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from './card';\r\nimport { cn } from '../../lib/utils';\r\nimport { LucideIcon, TrendingUp, TrendingDown } from 'lucide-react';\r\n\r\ninterface StatsCardProps {\r\n  title: string;\r\n  value: string | number;\r\n  description?: string | undefined;\r\n  icon?: LucideIcon | undefined;\r\n  trend?: {\r\n    value: number;\r\n    isPositive: boolean;\r\n  } | undefined;\r\n  className?: string | undefined;\r\n}\r\n\r\nexport function StatsCard({\r\n  title,\r\n  value,\r\n  description,\r\n  icon: Icon,\r\n  trend,\r\n  className,\r\n}: StatsCardProps) {\r\n  return (\r\n    <Card className={className}>\r\n      <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n        <CardTitle className=\"text-h6 font-medium\">{title}</CardTitle>\r\n        {Icon && (\r\n          <Icon className=\"h-4 w-4 text-muted-foreground\" />\r\n        )}\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"text-h3 font-bold\">{value}</div>\r\n        {description && (\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            {description}\r\n          </p>\r\n        )}\r\n        {trend && (\r\n          <div className=\"flex items-center gap-1 text-xs mt-1\">\r\n            {trend.isPositive ? (\r\n              <TrendingUp className=\"h-3 w-3 text-emerald-600 dark:text-emerald-400\" />\r\n            ) : (\r\n              <TrendingDown className=\"h-3 w-3 text-destructive\" />\r\n            )}\r\n            <span\r\n              className={cn(\r\n                \"font-medium\",\r\n                trend.isPositive ? \"text-emerald-600 dark:text-emerald-400\" : \"text-destructive\"\r\n              )}\r\n            >\r\n              {trend.isPositive ? \"+\" : \"\"}\r\n              {trend.value}%\r\n            </span>\r\n            <span className=\"text-muted-foreground\">so với tháng trước</span>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;;;;;AAcO,SAAS,UAAU,EACxB,KAAK,EACL,KAAK,EACL,WAAW,EACX,MAAM,IAAI,EACV,KAAK,EACL,SAAS,EACM;IACf,qBACE,6LAAC,oIAAI;QAAC,WAAW;;0BACf,6LAAC,0IAAU;gBAAC,WAAU;;kCACpB,6LAAC,yIAAS;wBAAC,WAAU;kCAAuB;;;;;;oBAC3C,sBACC,6LAAC;wBAAK,WAAU;;;;;;;;;;;;0BAGpB,6LAAC,2IAAW;;kCACV,6LAAC;wBAAI,WAAU;kCAAqB;;;;;;oBACnC,6BACC,6LAAC;wBAAE,WAAU;kCACV;;;;;;oBAGJ,uBACC,6LAAC;wBAAI,WAAU;;4BACZ,MAAM,UAAU,iBACf,6LAAC,mOAAU;gCAAC,WAAU;;;;;qDAEtB,6LAAC,yOAAY;gCAAC,WAAU;;;;;;0CAE1B,6LAAC;gCACC,WAAW,IAAA,qHAAE,EACX,eACA,MAAM,UAAU,GAAG,2CAA2C;;oCAG/D,MAAM,UAAU,GAAG,MAAM;oCACzB,MAAM,KAAK;oCAAC;;;;;;;0CAEf,6LAAC;gCAAK,WAAU;0CAAwB;;;;;;;;;;;;;;;;;;;;;;;;AAMpD;KA7CgB"}},
    {"offset": {"line": 1172, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/components/summary-cards.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport type { LucideIcon } from 'lucide-react';\r\nimport { StatsCard } from '../../../components/ui/stats-card';\r\n\r\ntype SummaryTrend = {\r\n  value: number;\r\n  isPositive: boolean;\r\n};\r\n\r\nexport type PayrollSummaryCard = {\r\n  id: string;\r\n  title: string;\r\n  value: string | number;\r\n  description?: string | undefined;\r\n  icon?: LucideIcon | undefined;\r\n  trend?: SummaryTrend | undefined;\r\n  className?: string | undefined;\r\n};\r\n\r\ntype PayrollSummaryCardsProps = {\r\n  items: PayrollSummaryCard[];\r\n};\r\n\r\nexport function PayrollSummaryCards({ items }: PayrollSummaryCardsProps) {\r\n  if (!items.length) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid gap-4 md:grid-cols-2 xl:grid-cols-4\">\r\n      {items.map((item) => (\r\n        <StatsCard\r\n          key={item.id}\r\n          title={item.title}\r\n          value={item.value}\r\n          description={item.description}\r\n          icon={item.icon}\r\n          trend={item.trend}\r\n          className={item.className}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAqBO,SAAS,oBAAoB,EAAE,KAAK,EAA4B;IACrE,IAAI,CAAC,MAAM,MAAM,EAAE;QACjB,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACZ,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC,kJAAS;gBAER,OAAO,KAAK,KAAK;gBACjB,OAAO,KAAK,KAAK;gBACjB,aAAa,KAAK,WAAW;gBAC7B,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;gBACjB,WAAW,KAAK,SAAS;eANpB,KAAK,EAAE;;;;;;;;;;AAWtB;KApBgB"}},
    {"offset": {"line": 1214, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/mobile/skeleton.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Card, CardContent } from \"../ui/card\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\ninterface SkeletonProps extends React.HTMLAttributes<HTMLDivElement> {\r\n  className?: string;\r\n}\r\n\r\n/**\r\n * Skeleton - Base skeleton loading component\r\n */\r\nexport function Skeleton({ className, ...props }: SkeletonProps) {\r\n  return (\r\n    <div\r\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\n/**\r\n * MobileCardSkeleton - Loading placeholder for mobile cards\r\n */\r\nexport function MobileCardSkeleton({ \r\n  count = 3,\r\n  className \r\n}: { \r\n  count?: number | undefined;\r\n  className?: string | undefined;\r\n}) {\r\n  return (\r\n    <>\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <Card key={i} className={cn(\"overflow-hidden\", className)}>\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-start space-x-3\">\r\n              {/* Avatar skeleton */}\r\n              <Skeleton className=\"h-12 w-12 rounded-full flex-shrink-0\" />\r\n              \r\n              {/* Content skeleton */}\r\n              <div className=\"flex-1 space-y-2\">\r\n                <Skeleton className=\"h-4 w-3/4\" />\r\n                <Skeleton className=\"h-3 w-1/2\" />\r\n                <div className=\"space-y-1.5 pt-2\">\r\n                  <Skeleton className=\"h-3 w-full\" />\r\n                  <Skeleton className=\"h-3 w-2/3\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Footer skeleton */}\r\n            <div className=\"flex items-center justify-between mt-3 pt-3 border-t border-border\">\r\n              <Skeleton className=\"h-5 w-20\" />\r\n              <Skeleton className=\"h-3 w-24\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\n/**\r\n * TableSkeleton - Loading placeholder for tables\r\n */\r\nexport function TableSkeleton({ \r\n  rows = 5,\r\n  columns = 4 \r\n}: { \r\n  rows?: number;\r\n  columns?: number;\r\n}) {\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {Array.from({ length: rows }).map((_, rowIndex) => (\r\n        <div key={rowIndex} className=\"flex items-center space-x-4\">\r\n          {Array.from({ length: columns }).map((_, colIndex) => (\r\n            <div key={colIndex}>\r\n              <Skeleton \r\n                className={cn(\r\n                  \"h-9\",\r\n                  colIndex === 0 ? \"w-1/4\" : \"flex-1\"\r\n                )}\r\n              />\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * CardGridSkeleton - Loading placeholder for card grids\r\n */\r\nexport function CardGridSkeleton({\r\n  count = 4,\r\n  columns = 4\r\n}: {\r\n  count?: number;\r\n  columns?: number;\r\n}) {\r\n  return (\r\n    <div className={`grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-${columns}`}>\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <Card key={i}>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-start justify-between mb-2\">\r\n              <Skeleton className=\"h-5 w-5 rounded\" />\r\n              <Skeleton className=\"h-4 w-16\" />\r\n            </div>\r\n            <Skeleton className=\"h-8 w-24 mb-2\" />\r\n            <Skeleton className=\"h-3 w-full\" />\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * FormSkeleton - Loading placeholder for forms\r\n */\r\nexport function FormSkeleton({ fields = 6 }: { fields?: number }) {\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {Array.from({ length: fields }).map((_, i) => (\r\n        <div key={i} className=\"space-y-2\">\r\n          <Skeleton className=\"h-4 w-32\" />\r\n          <Skeleton className=\"h-9 w-full\" />\r\n        </div>\r\n      ))}\r\n      <div className=\"flex justify-end space-x-2 pt-4\">\r\n        <Skeleton className=\"h-9 w-24\" />\r\n        <Skeleton className=\"h-9 w-24\" />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * ChartSkeleton - Loading placeholder for charts\r\n */\r\nexport function ChartSkeleton({ height = \"300px\" }: { height?: string }) {\r\n  return (\r\n    <div className=\"w-full\" style={{ height }}>\r\n      <div className=\"flex items-end justify-between h-full space-x-2 pb-4\">\r\n        {[40, 70, 55, 80, 60, 90, 45].map((h, i) => (\r\n          <div key={i} className=\"flex-1\" style={{ height: `${h}%` }}>\r\n            <Skeleton className=\"w-full h-full\" />\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <div className=\"flex justify-between pt-2\">\r\n        {Array.from({ length: 7 }).map((_, i) => (\r\n          <div key={i}>\r\n            <Skeleton className=\"h-3 w-8\" />\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * PageSkeleton - Loading placeholder for full pages\r\n */\r\nexport function PageSkeleton() {\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"space-y-2\">\r\n        <Skeleton className=\"h-8 w-48\" />\r\n        <Skeleton className=\"h-4 w-96\" />\r\n      </div>\r\n      \r\n      {/* Actions */}\r\n      <div className=\"flex justify-between\">\r\n        <Skeleton className=\"h-9 w-64\" />\r\n        <Skeleton className=\"h-9 w-32\" />\r\n      </div>\r\n      \r\n      {/* Content */}\r\n      <CardGridSkeleton count={6} />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1662, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/mobile/touch-button.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Button } from \"../ui/button\";\r\nimport { cn } from \"../../lib/utils\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nconst touchButtonVariants = cva(\r\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\r\n        destructive: \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\r\n        outline: \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\r\n        secondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-12 px-4 py-2 min-w-touch\", // Mobile-first: 48px height\r\n        sm: \"h-9 rounded-md px-3 min-w-touch\",\r\n        lg: \"h-14 rounded-md px-8 min-w-touch-lg\", // 56px height for large touch\r\n        xl: \"h-16 rounded-md px-10 min-w-touch-lg\", // 64px height for extra large\r\n        icon: \"h-12 w-12\", // Square touch target\r\n        \"icon-sm\": \"h-9 w-10\",\r\n        \"icon-lg\": \"h-14 w-14\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n);\r\n\r\nexport interface TouchButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof touchButtonVariants> {\r\n  asChild?: boolean;\r\n}\r\n\r\n/**\r\n * TouchButton - Mobile-optimized button with minimum 44px touch targets\r\n * Follows Apple HIG and Material Design guidelines for touch interfaces\r\n */\r\nconst TouchButton = React.forwardRef<HTMLButtonElement, TouchButtonProps>(\r\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\r\n    return (\r\n      <Button\r\n        className={cn(touchButtonVariants({ variant, size, className }))}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    );\r\n  }\r\n);\r\nTouchButton.displayName = \"TouchButton\";\r\n\r\nexport { TouchButton, touchButtonVariants };\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM,sBAAsB,IAAA,0KAAG,EAC7B,0RACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aAAa;YACb,SAAS;YACT,WAAW;YACX,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF;;;CAGC,GACD,MAAM,4BAAc,2KAAgB,MAClC,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,qBACE,6LAAC,wIAAM;QACL,WAAW,IAAA,qHAAE,EAAC,oBAAoB;YAAE;YAAS;YAAM;QAAU;QAC7D,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,YAAY,WAAW,GAAG"}},
    {"offset": {"line": 1734, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/mobile/empty-state.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { LucideIcon } from \"lucide-react\";\r\nimport { cn } from \"../../lib/utils\";\r\nimport { TouchButton } from \"./touch-button\";\r\n\r\ninterface EmptyStateProps {\r\n  icon?: LucideIcon | undefined;\r\n  title: string;\r\n  description?: string | undefined;\r\n  action?: React.ReactNode | undefined;\r\n  className?: string | undefined;\r\n  size?: \"sm\" | \"md\" | \"lg\" | undefined;\r\n}\r\n\r\n/**\r\n * EmptyState - Professional empty state component\r\n * Use cases:\r\n * - No search results\r\n * - Empty lists\r\n * - No data to display\r\n * - First-time user experience\r\n */\r\nexport function EmptyState({\r\n  icon: Icon,\r\n  title,\r\n  description,\r\n  action,\r\n  className,\r\n  size = \"md\",\r\n}: EmptyStateProps) {\r\n  const sizeClasses = {\r\n    sm: {\r\n      container: \"py-8\",\r\n      icon: \"h-12 w-12 mb-3\",\r\n      title: \"text-base\",\r\n      description: \"text-sm\",\r\n    },\r\n    md: {\r\n      container: \"py-12\",\r\n      icon: \"h-16 w-16 mb-4\",\r\n      title: \"text-lg\",\r\n      description: \"text-sm\",\r\n    },\r\n    lg: {\r\n      container: \"py-16\",\r\n      icon: \"h-20 w-20 mb-6\",\r\n      title: \"text-xl\",\r\n      description: \"text-base\",\r\n    },\r\n  };\r\n\r\n  const classes = sizeClasses[size];\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"flex flex-col items-center justify-center px-4 text-center\",\r\n        classes.container,\r\n        className\r\n      )}\r\n    >\r\n      {Icon && (\r\n        <Icon\r\n          className={cn(\r\n            \"text-muted-foreground\",\r\n            classes.icon\r\n          )}\r\n          strokeWidth={1.5}\r\n        />\r\n      )}\r\n      \r\n      <h3 className={cn(\"font-semibold mb-2\", classes.title)}>\r\n        {title}\r\n      </h3>\r\n      \r\n      {description && (\r\n        <p\r\n          className={cn(\r\n            \"text-muted-foreground mb-6 max-w-sm\",\r\n            classes.description\r\n          )}\r\n        >\r\n          {description}\r\n        </p>\r\n      )}\r\n      \r\n      {action && <div className=\"mt-2\">{action}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * SearchEmptyState - Specialized empty state for search results\r\n */\r\nexport function SearchEmptyState({\r\n  searchQuery,\r\n  onClear,\r\n}: {\r\n  searchQuery: string;\r\n  onClear?: () => void;\r\n}) {\r\n  return (\r\n    <EmptyState\r\n      title=\"Không tìm thấy kết quả\"\r\n      description={`Không có kết quả nào phù hợp với \"${searchQuery}\". Thử tìm kiếm với từ khóa khác.`}\r\n      action={\r\n        onClear && (\r\n          <TouchButton variant=\"outline\" onClick={onClear}>\r\n            Xóa bộ lọc\r\n          </TouchButton>\r\n        )\r\n      }\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;;AAmBO,SAAS,WAAW,EACzB,MAAM,IAAI,EACV,KAAK,EACL,WAAW,EACX,MAAM,EACN,SAAS,EACT,OAAO,IAAI,EACK;IAChB,MAAM,cAAc;QAClB,IAAI;YACF,WAAW;YACX,MAAM;YACN,OAAO;YACP,aAAa;QACf;QACA,IAAI;YACF,WAAW;YACX,MAAM;YACN,OAAO;YACP,aAAa;QACf;QACA,IAAI;YACF,WAAW;YACX,MAAM;YACN,OAAO;YACP,aAAa;QACf;IACF;IAEA,MAAM,UAAU,WAAW,CAAC,KAAK;IAEjC,qBACE,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,8DACA,QAAQ,SAAS,EACjB;;YAGD,sBACC,6LAAC;gBACC,WAAW,IAAA,qHAAE,EACX,yBACA,QAAQ,IAAI;gBAEd,aAAa;;;;;;0BAIjB,6LAAC;gBAAG,WAAW,IAAA,qHAAE,EAAC,sBAAsB,QAAQ,KAAK;0BAClD;;;;;;YAGF,6BACC,6LAAC;gBACC,WAAW,IAAA,qHAAE,EACX,uCACA,QAAQ,WAAW;0BAGpB;;;;;;YAIJ,wBAAU,6LAAC;gBAAI,WAAU;0BAAQ;;;;;;;;;;;;AAGxC;KAnEgB;AAwET,SAAS,iBAAiB,EAC/B,WAAW,EACX,OAAO,EAIR;IACC,qBACE,6LAAC;QACC,OAAM;QACN,aAAa,CAAC,kCAAkC,EAAE,YAAY,iCAAiC,CAAC;QAChG,QACE,yBACE,6LAAC,0JAAW;YAAC,SAAQ;YAAU,SAAS;sBAAS;;;;;;;;;;;AAO3D;MApBgB"}},
    {"offset": {"line": 1841, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Table = React.forwardRef<\r\n  HTMLTableElement,\r\n  React.HTMLAttributes<HTMLTableElement>\r\n>(({ className, ...props }, ref) => (\r\n    <table\r\n      ref={ref}\r\n      className={cn(\"w-full caption-bottom text-sm\", className)}\r\n      {...props}\r\n    />\r\n))\r\nTable.displayName = \"Table\"\r\n\r\nconst TableHeader = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <thead ref={ref} className={cn(\"[&_tr]:border-b [&_tr]:border-border\", className)} {...props} />\r\n))\r\nTableHeader.displayName = \"TableHeader\"\r\n\r\nconst TableBody = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tbody\r\n    ref={ref}\r\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableBody.displayName = \"TableBody\"\r\n\r\nconst TableFooter = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tfoot\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-t border-border bg-muted/50 font-medium [&>tr]:last:border-b-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableFooter.displayName = \"TableFooter\"\r\n\r\nconst TableRow = React.forwardRef<\r\n  HTMLTableRowElement,\r\n  React.HTMLAttributes<HTMLTableRowElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tr\r\n    ref={ref}\r\n    className={cn(\r\n      \"group border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableRow.displayName = \"TableRow\"\r\n\r\nconst TableHead = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.ThHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <th\r\n    ref={ref}\r\n    className={cn(\r\n      \"h-9 px-4 text-left align-middle font-medium text-foreground [&:has([role=checkbox])]:px-3 [&:has([role=checkbox])]:w-12 [&:has([role=checkbox])]:text-center whitespace-nowrap\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableHead.displayName = \"TableHead\"\r\n\r\nconst TableCell = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.TdHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <td\r\n    ref={ref}\r\n    className={cn(\r\n      \"px-4 py-1 align-middle whitespace-nowrap [&:has([role=checkbox])]:px-3 [&:has([role=checkbox])]:w-12 [&:has([role=checkbox])]:text-center\", \r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableCell.displayName = \"TableCell\"\r\n\r\nconst TableCaption = React.forwardRef<\r\n  HTMLTableCaptionElement,\r\n  React.HTMLAttributes<HTMLTableCaptionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <caption\r\n    ref={ref}\r\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCaption.displayName = \"TableCaption\"\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGf,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,wCAAwC;QAAa,GAAG,KAAK;;;;;;;AAE9F,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,yEACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,mGACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,kLACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,6IACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGb,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 1978, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/select.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\r\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { useModal } from \"../../contexts/modal-context\"\r\n\r\ntype BaseSelectProps = React.ComponentPropsWithoutRef<typeof SelectPrimitive.Root>\r\n\r\ntype SelectProps = Omit<BaseSelectProps, \"value\" | \"defaultValue\"> & {\r\n  value?: string | undefined\r\n  defaultValue?: string | undefined\r\n}\r\n\r\nconst Select = ({ value, defaultValue, ...props }: SelectProps) => {\r\n  const controlledProps: Partial<BaseSelectProps> = {}\r\n\r\n  if (value !== undefined) {\r\n    controlledProps.value = value\r\n  }\r\n\r\n  if (defaultValue !== undefined) {\r\n    controlledProps.defaultValue = defaultValue\r\n  }\r\n\r\n  return <SelectPrimitive.Root {...props} {...controlledProps} />\r\n}\r\nSelect.displayName = SelectPrimitive.Root.displayName\r\n\r\nconst SelectGroup = SelectPrimitive.Group\r\n\r\nconst SelectValue = SelectPrimitive.Value\r\n\r\nconst SelectTrigger = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\r\n>(({ className, children, ...props }, ref) => (\r\n  <SelectPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    {children}\r\n    <SelectPrimitive.Icon asChild>\r\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\r\n    </SelectPrimitive.Icon>\r\n  </SelectPrimitive.Trigger>\r\n))\r\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\r\n\r\nconst SelectScrollUpButton = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.ScrollUpButton\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default items-center justify-center py-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ChevronUp className=\"h-4 w-4\" />\r\n  </SelectPrimitive.ScrollUpButton>\r\n))\r\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\r\n\r\nconst SelectScrollDownButton = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.ScrollDownButton\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default items-center justify-center py-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ChevronDown className=\"h-4 w-4\" />\r\n  </SelectPrimitive.ScrollDownButton>\r\n))\r\nSelectScrollDownButton.displayName =\r\n  SelectPrimitive.ScrollDownButton.displayName\r\n\r\nconst SelectContent = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\r\n>(({ className, children, position = \"popper\", ...props }, ref) => {\r\n  const modalId = React.useId();\r\n  const [isOpen, setIsOpen] = React.useState(false);\r\n  const { zIndex } = useModal(modalId, isOpen, 'select');\r\n\r\n  React.useEffect(() => {\r\n    const content = ref && 'current' in ref ? ref.current : null;\r\n    if (!content) return;\r\n\r\n    const observer = new MutationObserver((mutations) => {\r\n      mutations.forEach((mutation) => {\r\n        if (mutation.type === 'attributes' && mutation.attributeName === 'data-state') {\r\n          const target = mutation.target as HTMLElement;\r\n          const state = target.getAttribute('data-state');\r\n          setIsOpen(state === 'open');\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe(content, { attributes: true, attributeFilter: ['data-state'] });\r\n\r\n    return () => observer.disconnect();\r\n  }, [ref]);\r\n\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        ref={ref}\r\n        className={cn(\r\n          \"relative max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\r\n          position === \"popper\" &&\r\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\r\n          className\r\n        )}\r\n        style={{ zIndex }}\r\n        position={position}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            \"p-1\",\r\n            position === \"popper\" &&\r\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  );\r\n})\r\nSelectContent.displayName = SelectPrimitive.Content.displayName\r\n\r\nconst SelectLabel = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Label>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.Label\r\n    ref={ref}\r\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSelectLabel.displayName = SelectPrimitive.Label.displayName\r\n\r\nconst SelectItem = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\r\n>(({ className, children, ...props }, ref) => (\r\n  <SelectPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\r\n      <SelectPrimitive.ItemIndicator>\r\n        <Check className=\"h-4 w-4\" />\r\n      </SelectPrimitive.ItemIndicator>\r\n    </span>\r\n\r\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n  </SelectPrimitive.Item>\r\n))\r\nSelectItem.displayName = SelectPrimitive.Item.displayName\r\n\r\nconst SelectSeparator = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.Separator\r\n    ref={ref}\r\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\r\n\r\nexport {\r\n  Select,\r\n  SelectGroup,\r\n  SelectValue,\r\n  SelectTrigger,\r\n  SelectContent,\r\n  SelectLabel,\r\n  SelectItem,\r\n  SelectSeparator,\r\n  SelectScrollUpButton,\r\n  SelectScrollDownButton,\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2269, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/data-table/data-table-pagination.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport {\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  ChevronsLeft,\r\n  ChevronsRight,\r\n} from \"lucide-react\"\r\n\r\nimport { Button } from \"../ui/button\"\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"../ui/select\"\r\n\r\ninterface DataTablePaginationProps {\r\n  pageIndex: number;\r\n  pageSize: number;\r\n  pageCount: number;\r\n  rowCount: number;\r\n  selectedRowCount: number;\r\n  setPageIndex: (index: number) => void;\r\n  setPageSize: (size: number) => void;\r\n  canPreviousPage: boolean;\r\n  canNextPage: boolean;\r\n}\r\n\r\nexport function DataTablePagination({\r\n  pageIndex,\r\n  pageSize,\r\n  pageCount,\r\n  rowCount,\r\n  selectedRowCount,\r\n  setPageIndex,\r\n  setPageSize,\r\n  canPreviousPage,\r\n  canNextPage,\r\n}: DataTablePaginationProps) {\r\n  // Generate page numbers to display\r\n  const getPageNumbers = () => {\r\n    const pages: (number | 'ellipsis')[] = [];\r\n    const showEllipsis = pageCount > 7;\r\n    \r\n    if (!showEllipsis) {\r\n      // Show all pages if 7 or fewer\r\n      for (let i = 0; i < pageCount; i++) {\r\n        pages.push(i);\r\n      }\r\n    } else {\r\n      // Always show first page\r\n      pages.push(0);\r\n      \r\n      if (pageIndex <= 3) {\r\n        // Near start: 1 2 3 4 5 ... last\r\n        for (let i = 1; i < 5; i++) {\r\n          pages.push(i);\r\n        }\r\n        pages.push('ellipsis');\r\n        pages.push(pageCount - 1);\r\n      } else if (pageIndex >= pageCount - 4) {\r\n        // Near end: 1 ... N-4 N-3 N-2 N-1 N\r\n        pages.push('ellipsis');\r\n        for (let i = pageCount - 5; i < pageCount; i++) {\r\n          pages.push(i);\r\n        }\r\n      } else {\r\n        // Middle: 1 ... current-1 current current+1 ... last\r\n        pages.push('ellipsis');\r\n        pages.push(pageIndex - 1);\r\n        pages.push(pageIndex);\r\n        pages.push(pageIndex + 1);\r\n        pages.push('ellipsis');\r\n        pages.push(pageCount - 1);\r\n      }\r\n    }\r\n    \r\n    return pages;\r\n  };\r\n  \r\n  const pageNumbers = getPageNumbers();\r\n  \r\n  return (\r\n    <div className=\"flex items-center justify-between px-2\">\r\n      <div className=\"flex-1 text-sm text-muted-foreground\">\r\n        {selectedRowCount} của{\" \"}\r\n        {rowCount} dòng được chọn.\r\n      </div>\r\n      <div className=\"flex items-center space-x-6 lg:space-x-8\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <p className=\"text-sm font-medium\">Số dòng mỗi trang</p>\r\n          <Select\r\n            value={`${pageSize}`}\r\n            onValueChange={(value) => {\r\n              setPageSize(Number(value))\r\n            }}\r\n          >\r\n            <SelectTrigger className=\"w-[70px]\">\r\n              <SelectValue placeholder={`${pageSize}`} />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              {[10, 20, 30, 40, 50].map((size) => (\r\n                <SelectItem key={size} value={`${size}`}>\r\n                  {size}\r\n                </SelectItem>\r\n              ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center space-x-1\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"px-3\"\r\n            onClick={() => setPageIndex(pageIndex - 1)}\r\n            disabled={!canPreviousPage}\r\n          >\r\n            Previous\r\n          </Button>\r\n          \r\n          {pageNumbers.map((page, idx) => {\r\n            if (page === 'ellipsis') {\r\n              return (\r\n                <span key={`ellipsis-${idx}`} className=\"px-2 text-muted-foreground\">\r\n                  ...\r\n                </span>\r\n              );\r\n            }\r\n            \r\n            return (\r\n              <Button\r\n                key={page}\r\n                variant={pageIndex === page ? \"default\" : \"outline\"}\r\n                size=\"sm\"\r\n                className=\"w-9 p-0\"\r\n                onClick={() => setPageIndex(page)}\r\n              >\r\n                {page + 1}\r\n              </Button>\r\n            );\r\n          })}\r\n          \r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"px-3\"\r\n            onClick={() => setPageIndex(pageIndex + 1)}\r\n            disabled={!canNextPage}\r\n          >\r\n            Next\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAQA;AACA;;;;AAoBO,SAAS,oBAAoB,EAClC,SAAS,EACT,QAAQ,EACR,SAAS,EACT,QAAQ,EACR,gBAAgB,EAChB,YAAY,EACZ,WAAW,EACX,eAAe,EACf,WAAW,EACc;IACzB,mCAAmC;IACnC,MAAM,iBAAiB;QACrB,MAAM,QAAiC,EAAE;QACzC,MAAM,eAAe,YAAY;QAEjC,IAAI,CAAC,cAAc;YACjB,+BAA+B;YAC/B,IAAK,IAAI,IAAI,GAAG,IAAI,WAAW,IAAK;gBAClC,MAAM,IAAI,CAAC;YACb;QACF,OAAO;YACL,yBAAyB;YACzB,MAAM,IAAI,CAAC;YAEX,IAAI,aAAa,GAAG;gBAClB,iCAAiC;gBACjC,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,IAAK;oBAC1B,MAAM,IAAI,CAAC;gBACb;gBACA,MAAM,IAAI,CAAC;gBACX,MAAM,IAAI,CAAC,YAAY;YACzB,OAAO,IAAI,aAAa,YAAY,GAAG;gBACrC,oCAAoC;gBACpC,MAAM,IAAI,CAAC;gBACX,IAAK,IAAI,IAAI,YAAY,GAAG,IAAI,WAAW,IAAK;oBAC9C,MAAM,IAAI,CAAC;gBACb;YACF,OAAO;gBACL,qDAAqD;gBACrD,MAAM,IAAI,CAAC;gBACX,MAAM,IAAI,CAAC,YAAY;gBACvB,MAAM,IAAI,CAAC;gBACX,MAAM,IAAI,CAAC,YAAY;gBACvB,MAAM,IAAI,CAAC;gBACX,MAAM,IAAI,CAAC,YAAY;YACzB;QACF;QAEA,OAAO;IACT;IAEA,MAAM,cAAc;IAEpB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;oBACZ;oBAAiB;oBAAK;oBACtB;oBAAS;;;;;;;0BAEZ,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAE,WAAU;0CAAsB;;;;;;0CACnC,6LAAC,wIAAM;gCACL,OAAO,GAAG,UAAU;gCACpB,eAAe,CAAC;oCACd,YAAY,OAAO;gCACrB;;kDAEA,6LAAC,+IAAa;wCAAC,WAAU;kDACvB,cAAA,6LAAC,6IAAW;4CAAC,aAAa,GAAG,UAAU;;;;;;;;;;;kDAEzC,6LAAC,+IAAa;kDACX;4CAAC;4CAAI;4CAAI;4CAAI;4CAAI;yCAAG,CAAC,GAAG,CAAC,CAAC,qBACzB,6LAAC,4IAAU;gDAAY,OAAO,GAAG,MAAM;0DACpC;+CADc;;;;;;;;;;;;;;;;;;;;;;kCAQzB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,wIAAM;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS,IAAM,aAAa,YAAY;gCACxC,UAAU,CAAC;0CACZ;;;;;;4BAIA,YAAY,GAAG,CAAC,CAAC,MAAM;gCACtB,IAAI,SAAS,YAAY;oCACvB,qBACE,6LAAC;wCAA6B,WAAU;kDAA6B;uCAA1D,CAAC,SAAS,EAAE,KAAK;;;;;gCAIhC;gCAEA,qBACE,6LAAC,wIAAM;oCAEL,SAAS,cAAc,OAAO,YAAY;oCAC1C,MAAK;oCACL,WAAU;oCACV,SAAS,IAAM,aAAa;8CAE3B,OAAO;mCANH;;;;;4BASX;0CAEA,6LAAC,wIAAM;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS,IAAM,aAAa,YAAY;gCACxC,UAAU,CAAC;0CACZ;;;;;;;;;;;;;;;;;;;;;;;;AAOX;KAhIgB"}},
    {"offset": {"line": 2480, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/data-table/sticky-scrollbar.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { cn } from '../../lib/utils';\r\n\r\ninterface StickyScrollbarProps {\r\n  /** Ref to the scrollable element (table container) */\r\n  targetRef: React.RefObject<HTMLDivElement | null>;\r\n  /** Additional CSS classes */\r\n  className?: string | undefined;\r\n}\r\n\r\n/**\r\n * Sticky Horizontal Scrollbar Component\r\n * \r\n * Creates a sticky scrollbar at the bottom of the viewport that syncs with\r\n * the table's horizontal scroll. This allows users to scroll horizontally\r\n * without having to scroll to the bottom of the table first.\r\n */\r\nexport function StickyScrollbar({ targetRef, className }: StickyScrollbarProps) {\r\n  const scrollbarRef = React.useRef<HTMLDivElement>(null);\r\n  const [isVisible, setIsVisible] = React.useState(false);\r\n  const [scrollbarStyle, setScrollbarStyle] = React.useState<React.CSSProperties>({});\r\n  const [isMounted, setIsMounted] = React.useState(false);\r\n  const [updateTrigger, setUpdateTrigger] = React.useState(0); // ✅ Force update trigger\r\n\r\n  // Force re-render after mount to ensure refs are available\r\n  React.useEffect(() => {\r\n    setIsMounted(true);\r\n  }, []);\r\n\r\n  // ✅ Force update when target element changes size (e.g., columns added/removed)\r\n  React.useEffect(() => {\r\n    if (!isMounted || !targetRef.current) return;\r\n    \r\n    const targetElement = targetRef.current;\r\n    \r\n    // Watch for changes to table width/scrollWidth\r\n    const mutationObserver = new MutationObserver(() => {\r\n      setUpdateTrigger(prev => prev + 1);\r\n    });\r\n    \r\n    mutationObserver.observe(targetElement, {\r\n      attributes: true,\r\n      childList: true,\r\n      subtree: true,\r\n    });\r\n    \r\n    return () => {\r\n      mutationObserver.disconnect();\r\n    };\r\n  }, [targetRef, isMounted]);\r\n\r\n  React.useEffect(() => {\r\n    if (!isMounted) return;\r\n    \r\n    const targetElement = targetRef.current;\r\n    const scrollbarElement = scrollbarRef.current;\r\n    \r\n    if (!targetElement || !scrollbarElement) return;\r\n\r\n    let animationFrameId: number;\r\n\r\n    // Check if horizontal scrollbar is needed and update position\r\n    const updateScrollbar = () => {\r\n      const hasHorizontalScroll = targetElement.scrollWidth > targetElement.clientWidth;\r\n      setIsVisible(hasHorizontalScroll);\r\n      \r\n      if (hasHorizontalScroll) {\r\n        // Get the bounding rect to position the scrollbar correctly\r\n        const rect = targetElement.getBoundingClientRect();\r\n        \r\n        // Set the scrollbar position and width to match the table VIEWPORT\r\n        setScrollbarStyle({\r\n          left: `${rect.left}px`,\r\n          width: `${rect.width}px`,\r\n        });\r\n        \r\n        // ✅ FIX: Set the inner content width to match table's FULL scroll width\r\n        // This allows the scrollbar to scroll the full distance\r\n        const scrollContent = scrollbarElement.firstElementChild as HTMLDivElement;\r\n        if (scrollContent) {\r\n          scrollContent.style.width = `${targetElement.scrollWidth}px`;\r\n          scrollContent.style.height = '1px'; // Ensure height for scrollbar\r\n        }\r\n      }\r\n    };\r\n\r\n    // Sync scroll position: sticky scrollbar -> table\r\n    const handleStickyScroll = () => {\r\n      cancelAnimationFrame(animationFrameId);\r\n      animationFrameId = requestAnimationFrame(() => {\r\n        if (targetElement.scrollLeft !== scrollbarElement.scrollLeft) {\r\n          targetElement.scrollLeft = scrollbarElement.scrollLeft;\r\n        }\r\n      });\r\n    };\r\n\r\n    // Sync scroll position: table -> sticky scrollbar\r\n    const handleTableScroll = () => {\r\n      cancelAnimationFrame(animationFrameId);\r\n      animationFrameId = requestAnimationFrame(() => {\r\n        if (scrollbarElement.scrollLeft !== targetElement.scrollLeft) {\r\n          scrollbarElement.scrollLeft = targetElement.scrollLeft;\r\n        }\r\n      });\r\n    };\r\n\r\n    // Initial update\r\n    updateScrollbar();\r\n\r\n    // Add event listeners\r\n    scrollbarElement.addEventListener('scroll', handleStickyScroll, { passive: true });\r\n    targetElement.addEventListener('scroll', handleTableScroll, { passive: true });\r\n    window.addEventListener('resize', updateScrollbar, { passive: true });\r\n\r\n    // Re-check on content changes\r\n    const resizeObserver = new ResizeObserver(updateScrollbar);\r\n    resizeObserver.observe(targetElement);\r\n\r\n    return () => {\r\n      cancelAnimationFrame(animationFrameId);\r\n      scrollbarElement.removeEventListener('scroll', handleStickyScroll);\r\n      targetElement.removeEventListener('scroll', handleTableScroll);\r\n      window.removeEventListener('resize', updateScrollbar);\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, [targetRef, isMounted, updateTrigger]); // ✅ Re-run when updateTrigger changes\r\n\r\n  // Always render but conditionally show with visibility\r\n  return (\r\n    <div\r\n      ref={scrollbarRef}\r\n      className={cn(\r\n        \"fixed bottom-0 z-[100] overflow-x-auto overflow-y-hidden\",\r\n        \"h-3 bg-muted/90 backdrop-blur-sm border-t border-border shadow-[0_-2px_12px_rgba(0,0,0,0.08)]\",\r\n        \"transition-opacity duration-200\",\r\n        isVisible ? \"opacity-100\" : \"opacity-0 pointer-events-none\",\r\n        className\r\n      )}\r\n      style={scrollbarStyle}\r\n    >\r\n      {/* Invisible content div to create scrollbar width */}\r\n      <div className=\"h-px pointer-events-none\" />\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2647, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/data-table/responsive-data-table.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Trash2, ChevronDown, ChevronsRight } from \"lucide-react\";\r\nimport { useBreakpoint } from \"../../contexts/breakpoint-context\";\r\nimport { Card, CardContent } from \"../ui/card\";\r\nimport { MobileCardSkeleton } from \"../mobile/skeleton\";\r\nimport { EmptyState } from \"../mobile/empty-state\";\r\nimport { TouchButton } from \"../mobile/touch-button\";\r\nimport { cn } from \"../../lib/utils\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"../ui/table\";\r\nimport { DataTablePagination } from \"./data-table-pagination\";\r\nimport { Button } from \"../ui/button\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"../ui/dropdown-menu\";\r\nimport { StickyScrollbar } from \"./sticky-scrollbar\";\r\nimport type { ColumnDef } from './types';\r\n\r\nexport interface BulkAction<TData> {\r\n  label: string;\r\n  icon?: React.ComponentType<{ className?: string }>;\r\n  onSelect: (selectedRows: TData[]) => void;\r\n}\r\n\r\ninterface DesktopDataTableProps<TData extends { systemId: string }> {\r\n  columns: ColumnDef<TData>[];\r\n  data: TData[];\r\n  pageCount: number;\r\n  pagination: { pageIndex: number; pageSize: number };\r\n  setPagination: (updater: React.SetStateAction<{ pageIndex: number; pageSize: number }>) => void;\r\n  rowCount: number;\r\n  rowSelection: Record<string, boolean>;\r\n  setRowSelection: (updater: React.SetStateAction<Record<string, boolean>>) => void;\r\n  onBulkDelete?: (() => void) | undefined;\r\n  showBulkDeleteButton?: boolean | undefined;\r\n  bulkActions?: BulkAction<TData>[] | undefined;\r\n  pkgxBulkActions?: BulkAction<TData>[] | undefined;\r\n  bulkActionButtons?: React.ReactNode | undefined;\r\n  allSelectedRows: TData[];\r\n  renderSubComponent?: ((row: TData) => React.ReactNode) | undefined;\r\n  expanded: Record<string, boolean>;\r\n  setExpanded: (updater: React.SetStateAction<Record<string, boolean>>) => void;\r\n  sorting: { id: string; desc: boolean };\r\n  setSorting: (updater: React.SetStateAction<{ id: string; desc: boolean }>) => void;\r\n  columnVisibility: Record<string, boolean>;\r\n  setColumnVisibility: React.Dispatch<React.SetStateAction<Record<string, boolean>>>;\r\n  columnOrder: string[];\r\n  setColumnOrder: React.Dispatch<React.SetStateAction<string[]>>;\r\n  pinnedColumns: string[];\r\n  setPinnedColumns: React.Dispatch<React.SetStateAction<string[]>>;\r\n  onRowClick?: ((row: TData) => void) | undefined;\r\n  getRowStyle?: ((row: TData) => React.CSSProperties) | undefined;\r\n  className?: string | undefined;\r\n}\r\n\r\ninterface ResponsiveDataTableProps<TData extends { systemId: string }> {\r\n  // Required props\r\n  columns: ColumnDef<TData>[];\r\n  data: TData[];\r\n  \r\n  // Mobile-specific\r\n  renderMobileCard?: ((row: TData, index: number) => React.ReactNode) | undefined;\r\n  mobileCardClassName?: string | undefined;\r\n  autoGenerateMobileCards?: boolean | undefined;\r\n  mobileVirtualized?: boolean | undefined;\r\n  mobileRowHeight?: number | undefined;\r\n  mobileListHeight?: number | undefined;\r\n  \r\n  // States\r\n  isLoading?: boolean | undefined;\r\n  emptyTitle?: string | undefined;\r\n  emptyDescription?: string | undefined;\r\n  emptyAction?: React.ReactNode | undefined;\r\n  \r\n  // Desktop DataTable props\r\n  pageCount: number;\r\n  pagination: { pageIndex: number; pageSize: number };\r\n  setPagination: (updater: React.SetStateAction<{ pageIndex: number; pageSize: number }>) => void;\r\n  rowCount: number;\r\n  rowSelection?: Record<string, boolean> | undefined;\r\n  setRowSelection?: ((updater: React.SetStateAction<Record<string, boolean>>) => void) | undefined;\r\n  onBulkDelete?: (() => void) | undefined;\r\n  showBulkDeleteButton?: boolean | undefined;\r\n  bulkActions?: BulkAction<TData>[] | undefined;\r\n  pkgxBulkActions?: BulkAction<TData>[] | undefined;\r\n  bulkActionButtons?: React.ReactNode | undefined;\r\n  allSelectedRows?: TData[] | undefined;\r\n  renderSubComponent?: ((row: TData) => React.ReactNode) | undefined;\r\n  expanded?: Record<string, boolean> | undefined;\r\n  setExpanded?: ((updater: React.SetStateAction<Record<string, boolean>>) => void) | undefined;\r\n  sorting: { id: string; desc: boolean };\r\n  setSorting: (updater: React.SetStateAction<{ id: string; desc: boolean }>) => void;\r\n  columnVisibility?: Record<string, boolean> | undefined;\r\n  setColumnVisibility?: React.Dispatch<React.SetStateAction<Record<string, boolean>>> | undefined;\r\n  columnOrder?: string[] | undefined;\r\n  setColumnOrder?: React.Dispatch<React.SetStateAction<string[]>> | undefined;\r\n  pinnedColumns?: string[] | undefined;\r\n  setPinnedColumns?: React.Dispatch<React.SetStateAction<string[]>> | undefined;\r\n  onRowClick?: ((row: TData) => void) | undefined;\r\n  getRowStyle?: ((row: TData) => React.CSSProperties) | undefined;\r\n  className?: string | undefined;\r\n}\r\n\r\n/**\r\n * ResponsiveDataTable - Auto-adaptive data display component\r\n * \r\n * Desktop (>= 768px): Full-featured DataTable with sorting, filtering, bulk actions\r\n * Mobile (< 768px): Card-based layout with touch-friendly interactions\r\n * \r\n * Features:\r\n * - Automatic responsive switching\r\n * - Loading states (skeleton)\r\n * - Empty states\r\n * - Mobile pagination\r\n * - Preserves functionality across breakpoints\r\n * \r\n * @example\r\n * <ResponsiveDataTable\r\n *   columns={columns}\r\n *   data={employees}\r\n *   renderMobileCard={(employee) => <EmployeeCard employee={employee} />}\r\n *   pagination={pagination}\r\n *   setPagination={setPagination}\r\n *   // ... other props\r\n * />\r\n */\r\nexport function ResponsiveDataTable<TData extends { systemId: string }>({\r\n  columns,\r\n  data,\r\n  renderMobileCard,\r\n  autoGenerateMobileCards = true,\r\n  mobileCardClassName,\r\n  isLoading = false,\r\n  emptyTitle = \"Không có dữ liệu\",\r\n  emptyDescription,\r\n  emptyAction,\r\n  mobileVirtualized = false,\r\n  mobileRowHeight = 180,\r\n  mobileListHeight = 600,\r\n  pageCount,\r\n  pagination,\r\n  setPagination,\r\n  rowCount,\r\n  rowSelection = {},\r\n  setRowSelection = () => {},\r\n  onBulkDelete,\r\n  showBulkDeleteButton = true,\r\n  bulkActions,\r\n  pkgxBulkActions,\r\n  bulkActionButtons,\r\n  allSelectedRows = [],\r\n  renderSubComponent,\r\n  expanded = {},\r\n  setExpanded = () => {},\r\n  sorting,\r\n  setSorting,\r\n  columnVisibility = {},\r\n  setColumnVisibility = () => {},\r\n  columnOrder = [],\r\n  setColumnOrder = () => {},\r\n  pinnedColumns = [],\r\n  setPinnedColumns = () => {},\r\n  onRowClick,\r\n  getRowStyle,\r\n  className,\r\n}: ResponsiveDataTableProps<TData>) {\r\n  const { isMobile } = useBreakpoint();\r\n  const autoCardColumns = React.useMemo(() => {\r\n    return columns\r\n      .filter(column => {\r\n        if (!column.id) return false;\r\n        if (['select', 'control', 'actions', 'expander'].includes(column.id)) return false;\r\n        if (columnVisibility && columnVisibility[column.id] === false) return false;\r\n        const meta = column.meta as Record<string, any> | undefined;\r\n        if (meta?.hideOnMobileCard) return false;\r\n        return true;\r\n      })\r\n      .slice(0, 6);\r\n  }, [columns, columnVisibility]);\r\n\r\n  const getColumnLabel = React.useCallback((column: ColumnDef<TData>) => {\r\n    if (typeof column.header === 'string') return column.header;\r\n    const meta = column.meta as Record<string, any> | undefined;\r\n    if (meta?.displayName) return meta.displayName;\r\n    return column.id || '';\r\n  }, []);\r\n\r\n  const renderColumnValue = React.useCallback((column: ColumnDef<TData>, row: TData) => {\r\n    if (typeof column.cell === 'function') {\r\n      return column.cell({\r\n        row,\r\n        isSelected: false,\r\n        isExpanded: false,\r\n        onToggleSelect: () => {},\r\n        onToggleExpand: () => {},\r\n      } as any);\r\n    }\r\n    if (column.accessorKey) {\r\n      const value = (row as any)[column.accessorKey as string];\r\n      if (value === undefined || value === null) return '—';\r\n      if (React.isValidElement(value)) return value;\r\n      return String(value);\r\n    }\r\n    return '—';\r\n  }, []);\r\n\r\n  const autoRenderMobileCard = React.useCallback((row: TData) => (\r\n    <MobileCardWrapper>\r\n      <div className=\"space-y-3 text-sm\">\r\n        {autoCardColumns.map(column => (\r\n          <div key={column.id}>\r\n            <div className=\"text-xs uppercase text-muted-foreground font-semibold\">\r\n              {getColumnLabel(column)}\r\n            </div>\r\n            <div className=\"text-base font-medium text-foreground\">\r\n              {renderColumnValue(column, row)}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </MobileCardWrapper>\r\n  ), [autoCardColumns, getColumnLabel, renderColumnValue]);\r\n\r\n  const hasAutoCardSupport = autoGenerateMobileCards !== false && autoCardColumns.length > 0;\r\n  const cardRenderer = renderMobileCard ?? (hasAutoCardSupport ? autoRenderMobileCard : undefined);\r\n  const shouldRenderMobileCards = Boolean(isMobile && cardRenderer);\r\n\r\n  const desktopProps: DesktopDataTableProps<TData> = {\r\n    columns,\r\n    data,\r\n    pageCount,\r\n    pagination,\r\n    setPagination,\r\n    rowCount,\r\n    rowSelection,\r\n    setRowSelection,\r\n    onBulkDelete,\r\n    showBulkDeleteButton,\r\n    bulkActions,\r\n    pkgxBulkActions,\r\n    bulkActionButtons,\r\n    allSelectedRows,\r\n    renderSubComponent,\r\n    expanded,\r\n    setExpanded,\r\n    sorting,\r\n    setSorting,\r\n    columnVisibility,\r\n    setColumnVisibility,\r\n    columnOrder,\r\n    setColumnOrder,\r\n    pinnedColumns,\r\n    setPinnedColumns,\r\n    onRowClick,\r\n    getRowStyle,\r\n    className,\r\n  };\r\n\r\n  // Loading state\r\n  if (isLoading) {\r\n    return shouldRenderMobileCards ? (\r\n      <MobileCardSkeleton count={pagination.pageSize || 10} className={mobileCardClassName} />\r\n    ) : (\r\n      <div className={cn(\"space-y-3\", className)}>\r\n        {Array.from({ length: pagination.pageSize || 10 }).map((_, i) => (\r\n          <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Empty state - only for mobile card mode\r\n  if (data.length === 0 && shouldRenderMobileCards) {\r\n    return (\r\n      <EmptyState\r\n        title={emptyTitle}\r\n        description={emptyDescription}\r\n        action={emptyAction}\r\n        className={className}\r\n      />\r\n    );\r\n  }\r\n\r\n  // Mobile card layout\r\n  if (shouldRenderMobileCards && cardRenderer) {\r\n    if (mobileVirtualized) {\r\n      return (\r\n        <div\r\n          className={cn('pb-4', className)}\r\n          style={{ maxHeight: mobileListHeight, overflowY: 'auto' }}\r\n        >\r\n          {data.map((row, index) => (\r\n            <div\r\n              key={row.systemId}\r\n              className={mobileCardClassName}\r\n              style={{ minHeight: mobileRowHeight }}\r\n            >\r\n              {cardRenderer(row, index)}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className={cn(\"space-y-3 pb-4\", className)}>\r\n        {data.map((row, index) => (\r\n          <div key={row.systemId} className={mobileCardClassName}>\r\n            {cardRenderer(row, index)}\r\n          </div>\r\n        ))}\r\n\r\n        {/* Mobile Pagination */}\r\n        {pageCount > 1 && (\r\n          <div className=\"flex items-center justify-between pt-4 border-t border-border\">\r\n            <TouchButton\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setPagination(p => ({ ...p, pageIndex: Math.max(0, p.pageIndex - 1) }))}\r\n              disabled={pagination.pageIndex === 0}\r\n            >\r\n              Trước\r\n            </TouchButton>\r\n            \r\n            <div className=\"flex flex-col items-center gap-1\">\r\n              <span className=\"text-sm font-medium\">\r\n                Trang {pagination.pageIndex + 1} / {pageCount}\r\n              </span>\r\n              <span className=\"text-xs text-muted-foreground\">\r\n                {rowCount} kết quả\r\n              </span>\r\n            </div>\r\n            \r\n            <TouchButton\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setPagination(p => ({ ...p, pageIndex: Math.min(pageCount - 1, p.pageIndex + 1) }))}\r\n              disabled={pagination.pageIndex >= pageCount - 1}\r\n            >\r\n              Sau\r\n            </TouchButton>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Desktop table layout\r\n  return <DesktopDataTable {...desktopProps} />;\r\n}\r\n\r\nfunction DesktopDataTable<TData extends { systemId: string }>({\r\n  columns,\r\n  data,\r\n  pageCount,\r\n  pagination,\r\n  setPagination,\r\n  rowCount,\r\n  rowSelection,\r\n  setRowSelection,\r\n  onBulkDelete,\r\n  showBulkDeleteButton = true,\r\n  bulkActions,\r\n  pkgxBulkActions,\r\n  bulkActionButtons,\r\n  allSelectedRows,\r\n  renderSubComponent,\r\n  expanded,\r\n  setExpanded,\r\n  sorting,\r\n  setSorting,\r\n  columnVisibility,\r\n  setColumnVisibility,\r\n  columnOrder,\r\n  setColumnOrder,\r\n  pinnedColumns,\r\n  setPinnedColumns,\r\n  onRowClick,\r\n  getRowStyle,\r\n  className,\r\n}: DesktopDataTableProps<TData>) {\r\n  const numSelected = Object.keys(rowSelection).length;\r\n  const isAllPageRowsSelected = data.length > 0 && data.every(row => rowSelection[row.systemId]);\r\n  const isSomePageRowsSelected = !isAllPageRowsSelected && data.some(row => rowSelection[row.systemId]);\r\n  const hasData = data?.length > 0;\r\n  const [columnWidths, setColumnWidths] = React.useState<Record<string, number>>({});\r\n  const stickyCellBg = 'var(--sticky-column-bg, rgba(255, 255, 255, 1))';\r\n  const stickyHeaderBg = 'var(--sticky-column-header-bg, var(--muted))';\r\n\r\n  const handleToggleAllPageRows = (value: boolean) => {\r\n    const newSelection = { ...rowSelection };\r\n    data.forEach(row => {\r\n      if (value) {\r\n        newSelection[row.systemId] = true;\r\n      } else {\r\n        delete newSelection[row.systemId];\r\n      }\r\n    });\r\n    setRowSelection(newSelection);\r\n  };\r\n\r\n  const displayColumns = React.useMemo(() => {\r\n    const expanderColumn: ColumnDef<TData> | null = renderSubComponent\r\n      ? {\r\n          id: 'expander',\r\n          header: () => null,\r\n          cell: ({ isExpanded, onToggleExpand }) => (\r\n            <div className=\"flex items-center justify-center\">\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  onToggleExpand();\r\n                }}\r\n                className=\"h-8 w-8\"\r\n              >\r\n                <ChevronsRight className={cn('h-4 w-4 transition-transform', isExpanded && 'rotate-90')} />\r\n              </Button>\r\n            </div>\r\n          ),\r\n          size: 60,\r\n          meta: { displayName: 'Mở rộng', sticky: 'left' },\r\n        }\r\n      : null;\r\n\r\n    const allConfigurableColumns = expanderColumn ? [expanderColumn, ...columns] : [...columns];\r\n\r\n    const visibleMasterCols = allConfigurableColumns.filter(col => {\r\n      if (col.id === 'expander') return true;\r\n      const isVisible = columnVisibility[col.id];\r\n      return isVisible !== false;\r\n    });\r\n\r\n    const normalizedCols = visibleMasterCols.map(col => {\r\n      if (['select', 'control'].includes(col.id)) {\r\n        return {\r\n          ...col,\r\n          meta: { ...col.meta, sticky: 'left' as const },\r\n        };\r\n      }\r\n\r\n      if (col.id === 'actions') {\r\n        return {\r\n          ...col,\r\n          meta: { ...col.meta, sticky: 'right' as const },\r\n        };\r\n      }\r\n\r\n      return col;\r\n    });\r\n\r\n    const staticLeftCols = normalizedCols.filter(c => {\r\n      const meta = c.meta as any;\r\n      return meta?.sticky === 'left' && !['select', 'control', 'expander'].includes(c.id);\r\n    });\r\n    const staticRightCols = normalizedCols.filter(c => (c.meta as any)?.sticky === 'right');\r\n    const controlCols = normalizedCols.filter(c => ['select', 'control', 'expander'].includes(c.id));\r\n    const bodyCols = normalizedCols.filter(c => {\r\n      const meta = c.meta as any;\r\n      return !meta?.sticky && !['select', 'control', 'expander'].includes(c.id);\r\n    });\r\n\r\n    const orderedBodyCols = [...bodyCols].sort((a, b) => {\r\n      const indexA = columnOrder.indexOf(a.id);\r\n      const indexB = columnOrder.indexOf(b.id);\r\n      if (indexA === -1 && indexB === -1) return 0;\r\n      if (indexA === -1) return 1;\r\n      if (indexB === -1) return -1;\r\n      return indexA - indexB;\r\n    });\r\n\r\n    const userPinnedCols = orderedBodyCols\r\n      .filter(col => pinnedColumns.includes(col.id))\r\n      .map(col => ({\r\n        ...col,\r\n        meta: { ...col.meta, sticky: 'left' as const }\r\n      }));\r\n\r\n    const nonPinnedBodyCols = orderedBodyCols.filter(c => !pinnedColumns.includes(c.id));\r\n\r\n    return [\r\n      ...controlCols,\r\n      ...staticLeftCols,\r\n      ...userPinnedCols,\r\n      ...nonPinnedBodyCols,\r\n      ...staticRightCols,\r\n    ] as ColumnDef<TData>[];\r\n  }, [columns, columnVisibility, columnOrder, pinnedColumns, renderSubComponent]);\r\n\r\n  const leftStickyColumns = React.useMemo(() => displayColumns.filter(c => (c.meta as any)?.sticky === 'left'), [displayColumns]);\r\n  const rightStickyColumns = React.useMemo(() => displayColumns.filter(c => (c.meta as any)?.sticky === 'right'), [displayColumns]);\r\n\r\n  const getColumnWidth = React.useCallback((column: ColumnDef<TData>) => {\r\n    return column.size ?? columnWidths[column.id] ?? ((column.meta as any)?.minWidth ?? 140);\r\n  }, [columnWidths]);\r\n\r\n  const leftOffsets = React.useMemo(() => {\r\n      let offset = 0;\r\n      return leftStickyColumns.map(c => {\r\n          const width = getColumnWidth(c);\r\n          const currentOffset = offset;\r\n          offset += width;\r\n          return currentOffset;\r\n      });\r\n  }, [leftStickyColumns, getColumnWidth]);\r\n\r\n  const rightOffsets = React.useMemo(() => {\r\n      let offset = 0;\r\n      const reversedOffsets = [...rightStickyColumns].reverse().map(c => {\r\n          const width = getColumnWidth(c);\r\n          const currentOffset = offset;\r\n          offset += width;\r\n          return currentOffset;\r\n      });\r\n      return reversedOffsets.reverse();\r\n  }, [rightStickyColumns, getColumnWidth]);\r\n\r\n  const tableContainerRef = React.useRef<HTMLDivElement>(null);\r\n  const headerScrollRef = React.useRef<HTMLDivElement>(null);\r\n  const bodyTableRef = React.useRef<HTMLTableElement>(null);\r\n  const headerTableRef = React.useRef<HTMLTableElement>(null);\r\n  const fallbackTableRef = React.useCallback((node: HTMLTableElement | null) => {\r\n    headerTableRef.current = node;\r\n    bodyTableRef.current = node;\r\n  }, []);\r\n\r\n  const syncScroll = (source: 'header' | 'body') => {\r\n    if (!headerScrollRef.current || !tableContainerRef.current) return;\r\n\r\n    if (source === 'body') {\r\n      headerScrollRef.current.scrollLeft = tableContainerRef.current.scrollLeft;\r\n    } else {\r\n      tableContainerRef.current.scrollLeft = headerScrollRef.current.scrollLeft;\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (!hasData) return;\r\n    if (!headerTableRef.current) return;\r\n\r\n    const syncWidths = () => {\r\n      const bodyTable = bodyTableRef.current;\r\n      const headerTable = headerTableRef.current;\r\n      if (!headerTable) return;\r\n\r\n      const bodyRow = bodyTable?.querySelector('tbody tr:first-child');\r\n      const headerRow = headerTable.querySelector('thead tr:last-child');\r\n      if (!headerRow) return;\r\n\r\n      const bodyCells = bodyRow ? Array.from(bodyRow.querySelectorAll('td')) : [];\r\n      const headerCells = Array.from(headerRow.querySelectorAll('th'));\r\n      const nextWidthMap: Record<string, number> = {};\r\n\r\n      displayColumns.forEach((column, index) => {\r\n        const sourceCell = bodyCells[index];\r\n        const fallbackCell = headerCells[index];\r\n        const width = sourceCell?.getBoundingClientRect().width || fallbackCell?.getBoundingClientRect().width;\r\n        if (width && headerCells[index]) {\r\n          headerCells[index].style.width = `${width}px`;\r\n          headerCells[index].style.minWidth = `${width}px`;\r\n          headerCells[index].style.maxWidth = `${width}px`;\r\n          nextWidthMap[column.id] = width;\r\n        }\r\n      });\r\n\r\n      if (bodyTable) {\r\n        headerTable.style.width = `${bodyTable.getBoundingClientRect().width}px`;\r\n      }\r\n\r\n      setColumnWidths(prev => {\r\n        let changed = false;\r\n        const updated = { ...prev };\r\n        Object.entries(nextWidthMap).forEach(([key, width]) => {\r\n          if (prev[key] !== width) {\r\n            changed = true;\r\n            updated[key] = width;\r\n          }\r\n        });\r\n        return changed ? updated : prev;\r\n      });\r\n    };\r\n\r\n    syncWidths();\r\n    window.addEventListener('resize', syncWidths);\r\n\r\n    const resizeObserver = new ResizeObserver(syncWidths);\r\n    if (bodyTableRef.current) {\r\n      resizeObserver.observe(bodyTableRef.current);\r\n    }\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', syncWidths);\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, [data, displayColumns, hasData]);\r\n\r\n  const renderHeaderRow = (isSticky: boolean) => (\r\n    <TableRow className=\"h-9\">\r\n      {displayColumns.map((column, colIndex) => {\r\n        const stickyMeta = isSticky ? (column.meta as any)?.sticky : undefined;\r\n        const hasFixedSize = column.size !== undefined;\r\n        const fallbackMinWidth = (column.meta as any)?.minWidth ?? 140;\r\n\r\n        const style: React.CSSProperties = {};\r\n\r\n        if (hasFixedSize) {\r\n          style.width = column.size;\r\n          style.minWidth = column.size;\r\n          style.maxWidth = column.size;\r\n        } else {\r\n          style.minWidth = fallbackMinWidth;\r\n        }\r\n\r\n        let thClassName = \"bg-muted whitespace-nowrap\";\r\n\r\n        const isLastLeftSticky = stickyMeta === 'left' && colIndex === leftStickyColumns.length - 1;\r\n        const isFirstRightSticky = stickyMeta === 'right' && colIndex === displayColumns.length - rightStickyColumns.length;\r\n\r\n        if (isSticky && stickyMeta === 'left') {\r\n          const stickyIndex = leftStickyColumns.findIndex(c => c.id === column.id);\r\n          if (stickyIndex !== -1) {\r\n            (style as any).position = 'sticky';\r\n            (style as any).left = `${leftOffsets[stickyIndex]}px`;\r\n            (style as any).top = 0;\r\n            (style as any).backgroundColor = stickyHeaderBg;\r\n            thClassName = cn(thClassName, \"z-30 bg-muted shadow-sm\");\r\n          }\r\n        } else if (isSticky && stickyMeta === 'right') {\r\n          const stickyIndex = rightStickyColumns.findIndex(c => c.id === column.id);\r\n          if (stickyIndex !== -1) {\r\n            (style as any).position = 'sticky';\r\n            (style as any).right = `${rightOffsets[stickyIndex]}px`;\r\n            (style as any).top = 0;\r\n            (style as any).backgroundColor = stickyHeaderBg;\r\n            thClassName = cn(thClassName, \"z-30 bg-muted shadow-[-2px_0_4px_-2px_rgba(0,0,0,0.1)]\");\r\n          }\r\n        }\r\n\r\n        if (['control', 'select', 'expander', 'actions'].includes(column.id)) {\r\n          thClassName = cn(thClassName, \"px-2 text-center\");\r\n        }\r\n\r\n        return (\r\n          <TableHead\r\n            key={column.id}\r\n            style={style}\r\n            className={cn(thClassName, {\r\n              \"border-r border-border\": isSticky && isLastLeftSticky,\r\n            })}\r\n          >\r\n            {typeof column.header === 'function'\r\n              // @ts-ignore\r\n              ? column.header({\r\n                  isAllPageRowsSelected,\r\n                  isSomePageRowsSelected,\r\n                  onToggleAll: handleToggleAllPageRows,\r\n                  sorting,\r\n                  setSorting,\r\n                })\r\n              : column.header}\r\n          </TableHead>\r\n        );\r\n      })}\r\n    </TableRow>\r\n  );\r\n\r\n  return (\r\n    <div className={cn(\"flex flex-col w-full\", className)}>\r\n      {hasData ? (\r\n        <>\r\n          <div\r\n            ref={headerScrollRef}\r\n            onScroll={() => syncScroll('header')}\r\n            className=\"sticky top-32 z-30 overflow-x-auto rounded-t-md border border-border border-b-0 bg-muted [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]\"\r\n          >\r\n            <Table ref={headerTableRef}>\r\n              <TableHeader className=\"bg-muted shadow-sm\">\r\n                {numSelected > 0 && (\r\n                  <tr className=\"absolute inset-x-0 top-0 z-50 h-9 bg-muted/95 backdrop-blur-sm border-b border-border shadow-md\">\r\n                    <th className=\"sticky left-0 z-[60] bg-muted/95 backdrop-blur-sm px-3 w-[48px]\">\r\n                      {columns.find(c => c.id === 'select') &&\r\n                        typeof columns.find(c => c.id === 'select')!.header === 'function' &&\r\n                        // @ts-ignore\r\n                        columns.find(c => c.id === 'select')!.header({\r\n                          isAllPageRowsSelected,\r\n                          isSomePageRowsSelected,\r\n                          onToggleAll: handleToggleAllPageRows,\r\n                        })\r\n                      }\r\n                    </th>\r\n                    <th className=\"sticky left-[48px] z-[60] h-9 bg-muted/95 backdrop-blur-sm\">\r\n                      <div className=\"flex items-center gap-3 px-4\">\r\n                        <span className=\"text-sm font-medium\">{numSelected} mục đã chọn</span>\r\n                        {bulkActions && bulkActions.length > 0 && (\r\n                          <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                              <Button variant=\"outline\" size=\"sm\">\r\n                                Action\r\n                                <ChevronDown className=\"ml-2 h-4 w-4\" />\r\n                              </Button>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"start\">\r\n                              {bulkActions.map((action, index) => (\r\n                                <DropdownMenuItem\r\n                                  key={index}\r\n                                  onSelect={() => action.onSelect(allSelectedRows)}\r\n                                  disabled={(action as any).disabled}\r\n                                >\r\n                                  {action.icon && <action.icon className=\"mr-2 h-4 w-4\" />}\r\n                                  {action.label}\r\n                                </DropdownMenuItem>\r\n                              ))}\r\n                            </DropdownMenuContent>\r\n                          </DropdownMenu>\r\n                        )}\r\n                        {pkgxBulkActions && pkgxBulkActions.length > 0 && (\r\n                          <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                              <Button variant=\"outline\" size=\"sm\">\r\n                                PKGX\r\n                                <ChevronDown className=\"ml-2 h-4 w-4\" />\r\n                              </Button>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"start\">\r\n                              {pkgxBulkActions.map((action, index) => (\r\n                                <DropdownMenuItem\r\n                                  key={index}\r\n                                  onSelect={() => action.onSelect(allSelectedRows)}\r\n                                  disabled={(action as any).disabled}\r\n                                  className={(action as any).variant === 'destructive' ? 'text-destructive focus:text-destructive' : ''}\r\n                                >\r\n                                  {action.icon && <action.icon className=\"mr-2 h-4 w-4\" />}\r\n                                  {action.label}\r\n                                </DropdownMenuItem>\r\n                              ))}\r\n                            </DropdownMenuContent>\r\n                          </DropdownMenu>\r\n                        )}\r\n                        {bulkActionButtons}\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n                )}\r\n                {renderHeaderRow(true)}\r\n              </TableHeader>\r\n            </Table>\r\n          </div>\r\n\r\n          <div\r\n            ref={tableContainerRef}\r\n            onScroll={() => syncScroll('body')}\r\n            className=\"rounded-b-md border border-border bg-background overflow-x-auto [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]\"\r\n          >\r\n            <Table ref={bodyTableRef}>\r\n              <TableBody>\r\n                {data.map((row, rowIndex) => (\r\n                  <React.Fragment key={`${row.systemId}-${rowIndex}`}>\r\n                    <TableRow\r\n                      data-state={rowSelection[row.systemId] && \"selected\"}\r\n                      onClick={() => onRowClick?.(row)}\r\n                      className={cn('group', onRowClick && 'cursor-pointer')}\r\n                      style={getRowStyle?.(row)}\r\n                    >\r\n                      {displayColumns.map((column, colIndex) => {\r\n                        const isInteractiveColumn = ['select', 'control', 'actions', 'expander'].includes(column.id);\r\n\r\n                        const stickyMeta = (column.meta as any)?.sticky;\r\n                        const hasFixedSize = column.size !== undefined;\r\n                        const fallbackMinWidth = (column.meta as any)?.minWidth ?? 140;\r\n\r\n                        const style: React.CSSProperties = {};\r\n\r\n                        if (hasFixedSize) {\r\n                          style.width = column.size;\r\n                          style.minWidth = column.size;\r\n                          style.maxWidth = column.size;\r\n                        } else {\r\n                          style.minWidth = fallbackMinWidth;\r\n                        }\r\n\r\n                        let tdClassName = \"\";\r\n\r\n                        const isLastLeftSticky = stickyMeta === 'left' && colIndex === leftStickyColumns.length - 1;\r\n\r\n                        if (stickyMeta === 'left') {\r\n                          const stickyIndex = leftStickyColumns.findIndex(c => c.id === column.id);\r\n                          if (stickyIndex !== -1) {\r\n                            (style as any).position = 'sticky';\r\n                            (style as any).left = `${leftOffsets[stickyIndex]}px`;\r\n                            const rowBgColor = getRowStyle?.(row)?.backgroundColor;\r\n                            (style as any).backgroundColor = rowBgColor || stickyCellBg;\r\n                            tdClassName = cn(\r\n                              \"z-20 shadow-[2px_0_6px_rgba(0,0,0,0.05)]\",\r\n                              \"bg-muted text-foreground group-hover:bg-muted group-data-[state=selected]:bg-muted\"\r\n                            );\r\n                          }\r\n                        } else if (stickyMeta === 'right') {\r\n                          const stickyIndex = rightStickyColumns.findIndex(c => c.id === column.id);\r\n                          if (stickyIndex !== -1) {\r\n                            (style as any).position = 'sticky';\r\n                            (style as any).right = `${rightOffsets[stickyIndex]}px`;\r\n                            const rowBgColor = getRowStyle?.(row)?.backgroundColor;\r\n                            (style as any).backgroundColor = rowBgColor || stickyCellBg;\r\n                            tdClassName = cn(\r\n                              \"z-20\",\r\n                              \"bg-muted text-foreground group-hover:bg-muted group-data-[state=selected]:bg-muted shadow-[-2px_0_6px_rgba(0,0,0,0.08)]\"\r\n                            );\r\n                          }\r\n                        }\r\n\r\n                        if (['control', 'select', 'expander', 'actions'].includes(column.id)) {\r\n                          tdClassName = cn(tdClassName, \"px-2 text-center\");\r\n                        }\r\n\r\n                        return (\r\n                          <TableCell\r\n                            key={column.id}\r\n                            style={style}\r\n                            className={cn(tdClassName, {\r\n                              \"border-r border-border\": isLastLeftSticky,\r\n                            })}\r\n                            onClick={isInteractiveColumn ? (e) => e.stopPropagation() : undefined}\r\n                          >\r\n                            {column.cell({\r\n                              row,\r\n                              isSelected: !!rowSelection[row.systemId],\r\n                              isExpanded: !!expanded[row.systemId],\r\n                              onToggleSelect: (value) => {\r\n                                setRowSelection(prev => {\r\n                                  const newSelection = { ...prev };\r\n                                  if (value) {\r\n                                    newSelection[row.systemId] = true;\r\n                                  } else {\r\n                                    delete newSelection[row.systemId];\r\n                                  }\r\n                                  return newSelection;\r\n                                });\r\n                              },\r\n                              onToggleExpand: () => setExpanded(prev => ({ ...prev, [row.systemId]: !prev[row.systemId] })),\r\n                            })}\r\n                          </TableCell>\r\n                        );\r\n                      })}\r\n                    </TableRow>\r\n                    {expanded[row.systemId] && renderSubComponent && (\r\n                      <TableRow>\r\n                        <TableCell colSpan={displayColumns.length} className=\"p-0\">\r\n                          {renderSubComponent(row)}\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    )}\r\n                  </React.Fragment>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n        </>\r\n      ) : (\r\n        <div\r\n          ref={tableContainerRef}\r\n          className=\"rounded-md border border-border bg-background overflow-x-auto [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]\"\r\n        >\r\n          <Table ref={fallbackTableRef}>\r\n            <TableHeader className=\"bg-muted shadow-sm\">\r\n              {renderHeaderRow(true)}\r\n            </TableHeader>\r\n            <TableBody>\r\n              <TableRow>\r\n                <TableCell colSpan={displayColumns.length} className=\"h-24 text-center\">\r\n                  Không có dữ liệu.\r\n                </TableCell>\r\n              </TableRow>\r\n            </TableBody>\r\n          </Table>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex-shrink-0 border-t border-border bg-background px-6 py-3\">\r\n        <DataTablePagination\r\n          pageIndex={pagination.pageIndex}\r\n          pageSize={pagination.pageSize}\r\n          pageCount={pageCount}\r\n          setPageIndex={(index) => setPagination(p => ({ ...p, pageIndex: index }))}\r\n          setPageSize={(size) => setPagination({ pageIndex: 0, pageSize: size })}\r\n          canPreviousPage={pagination.pageIndex > 0}\r\n          canNextPage={pagination.pageIndex < pageCount - 1}\r\n          rowCount={rowCount}\r\n          selectedRowCount={numSelected}\r\n        />\r\n      </div>\r\n\r\n      <StickyScrollbar targetRef={tableContainerRef} />\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * MobileCardWrapper - Helper component for consistent mobile card styling\r\n */\r\nexport function MobileCardWrapper({\r\n  children,\r\n  onClick,\r\n  className,\r\n}: {\r\n  children: React.ReactNode;\r\n  onClick?: () => void;\r\n  className?: string;\r\n}) {\r\n  return (\r\n    <Card\r\n      className={cn(\r\n        \"hover:shadow-md transition-shadow\",\r\n        onClick && \"cursor-pointer\",\r\n        className\r\n      )}\r\n      onClick={onClick}\r\n    >\r\n      <CardContent className=\"p-4\">\r\n        {children}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3826, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/layout/page-filters.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Input } from '../ui/input';\r\nimport { cn } from '../../lib/utils';\r\n\r\n/**\r\n * Page Filters Component\r\n * Mobile-first filters bar for search and custom filters\r\n * Hàng 3 trong layout 3 tầng\r\n * Layout: Search + leftFilters bên TRÁI | rightFilters bên PHẢI\r\n */\r\nexport interface PageFiltersProps {\r\n  /** Search input props */\r\n  searchValue?: string;\r\n  onSearchChange?: (value: string) => void;\r\n  searchPlaceholder?: string;\r\n  /** Deprecated: Use children for backward compatibility, or use leftFilters + rightFilters for new layout */\r\n  children?: React.ReactNode;\r\n  /** Filters to show next to search (left side) */\r\n  leftFilters?: React.ReactNode;\r\n  /** Filters to show on right side */\r\n  rightFilters?: React.ReactNode;\r\n  /** Additional CSS classes */\r\n  className?: string;\r\n}\r\n\r\nexport function PageFilters({ \r\n  searchValue = '',\r\n  onSearchChange,\r\n  searchPlaceholder = 'Tìm kiếm...',\r\n  children,\r\n  leftFilters,\r\n  rightFilters,\r\n  className \r\n}: PageFiltersProps) {\r\n  // Backward compatibility: if children is provided without leftFilters/rightFilters, use old layout\r\n  const useNewLayout = (leftFilters !== undefined || rightFilters !== undefined);\r\n  \r\n  if (!useNewLayout && children) {\r\n    return (\r\n      <div \r\n        className={cn(\r\n          \"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 py-3 bg-muted/20\",\r\n          className\r\n        )}\r\n      >\r\n        {/* Search bar - Full width on mobile, auto on desktop */}\r\n        {onSearchChange && (\r\n          <Input\r\n            type=\"search\"\r\n            placeholder={searchPlaceholder}\r\n            value={searchValue}\r\n            onChange={(e) => onSearchChange(e.target.value)}\r\n            className=\"h-9 w-full sm:w-[280px] md:w-[360px] lg:w-[420px]\"\r\n          />\r\n        )}\r\n        \r\n        {/* Custom filters - Wrap on mobile */}\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          {children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  // New layout: Search + leftFilters | rightFilters\r\n  return (\r\n    <div \r\n      className={cn(\r\n        \"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 py-3 bg-muted/20\",\r\n        className\r\n      )}\r\n    >\r\n      {/* Left side: Search + leftFilters */}\r\n      <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 flex-1\">\r\n        {onSearchChange && (\r\n          <Input\r\n            type=\"search\"\r\n            placeholder={searchPlaceholder}\r\n            value={searchValue}\r\n            onChange={(e) => onSearchChange(e.target.value)}\r\n            className=\"h-9 w-full sm:w-[280px] md:w-[360px] lg:w-[420px]\"\r\n          />\r\n        )}\r\n        {leftFilters && (\r\n          <div className=\"flex flex-wrap items-center gap-2\">\r\n            {leftFilters}\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Right side: rightFilters */}\r\n      {rightFilters && (\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          {rightFilters}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAuBO,SAAS,YAAY,EAC1B,cAAc,EAAE,EAChB,cAAc,EACd,oBAAoB,aAAa,EACjC,QAAQ,EACR,WAAW,EACX,YAAY,EACZ,SAAS,EACQ;IACjB,mGAAmG;IACnG,MAAM,eAAgB,gBAAgB,aAAa,iBAAiB;IAEpE,IAAI,CAAC,gBAAgB,UAAU;QAC7B,qBACE,6LAAC;YACC,WAAW,IAAA,qHAAE,EACX,kGACA;;gBAID,gCACC,6LAAC,sIAAK;oBACJ,MAAK;oBACL,aAAa;oBACb,OAAO;oBACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;oBAC9C,WAAU;;;;;;8BAKd,6LAAC;oBAAI,WAAU;8BACZ;;;;;;;;;;;;IAIT;IAEA,kDAAkD;IAClD,qBACE,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,kGACA;;0BAIF,6LAAC;gBAAI,WAAU;;oBACZ,gCACC,6LAAC,sIAAK;wBACJ,MAAK;wBACL,aAAa;wBACb,OAAO;wBACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wBAC9C,WAAU;;;;;;oBAGb,6BACC,6LAAC;wBAAI,WAAU;kCACZ;;;;;;;;;;;;YAMN,8BACC,6LAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAKX;KAzEgB"}},
    {"offset": {"line": 3926, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\r\nimport { Check } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\ntype BaseCheckboxProps = React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\r\n\r\ntype CheckboxProps = Omit<BaseCheckboxProps, \"checked\" | \"defaultChecked\"> & {\r\n  checked?: CheckboxPrimitive.CheckedState | undefined\r\n  defaultChecked?: CheckboxPrimitive.CheckedState | undefined\r\n}\r\n\r\nconst Checkbox = React.forwardRef<\r\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\r\n  CheckboxProps\r\n>(({ className, checked, defaultChecked, ...props }, ref) => (\r\n  <CheckboxPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n    {...(checked !== undefined ? { checked } : {})}\r\n    {...(defaultChecked !== undefined ? { defaultChecked } : {})}\r\n  >\r\n    <CheckboxPrimitive.Indicator\r\n      className={cn(\"flex items-center justify-center text-current\")}\r\n    >\r\n      <Check className=\"h-4 w-4\" />\r\n    </CheckboxPrimitive.Indicator>\r\n  </CheckboxPrimitive.Root>\r\n))\r\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\r\n\r\nexport { Checkbox }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AASA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,oBACnD,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,kTACA;QAED,GAAG,KAAK;QACR,GAAI,YAAY,YAAY;YAAE;QAAQ,IAAI,CAAC,CAAC;QAC5C,GAAI,mBAAmB,YAAY;YAAE;QAAe,IAAI,CAAC,CAAC;kBAE3D,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,qHAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 3982, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/components/status-badge.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Badge } from '../../../components/ui/badge';\r\nimport type { PayrollBatchStatus } from '../../../lib/payroll-types';\r\nimport { cn } from '../../../lib/utils';\r\n\r\ntype PayrollStatusBadgeProps = {\r\n  status: PayrollBatchStatus;\r\n  className?: string;\r\n};\r\n\r\nconst STATUS_LABEL: Record<PayrollBatchStatus, string> = {\r\n  draft: 'Nháp',\r\n  reviewed: 'Đang duyệt',\r\n  locked: 'Đã khóa',\r\n  cancelled: 'Đã hủy',\r\n};\r\n\r\nconst STATUS_VARIANT: Record<PayrollBatchStatus, React.ComponentProps<typeof Badge>['variant']> = {\r\n  draft: 'secondary',\r\n  reviewed: 'warning',\r\n  locked: 'success',\r\n  cancelled: 'destructive',\r\n};\r\n\r\nexport function PayrollStatusBadge({ status, className }: PayrollStatusBadgeProps) {\r\n  return (\r\n    <Badge variant={STATUS_VARIANT[status]} className={cn('text-body-xs font-medium', className)}>\r\n      {STATUS_LABEL[status]}\r\n    </Badge>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AAEA;;;;AAOA,MAAM,eAAmD;IACvD,OAAO;IACP,UAAU;IACV,QAAQ;IACR,WAAW;AACb;AAEA,MAAM,iBAA4F;IAChG,OAAO;IACP,UAAU;IACV,QAAQ;IACR,WAAW;AACb;AAEO,SAAS,mBAAmB,EAAE,MAAM,EAAE,SAAS,EAA2B;IAC/E,qBACE,6LAAC,sIAAK;QAAC,SAAS,cAAc,CAAC,OAAO;QAAE,WAAW,IAAA,qHAAE,EAAC,4BAA4B;kBAC/E,YAAY,CAAC,OAAO;;;;;;AAG3B;KANgB"}},
    {"offset": {"line": 4025, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/components/batch-columns.tsx"],"sourcesContent":["/**\r\n * Payroll Batch Column Definitions\r\n * Chuẩn theo guide copy-employee-features-guide.md\r\n */\r\n\r\nimport * as React from 'react';\r\nimport Link from 'next/link';\r\nimport { MoreHorizontal, Eye, Lock, Unlock, Trash2 } from 'lucide-react';\r\nimport type { ColumnDef } from '../../../components/data-table/types';\r\nimport type { PayrollBatch } from '../../../lib/payroll-types';\r\nimport { ROUTES } from '../../../lib/router';\r\nimport { Checkbox } from '../../../components/ui/checkbox';\r\nimport { Button } from '../../../components/ui/button';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '../../../components/ui/dropdown-menu';\r\nimport { PayrollStatusBadge } from './status-badge';\r\nimport { formatDateForDisplay, formatDateTimeForDisplay } from '@/lib/date-utils';\r\n\r\nconst currencyFormatter = new Intl.NumberFormat('vi-VN', {\r\n  style: 'currency',\r\n  currency: 'VND',\r\n  maximumFractionDigits: 0,\r\n});\r\n\r\nconst formatCurrency = (value?: number) =>\r\n  typeof value === 'number' ? currencyFormatter.format(value) : '—';\r\n\r\nconst formatMonthKey = (monthKey: string) => {\r\n  if (!monthKey) return '—';\r\n  const [year, month] = monthKey.split('-');\r\n  return `Tháng ${month}/${year}`;\r\n};\r\n\r\nconst formatDate = (value?: string) => {\r\n  if (!value) return '—';\r\n  return formatDateForDisplay(value);\r\n};\r\n\r\nconst formatDateTime = (value?: string) => {\r\n  if (!value) return '—';\r\n  return formatDateTimeForDisplay(value);\r\n};\r\n\r\ntype BatchColumnActions = {\r\n  onLock?: (systemId: string) => void;\r\n  onUnlock?: (systemId: string) => void;\r\n  onCancel?: (systemId: string) => void;\r\n  navigate: (path: string) => void;\r\n};\r\n\r\nexport const getBatchColumns = (actions: BatchColumnActions): ColumnDef<PayrollBatch>[] => [\r\n  // 1. Select column\r\n  {\r\n    id: 'select',\r\n    size: 48,\r\n    enableSorting: false,\r\n    header: ({ isAllPageRowsSelected, onToggleAll }) => (\r\n      <Checkbox\r\n        checked={isAllPageRowsSelected}\r\n        onCheckedChange={(value) => onToggleAll?.(!!value)}\r\n        aria-label=\"Chọn tất cả\"\r\n      />\r\n    ),\r\n    cell: ({ row, isSelected, onToggleSelect }) => (\r\n      <Checkbox\r\n        checked={isSelected}\r\n        onCheckedChange={(value) => onToggleSelect(!!value)}\r\n        onClick={(e) => e.stopPropagation()}\r\n        aria-label=\"Chọn hàng\"\r\n      />\r\n    ),\r\n    meta: { displayName: 'Chọn', sticky: 'left' },\r\n  },\r\n\r\n  // 2. ID column - Clickable, navigate to detail\r\n  {\r\n    id: 'id',\r\n    accessorKey: 'id',\r\n    size: 120,\r\n    header: 'Mã bảng lương',\r\n    cell: ({ row }) => (\r\n      <Link\r\n        href={ROUTES.PAYROLL.DETAIL.replace(':systemId', row.systemId)}\r\n        className=\"font-mono text-body-xs text-primary hover:underline\"\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        {row.id}\r\n      </Link>\r\n    ),\r\n    meta: { displayName: 'Mã bảng lương' },\r\n  },\r\n\r\n  // 3. Title\r\n  {\r\n    id: 'title',\r\n    accessorKey: 'title',\r\n    size: 200,\r\n    header: 'Tiêu đề',\r\n    cell: ({ row }) => (\r\n      <span className=\"font-medium\">{row.title}</span>\r\n    ),\r\n    meta: { displayName: 'Tiêu đề' },\r\n  },\r\n\r\n  // 4. Reference Month\r\n  {\r\n    id: 'referenceMonth',\r\n    accessorKey: 'referenceAttendanceMonthKeys',\r\n    size: 150,\r\n    header: 'Tháng tham chiếu',\r\n    cell: ({ row }) => formatMonthKey(row.referenceAttendanceMonthKeys[0]),\r\n    meta: { displayName: 'Tháng tham chiếu' },\r\n  },\r\n\r\n  // 5. Payroll Date\r\n  {\r\n    id: 'payrollDate',\r\n    accessorKey: 'payrollDate',\r\n    size: 120,\r\n    header: 'Ngày trả',\r\n    cell: ({ row }) => formatDate(row.payrollDate),\r\n    meta: { displayName: 'Ngày trả' },\r\n  },\r\n\r\n  // 6. Status\r\n  {\r\n    id: 'status',\r\n    accessorKey: 'status',\r\n    size: 120,\r\n    header: 'Trạng thái',\r\n    cell: ({ row }) => <PayrollStatusBadge status={row.status} />,\r\n    meta: { displayName: 'Trạng thái' },\r\n  },\r\n\r\n  // 7. Total Net Pay\r\n  {\r\n    id: 'totalNet',\r\n    accessorKey: 'totalNet',\r\n    size: 150,\r\n    header: () => <div className=\"text-right\">Tổng thực lĩnh</div>,\r\n    cell: ({ row }) => (\r\n      <div className=\"text-right font-semibold text-primary\">\r\n        {formatCurrency(row.totalNet)}\r\n      </div>\r\n    ),\r\n    meta: { displayName: 'Tổng thực lĩnh' },\r\n  },\r\n\r\n  // 8. Employee Count\r\n  {\r\n    id: 'employeeCount',\r\n    accessorKey: 'payslipSystemIds',\r\n    size: 100,\r\n    header: () => <div className=\"text-center\">Số NV</div>,\r\n    cell: ({ row }) => (\r\n      <div className=\"text-center\">\r\n        {row.payslipSystemIds?.length ?? 0}\r\n      </div>\r\n    ),\r\n    meta: { displayName: 'Số nhân viên' },\r\n  },\r\n\r\n  // 9. Created At\r\n  {\r\n    id: 'createdAt',\r\n    accessorKey: 'createdAt',\r\n    size: 160,\r\n    header: 'Ngày tạo',\r\n    cell: ({ row }) => formatDateTime(row.createdAt),\r\n    meta: { displayName: 'Ngày tạo' },\r\n  },\r\n\r\n  // Actions column\r\n  {\r\n    id: 'actions',\r\n    size: 90,\r\n    enableSorting: false,\r\n    header: () => <div className=\"text-right\">Thao tác</div>,\r\n    cell: ({ row }) => {\r\n      const batch = row;\r\n      const isLocked = batch.status === 'locked';\r\n\r\n      return (\r\n        <div className=\"flex justify-end\">\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                className=\"h-8 w-8\"\r\n                onClick={(e) => e.stopPropagation()}\r\n              >\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n                <span className=\"sr-only\">Mở menu</span>\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n              <DropdownMenuItem\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  actions.navigate(ROUTES.PAYROLL.DETAIL.replace(':systemId', batch.systemId));\r\n                }}\r\n              >\r\n                <Eye className=\"mr-2 h-4 w-4\" />\r\n                Xem chi tiết\r\n              </DropdownMenuItem>\r\n              <DropdownMenuSeparator />\r\n              {!isLocked && actions.onLock && (\r\n                <DropdownMenuItem\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    actions.onLock?.(batch.systemId);\r\n                  }}\r\n                >\r\n                  <Lock className=\"mr-2 h-4 w-4\" />\r\n                  Khóa bảng lương\r\n                </DropdownMenuItem>\r\n              )}\r\n              {isLocked && actions.onUnlock && (\r\n                <DropdownMenuItem\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    actions.onUnlock?.(batch.systemId);\r\n                  }}\r\n                >\r\n                  <Unlock className=\"mr-2 h-4 w-4\" />\r\n                  Mở khóa\r\n                </DropdownMenuItem>\r\n              )}\r\n              {!isLocked && actions.onCancel && (\r\n                <>\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      actions.onCancel?.(batch.systemId);\r\n                    }}\r\n                    className=\"text-destructive focus:text-destructive\"\r\n                  >\r\n                    <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                    Hủy bảng lương\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        </div>\r\n      );\r\n    },\r\n    meta: { displayName: 'Thao tác', sticky: 'right' },\r\n  },\r\n];\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4424, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/components/batch-card.tsx"],"sourcesContent":["/**\r\n * Mobile Card for Payroll Batch\r\n * Hiển thị thông tin batch ở mobile view\r\n */\r\n\r\n'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Calendar, Users, Wallet, MoreHorizontal, Eye, Lock, Unlock, Trash2 } from 'lucide-react';\r\nimport { Card, CardContent } from '../../../components/ui/card';\r\nimport { Badge } from '../../../components/ui/badge';\r\nimport { Button } from '../../../components/ui/button';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '../../../components/ui/dropdown-menu';\r\nimport type { PayrollBatch } from '../../../lib/payroll-types';\r\nimport { ROUTES } from '../../../lib/router';\r\nimport { formatDateForDisplay } from '@/lib/date-utils';\r\n\r\nconst currencyFormatter = new Intl.NumberFormat('vi-VN', {\r\n  style: 'currency',\r\n  currency: 'VND',\r\n  maximumFractionDigits: 0,\r\n});\r\n\r\nconst formatCurrency = (value?: number) =>\r\n  typeof value === 'number' ? currencyFormatter.format(value) : '—';\r\n\r\nconst formatMonthKey = (monthKey: string) => {\r\n  if (!monthKey) return '—';\r\n  const [year, month] = monthKey.split('-');\r\n  return `Tháng ${month}/${year}`;\r\n};\r\n\r\nconst formatDate = (value?: string) => {\r\n  if (!value) return '—';\r\n  return formatDateForDisplay(value);\r\n};\r\n\r\nconst getStatusVariant = (status: PayrollBatch['status']): 'default' | 'secondary' | 'outline' => {\r\n  switch (status) {\r\n    case 'locked':\r\n      return 'default';\r\n    case 'reviewed':\r\n      return 'secondary';\r\n    case 'draft':\r\n    default:\r\n      return 'outline';\r\n  }\r\n};\r\n\r\nconst getStatusLabel = (status: PayrollBatch['status']): string => {\r\n  switch (status) {\r\n    case 'locked':\r\n      return 'Đã khóa';\r\n    case 'reviewed':\r\n      return 'Đã duyệt';\r\n    case 'draft':\r\n    default:\r\n      return 'Nháp';\r\n  }\r\n};\r\n\r\ntype BatchCardActions = {\r\n  onLock?: (systemId: string) => void;\r\n  onUnlock?: (systemId: string) => void;\r\n  onCancel?: (systemId: string) => void;\r\n};\r\n\r\ninterface BatchCardProps {\r\n  batch: PayrollBatch;\r\n  actions?: BatchCardActions;\r\n}\r\n\r\nexport function BatchCard({ batch, actions }: BatchCardProps) {\r\n  const router = useRouter();\r\n  const isLocked = batch.status === 'locked';\r\n\r\n  const handleClick = () => {\r\n    router.push(ROUTES.PAYROLL.DETAIL.replace(':systemId', batch.systemId));\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      className=\"hover:shadow-md transition-shadow cursor-pointer\"\r\n      onClick={handleClick}\r\n    >\r\n      <CardContent className=\"p-4\">\r\n        {/* Header: Title + Code + Menu */}\r\n        <div className=\"flex items-start justify-between gap-2 mb-2\">\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <h3 className=\"font-semibold text-body-medium truncate\">{batch.title}</h3>\r\n            </div>\r\n            <span className=\"text-body-xs text-muted-foreground font-mono\">{batch.id}</span>\r\n          </div>\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"h-8 w-8 p-0 flex-shrink-0\"\r\n                onClick={(e) => e.stopPropagation()}\r\n              >\r\n                <MoreHorizontal className=\"h-4 w-4\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\">\r\n              <DropdownMenuItem\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleClick();\r\n                }}\r\n              >\r\n                <Eye className=\"mr-2 h-4 w-4\" />\r\n                Xem chi tiết\r\n              </DropdownMenuItem>\r\n              <DropdownMenuSeparator />\r\n              {!isLocked && actions?.onLock && (\r\n                <DropdownMenuItem\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    actions.onLock?.(batch.systemId);\r\n                  }}\r\n                >\r\n                  <Lock className=\"mr-2 h-4 w-4\" />\r\n                  Khóa bảng lương\r\n                </DropdownMenuItem>\r\n              )}\r\n              {isLocked && actions?.onUnlock && (\r\n                <DropdownMenuItem\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    actions.onUnlock?.(batch.systemId);\r\n                  }}\r\n                >\r\n                  <Unlock className=\"mr-2 h-4 w-4\" />\r\n                  Mở khóa\r\n                </DropdownMenuItem>\r\n              )}\r\n              {!isLocked && actions?.onCancel && (\r\n                <>\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      actions.onCancel?.(batch.systemId);\r\n                    }}\r\n                    className=\"text-destructive focus:text-destructive\"\r\n                  >\r\n                    <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                    Hủy bảng lương\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        </div>\r\n\r\n        {/* Reference Month */}\r\n        <div className=\"text-body-xs text-muted-foreground mb-3 flex items-center\">\r\n          <Calendar className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n          <span>{formatMonthKey(batch.referenceAttendanceMonthKeys[0])}</span>\r\n        </div>\r\n\r\n        {/* Divider */}\r\n        <div className=\"border-t mb-3\" />\r\n\r\n        {/* Info rows */}\r\n        <div className=\"space-y-2\">\r\n          {/* Ngày trả & Số NV */}\r\n          <div className=\"flex items-center justify-between text-body-xs\">\r\n            <div className=\"flex items-center text-muted-foreground\">\r\n              <Calendar className=\"h-3 w-3 mr-1.5\" />\r\n              <span>Ngày trả: {formatDate(batch.payrollDate)}</span>\r\n            </div>\r\n            <div className=\"flex items-center text-muted-foreground\">\r\n              <Users className=\"h-3 w-3 mr-1.5\" />\r\n              <span>{batch.payslipSystemIds?.length ?? 0} NV</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Tổng thực lĩnh & Status */}\r\n          <div className=\"flex items-center justify-between text-body-xs pt-1\">\r\n            <div className=\"flex items-center font-semibold text-primary\">\r\n              <Wallet className=\"h-3 w-3 mr-1.5\" />\r\n              <span>{formatCurrency(batch.totalNet)}</span>\r\n            </div>\r\n            <Badge variant={getStatusVariant(batch.status)} className=\"text-body-xs\">\r\n              {getStatusLabel(batch.status)}\r\n            </Badge>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4853, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/settings-sync-helper.ts"],"sourcesContent":["/**\r\n * Settings API Sync Helper\r\n * \r\n * Helper functions to sync settings stores with PostgreSQL API\r\n */\r\n\r\nconst API_BASE = '/api/settings';\r\n\r\nexport interface SettingSyncConfig {\r\n  group: string;\r\n  key?: string;\r\n}\r\n\r\n/**\r\n * Fetch settings from API by group\r\n */\r\nexport async function fetchSettingsFromAPI<T>(config: SettingSyncConfig): Promise<T | null> {\r\n  try {\r\n    const params = new URLSearchParams();\r\n    params.set('group', config.group);\r\n    if (config.key) {\r\n      params.set('key', config.key);\r\n    }\r\n    \r\n    const response = await fetch(`${API_BASE}?${params.toString()}`);\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to fetch settings: ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    \r\n    // If specific key requested, return the value\r\n    if (config.key && data.value !== undefined) {\r\n      return data.value as T;\r\n    }\r\n    \r\n    // Return grouped data for the specified group\r\n    return data.grouped?.[config.group] as T || null;\r\n  } catch (error) {\r\n    console.error(`[Settings Sync] Error fetching ${config.group}:`, error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Save settings to API\r\n */\r\nexport async function saveSettingsToAPI(\r\n  group: string,\r\n  key: string,\r\n  value: any,\r\n  description?: string\r\n): Promise<boolean> {\r\n  try {\r\n    const response = await fetch(API_BASE, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        group,\r\n        key,\r\n        value: typeof value === 'object' ? JSON.stringify(value) : value,\r\n        description,\r\n      }),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Failed to save setting: ${response.statusText}`);\r\n    }\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Settings Sync] Error saving ${group}.${key}:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Bulk save settings to API\r\n */\r\nexport async function bulkSaveSettingsToAPI(\r\n  group: string,\r\n  settings: Record<string, any>\r\n): Promise<boolean> {\r\n  try {\r\n    const settingsArray = Object.entries(settings).map(([key, value]) => ({\r\n      group,\r\n      key,\r\n      value: typeof value === 'object' ? JSON.stringify(value) : value,\r\n    }));\r\n    \r\n    const response = await fetch(API_BASE, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ settings: settingsArray }),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Failed to bulk save settings: ${response.statusText}`);\r\n    }\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Settings Sync] Error bulk saving ${group}:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Create a settings sync middleware for Zustand stores\r\n * This wraps store actions to also sync to API\r\n */\r\nexport function createSettingsSyncMiddleware(group: string) {\r\n  return (setter: Function) => {\r\n    return (partialState: any) => {\r\n      // Apply local state first\r\n      setter(partialState);\r\n      \r\n      // Sync to API in background\r\n      if (typeof partialState === 'object' && partialState !== null) {\r\n        bulkSaveSettingsToAPI(group, partialState).catch(console.error);\r\n      }\r\n    };\r\n  };\r\n}\r\n\r\n/**\r\n * Hook to initialize settings from API\r\n */\r\nexport async function initializeSettingsFromAPI<T>(\r\n  group: string,\r\n  setSettings: (settings: T) => void,\r\n  defaultSettings: T\r\n): Promise<void> {\r\n  const apiSettings = await fetchSettingsFromAPI<T>({ group });\r\n  \r\n  if (apiSettings) {\r\n    // Parse JSON strings back to objects if needed\r\n    const parsedSettings = Object.entries(apiSettings).reduce((acc, [key, value]) => {\r\n      try {\r\n        if (typeof value === 'string' && (value.startsWith('{') || value.startsWith('['))) {\r\n          acc[key as keyof T] = JSON.parse(value);\r\n        } else {\r\n          acc[key as keyof T] = value as T[keyof T];\r\n        }\r\n      } catch {\r\n        acc[key as keyof T] = value as T[keyof T];\r\n      }\r\n      return acc;\r\n    }, {} as T);\r\n    \r\n    setSettings({ ...defaultSettings, ...parsedSettings });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4984, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/global-settings-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport * as React from 'react';\r\nimport { bulkSaveSettingsToAPI, initializeSettingsFromAPI } from '@/lib/settings-sync-helper';\r\n\r\nexport interface GlobalSettings {\r\n  /** Số dòng mỗi trang mặc định cho tất cả data tables */\r\n  defaultPageSize: number;\r\n  /** Các option page size cho dropdown */\r\n  pageSizeOptions: number[];\r\n}\r\n\r\nconst DEFAULT_SETTINGS: GlobalSettings = {\r\n  defaultPageSize: 20,\r\n  pageSizeOptions: [5, 10, 20, 50, 100],\r\n};\r\n\r\nconst SETTINGS_GROUP = 'global';\r\n\r\ninterface GlobalSettingsStore {\r\n  settings: GlobalSettings;\r\n  initialized: boolean;\r\n  setDefaultPageSize: (size: number) => void;\r\n  setPageSizeOptions: (options: number[]) => void;\r\n  resetSettings: () => void;\r\n  initFromAPI: () => Promise<void>;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nexport const useGlobalSettingsStore = create<GlobalSettingsStore>()(\r\n  (set, get) => ({\r\n    settings: DEFAULT_SETTINGS,\r\n    initialized: false,\r\n      \r\n      setDefaultPageSize: (size) => {\r\n        set((state) => ({\r\n          settings: { ...state.settings, defaultPageSize: size },\r\n        }));\r\n        // Sync to API in background\r\n        bulkSaveSettingsToAPI(SETTINGS_GROUP, { defaultPageSize: size }).catch(console.error);\r\n      },\r\n      \r\n      setPageSizeOptions: (options) => {\r\n        set((state) => ({\r\n          settings: { ...state.settings, pageSizeOptions: options },\r\n        }));\r\n        // Sync to API in background\r\n        bulkSaveSettingsToAPI(SETTINGS_GROUP, { pageSizeOptions: options }).catch(console.error);\r\n      },\r\n      \r\n      resetSettings: () => {\r\n        set({ settings: DEFAULT_SETTINGS });\r\n        // Sync reset to API\r\n        bulkSaveSettingsToAPI(SETTINGS_GROUP, DEFAULT_SETTINGS).catch(console.error);\r\n      },\r\n      \r\n      initFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        await initializeSettingsFromAPI<GlobalSettings>(\r\n          SETTINGS_GROUP,\r\n          (apiSettings) => set({ settings: apiSettings }),\r\n          DEFAULT_SETTINGS\r\n        );\r\n        set({ initialized: true });\r\n      },\r\n\r\n      loadFromAPI: async () => {\r\n        // Alias for initFromAPI for consistency with other stores\r\n        await get().initFromAPI();\r\n      },\r\n    })\r\n);\r\n\r\n/** Hook để lấy default page size */\r\nexport function useDefaultPageSize() {\r\n  return useGlobalSettingsStore((state) => state.settings.defaultPageSize);\r\n}\r\n\r\n/** Hook để lấy page size options */\r\nexport function usePageSizeOptions() {\r\n  return useGlobalSettingsStore((state) => state.settings.pageSizeOptions);\r\n}\r\n\r\n/** \r\n * Hook để quản lý pagination state với default page size từ global settings\r\n * @returns [pagination, setPagination]\r\n */\r\nexport function usePaginationWithGlobalDefault() {\r\n  const defaultPageSize = useDefaultPageSize();\r\n  return React.useState({ pageIndex: 0, pageSize: defaultPageSize });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;;;;;AASA,MAAM,mBAAmC;IACvC,iBAAiB;IACjB,iBAAiB;QAAC;QAAG;QAAI;QAAI;QAAI;KAAI;AACvC;AAEA,MAAM,iBAAiB;AAYhB,MAAM,yBAAyB,IAAA,qJAAM,IAC1C,CAAC,KAAK,MAAQ,CAAC;QACb,UAAU;QACV,aAAa;QAEX,oBAAoB,CAAC;YACnB,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;wBAAE,GAAG,MAAM,QAAQ;wBAAE,iBAAiB;oBAAK;gBACvD,CAAC;YACD,4BAA4B;YAC5B,IAAA,6JAAqB,EAAC,gBAAgB;gBAAE,iBAAiB;YAAK,GAAG,KAAK,CAAC,QAAQ,KAAK;QACtF;QAEA,oBAAoB,CAAC;YACnB,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;wBAAE,GAAG,MAAM,QAAQ;wBAAE,iBAAiB;oBAAQ;gBAC1D,CAAC;YACD,4BAA4B;YAC5B,IAAA,6JAAqB,EAAC,gBAAgB;gBAAE,iBAAiB;YAAQ,GAAG,KAAK,CAAC,QAAQ,KAAK;QACzF;QAEA,eAAe;YACb,IAAI;gBAAE,UAAU;YAAiB;YACjC,oBAAoB;YACpB,IAAA,6JAAqB,EAAC,gBAAgB,kBAAkB,KAAK,CAAC,QAAQ,KAAK;QAC7E;QAEA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YACvB,MAAM,IAAA,iKAAyB,EAC7B,gBACA,CAAC,cAAgB,IAAI;oBAAE,UAAU;gBAAY,IAC7C;YAEF,IAAI;gBAAE,aAAa;YAAK;QAC1B;QAEA,aAAa;YACX,0DAA0D;YAC1D,MAAM,MAAM,WAAW;QACzB;IACF,CAAC;AAIE,SAAS;;IACd,OAAO;qDAAuB,CAAC,QAAU,MAAM,QAAQ,CAAC,eAAe;;AACzE;GAFgB;;QACP;;;AAIF,SAAS;;IACd,OAAO;qDAAuB,CAAC,QAAU,MAAM,QAAQ,CAAC,eAAe;;AACzE;IAFgB;;QACP;;;AAOF,SAAS;;IACd,MAAM,kBAAkB;IACxB,OAAO,yKAAc,CAAC;QAAE,WAAW;QAAG,UAAU;IAAgB;AAClE;IAHgB;;QACU"}},
    {"offset": {"line": 5102, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/store-factory.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// persist, createJSONStorage removed - database is now source of truth\r\nimport { \r\n  generateSystemId, \r\n  generateBusinessId, \r\n  isBusinessIdUnique,\r\n  getMaxSystemIdCounter,\r\n  getMaxBusinessIdCounter,\r\n  findNextAvailableBusinessId,\r\n  type EntityType \r\n} from './id-utils';\r\nimport { getPrefix } from './smart-prefix';\r\nimport { ID_CONFIG, type SystemId, type BusinessId, createSystemId, createBusinessId as brandBusinessId } from './id-config';\r\n\r\nconst SYSTEM_FALLBACK_ID: SystemId = createSystemId('SYS000000');\r\n\r\nconst asSystemIdFallback = (): SystemId => SYSTEM_FALLBACK_ID;\r\n\r\n// ✅ API Sync helper for store-factory\r\nasync function syncToAPI<T>(\r\n  apiEndpoint: string,\r\n  action: 'create' | 'update' | 'delete' | 'restore',\r\n  data: T | { systemId: SystemId },\r\n  systemId?: SystemId\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' \r\n      ? apiEndpoint \r\n      : `${apiEndpoint}/${systemId || (data as any).systemId}`;\r\n    \r\n    const method = action === 'create' ? 'POST' \r\n      : action === 'update' ? 'PATCH' \r\n      : action === 'delete' ? 'DELETE'\r\n      : 'PATCH'; // restore uses PATCH\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'include',\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.warn(`[Store Factory API] ${action} failed for ${apiEndpoint}:`, response.status);\r\n    }\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Store Factory API] ${action} error for ${apiEndpoint}:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Item with SystemId (branded type)\r\nexport type ItemWithSystemId = { systemId: SystemId; [key: string]: any };\r\n\r\n// ✅ Counter state for ID generation\r\nexport type CounterState = {\r\n  systemId: number;\r\n  businessId: number;\r\n};\r\n\r\nexport type CrudState<T extends ItemWithSystemId> = {\r\n  data: T[];\r\n  _counters: CounterState; // ✅ Persisted counters\r\n  _initialized: boolean; // ✅ Track if loaded from API\r\n  add: (item: Omit<T, 'systemId'>) => T;\r\n  addMultiple: (items: Omit<T, 'systemId'>[]) => void;\r\n  update: (systemId: SystemId, item: Partial<T>) => void; // ✅ Accept partial updates\r\n  remove: (systemId: SystemId) => void; // ✅ Branded type\r\n  hardDelete: (systemId: SystemId) => void; // ✅ Branded type\r\n  restore: (systemId: SystemId) => void; // ✅ Branded type\r\n  findById: (systemId: SystemId | string) => T | undefined; // ✅ Branded type\r\n  getActive: () => T[];\r\n  getDeleted: () => T[];\r\n  loadFromAPI: () => Promise<void>; // ✅ Load data from database\r\n};\r\n\r\nexport const createCrudStore = <T extends ItemWithSystemId>(\r\n  _initialData: T[], // @deprecated - Kept for backward compatibility but NO LONGER USED\r\n  entityType: EntityType, // Changed from idPrefix to entityType\r\n  options?: {\r\n    businessIdField?: keyof T; // Field name for business ID (default: 'id')\r\n    persistKey?: string; // @deprecated - No longer used, kept for backward compatibility\r\n    getCurrentUser?: () => string | undefined; // Function to get current user systemId\r\n    apiEndpoint?: string; // ✅ API endpoint for database sync (e.g., '/api/employees')\r\n  }\r\n) => {\r\n  const businessPrefix = getPrefix(entityType); // Vietnamese prefix for Business ID (NV, KH, DH)\r\n  const config = ID_CONFIG[entityType];\r\n  const systemIdPrefix = config?.systemIdPrefix || entityType.toUpperCase(); // English prefix for SystemId (EMP, CUSTOMER, ORDER)\r\n  \r\n  const businessIdField = options?.businessIdField ?? 'id';\r\n  // const persistKey = options?.persistKey; // @deprecated - No longer used\r\n  const getCurrentUser = options?.getCurrentUser;\r\n  const apiEndpoint = options?.apiEndpoint;\r\n\r\n  // ✅ CHANGED: Start with empty array - database is source of truth\r\n  // Mock data files (data.ts) are NO LONGER USED for runtime\r\n  const normalizedInitialData: T[] = [];\r\n\r\n  const storeConfig = (set: any, get: any) => ({\r\n    data: normalizedInitialData, // ✅ Start empty - data loaded via React Query\r\n    // ✅ Counters start at 0 - will be initialized from API via loadFromAPI()\r\n    _counters: {\r\n      systemId: 0,\r\n      businessId: 0\r\n    },\r\n    _initialized: false, // ✅ Track API initialization\r\n    add: (item: Omit<T, 'systemId'>): T => {\r\n        // ✅ Get counters from state (persisted)\r\n        const currentCounters = get()._counters;\r\n        const newSystemIdCounter = currentCounters.systemId + 1;\r\n        const newSystemId = createSystemId(generateSystemId(entityType, newSystemIdCounter));\r\n        \r\n        // Generate or validate Business ID (if field exists)\r\n        let finalItem = { ...item } as any;\r\n        let newBusinessIdCounter = currentCounters.businessId;\r\n        \r\n        if (businessIdField in item) {\r\n          const customId = (item as any)[businessIdField];\r\n          const existingIds = get().data.map((d: any) => d[businessIdField]);\r\n          \r\n          // ✅ If customId provided, validate uniqueness\r\n          if (customId && customId.trim()) {\r\n            if (!isBusinessIdUnique(customId, existingIds)) {\r\n              throw new Error(`Mã \"${customId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n            }\r\n            finalItem[businessIdField] = customId.trim().toUpperCase();\r\n          } else {\r\n            // ✅ Auto-generate with findNextAvailableBusinessId\r\n            const digitCount = 6; // All entities use 6 digits\r\n            const result = findNextAvailableBusinessId(businessPrefix, existingIds, newBusinessIdCounter, digitCount);\r\n            finalItem[businessIdField] = result.nextId;\r\n            newBusinessIdCounter = result.updatedCounter;\r\n          }\r\n        }\r\n        \r\n        const now = new Date().toISOString();\r\n        const currentUser = getCurrentUser?.();\r\n        const newItem = { \r\n          ...finalItem, \r\n          systemId: newSystemId, // ✅ Branded SystemId\r\n          createdAt: finalItem.createdAt || now,\r\n          updatedAt: now,\r\n          createdBy: finalItem.createdBy || currentUser,\r\n          updatedBy: currentUser,\r\n        } as unknown as T;\r\n        \r\n        // ✅ Update both data and counters atomically\r\n        set((state: any) => ({ \r\n          data: [...state.data, newItem],\r\n          _counters: {\r\n            systemId: newSystemIdCounter,\r\n            businessId: newBusinessIdCounter\r\n          }\r\n        }));\r\n        \r\n        // ✅ Sync to API in background\r\n        if (apiEndpoint) {\r\n          syncToAPI(apiEndpoint, 'create', newItem).catch(console.error);\r\n        }\r\n        \r\n        return newItem;\r\n    },\r\n    addMultiple: (items: Omit<T, 'systemId'>[]) => \r\n        set((state: any) => {\r\n            const now = new Date().toISOString();\r\n            const currentUser = getCurrentUser?.();\r\n            const newItems: T[] = [];\r\n            const digitCount = 6; // All entities use 6 digits\r\n            \r\n            // ✅ Start from current counters\r\n            let currentSystemIdCounter = state._counters.systemId;\r\n            let currentBusinessIdCounter = state._counters.businessId;\r\n            \r\n            items.forEach(item => {\r\n                // ✅ Generate SystemId from current counter\r\n                currentSystemIdCounter++;\r\n                const newSystemId = createSystemId(generateSystemId(entityType, currentSystemIdCounter));\r\n                \r\n                // Generate or validate Business ID (if field exists)\r\n                let finalItem = { ...item } as any;\r\n                if (businessIdField in item) {\r\n                  const customId = (item as any)[businessIdField];\r\n                  \r\n                  // Collect existing IDs (from state + already added in this batch)\r\n                  const existingIds = [\r\n                    ...state.data.map((d: any) => d[businessIdField]),\r\n                    ...newItems.map((d: any) => d[businessIdField])\r\n                  ];\r\n                  \r\n                  // ✅ If customId provided, validate uniqueness\r\n                  if (customId && customId.trim()) {\r\n                    if (!isBusinessIdUnique(customId, existingIds)) {\r\n                      throw new Error(`Mã \"${customId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n                    }\r\n                    finalItem[businessIdField] = customId.trim().toUpperCase();\r\n                  } else {\r\n                    // ✅ Auto-generate with findNextAvailableBusinessId\r\n                    const result = findNextAvailableBusinessId(businessPrefix, existingIds, currentBusinessIdCounter, digitCount);\r\n                    finalItem[businessIdField] = result.nextId;\r\n                    currentBusinessIdCounter = result.updatedCounter;\r\n                  }\r\n                }\r\n                \r\n                newItems.push({ \r\n                  ...finalItem, \r\n                  systemId: newSystemId,\r\n                  createdAt: now,\r\n                  updatedAt: now,\r\n                  createdBy: currentUser,\r\n                  updatedBy: currentUser,\r\n                } as unknown as T);\r\n            });\r\n            \r\n            // ✅ Update both data and counters\r\n            const result = { \r\n              data: [...state.data, ...newItems],\r\n              _counters: {\r\n                systemId: currentSystemIdCounter,\r\n                businessId: currentBusinessIdCounter\r\n              }\r\n            };\r\n            \r\n            // ✅ Sync to API in background (batch)\r\n            if (apiEndpoint) {\r\n              newItems.forEach(item => {\r\n                syncToAPI(apiEndpoint, 'create', item).catch(console.error);\r\n              });\r\n            }\r\n            \r\n            return result;\r\n        }),\r\n    update: (systemId: SystemId, updatedItem: Partial<T>) => {\r\n      // Validate unique business ID (case-insensitive, skip self)\r\n      if (businessIdField in updatedItem) {\r\n        const businessId = (updatedItem as any)[businessIdField];\r\n        const existingIds = get().data\r\n          .filter((d: any) => d.systemId !== systemId)\r\n          .map((d: any) => d[businessIdField]);\r\n        \r\n        if (businessId && !isBusinessIdUnique(businessId, existingIds)) {\r\n          throw new Error(`Mã \"${businessId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n        }\r\n      }\r\n\r\n      const now = new Date().toISOString();\r\n      const currentUser = getCurrentUser?.();\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId \r\n            ? { ...item, ...updatedItem, updatedAt: now, updatedBy: currentUser } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const fullItem = get().data.find((item: T) => item.systemId === systemId);\r\n        if (fullItem) {\r\n          syncToAPI(apiEndpoint, 'update', fullItem, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    remove: (systemId: SystemId) => {\r\n      // Soft delete - mark as deleted\r\n      const now = new Date().toISOString();\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, deletedAt: now } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const item = get().data.find((item: T) => item.systemId === systemId);\r\n        if (item) {\r\n          syncToAPI(apiEndpoint, 'update', { ...item, isDeleted: true, deletedAt: now }, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    hardDelete: (systemId: SystemId) => {\r\n      // Permanent delete - remove from array\r\n      set((state: any) => ({\r\n        data: state.data.filter((item: T) => item.systemId !== systemId),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        syncToAPI(apiEndpoint, 'delete', { systemId }, systemId).catch(console.error);\r\n      }\r\n    },\r\n    restore: (systemId: SystemId) => {\r\n      // Restore soft-deleted item\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: false, deletedAt: null } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const item = get().data.find((item: T) => item.systemId === systemId);\r\n        if (item) {\r\n          syncToAPI(apiEndpoint, 'restore', { ...item, isDeleted: false, deletedAt: null }, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    getActive: () => get().data.filter((item: any) => !item.isDeleted),\r\n    getDeleted: () => get().data.filter((item: any) => item.isDeleted),\r\n    findById: (id: SystemId | string) => get().data.find((item: T) => item.systemId === id || (item as any).id === id),\r\n    \r\n    // ✅ Load data from database API - OPTIMIZED: No more limit=10000!\r\n    // This is now only used for counter initialization, NOT for loading all data\r\n    // Use React Query hooks for data fetching with proper pagination\r\n    loadFromAPI: async () => {\r\n      if (!apiEndpoint) return;\r\n      if (get()._initialized) return;\r\n      \r\n      try {\r\n        // Only fetch minimal data needed to initialize counters\r\n        // Actual data loading should be done via React Query hooks\r\n        const response = await fetch(`${apiEndpoint}?limit=1&sortBy=systemId&sortOrder=desc`, {\r\n          credentials: 'include',\r\n        });\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const pagination = json.pagination || {};\r\n          const lastItem = json.data?.[0];\r\n          \r\n          // Initialize counters from the latest item (highest IDs)\r\n          const newCounters = {\r\n            systemId: lastItem ? getMaxSystemIdCounter([lastItem], systemIdPrefix) : 0,\r\n            businessId: (lastItem && options?.businessIdField)\r\n              ? getMaxBusinessIdCounter([lastItem] as any[], businessPrefix)\r\n              : 0\r\n          };\r\n          \r\n          set({ \r\n            data: [], // Don't store data in Zustand anymore - use React Query\r\n            _counters: newCounters,\r\n            _initialized: true \r\n          });\r\n          \r\n          console.log(`[Store Factory] ${apiEndpoint} initialized. Total records: ${pagination.total || 'unknown'}`);\r\n        }\r\n      } catch (error) {\r\n        console.error(`[Store Factory] loadFromAPI error for ${apiEndpoint}:`, error);\r\n        // Still mark as initialized to prevent infinite retry\r\n        set({ _initialized: true });\r\n      }\r\n    },\r\n  });\r\n\r\n  // ✅ SIMPLIFIED: No localStorage persistence, database is source of truth\r\n  // Data is loaded via ApiSyncProvider on app init\r\n  return create<CrudState<T>>(storeConfig);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5413, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { TargetGroup } from './types';\r\n\r\nexport const useTargetGroupStore = createCrudStore<TargetGroup>([], 'target-groups', {\r\n  apiEndpoint: '/api/settings/data?type=target-group',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,sBAAsB,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IACnF,aAAa;AACf"}},
    {"offset": {"line": 5429, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentMethod } from './types';\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\n\r\n// API sync helper\r\nasync function syncToAPI(\r\n  action: 'create' | 'update' | 'delete',\r\n  data: Partial<PaymentMethod>\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create'\r\n      ? '/api/settings/payment-methods'\r\n      : `/api/settings/payment-methods/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Payment Methods API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface PaymentMethodState {\r\n  data: PaymentMethod[];\r\n  initialized: boolean;\r\n  add: (item: Omit<PaymentMethod, 'systemId' | 'isDefault'>) => void;\r\n  update: (systemId: SystemId, updatedPolicy: Omit<PaymentMethod, 'isDefault' | 'systemId'>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  setDefault: (systemId: SystemId) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nexport const usePaymentMethodStore = create<PaymentMethodState>()(\r\n  (set, get) => ({\r\n      data: [],\r\n      initialized: false,\r\n      add: (item) => {\r\n        const newItem: PaymentMethod = { \r\n          ...item, \r\n          systemId: asSystemId(`PM_${Date.now()}`),\r\n          isDefault: get().data.length === 0,\r\n        };\r\n        set((state) => ({ data: [...state.data, newItem] }));\r\n        \r\n        // Sync to API\r\n        syncToAPI('create', newItem).catch(console.error);\r\n      },\r\n      update: (systemId, updatedFields) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => p.systemId === systemId ? { ...p, ...updatedFields } : p),\r\n        }));\r\n        \r\n        // Sync to API\r\n        const updated = get().data.find(p => p.systemId === systemId);\r\n        if (updated) {\r\n          syncToAPI('update', updated).catch(console.error);\r\n        }\r\n      },\r\n      remove: (systemId) => {\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n        set((state) => ({\r\n          data: state.data.filter((p) => p.systemId !== systemId),\r\n        }));\r\n      },\r\n      setDefault: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => ({ ...p, isDefault: p.systemId === systemId })),\r\n        }));\r\n        \r\n        // Sync all to API (update default status)\r\n        const data = get().data;\r\n        for (const item of data) {\r\n          syncToAPI('update', item).catch(console.error);\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Settings data is typically small, but using limit for consistency\r\n          const response = await fetch('/api/settings/payment-methods?limit=30');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const data = json.data || json.methods || [];\r\n            if (data.length > 0) {\r\n              set({ data, initialized: true });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payment Methods Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,kBAAkB;AAClB,eAAe,UACb,MAAsC,EACtC,IAA4B;IAE5B,IAAI;QACF,MAAM,WAAW,WAAW,WACxB,kCACA,CAAC,8BAA8B,EAAE,KAAK,QAAQ,EAAE;QACpD,MAAM,SAAS,WAAW,WAAW,SAAS,WAAW,WAAW,UAAU;QAE9E,MAAM,WAAW,MAAM,MAAM,UAAU;YACrC;YACA,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,WAAW,WAAW,KAAK,SAAS,CAAC,QAAQ;QACrD;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,OAAO,OAAO,CAAC,EAAE;QACxD,OAAO;IACT;AACF;AAYO,MAAM,wBAAwB,IAAA,qJAAM,IACzC,CAAC,KAAK,MAAQ,CAAC;QACX,MAAM,EAAE;QACR,aAAa;QACb,KAAK,CAAC;YACJ,MAAM,UAAyB;gBAC7B,GAAG,IAAI;gBACP,UAAU,IAAA,mIAAU,EAAC,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;gBACvC,WAAW,MAAM,IAAI,CAAC,MAAM,KAAK;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBAAE,MAAM;2BAAI,MAAM,IAAI;wBAAE;qBAAQ;gBAAC,CAAC;YAElD,cAAc;YACd,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;QAClD;QACA,QAAQ,CAAC,UAAU;YACjB,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW;4BAAE,GAAG,CAAC;4BAAE,GAAG,aAAa;wBAAC,IAAI;gBACnF,CAAC;YAED,cAAc;YACd,MAAM,UAAU,MAAM,IAAI,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;YACpD,IAAI,SAAS;gBACX,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;YAClD;QACF;QACA,QAAQ,CAAC;YACP,UAAU,UAAU;gBAAE;YAAS,GAAG,KAAK,CAAC,QAAQ,KAAK;YACrD,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;gBAChD,CAAC;QACH;QACA,YAAY,CAAC;YACX,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;4BAAE,GAAG,CAAC;4BAAE,WAAW,EAAE,QAAQ,KAAK;wBAAS,CAAC;gBACzE,CAAC;YAED,0CAA0C;YAC1C,MAAM,OAAO,MAAM,IAAI;YACvB,KAAK,MAAM,QAAQ,KAAM;gBACvB,UAAU,UAAU,MAAM,KAAK,CAAC,QAAQ,KAAK;YAC/C;QACF;QAEA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YAEvB,IAAI;gBACF,0EAA0E;gBAC1E,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,MAAM,OAAO,KAAK,IAAI,IAAI,KAAK,OAAO,IAAI,EAAE;oBAC5C,IAAI,KAAK,MAAM,GAAG,GAAG;wBACnB,IAAI;4BAAE;4BAAM,aAAa;wBAAK;oBAChC,OAAO;wBACL,IAAI;4BAAE,aAAa;wBAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8CAA8C;YAC9D;QACF;IACF,CAAC"}},
    {"offset": {"line": 5538, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/cashbook/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { CashAccount } from './types';\r\nimport { findNextAvailableBusinessId, generateSystemId, getMaxBusinessIdCounter, getMaxSystemIdCounter, type EntityType } from '../../lib/id-utils';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '../../lib/id-types';\r\n\r\nconst CASH_ACCOUNT_ENTITY: EntityType = 'cash-accounts';\r\nconst SYSTEM_ID_PREFIX = 'ACCOUNT';\r\nconst BUSINESS_ID_PREFIX = 'TK';\r\nconst BUSINESS_ID_DIGITS = 6;\r\n\r\n// API sync helpers\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: any): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/cash-accounts' : `/api/cash-accounts/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Cashbook API] ${action} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Cashbook API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function fetchFromAPI(): Promise<CashAccount[]> {\r\n  try {\r\n    const response = await fetch('/api/cash-accounts?limit=50');\r\n    if (!response.ok) return [];\r\n    const json = await response.json();\r\n    return json.data || [];\r\n  } catch (error) {\r\n    console.error('[Cashbook API] fetch error:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\ninterface CashbookState {\r\n  accounts: CashAccount[];\r\n  initialized: boolean;\r\n  getAccountById: (id: BusinessId) => CashAccount | undefined;\r\n  add: (item: Omit<CashAccount, 'systemId'>) => void;\r\n  update: (systemId: SystemId, item: CashAccount) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  setDefault: (systemId: SystemId) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst getNextSystemId = (accounts: CashAccount[]): SystemId => {\r\n  const currentCounter = getMaxSystemIdCounter(accounts, SYSTEM_ID_PREFIX);\r\n  return asSystemId(generateSystemId(CASH_ACCOUNT_ENTITY, currentCounter + 1));\r\n};\r\n\r\nconst ensureBusinessId = (accounts: CashAccount[], provided?: BusinessId): BusinessId => {\r\n  if (provided && provided.trim()) {\r\n    return provided;\r\n  }\r\n\r\n  const existingIds = accounts.map(acc => acc.id as string);\r\n  const startCounter = getMaxBusinessIdCounter(accounts, BUSINESS_ID_PREFIX);\r\n  const { nextId } = findNextAvailableBusinessId(BUSINESS_ID_PREFIX, existingIds, startCounter, BUSINESS_ID_DIGITS);\r\n  return asBusinessId(nextId);\r\n};\r\n\r\nexport const useCashbookStore = create<CashbookState>()(\r\n  (set, get) => ({\r\n      accounts: [],\r\n      initialized: false,\r\n      getAccountById: (id) => get().accounts.find(a => a.id === id),\r\n      \r\n      add: (item) => {\r\n        const newAccount: CashAccount = {\r\n          ...item,\r\n          systemId: getNextSystemId(get().accounts),\r\n          id: ensureBusinessId(get().accounts, item.id),\r\n        };\r\n        set((state) => ({ accounts: [...state.accounts, newAccount] }));\r\n        // Sync to API\r\n        syncToAPI('create', newAccount).catch(console.error);\r\n      },\r\n      \r\n      update: (systemId, updatedItem) => {\r\n        set((state) => ({\r\n          accounts: state.accounts.map((acc) => (acc.systemId === systemId ? updatedItem : acc))\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('update', updatedItem).catch(console.error);\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set((state) => ({\r\n          accounts: state.accounts.filter(acc => acc.systemId !== systemId)\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n      },\r\n      \r\n      setDefault: (systemId) => {\r\n        set((state) => {\r\n          const targetAccount = state.accounts.find(acc => acc.systemId === systemId);\r\n          if (!targetAccount) return state;\r\n\r\n          const updated = state.accounts.map(acc => ({\r\n            ...acc,\r\n            isDefault: (acc.type === targetAccount.type ? acc.systemId === systemId : acc.isDefault) ?? false\r\n          }));\r\n          \r\n          // Sync updated accounts to API\r\n          updated.forEach(acc => {\r\n            if (acc.type === targetAccount.type) {\r\n              syncToAPI('update', acc).catch(console.error);\r\n            }\r\n          });\r\n          \r\n          return { accounts: updated };\r\n        });\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        const apiData = await fetchFromAPI();\r\n        if (apiData.length > 0) {\r\n          set({ accounts: apiData, initialized: true });\r\n        } else {\r\n          set({ initialized: true });\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5673, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { ReceiptType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<ReceiptType>([], 'receipt-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=receipt-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<ReceiptType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const useReceiptTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,oIAAS,EAAC,IAAA,yIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 5704, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<PaymentType>([], 'payment-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=payment-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<PaymentType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const usePaymentTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,oIAAS,EAAC,IAAA,yIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 5735, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/finance/document-lookups.ts"],"sourcesContent":["import { useTargetGroupStore } from '@/features/settings/target-groups/store';\r\nimport { usePaymentMethodStore } from '@/features/settings/payments/methods/store';\r\nimport { useCashbookStore } from '@/features/cashbook/store';\r\nimport { useReceiptTypeStore } from '@/features/settings/receipt-types/store';\r\nimport { usePaymentTypeStore } from '@/features/settings/payments/types/store';\r\nimport type { TargetGroup } from '@/features/settings/target-groups/types';\r\nimport type { PaymentMethod } from '@/features/settings/payments/methods/types';\r\nimport type { CashAccount } from '@/features/cashbook/types';\r\nimport type { ReceiptType } from '@/features/settings/receipt-types/types';\r\nimport type { PaymentType } from '@/features/settings/payments/types/types';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\nconst normalizeName = (value?: string | null) => (value ?? '').trim().toLowerCase();\r\n\r\nexport const DEFAULT_CUSTOMER_GROUP = 'khách hàng';\r\n\r\nexport const pickTargetGroup = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n  fallbackName?: string | undefined;\r\n}): TargetGroup | null => {\r\n  const groups = useTargetGroupStore.getState().data ?? [];\r\n  if (groups.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = groups.find(group => group.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  const lookupNames = [options?.name, options?.fallbackName, DEFAULT_CUSTOMER_GROUP].filter(Boolean) as string[];\r\n  for (const candidate of lookupNames) {\r\n    const normalized = normalizeName(candidate);\r\n    const match = groups.find(group => normalizeName(group.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return groups[0] ?? null;\r\n};\r\n\r\nexport const pickPaymentMethod = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n}): PaymentMethod | null => {\r\n  const methods = usePaymentMethodStore.getState().data ?? [];\r\n  if (methods.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = methods.find(method => method.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  if (options?.name) {\r\n    const normalized = normalizeName(options.name);\r\n    const match = methods.find(method => normalizeName(method.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return methods.find(method => method.isDefault) ?? methods[0] ?? null;\r\n};\r\n\r\nexport const pickAccount = (options: {\r\n  accountSystemId?: SystemId | undefined;\r\n  preferredType?: 'cash' | 'bank' | undefined;\r\n  branchSystemId?: SystemId | undefined;\r\n  paymentMethodName?: string | undefined;\r\n}): CashAccount | null => {\r\n  const { accounts } = useCashbookStore.getState();\r\n  if (!accounts || accounts.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options.accountSystemId) {\r\n    const match = accounts.find(account => account.systemId === options.accountSystemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  let preferredType = options.preferredType;\r\n  if (!preferredType && options.paymentMethodName) {\r\n    const normalizedMethod = normalizeName(options.paymentMethodName);\r\n    preferredType = normalizedMethod === 'tiền mặt' ? 'cash' : normalizedMethod === 'chuyển khoản' ? 'bank' : undefined;\r\n  }\r\n\r\n  const candidates = preferredType ? accounts.filter(account => account.type === preferredType) : accounts;\r\n\r\n  if (candidates.length === 0) {\r\n    return accounts[0];\r\n  }\r\n\r\n  return (\r\n    candidates.find(account => account.branchSystemId && options.branchSystemId && account.branchSystemId === options.branchSystemId) ??\r\n    candidates.find(account => account.isDefault) ??\r\n    candidates[0]\r\n  );\r\n};\r\n\r\nexport const pickReceiptType = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n}): ReceiptType | null => {\r\n  const types = useReceiptTypeStore.getState().data ?? [];\r\n  if (types.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = types.find(type => type.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  if (options?.name) {\r\n    const normalized = normalizeName(options.name);\r\n    const match = types.find(type => normalizeName(type.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return types[0] ?? null;\r\n};\r\n\r\nexport const pickPaymentType = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n}): PaymentType | null => {\r\n  const types = usePaymentTypeStore.getState().data ?? [];\r\n  if (types.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = types.find(type => type.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  if (options?.name) {\r\n    const normalized = normalizeName(options.name);\r\n    const match = types.find(type => normalizeName(type.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return types[0] ?? null;\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5875, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/repositories/in-memory-repository.ts"],"sourcesContent":["import type { SystemId } from '../lib/id-types';\r\nimport type { CrudState, ItemWithSystemId } from '../lib/store-factory';\r\nimport type { CrudRepository } from './types';\r\n\r\n/**\r\n * Adapter mặc định dùng trực tiếp Zustand store để giả lập tầng persistence.\r\n * Giữ cùng signature với repository interface để sau này thay bằng API/DB dễ dàng.\r\n */\r\nexport const createInMemoryRepository = <TEntity extends ItemWithSystemId>(\r\n  stateGetter: () => CrudState<TEntity>\r\n): CrudRepository<TEntity, Omit<TEntity, 'systemId'>, Partial<TEntity>> => {\r\n  const getStore = () => stateGetter();\r\n\r\n  const ensureEntity = (systemId: SystemId): TEntity => {\r\n    const entity = getStore().findById(systemId);\r\n    if (!entity) {\r\n      throw new Error(`Không tìm thấy entity với systemId=${systemId}`);\r\n    }\r\n    return entity;\r\n  };\r\n\r\n  return {\r\n    async list() {\r\n      return [...getStore().data];\r\n    },\r\n    async getById(systemId) {\r\n      return getStore().findById(systemId);\r\n    },\r\n    async create(payload) {\r\n      return getStore().add(payload as Omit<TEntity, 'systemId'>);\r\n    },\r\n    async update(systemId, payload) {\r\n      ensureEntity(systemId);\r\n      getStore().update(systemId, payload);\r\n      return ensureEntity(systemId);\r\n    },\r\n    async softDelete(systemId) {\r\n      ensureEntity(systemId);\r\n      getStore().remove(systemId);\r\n    },\r\n    async restore(systemId) {\r\n      ensureEntity(systemId);\r\n      getStore().restore(systemId);\r\n      return getStore().findById(systemId);\r\n    },\r\n    async hardDelete(systemId) {\r\n      ensureEntity(systemId);\r\n      getStore().hardDelete(systemId);\r\n    },\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;AAQO,MAAM,2BAA2B,CACtC;IAEA,MAAM,WAAW,IAAM;IAEvB,MAAM,eAAe,CAAC;QACpB,MAAM,SAAS,WAAW,QAAQ,CAAC;QACnC,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM,CAAC,mCAAmC,EAAE,UAAU;QAClE;QACA,OAAO;IACT;IAEA,OAAO;QACL,MAAM;YACJ,OAAO;mBAAI,WAAW,IAAI;aAAC;QAC7B;QACA,MAAM,SAAQ,QAAQ;YACpB,OAAO,WAAW,QAAQ,CAAC;QAC7B;QACA,MAAM,QAAO,OAAO;YAClB,OAAO,WAAW,GAAG,CAAC;QACxB;QACA,MAAM,QAAO,QAAQ,EAAE,OAAO;YAC5B,aAAa;YACb,WAAW,MAAM,CAAC,UAAU;YAC5B,OAAO,aAAa;QACtB;QACA,MAAM,YAAW,QAAQ;YACvB,aAAa;YACb,WAAW,MAAM,CAAC;QACpB;QACA,MAAM,SAAQ,QAAQ;YACpB,aAAa;YACb,WAAW,OAAO,CAAC;YACnB,OAAO,WAAW,QAAQ,CAAC;QAC7B;QACA,MAAM,YAAW,QAAQ;YACvB,aAAa;YACb,WAAW,UAAU,CAAC;QACxB;IACF;AACF"}},
    {"offset": {"line": 5927, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/activity-history-helper.ts"],"sourcesContent":["/**\r\n * Activity History Helper\r\n * \r\n * Helper để tạo các entry lịch sử hoạt động một cách nhất quán\r\n * Dùng chung cho tất cả các modules trong hệ thống\r\n * \r\n * NOTE: Đã remove import useEmployeeStore để tránh circular dependency\r\n * và cải thiện compile time\r\n */\r\n\r\nimport type { HistoryEntry } from '../components/ActivityHistory';\r\nimport { getCurrentUserInfo as getAuthUserInfo } from '../contexts/auth-context';\r\nimport type { SystemId } from './id-types';\r\n\r\n// Re-export HistoryEntry type for convenience\r\nexport type { HistoryEntry } from '../components/ActivityHistory';\r\n\r\n/**\r\n * Lấy thông tin người dùng hiện tại từ auth context\r\n * NOTE: Avatar lookup từ employee store đã bị remove để tránh circular dependency\r\n */\r\nexport function getCurrentUserInfo(): { systemId: string; name: string; avatar?: string } {\r\n  const authInfo = getAuthUserInfo();\r\n  \r\n  return {\r\n    systemId: authInfo.systemId || 'SYSTEM',\r\n    name: authInfo.name || 'Hệ thống',\r\n    avatar: undefined, // Avatar will be fetched by component if needed\r\n  };\r\n}\r\n\r\n/**\r\n * Lấy thông tin nhân viên từ systemId\r\n * NOTE: This function now requires employee data to be passed in\r\n * to avoid circular dependency with employee store\r\n */\r\nexport function getEmployeeInfoFromData(\r\n  employeeSystemId: SystemId | string,\r\n  employees: Array<{ systemId: string; fullName: string; avatarUrl?: string }>\r\n): { systemId: string; name: string; avatar?: string } {\r\n  const employee = employees.find(e => e.systemId === employeeSystemId);\r\n  \r\n  if (employee) {\r\n    return {\r\n      systemId: employee.systemId,\r\n      name: employee.fullName,\r\n      avatar: employee.avatarUrl,\r\n    };\r\n  }\r\n  \r\n  // Fallback to system\r\n  return {\r\n    systemId: String(employeeSystemId) || 'SYSTEM',\r\n    name: 'Hệ thống',\r\n  };\r\n}\r\n\r\n/**\r\n * @deprecated Use getEmployeeInfoFromData instead\r\n */\r\nexport function getEmployeeInfo(employeeSystemId: SystemId | string): { systemId: string; name: string; avatar?: string } {\r\n  // Return minimal info without employee store lookup\r\n  return {\r\n    systemId: String(employeeSystemId) || 'SYSTEM',\r\n    name: 'Hệ thống',\r\n  };\r\n}\r\n\r\n/**\r\n * Tạo một history entry mới\r\n */\r\nexport function createHistoryEntry(\r\n  action: HistoryEntry['action'],\r\n  userOrDescription: { systemId: string; name: string; avatar?: string } | string,\r\n  descriptionOrMetadata?: string | HistoryEntry['metadata'],\r\n  metadata?: HistoryEntry['metadata']\r\n): HistoryEntry {\r\n  const hasUserObject = typeof userOrDescription === 'object' && userOrDescription !== null;\r\n  const user = hasUserObject ? userOrDescription : getCurrentUserInfo();\r\n  const description = (hasUserObject ? descriptionOrMetadata : userOrDescription) as string | undefined;\r\n  const meta = (hasUserObject ? metadata : descriptionOrMetadata) as HistoryEntry['metadata'] | undefined;\r\n\r\n  return {\r\n    id: `history-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n    action,\r\n    timestamp: new Date(),\r\n    user: {\r\n      systemId: user.systemId,\r\n      name: user.name,\r\n      avatar: user.avatar,\r\n    },\r\n    description: description ?? '',\r\n    metadata: meta,\r\n  };\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"created\"\r\n */\r\nexport function createCreatedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('created', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"updated\"\r\n */\r\nexport function createUpdatedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('updated', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"status_changed\"\r\n */\r\nexport function createStatusChangedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  oldStatus: string,\r\n  newStatus: string,\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry(\r\n    'status_changed',\r\n    user,\r\n    description,\r\n    { field: 'status', oldValue: oldStatus, newValue: newStatus }\r\n  );\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"deleted\"\r\n */\r\nexport function createDeletedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('deleted', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"assigned\"\r\n */\r\nexport function createAssignedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('assigned', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"payment_made\"\r\n */\r\nexport function createPaymentEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('payment_made', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"comment_added\"\r\n */\r\nexport function createCommentEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('comment_added', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"cancelled\"\r\n */\r\nexport function createCancelledEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('cancelled', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"verified\"\r\n */\r\nexport function createVerifiedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('verified', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"ended\"\r\n */\r\nexport function createEndedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('ended', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"reopened\"\r\n */\r\nexport function createReopenedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('reopened', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho product actions\r\n */\r\nexport function createProductEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  action: 'product_added' | 'product_updated' | 'product_removed',\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry(action, user, description);\r\n}\r\n\r\n/**\r\n * Helper để append history entry vào existing array\r\n */\r\nexport function appendHistoryEntry(\r\n  existingHistory: HistoryEntry[] | undefined,\r\n  ...newEntries: HistoryEntry[]\r\n): HistoryEntry[] {\r\n  return [...(existingHistory || []), ...newEntries];\r\n}\r\n\r\n/**\r\n * Helper để tạo nhiều history entries cùng lúc\r\n */\r\nexport function createBulkUpdateEntries(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  changes: Array<{ field: string; description: string }>\r\n): HistoryEntry[] {\r\n  return changes.map(change => createHistoryEntry('updated', user, change.description));\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6079, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Employee } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\nimport Fuse from 'fuse.js';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { registerBreadcrumbStore } from '../../lib/breadcrumb-generator'; // ✅ NEW\r\nimport { type SystemId } from '../../lib/id-types';\r\nimport { createInMemoryRepository } from '../../repositories/in-memory-repository';\r\nimport { \r\n  createHistoryEntry, \r\n  getCurrentUserInfo,\r\n  appendHistoryEntry \r\n} from '../../lib/activity-history-helper';\r\n\r\ntype EmployeePersistenceAdapter = {\r\n  create: (payload: Omit<Employee, 'systemId'>) => Promise<Employee>;\r\n  update: (systemId: SystemId, payload: Partial<Employee>) => Promise<Employee>;\r\n  softDelete: (systemId: SystemId) => Promise<void>;\r\n  restore: (systemId: SystemId) => Promise<Employee | undefined>;\r\n  hardDelete: (systemId: SystemId) => Promise<void>;\r\n};\r\n\r\nconst baseStore = createCrudStore<Employee>([], 'employees', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId, // ✅ Track who creates/updates\r\n  apiEndpoint: '/api/employees',\r\n});\r\n\r\n// ✅ Wrap add method to include activity history\r\nconst originalAdd = baseStore.getState().add;\r\nconst wrappedAdd = (item: Omit<Employee, 'systemId'>): Employee => {\r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntry = createHistoryEntry(\r\n    'created',\r\n    `${userInfo.name} đã tạo hồ sơ nhân viên ${item.fullName} (${item.id})`,\r\n    userInfo\r\n  );\r\n  \r\n  const newEmployee = originalAdd({\r\n    ...item,\r\n    activityHistory: [historyEntry],\r\n  });\r\n  \r\n  return newEmployee;\r\n};\r\n\r\n// ✅ Wrap update method to include activity history\r\nconst originalUpdate = baseStore.getState().update;\r\nconst wrappedUpdate = (systemId: SystemId, updates: Partial<Employee>): void => {\r\n  const currentEmployee = baseStore.getState().data.find(e => e.systemId === systemId);\r\n  if (!currentEmployee) return;\r\n  \r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntries: HistoryEntry[] = [];\r\n  \r\n  // Track important field changes\r\n  const trackedFields: { key: keyof Employee; label: string }[] = [\r\n    { key: 'fullName', label: 'họ tên' },\r\n    { key: 'jobTitle', label: 'chức danh' },\r\n    { key: 'department', label: 'phòng ban' },\r\n    { key: 'employmentStatus', label: 'trạng thái làm việc' },\r\n    { key: 'employeeType', label: 'loại nhân viên' },\r\n    { key: 'baseSalary', label: 'lương cơ bản' },\r\n    { key: 'phone', label: 'số điện thoại' },\r\n    { key: 'workEmail', label: 'email công việc' },\r\n    { key: 'role', label: 'vai trò' },\r\n  ];\r\n  \r\n  trackedFields.forEach(({ key, label }) => {\r\n    if (updates[key] !== undefined && updates[key] !== currentEmployee[key]) {\r\n      const oldValue = currentEmployee[key];\r\n      const newValue = updates[key];\r\n      \r\n      // Format values for display\r\n      let oldDisplay = oldValue;\r\n      let newDisplay = newValue;\r\n      \r\n      if (key === 'baseSalary') {\r\n        oldDisplay = new Intl.NumberFormat('vi-VN').format(oldValue as number) + 'đ';\r\n        newDisplay = new Intl.NumberFormat('vi-VN').format(newValue as number) + 'đ';\r\n      }\r\n      \r\n      historyEntries.push(createHistoryEntry(\r\n        'updated',\r\n        `${userInfo.name} đã cập nhật ${label}: \"${oldDisplay || '(trống)'}\" → \"${newDisplay}\"`,\r\n        userInfo,\r\n        { field: key, oldValue, newValue }\r\n      ));\r\n    }\r\n  });\r\n  \r\n  // If status changed specifically\r\n  if (updates.employmentStatus && updates.employmentStatus !== currentEmployee.employmentStatus) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'status_changed',\r\n      `${userInfo.name} đã thay đổi trạng thái làm việc từ \"${currentEmployee.employmentStatus}\" thành \"${updates.employmentStatus}\"`,\r\n      userInfo,\r\n      { field: 'employmentStatus', oldValue: currentEmployee.employmentStatus, newValue: updates.employmentStatus }\r\n    ));\r\n  }\r\n  \r\n  // If no specific changes tracked, add generic update entry\r\n  if (historyEntries.length === 0) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'updated',\r\n      `${userInfo.name} đã cập nhật thông tin nhân viên`,\r\n      userInfo\r\n    ));\r\n  }\r\n  \r\n  const updatedHistory = appendHistoryEntry(currentEmployee.activityHistory, ...historyEntries);\r\n  \r\n  originalUpdate(systemId, {\r\n    ...updates,\r\n    activityHistory: updatedHistory,\r\n  });\r\n};\r\n\r\n// ✅ Override base store methods\r\nbaseStore.setState({\r\n  add: wrappedAdd,\r\n  update: wrappedUpdate,\r\n});\r\n\r\nexport const employeeRepository = createInMemoryRepository<Employee>(() => baseStore.getState());\r\n\r\n// ✅ API-backed persistence adapter - syncs to PostgreSQL\r\nconst API_ENDPOINT = '/api/employees';\r\n\r\nconst persistence: EmployeePersistenceAdapter = {\r\n  create: async (payload) => {\r\n    // First create locally for immediate UI update\r\n    const localResult = await employeeRepository.create(payload);\r\n    \r\n    // Then sync to API (background)\r\n    try {\r\n      const response = await fetch(API_ENDPOINT, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ ...payload, systemId: localResult.systemId }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Create sync failed, data saved locally');\r\n      } else {\r\n        console.log('[Employee API] Created:', localResult.systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Create sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  update: async (systemId, payload) => {\r\n    // First update locally\r\n    const localResult = await employeeRepository.update(systemId, payload);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'PATCH',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Update sync failed');\r\n      } else {\r\n        console.log('[Employee API] Updated:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Update sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  softDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.softDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: false }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Soft delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Soft deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Soft delete sync error:', e);\r\n    }\r\n  },\r\n  restore: async (systemId) => {\r\n    // First restore locally\r\n    const localResult = await employeeRepository.restore(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}/restore`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Restore sync failed');\r\n      } else {\r\n        console.log('[Employee API] Restored:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Restore sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  hardDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.hardDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: true }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Hard delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Hard deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Hard delete sync error:', e);\r\n    }\r\n  },\r\n};\r\n\r\n// ✅ Register for breadcrumb auto-generation\r\nregisterBreadcrumbStore('employees', () => baseStore.getState());\r\n\r\n// Define enhanced interface\r\ninterface EmployeeStoreState extends CrudState<Employee> {\r\n  searchEmployees: (query: string, page: number, limit?: number) => Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>;\r\n  permanentDelete: (systemId: SystemId) => Promise<void>;\r\n  persistence: EmployeePersistenceAdapter;\r\n}\r\n\r\ntype EmployeeStoreHook = (() => EmployeeStoreState) & {\r\n  getState: () => EmployeeStoreState;\r\n  persistence: EmployeePersistenceAdapter;\r\n};\r\n\r\n// Augmented methods\r\nconst augmentedMethods = {\r\n    // FIX: Changed `page: number = 1` to `page: number` to make it a required parameter, matching Combobox prop type.\r\n    // ✅ CRITICAL FIX: Create fresh Fuse instance on each search to avoid stale data\r\n    searchEmployees: async (query: string, page: number, limit: number = 20) => {\r\n        return new Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>(resolve => {\r\n            setTimeout(() => {\r\n                const allEmployees = baseStore.getState().data;\r\n                \r\n                // ✅ Create fresh Fuse instance with current data\r\n                const fuse = new Fuse(allEmployees, {\r\n                    keys: ['fullName', 'id', 'phone', 'personalEmail', 'workEmail'],\r\n                    threshold: 0.3,\r\n                });\r\n                \r\n                const results = query ? fuse.search(query).map(r => r.item) : allEmployees;\r\n                \r\n                const start = (page - 1) * limit;\r\n                const end = start + limit;\r\n                const paginatedItems = results.slice(start, end);\r\n\r\n                resolve({\r\n                    items: paginatedItems.map(e => ({ value: e.systemId, label: e.fullName })),\r\n                    hasNextPage: end < results.length,\r\n                });\r\n            }, 300);\r\n        });\r\n    },\r\n    permanentDelete: async (systemId: SystemId) => {\r\n        await persistence.hardDelete(systemId);\r\n    }\r\n};\r\n\r\nconst useEmployeeStoreHook = (): EmployeeStoreState => {\r\n  const state = baseStore();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods, // This includes permanentDelete\r\n    persistence,\r\n  };\r\n};\r\n\r\nexport const useEmployeeStore = useEmployeeStoreHook as EmployeeStoreHook;\r\n\r\n// Export getState for non-hook usage\r\nuseEmployeeStore.getState = (): EmployeeStoreState => {\r\n  const state = baseStore.getState();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods,\r\n    persistence,\r\n  };\r\n};\r\n\r\nuseEmployeeStore.persistence = persistence;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6391, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { Payment } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport {\r\n  extractCounterFromBusinessId,\r\n  findNextAvailableBusinessId,\r\n  generateSystemId,\r\n  getMaxBusinessIdCounter,\r\n  getMaxSystemIdCounter,\r\n  type EntityType,\r\n} from '../../lib/id-utils';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '../../lib/id-types';\r\nimport { pickAccount, pickPaymentMethod, pickPaymentType, pickTargetGroup } from '@/features/finance/document-lookups';\r\nimport { useEmployeeStore } from '../employees/store';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\n\r\n// API sync helpers\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: any): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/payments' : `/api/payments/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Payments API] ${action} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Payments API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Helper to get current user info\r\nconst getCurrentUserInfo = () => {\r\n  const currentUserSystemId = getCurrentUserSystemId?.() || 'SYSTEM';\r\n  const employee = useEmployeeStore.getState().data.find(e => e.systemId === currentUserSystemId);\r\n  return {\r\n    systemId: currentUserSystemId,\r\n    name: employee?.fullName || 'Hệ thống',\r\n    avatar: employee?.avatarUrl,\r\n  };\r\n};\r\n\r\n// Helper to create history entry\r\nconst createHistoryEntry = (\r\n  action: HistoryEntry['action'],\r\n  description: string,\r\n  metadata?: HistoryEntry['metadata']\r\n): HistoryEntry => ({\r\n  id: crypto.randomUUID(),\r\n  action,\r\n  timestamp: new Date(),\r\n  user: getCurrentUserInfo(),\r\n  description,\r\n  metadata,\r\n});\r\n\r\nexport type PaymentInput = Omit<Payment, 'systemId' | 'id'> & { id?: BusinessId | string };\r\n\r\ninterface PaymentStore {\r\n  data: Payment[];\r\n  businessIdCounter: number;\r\n  systemIdCounter: number;\r\n  initialized: boolean;\r\n  add: (item: PaymentInput) => Payment;\r\n  addMultiple: (items: PaymentInput[]) => void;\r\n  update: (systemId: SystemId, item: Payment) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => Payment | undefined;\r\n  getActive: () => Payment[];\r\n  cancel: (systemId: SystemId, reason?: string) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst PAYMENT_ENTITY: EntityType = 'payments';\r\nconst SYSTEM_ID_PREFIX = 'PAYMENT';\r\nconst BUSINESS_ID_PREFIX = 'PC';\r\nconst BUSINESS_ID_DIGITS = 6;\r\nconst PURCHASE_ORDER_SYSTEM_PREFIX = 'PURCHASE';\r\nconst PURCHASE_ORDER_BUSINESS_PREFIX = 'PO';\r\n\r\nconst normalizePaymentStatus = (status?: Payment['status']): Payment['status'] =>\r\n  status === 'cancelled' ? 'cancelled' : 'completed';\r\n\r\nconst normalizePayment = (payment: Payment): Payment => ({\r\n  ...payment,\r\n  status: normalizePaymentStatus(payment.status),\r\n});\r\n\r\nconst ensurePaymentMetadata = (payment: Payment): Payment => {\r\n  let mutated = false;\r\n  const updates: Partial<Payment> = {};\r\n\r\n  const targetGroup = pickTargetGroup({\r\n    systemId: payment.recipientTypeSystemId,\r\n    name: payment.recipientTypeName,\r\n  });\r\n  if (targetGroup) {\r\n    if (payment.recipientTypeSystemId !== targetGroup.systemId) {\r\n      updates.recipientTypeSystemId = targetGroup.systemId;\r\n      mutated = true;\r\n    }\r\n    if (payment.recipientTypeName !== targetGroup.name) {\r\n      updates.recipientTypeName = targetGroup.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const paymentMethod = pickPaymentMethod({\r\n    systemId: payment.paymentMethodSystemId,\r\n    name: payment.paymentMethodName,\r\n  });\r\n  if (paymentMethod) {\r\n    if (payment.paymentMethodSystemId !== paymentMethod.systemId) {\r\n      updates.paymentMethodSystemId = paymentMethod.systemId;\r\n      mutated = true;\r\n    }\r\n    if (payment.paymentMethodName !== paymentMethod.name) {\r\n      updates.paymentMethodName = paymentMethod.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const account = pickAccount({\r\n    accountSystemId: payment.accountSystemId,\r\n    branchSystemId: payment.branchSystemId,\r\n    paymentMethodName: paymentMethod?.name ?? payment.paymentMethodName,\r\n  });\r\n  if (account && payment.accountSystemId !== account.systemId) {\r\n    updates.accountSystemId = account.systemId;\r\n    mutated = true;\r\n  }\r\n\r\n  const paymentType = pickPaymentType({\r\n    systemId: payment.paymentReceiptTypeSystemId,\r\n    name: payment.paymentReceiptTypeName,\r\n  });\r\n  if (paymentType) {\r\n    if (payment.paymentReceiptTypeSystemId !== paymentType.systemId) {\r\n      updates.paymentReceiptTypeSystemId = paymentType.systemId;\r\n      mutated = true;\r\n    }\r\n    if (payment.paymentReceiptTypeName !== paymentType.name) {\r\n      updates.paymentReceiptTypeName = paymentType.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const normalizedGroupName = targetGroup?.name?.trim().toLowerCase();\r\n  if (normalizedGroupName === 'khách hàng') {\r\n    if (!payment.customerName && payment.recipientName) {\r\n      updates.customerName = payment.recipientName;\r\n      mutated = true;\r\n    }\r\n    if (!payment.customerSystemId && payment.recipientSystemId) {\r\n      updates.customerSystemId = payment.recipientSystemId;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  return mutated ? { ...payment, ...updates } : payment;\r\n};\r\n\r\nconst backfillPaymentMetadata = (payments: Payment[]): Payment[] => {\r\n  let mutated = false;\r\n  const updated = payments.map(payment => {\r\n    const normalized = ensurePaymentMetadata(payment);\r\n    if (normalized !== payment) {\r\n      mutated = true;\r\n    }\r\n    return normalized;\r\n  });\r\n  return mutated ? updated : payments;\r\n};\r\n\r\nconst initialPayments: Payment[] = []; // Database is source of truth\r\n\r\nlet systemIdCounter = getMaxSystemIdCounter(initialPayments, SYSTEM_ID_PREFIX);\r\nlet businessIdCounter = getMaxBusinessIdCounter(initialPayments, BUSINESS_ID_PREFIX);\r\n\r\nconst getNextSystemId = (): SystemId => {\r\n  systemIdCounter += 1;\r\n  return asSystemId(generateSystemId(PAYMENT_ENTITY, systemIdCounter));\r\n};\r\n\r\nconst ensurePaymentBusinessId = (payments: Payment[], provided?: BusinessId | string): BusinessId => {\r\n  if (provided && `${provided}`.trim().length > 0) {\r\n    const normalized = `${provided}`.trim().toUpperCase();\r\n    const parsedCounter = extractCounterFromBusinessId(normalized, BUSINESS_ID_PREFIX);\r\n    if (parsedCounter > businessIdCounter) {\r\n      businessIdCounter = parsedCounter;\r\n    }\r\n    return asBusinessId(normalized);\r\n  }\r\n\r\n  const existingIds = payments.map(payment => payment.id as string).filter(Boolean);\r\n  const { nextId, updatedCounter } = findNextAvailableBusinessId(\r\n    BUSINESS_ID_PREFIX,\r\n    existingIds,\r\n    businessIdCounter,\r\n    BUSINESS_ID_DIGITS\r\n  );\r\n  businessIdCounter = updatedCounter;\r\n  return asBusinessId(nextId);\r\n};\r\n\r\nconst reconcileLinkedDocuments = (payment: Payment): Payment => {\r\n  if (!payment.originalDocumentId) {\r\n    return payment;\r\n  }\r\n\r\n  const normalizedDocId = payment.originalDocumentId.toUpperCase();\r\n  const nextPayment = { ...payment };\r\n\r\n  if (!nextPayment.purchaseOrderSystemId && normalizedDocId.startsWith(PURCHASE_ORDER_SYSTEM_PREFIX)) {\r\n    nextPayment.purchaseOrderSystemId = asSystemId(payment.originalDocumentId);\r\n  }\r\n\r\n  if (!nextPayment.purchaseOrderId && normalizedDocId.startsWith(PURCHASE_ORDER_BUSINESS_PREFIX)) {\r\n    nextPayment.purchaseOrderId = asBusinessId(payment.originalDocumentId);\r\n  }\r\n\r\n  return nextPayment;\r\n};\r\n\r\nconst buildPayment = (input: PaymentInput, existingPayments: Payment[]): Payment => {\r\n  const systemId = getNextSystemId();\r\n  const id = ensurePaymentBusinessId(existingPayments, input.id);\r\n  const basePayment: Payment = {\r\n    ...input,\r\n    systemId,\r\n    id,\r\n    createdAt: input.createdAt || new Date().toISOString(),\r\n    status: normalizePaymentStatus(input.status),\r\n  };\r\n\r\n  return reconcileLinkedDocuments(basePayment);\r\n};\r\n\r\nexport const usePaymentStore = create<PaymentStore>()(\r\n  (set, get) => ({\r\n      data: initialPayments,\r\n      businessIdCounter,\r\n      systemIdCounter,\r\n      initialized: false,\r\n      \r\n      add: (item) => {\r\n        let createdPayment: Payment | null = null;\r\n        set(state => {\r\n          const newPayment = buildPayment(item, state.data);\r\n          createdPayment = newPayment;\r\n          return {\r\n            data: [...state.data, newPayment],\r\n            businessIdCounter,\r\n            systemIdCounter,\r\n          };\r\n        });\r\n        // Sync to API\r\n        if (createdPayment) {\r\n          syncToAPI('create', createdPayment).catch(console.error);\r\n        }\r\n        return createdPayment!;\r\n      },\r\n      \r\n      addMultiple: (items) => {\r\n        const created: Payment[] = [];\r\n        set(state => {\r\n          items.forEach(item => {\r\n            const context = [...state.data, ...created];\r\n            const payment = buildPayment(item, context);\r\n            created.push(payment);\r\n          });\r\n\r\n          return {\r\n            data: [...state.data, ...created],\r\n            businessIdCounter,\r\n            systemIdCounter,\r\n          };\r\n        });\r\n        // Sync all to API\r\n        created.forEach(payment => {\r\n          syncToAPI('create', payment).catch(console.error);\r\n        });\r\n      },\r\n      \r\n      update: (systemId, item) => {\r\n        const updated = reconcileLinkedDocuments({\r\n          ...item,\r\n          systemId,\r\n          status: normalizePaymentStatus(item.status),\r\n          updatedAt: new Date().toISOString(),\r\n        });\r\n        set(state => ({\r\n          data: state.data.map(payment =>\r\n            payment.systemId === systemId ? updated : payment\r\n          ),\r\n          businessIdCounter,\r\n          systemIdCounter,\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('update', updated).catch(console.error);\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set(state => ({\r\n          data: state.data.filter(payment => payment.systemId !== systemId),\r\n          businessIdCounter,\r\n          systemIdCounter,\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n      },\r\n      \r\n      findById: (systemId) => {\r\n        return get().data.find(payment => payment.systemId === systemId);\r\n      },\r\n      \r\n      getActive: () => {\r\n        return get().data.filter(payment => payment.status !== 'cancelled');\r\n      },\r\n      \r\n      cancel: (systemId: SystemId, reason?: string) => {\r\n        const payment = get().findById(systemId);\r\n        if (payment && payment.status !== 'cancelled') {\r\n          const historyEntry = createHistoryEntry(\r\n            'cancelled',\r\n            `Đã hủy phiếu chi${reason ? `: ${reason}` : ''}`,\r\n            { oldValue: 'Hoàn thành', newValue: 'Đã hủy', note: reason }\r\n          );\r\n          \r\n          get().update(systemId, {\r\n            ...payment,\r\n            status: 'cancelled',\r\n            cancelledAt: new Date().toISOString(),\r\n            activityHistory: [...(payment.activityHistory || []), historyEntry],\r\n          });\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        try {\r\n          // NOTE: Use React Query hooks for paginated data. This only loads initial batch.\r\n          const response = await fetch('/api/payments?limit=30');\r\n          if (!response.ok) return;\r\n          const json = await response.json();\r\n          const apiData = json.data || [];\r\n          if (apiData.length > 0) {\r\n            const normalized = backfillPaymentMetadata(apiData.map(normalizePayment));\r\n            const nextSystemCounter = getMaxSystemIdCounter(normalized, SYSTEM_ID_PREFIX);\r\n            const nextBusinessCounter = getMaxBusinessIdCounter(normalized, BUSINESS_ID_PREFIX);\r\n            systemIdCounter = nextSystemCounter;\r\n            businessIdCounter = nextBusinessCounter;\r\n            set({ \r\n              data: normalized, \r\n              systemIdCounter, \r\n              businessIdCounter,\r\n              initialized: true \r\n            });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payments API] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6727, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/penalties/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData, penaltyTypesData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Penalty, PenaltyType } from './types';\r\n\r\nexport const usePenaltyStore = createCrudStore<Penalty>([], 'penalties', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=penalty',\r\n});\r\n\r\nexport const usePenaltyTypeStore = createCrudStore<PenaltyType>([], 'penalties', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=penalty-type',\r\n});\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,MAAM,kBAAkB,IAAA,6IAAe,EAAU,EAAE,EAAE,aAAa;IACvE,iBAAiB;IACjB,aAAa;AACf;AAEO,MAAM,sBAAsB,IAAA,6IAAe,EAAc,EAAE,EAAE,aAAa;IAC/E,iBAAiB;IACjB,aAAa;AACf"}},
    {"offset": {"line": 6750, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/order.ts"],"sourcesContent":["/**\r\n * Mẫu in Đơn bán hàng - TipTap compatible\r\n * \r\n * QUAN TRỌNG - Quy tắc template:\r\n * 1. Bảng chứa {line_stt} là bảng line items - sẽ được lặp theo số sản phẩm\r\n * 2. Các bảng khác là bảng thông tin - không lặp\r\n * 3. Sử dụng inline styles để đảm bảo hiển thị đúng khi in\r\n * \r\n * CHUẨN TEMPLATE v2 (2025-12-08):\r\n * - Header: Logo trái + Store info phải (dạng table)\r\n * - Title: Căn giữa, border-bottom\r\n * - Info table: Label 22% nền xám\r\n * - Product table: table-layout fixed, responsive\r\n * - Summary: 250px căn phải\r\n * - Footer: border-top dashed, font nhỏ\r\n */\r\nexport const ORDER_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER: Logo trái + Thông tin cửa hàng phải -->\r\n<table style=\"width: 100%; margin-bottom: 12px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 70px; vertical-align: top; padding-right: 10px;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">{store_address}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">ĐT: {store_phone_number} | Email: {store_email}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 12px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 8px;\">HÓA ĐƠN BÁN HÀNG</h2>\r\n<div style=\"text-align: center; margin-bottom: 12px; font-size: 11px;\">\r\n  <div>Số: <strong>{order_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Khách hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 18%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Mã KH:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{customer_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Điện thoại:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{customer_phone_number}</td>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Nhóm KH:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{customer_group}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Địa chỉ:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{billing_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">ĐC giao hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{shipping_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">NV bán:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{account_name}</td>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Trạng thái:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{order_status}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM - Responsive với table-layout fixed -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 28px; font-size: 10px;\">STT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; font-size: 10px;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 32px; font-size: 10px;\">ĐVT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 28px; font-size: 10px;\">SL</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 65px; font-size: 10px;\">Đơn giá</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 50px; font-size: 10px;\">VAT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 45px; font-size: 10px;\">CK</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 70px; font-size: 10px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_stt}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 10px; word-wrap: break-word;\">{line_product_name}<br><small style=\"color: #666;\">{line_variant}</small></td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_unit}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{line_price}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{line_tax_amount}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{line_discount_amount}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{line_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG TỔNG GIÁ TRỊ -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng số lượng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; width: 85px; font-size: 11px;\"><strong>{total_quantity}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng tiền hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Chiết khấu:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total_discount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Thuế:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total_tax}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Phí giao hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{delivery_fee}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; font-size: 11px;\"><strong>TỔNG CỘNG:</strong></td>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\"><strong>{total_amount}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẰNG CHỮ -->\r\n<p style=\"margin: 8px 0; font-size: 11px;\"><strong>Bằng chữ:</strong> <em>{total_text}</em></p>\r\n\r\n<!-- THANH TOÁN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Phương thức TT:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{payment_name}</td>\r\n      <td style=\"padding: 4px 6px; width: 18%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">TT thanh toán:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{payment_status}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Khách đưa:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{payment_customer}</td>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Tiền thừa:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{money_return}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 8px 0; padding: 8px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">\r\n  <strong>Ghi chú:</strong> {order_note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 25px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 8px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; font-size: 11px;\">Người mua hàng</div>\r\n        <div style=\"color: #888; font-size: 10px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div style=\"font-size: 11px;\">{customer_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 8px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; font-size: 11px;\">Người bán hàng</div>\r\n        <div style=\"color: #888; font-size: 10px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div style=\"font-size: 11px;\">{account_name}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 10px; color: #666;\">\r\n  <div>Cảm ơn quý khách đã mua hàng!</div>\r\n  <div>Hotline: {store_phone_number} | In lúc: {print_date} {print_time}</div>\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;CAeC;;;;AACM,MAAM,iBAAiB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqK/B,CAAC"}},
    {"offset": {"line": 6942, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/quote.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu báo giá / Đơn tạm tính - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const QUOTE_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n      <div>ĐT: {store_phone_number} | Email: {store_email}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU BÁO GIÁ</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Số: <strong>{order_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n  <div style=\"font-style: italic;\">Hiệu lực đến: {issued_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Khách hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">Mã KH:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Điện thoại:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_phone_number}</td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Email:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_email}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\">{billing_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Nhân viên:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{account_name}</td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Chính sách giá:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{price_list_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 50px;\">SL</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 100px;\">Đơn giá</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 80px;\">CK</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 110px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_discount_amount}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG GIÁ TRỊ -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Tổng tiền hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; width: 120px;\">{total}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Chiết khấu:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{total_discount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Thuế VAT:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{total_tax}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>TỔNG CỘNG:</strong></td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{total_amount}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<p style=\"margin: 10px 0;\"><strong>Bằng chữ:</strong> <em>{total_text}</em></p>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {order_note}\r\n</div>\r\n\r\n<!-- ĐIỀU KHOẢN -->\r\n<div style=\"margin-bottom: 10px; padding: 10px; border: 1px solid #333; font-size: 11px;\">\r\n  <strong>Điều khoản:</strong>\r\n  <ul style=\"margin: 5px 0 0 15px; padding: 0;\">\r\n    <li>Báo giá có hiệu lực trong 7 ngày kể từ ngày lập</li>\r\n    <li>Giá trên chưa bao gồm phí vận chuyển (nếu có)</li>\r\n    <li>Thanh toán: Theo thỏa thuận</li>\r\n  </ul>\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Khách hàng</strong><br>\r\n        <em>(Ký xác nhận đồng ý)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {customer_name}\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Nhân viên báo giá</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333;\">\r\n  <p style=\"margin: 5px 0;\">Cảm ơn Quý khách đã quan tâm!</p>\r\n  <p style=\"margin: 5px 0;\">Liên hệ: {store_phone_number}</p>\r\n\n  <div style=\"font-size: 10px; color: #666; margin-top: 5px;\">In lúc: {print_date} {print_time}</div></div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,iBAAiB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgJ/B,CAAC"}},
    {"offset": {"line": 7101, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/receipt.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu thu - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const RECEIPT_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU THU</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Số: <strong>{receipt_voucher_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- MÃ VẠCH -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 10px; border: 1px solid #333; background: #f5f5f5;\">\r\n      <div style=\"margin-bottom: 8px;\">{receipt_barcode}</div>\r\n      <div style=\"font-family: monospace;\">{receipt_voucher_code}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- THÔNG TIN PHIẾU THU -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Người nộp tiền:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{object_name}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{object_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Lý do nộp:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{description}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Hình thức thanh toán:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{payment_method}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- SỐ TIỀN -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 15px; border: 2px solid #333;\">\r\n      <div style=\"margin-bottom: 8px;\">Số tiền</div>\r\n      <div style=\"font-size: 24px; font-weight: bold;\">{amount}</div>\r\n      <div style=\"font-style: italic; margin-top: 8px;\">({amount_text})</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người nộp tiền</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {object_name}\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ quỹ</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người lập phiếu</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGjC,CAAC"}},
    {"offset": {"line": 7216, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/payment.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu chi - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const PAYMENT_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU CHI</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Số: <strong>{payment_voucher_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- MÃ VẠCH -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 10px; border: 1px solid #333; background: #f5f5f5;\">\r\n      <div style=\"margin-bottom: 8px;\">{payment_barcode}</div>\r\n      <div style=\"font-family: monospace;\">{payment_voucher_code}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- THÔNG TIN PHIẾU CHI -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Người nhận tiền:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{object_name}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{object_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Lý do chi:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{description}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Hình thức thanh toán:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{payment_method}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- SỐ TIỀN -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 15px; border: 2px solid #333;\">\r\n      <div style=\"margin-bottom: 8px;\">Số tiền</div>\r\n      <div style=\"font-size: 24px; font-weight: bold;\">{amount}</div>\r\n      <div style=\"font-style: italic; margin-top: 8px;\">({amount_text})</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người nhận tiền</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {object_name}\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ quỹ</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người lập phiếu</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGjC,CAAC"}},
    {"offset": {"line": 7331, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/warranty.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu bảo hành - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const WARRANTY_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n      <div>Hotline: <strong>{store_phone_number}</strong></div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU BẢO HÀNH</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Mã phiếu: <strong>{warranty_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Khách hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">SĐT:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_phone_number}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\">{customer_address}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THÔNG TIN SẢN PHẨM BẢO HÀNH -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed; border: 2px solid #333;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333;\">Sản phẩm:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{product_name}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Serial/IMEI:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; font-family: monospace; font-size: 14px;\">{serial_number}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Thời hạn BH:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{warranty_duration}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Ngày hết hạn:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{warranty_expired_on}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- QUY ĐỊNH BẢO HÀNH -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tr>\r\n    <td style=\"width: 50%; padding: 10px; border: 1px solid #333; vertical-align: top;\">\r\n      <strong>ĐƯỢC BẢO HÀNH:</strong>\r\n      <div style=\"padding-left: 10px; margin-top: 5px;\">\r\n        <div>- Còn trong thời hạn bảo hành</div>\r\n        <div>- Tem bảo hành còn nguyên vẹn</div>\r\n        <div>- Hư hỏng do lỗi kỹ thuật từ NSX</div>\r\n      </div>\r\n    </td>\r\n    <td style=\"width: 50%; padding: 10px; border: 1px solid #333; vertical-align: top;\">\r\n      <strong>TỪ CHỐI BẢO HÀNH:</strong>\r\n      <div style=\"padding-left: 10px; margin-top: 5px;\">\r\n        <div>- Rơi vỡ, trầy xước, biến dạng</div>\r\n        <div>- Vào nước, ẩm, cháy, nổ</div>\r\n        <div>- Tự ý tháo lắp, sửa chữa</div>\r\n        <div>- Sử dụng sai cách, cố ý làm hư</div>\r\n      </div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Khách hàng</strong><br>\r\n        <em>(Ký xác nhận)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {customer_name}\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Nhân viên</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  Cảm ơn quý khách đã tin tưởng sử dụng dịch vụ của chúng tôi!\r\n\n  <div style=\"font-size: 10px; color: #666; margin-top: 5px;\">In lúc: {print_date} {print_time}</div></div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GlC,CAAC"}},
    {"offset": {"line": 7456, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/inventory-check.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu kiểm kho - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const INVENTORY_CHECK_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU KIỂM KHO</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Mã phiếu: <strong>{inventory_code}</strong></div>\r\n  <div>Ngày kiểm: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHO -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Kho kiểm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{location_name}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Trạng thái:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{inventory_status}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Người kiểm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\">{account_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 70px;\">Tồn kho</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 70px;\">Thực tế</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">Lệch</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left; width: 100px;\">Ghi chú</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_on_hand}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_real_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_difference}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; font-size: 11px;\">{line_note}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG KẾT -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Tổng số SP kiểm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; width: 80px;\"><strong>{total_items}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Chênh lệch (thừa):</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>+{total_surplus}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Chênh lệch (thiếu):</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>-{total_shortage}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Người kiểm kho</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ kho</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,2BAA2B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GzC,CAAC"}},
    {"offset": {"line": 7582, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/stock-transfer.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu chuyển kho - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const STOCK_TRANSFER_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU CHUYỂN KHO</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Mã phiếu: <strong>{transfer_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN CHUYỂN KHO -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 10px; width: 45%; border: 2px solid #333; text-align: center;\">\r\n        <div style=\"font-size: 12px;\">KHO XUẤT</div>\r\n        <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{source_location_name}</div>\r\n      </td>\r\n      <td style=\"padding: 10px; text-align: center; font-size: 20px; width: 10%;\">--&gt;</td>\r\n      <td style=\"padding: 10px; width: 45%; border: 2px solid #333; text-align: center;\">\r\n        <div style=\"font-size: 12px;\">KHO NHẬP</div>\r\n        <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{target_location_name}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Trạng thái:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{status}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Người tạo:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{account_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 80px;\">Số lượng</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">OK</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\"><div style=\"width: 16px; height: 16px; border: 1px solid #333; margin: 0 auto;\"></div></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG CỘNG -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>Tổng số lượng:</strong></td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{total_quantity}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người lập phiếu</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ kho xuất</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ kho nhập</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,0BAA0B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHxC,CAAC"}},
    {"offset": {"line": 7715, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/sales-return.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu trả hàng - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const SALES_RETURN_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU TRẢ HÀNG</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Số: <strong>{order_return_code}</strong></div>\r\n  <div>Đơn hàng gốc: <strong>{order_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Khách hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">SĐT:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_phone_number}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Lý do trả:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\"><strong>{reason_return}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM TRẢ -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">SL Trả</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 100px;\">Đơn giá</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 110px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_total}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG TIỀN HOÀN -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Tổng số lượng trả:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; width: 100px;\"><strong>{total_quantity}</strong></td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>TỔNG TIỀN HOÀN:</strong></td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{total}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Trạng thái hoàn:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{refund_status}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Khách hàng</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {customer_name}\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Người nhận hàng trả</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  Hotline: {store_phone_number}\r\n\n  <div style=\"font-size: 10px; color: #666; margin-top: 5px;\">In lúc: {print_date} {print_time}</div></div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,wBAAwB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHtC,CAAC"}},
    {"offset": {"line": 7844, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/purchase-order.ts"],"sourcesContent":["/**\r\n * Mẫu in Đơn đặt hàng nhập - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const PURCHASE_ORDER_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">ĐƠN ĐẶT HÀNG NHẬP</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Số: <strong>{order_supplier_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NHÀ CUNG CẤP -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Nhà cung cấp:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{supplier_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">Mã NCC:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; font-family: monospace;\">{supplier_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Điện thoại:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{supplier_phone_number}</td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Email:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{supplier_email}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\">{supplier_address}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">SL Đặt</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 100px;\">Đơn giá</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 110px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_ordered_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_total}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG TIỀN -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Tổng tiền hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; width: 100px;\">{total}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Chiết khấu:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{discount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Thuế VAT:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{tax_vat}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>TỔNG CỘNG:</strong></td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{total_order}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Người lập đơn</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px;\">\r\n        <strong>Duyệt đơn</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,0BAA0B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyHxC,CAAC"}},
    {"offset": {"line": 7980, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/packing.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu đóng gói - TipTap compatible\r\n * Cập nhật: 2025-12-08 - Responsive + Chuẩn hóa\r\n */\r\nexport const PACKING_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 12px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 70px; vertical-align: top; padding-right: 10px;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 12px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 8px;\">PHIẾU ĐÓNG GÓI</h2>\r\n<div style=\"text-align: center; margin-bottom: 12px; font-size: 11px;\">\r\n  <div>Mã: <strong>{fulfillment_code}</strong> | Đơn hàng: <strong>{order_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Khách hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 15%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">SĐT:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{customer_phone_number}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Địa chỉ giao:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{shipping_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">NV được gán:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{assigned_employee}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM - Responsive -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 28px; font-size: 10px;\">STT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 70px; font-size: 10px;\">Mã SP</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; font-size: 10px;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 35px; font-size: 10px;\">SL</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 55px; font-size: 10px;\">Vị trí</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; width: 70px; font-size: 10px;\">Ghi chú</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 28px; font-size: 10px;\">OK</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_stt}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-family: monospace; font-size: 9px;\">{line_variant_code}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 10px; word-wrap: break-word;\">{line_product_name}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-weight: bold; font-size: 11px;\">{line_quantity}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{bin_location}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 9px;\">{line_note}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center;\"><div style=\"width: 14px; height: 14px; border: 1px solid #333; margin: 0 auto;\"></div></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG CỘNG VÀ COD -->\r\n<table style=\"width: 220px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng số lượng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; width: 75px; font-size: 11px;\"><strong>{total_quantity}</strong></td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; font-size: 11px;\"><strong>COD - THU HỘ:</strong></td>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\"><strong>{cod}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 8px 0; padding: 8px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">\r\n  <strong>Ghi chú đóng gói:</strong> {packing_note}\r\n</div>\r\n<div style=\"margin: 8px 0; padding: 8px; border: 1px solid #333; font-size: 11px;\">\r\n  <strong>Ghi chú đơn hàng:</strong> {order_note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 25px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 8px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; font-size: 11px;\">Người đóng gói</div>\r\n        <div style=\"color: #888; font-size: 10px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div style=\"font-size: 11px;\">{account_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 8px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; font-size: 11px;\">Kiểm tra</div>\r\n        <div style=\"color: #888; font-size: 10px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 10px; color: #666;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHjC,CAAC"}},
    {"offset": {"line": 8109, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/delivery.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu giao hàng - TipTap compatible\r\n * Cập nhật: 2025-12-08 - Responsive + Chuẩn hóa\r\n */\r\nexport const DELIVERY_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 12px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 70px; vertical-align: top; padding-right: 10px;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">{store_address}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">ĐT: {store_phone_number}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 12px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 8px;\">PHIẾU GIAO HÀNG</h2>\r\n<div style=\"text-align: center; margin-bottom: 12px; font-size: 11px;\">\r\n  <div>Mã: <strong>{delivery_code}</strong> | Đơn hàng: <strong>{order_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- MÃ VẠCH VẬN ĐƠN -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 8px; border: 1px solid #333; background: #f5f5f5;\">\r\n      <div style=\"margin-bottom: 5px;\">{shipment_barcode}</div>\r\n      <div style=\"font-size: 14px; font-weight: bold; font-family: monospace;\">{tracking_number}</div>\r\n      <div style=\"font-size: 10px;\">Đối tác: {carrier_name}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- THÔNG TIN NGƯỜI NHẬN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Người nhận:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{receiver_name}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 15%; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">SĐT:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{receiver_phone}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Địa chỉ giao:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{shipping_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">NV giao hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{shipper_name}</td>\r\n      <td style=\"padding: 4px 6px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">Trạng thái:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{delivery_status}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM - Responsive -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 28px; font-size: 10px;\">STT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 70px; font-size: 10px;\">Mã SP</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; font-size: 10px;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 32px; font-size: 10px;\">ĐVT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 30px; font-size: 10px;\">SL</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 60px; font-size: 10px;\">Đơn giá</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 70px; font-size: 10px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_stt}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-family: monospace; font-size: 9px;\">{line_variant_code}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 10px; word-wrap: break-word;\">{line_product_name}<br><small style=\"color: #666;\">{line_variant}</small></td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_unit}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-weight: bold; font-size: 11px;\">{line_quantity}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{line_price}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{line_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG GIÁ TRỊ -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng số lượng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; width: 85px; font-size: 11px;\"><strong>{total_quantity}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng tiền hàng:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Phí vận chuyển:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{delivery_fee}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; font-size: 11px;\"><strong>COD - THU HỘ:</strong></td>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\"><strong>{cod_amount}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 8px 0; padding: 8px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 25px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 8px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; font-size: 11px;\">Người giao</div>\r\n        <div style=\"color: #888; font-size: 10px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div style=\"font-size: 11px;\">{shipper_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 8px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; font-size: 11px;\">Người nhận</div>\r\n        <div style=\"color: #888; font-size: 10px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div style=\"font-size: 11px;\">{receiver_name}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 10px; color: #666;\">\r\n  <div>Cảm ơn quý khách!</div>\r\n  <div>Hotline: {store_phone_number} | In lúc: {print_date} {print_time}</div>\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuIlC,CAAC"}},
    {"offset": {"line": 8259, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/shipping-label.ts"],"sourcesContent":["/**\r\n * Mẫu in Nhãn giao hàng - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const SHIPPING_LABEL_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 13px; line-height: 1.4; max-width: 400px; margin: 0 auto; border: 2px solid #333; padding: 15px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 2px dashed #333;\">\r\n  <div style=\"font-size: 14px; font-weight: bold;\">{store_name}</div>\r\n  <div style=\"font-size: 12px;\">{store_phone_number}</div>\r\n</div>\r\n\r\n<!-- MÃ VẬN ĐƠN -->\r\n<div style=\"text-align: center; margin-bottom: 10px; padding: 10px; background: #f5f5f5;\">\r\n  <div style=\"margin-bottom: 8px;\">{shipment_barcode}</div>\r\n  <div style=\"font-size: 18px; font-weight: bold; font-family: monospace;\">{shipment_code}</div>\r\n  <div style=\"font-size: 12px;\">Đơn: {order_code}</div>\r\n</div>\r\n\r\n<!-- NGƯỜI GỬI -->\r\n<div style=\"margin-bottom: 10px; padding: 8px; background: #f5f5f5;\">\r\n  <div style=\"font-weight: bold; font-size: 11px;\">Gửi:</div>\r\n  <div><strong>{store_name}</strong></div>\r\n  <div style=\"font-size: 11px;\">{store_address}</div>\r\n</div>\r\n\r\n<!-- NGƯỜI NHẬN -->\r\n<div style=\"margin-bottom: 10px; padding: 10px; border: 1px solid #333;\">\r\n  <div style=\"font-weight: bold; font-size: 11px;\">Nhận:</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{customer_name}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold;\">{customer_phone_number}</div>\r\n  <div style=\"font-size: 12px;\">{shipping_address}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KIỆN -->\r\n<table style=\"width: 100%; margin-bottom: 10px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 8px; background: #f5f5f5; width: 50%; border: 1px solid #333;\">\r\n      <div style=\"font-size: 11px;\">Số lượng</div>\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{total_quantity}</div>\r\n    </td>\r\n    <td style=\"text-align: center; padding: 8px; background: #f5f5f5; width: 50%; border: 1px solid #333;\">\r\n      <div style=\"font-size: 11px;\">Khối lượng</div>\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{total_weight_g}g</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- COD -->\r\n<div style=\"text-align: center; padding: 12px; border: 2px solid #333; margin-bottom: 10px;\">\r\n  <div style=\"font-size: 12px; font-weight: bold;\">THU HỘ (COD)</div>\r\n  <div style=\"font-size: 22px; font-weight: bold;\">{cod}</div>\r\n</div>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"font-size: 11px;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n</div>\r\n`;\r\n\r\n/**\r\n * Mẫu nhãn nhỏ - compact\r\n */\r\nexport const SHIPPING_LABEL_TEMPLATE_SMALL = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 11px; line-height: 1.3; max-width: 300px; padding: 10px; border: 1px solid #333;\">\r\n  <div style=\"text-align: center; margin-bottom: 8px;\">{shipment_barcode}</div>\r\n  <div style=\"text-align: center; font-weight: bold; font-family: monospace; margin-bottom: 10px;\">{shipment_code}</div>\r\n  <div style=\"border-top: 1px dashed #333; padding-top: 8px;\">\r\n    <div><strong>{customer_name}</strong></div>\r\n    <div>{customer_phone_number}</div>\r\n    <div style=\"font-size: 10px;\">{shipping_address}</div>\r\n  </div>\r\n  <div style=\"text-align: center; margin-top: 10px; padding: 5px; background: #f5f5f5; font-weight: bold;\">\r\n    COD: {cod}\r\n  </div>\r\n</div>\r\n`;\r\n\r\n/**\r\n * Mẫu nhãn lớn - đầy đủ thông tin\r\n */\r\nexport const SHIPPING_LABEL_TEMPLATE_LARGE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 13px; line-height: 1.4; max-width: 500px; margin: 0 auto; border: 3px solid #333; padding: 20px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px; padding-bottom: 15px; border-bottom: 2px solid #333;\">\r\n  <div style=\"font-size: 18px; font-weight: bold;\">{store_name}</div>\r\n  <div>{store_phone_number}</div>\r\n</div>\r\n\r\n<!-- MÃ VẠCH + QR -->\r\n<table style=\"width: 100%; margin-bottom: 20px;\">\r\n  <tr>\r\n    <td style=\"text-align: center; width: 60%;\">{shipment_barcode}</td>\r\n    <td style=\"text-align: center; width: 40%;\">{shipment_qrcode}</td>\r\n  </tr>\r\n</table>\r\n\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 28px; font-weight: bold; font-family: monospace;\">{shipment_code}</div>\r\n  <div>Đơn: {order_code}</div>\r\n</div>\r\n\r\n<!-- NGƯỜI GỬI / NHẬN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tr>\r\n    <td style=\"padding: 15px; background: #f5f5f5; border: 1px solid #333; vertical-align: top; width: 50%;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI GỬI</div>\r\n      <div><strong>{store_name}</strong></div>\r\n      <div>{store_phone_number}</div>\r\n      <div style=\"font-size: 11px;\">{store_address}</div>\r\n    </td>\r\n    <td style=\"padding: 15px; border: 2px solid #333; vertical-align: top; width: 50%;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI NHẬN</div>\r\n      <div style=\"font-size: 16px;\"><strong>{customer_name}</strong></div>\r\n      <div style=\"font-size: 15px; font-weight: bold;\">{customer_phone_number}</div>\r\n      <div style=\"font-size: 12px;\">{shipping_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- THÔNG TIN KIỆN -->\r\n<table style=\"width: 100%; margin-bottom: 10px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"text-align: center; padding: 15px; background: #f5f5f5; width: 50%; border: 1px solid #333;\">\r\n      <div style=\"font-size: 12px;\">Số lượng</div>\r\n      <div style=\"font-size: 24px; font-weight: bold;\">{total_quantity}</div>\r\n    </td>\r\n    <td style=\"text-align: center; padding: 15px; background: #f5f5f5; width: 50%; border: 1px solid #333;\">\r\n      <div style=\"font-size: 12px;\">Khối lượng</div>\r\n      <div style=\"font-size: 24px; font-weight: bold;\">{total_weight_kg} kg</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- COD -->\r\n<div style=\"text-align: center; padding: 20px; border: 3px solid #333; margin-bottom: 10px;\">\r\n  <div style=\"font-size: 14px; font-weight: bold;\">THU HỘ (COD)</div>\r\n  <div style=\"font-size: 32px; font-weight: bold;\">{cod}</div>\r\n</div>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AACM,MAAM,0BAA0B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDxC,CAAC;AAKM,MAAM,gCAAgC,CAAC;;;;;;;;;;;;;AAa9C,CAAC;AAKM,MAAM,gCAAgC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkE9C,CAAC"}},
    {"offset": {"line": 8416, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/product-label.ts"],"sourcesContent":["/**\r\n * Mẫu in Tem phụ sản phẩm (product label)\r\n * Thiết kế theo mẫu tem phụ nhập khẩu chuẩn\r\n */\r\nexport const PRODUCT_LABEL_TEMPLATE = `\r\n<div style=\"font-family: 'Inter', Arial, sans-serif; width: 320px; background: #fff; padding: 16px; line-height: 1.5; font-size: 13px; color: #111;\">\r\n  <!-- TÊN SẢN PHẨM -->\r\n  <div style=\"margin-bottom: 12px;\">\r\n    <span style=\"font-weight: 700;\">TÊN SẢN PHẨM:</span> {product_name_vat}\r\n  </div>\r\n\r\n  <!-- THƯƠNG HIỆU & ĐỊA CHỈ SẢN XUẤT -->\r\n  <div style=\"margin-bottom: 8px;\">\r\n    <span style=\"font-weight: 700;\">Thương Hiệu:</span> {product_brand}. <span style=\"font-weight: 700;\">Địa chỉ sản xuất:</span> {product_origin}\r\n  </div>\r\n\r\n  <!-- HƯỚNG DẪN SỬ DỤNG -->\r\n  <div style=\"margin-bottom: 8px;\">\r\n    <span style=\"font-weight: 700;\">Hướng Dẫn sử dụng:</span> {product_usage_guide}\r\n  </div>\r\n\r\n  <!-- ĐƠN VỊ NHẬP KHẨU -->\r\n  <div style=\"margin-bottom: 8px;\">\r\n    <span style=\"font-weight: 700;\">ĐƠN VỊ NHẬP KHẨU:</span> {product_importer_name}\r\n  </div>\r\n\r\n  <!-- ĐỊA CHỈ NHẬP KHẨU -->\r\n  <div style=\"margin-bottom: 12px;\">\r\n    <span style=\"font-weight: 700;\">Địa chỉ:</span> {product_importer_address}\r\n  </div>\r\n\r\n  <!-- BARCODE -->\r\n  <div style=\"display: flex; align-items: center; gap: 12px; padding-top: 8px; border-top: 1px dashed #ccc;\">\r\n    <div style=\"flex: 1;\">\r\n      {product_barcode_image}\r\n      <div style=\"font-size: 11px; margin-top: 2px;\">{product_barcode}</div>\r\n    </div>\r\n  </div>\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,yBAAyB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCvC,CAAC"}},
    {"offset": {"line": 8466, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/stock-in.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu nhập kho - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const STOCK_IN_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU NHẬP KHO</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Mã: <strong>{stock_in_code}</strong></div>\r\n  <div>Đơn đặt hàng: <strong>{order_supplier_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NHẬP KHO -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Kho nhập:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{location_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">Trạng thái:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{stock_in_status}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Nhà cung cấp:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{supplier_name}</strong></td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Mã NCC:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; font-family: monospace;\">{supplier_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Người tạo:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\">{account_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 35px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 90px;\">Mã SP</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 50px;\">ĐVT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 55px;\">SL Đặt</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 55px;\">SL Nhập</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 90px;\">Đơn giá</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 100px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_ordered_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_received_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_total}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG TIỀN -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Tổng tiền hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; width: 100px;\">{total}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Chiết khấu:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{discount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Thuế VAT:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{tax_vat}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>TỔNG CỘNG:</strong></td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{total_order}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Đã thanh toán:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{paid}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Còn phải trả:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{remaining}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người giao</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ kho</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người lập</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIlC,CAAC"}},
    {"offset": {"line": 8618, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/supplier-return.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu trả hàng NCC - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const SUPPLIER_RETURN_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU TRẢ HÀNG NHÀ CUNG CẤP</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Mã: <strong>{return_supplier_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NHÀ CUNG CẤP -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Nhà cung cấp:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{supplier_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">Mã NCC:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; font-family: monospace;\">{supplier_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Điện thoại:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{supplier_phone_number}</td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Email:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{supplier_email}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\">{supplier_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Lý do trả:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\" colspan=\"3\"><strong>{reason_return}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM TRẢ -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: center; width: 60px;\">SL Trả</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 100px;\">Đơn giá</th>\r\n      <th style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 110px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333;\">{line_product_name}<br><small>{line_variant}</small></td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 6px; border: 1px solid #333; text-align: right;\">{line_total}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG GIÁ TRỊ -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>TỔNG GIÁ TRỊ TRẢ:</strong></td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 100px;\"><strong>{total_order}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Đã nhận hoàn:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{refunded}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">Còn phải nhận:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{remaining}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Đại diện NCC</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Thủ kho</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người lập</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {account_name}\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,2BAA2B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8HzC,CAAC"}},
    {"offset": {"line": 8759, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/complaint.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu khiếu nại - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const COMPLAINT_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n      <div>Hotline: <strong>{store_phone_number}</strong></div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU KHIẾU NẠI</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Mã phiếu: <strong>{complaint_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Khách hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">SĐT:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{customer_phone_number}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Email:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_email}</td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{customer_address}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THÔNG TIN ĐƠN HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Mã đơn hàng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{order_code}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">Ngày mua:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{order_date}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- NỘI DUNG KHIẾU NẠI -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed; border: 2px solid #333;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333;\">Loại khiếu nại:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{complaint_type}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Sản phẩm:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_product_name} - <small>{line_variant}</small></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Mô tả vấn đề:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{complaint_description}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Yêu cầu của KH:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{customer_request}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- XỬ LÝ KHIẾU NẠI -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Trạng thái:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{complaint_status}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Phương án xử lý:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{resolution}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Người xử lý:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{assignee_name}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Ngày hoàn thành:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{resolved_on}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {complaint_note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Khách hàng</strong><br>\r\n        <em>(Ký xác nhận)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {customer_name}\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người xử lý</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {assignee_name}\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Quản lý</strong><br>\r\n        <em>(Ký duyệt)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  Cảm ơn quý khách đã phản hồi. Chúng tôi sẽ xử lý trong thời gian sớm nhất!\r\n\n  <div style=\"font-size: 10px; color: #666; margin-top: 5px;\">In lúc: {print_date} {print_time}</div></div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,qBAAqB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqInC,CAAC"}},
    {"offset": {"line": 8907, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/penalty.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu phạt - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const PENALTY_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 14px; font-weight: bold; margin-bottom: 2px; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU XỬ PHẠT</h2>\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div>Số: <strong>{penalty_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NGƯỜI BỊ PHẠT -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Họ và tên:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{employee_name}</strong></td>\r\n      <td style=\"padding: 5px; width: 15%; background: #f5f5f5; border: 1px solid #333;\">Mã NV:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; font-family: monospace;\">{employee_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Bộ phận:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{department_name}</td>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Chức vụ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{position_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- NỘI DUNG VI PHẠM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; background: #f5f5f5; border: 1px solid #333;\">Loại vi phạm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{violation_type}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Ngày vi phạm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{violation_date}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Mô tả vi phạm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{violation_description}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Bằng chứng:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{evidence}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- HÌNH THỨC XỬ PHẠT -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed; border: 2px solid #333;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 30%; background: #f5f5f5; border: 1px solid #333;\">Hình thức:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{penalty_type}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">Lần vi phạm:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Lần thứ <strong>{violation_count}</strong></td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 12px; border: 1px solid #333;\"><strong>SỐ TIỀN PHẠT:</strong></td>\r\n      <td style=\"padding: 12px; border: 1px solid #333; font-size: 18px; font-weight: bold;\">{penalty_amount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Bằng chữ:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; font-style: italic;\">{penalty_amount_text}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 10px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {penalty_note}\r\n</div>\r\n\r\n<!-- CĂN CỨ PHÁP LÝ -->\r\n<div style=\"margin: 10px 0; padding: 10px; border: 1px solid #333; font-size: 12px;\">\r\n  <strong>Căn cứ pháp lý:</strong> Theo quy định nội bộ công ty và Bộ luật Lao động Việt Nam.\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Người vi phạm</strong><br>\r\n        <em>(Ký xác nhận)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n        {employee_name}\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Trưởng bộ phận</strong><br>\r\n        <em>(Ký, ghi rõ họ tên)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px;\">\r\n        <strong>Giám đốc</strong><br>\r\n        <em>(Ký duyệt)</em><br>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 11px;\">\r\n  Phiếu này được lập thành 02 bản, mỗi bên giữ 01 bản có giá trị như nhau.\r\n\n  <div style=\"font-size: 10px; color: #666; margin-top: 5px;\">In lúc: {print_date} {print_time}</div></div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4HjC,CAAC"}},
    {"offset": {"line": 9046, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/cost-adjustment.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu điều chỉnh giá vốn - TipTap compatible\r\n * Cập nhật: Thiết kế đen trắng cho máy in\r\n */\r\nexport const COST_ADJUSTMENT_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<table style=\"width: 100%; margin-bottom: 10px;\">\r\n  <tr>\r\n    <td style=\"width: 80px; vertical-align: top;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div>{store_address}</div>\r\n      <div>ĐT: {store_phone}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 15px 0 5px 0; font-size: 16px; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU ĐIỀU CHỈNH GIÁ VỐN</h2>\r\n<div style=\"text-align: center; margin-bottom: 15px;\">\r\n  <div>Số: <strong>{adjustment_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN CHI NHÁNH -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 15px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; width: 25%; background: #f5f5f5; border: 1px solid #333;\">Chi nhánh:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{location_name}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Địa chỉ:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{location_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Lý do điều chỉnh:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\"><strong>{reason}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Trạng thái:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{status}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- DANH SÁCH SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 15px; font-size: 11px;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: center; width: 30px;\">STT</th>\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: left;\">Mã SP</th>\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: center; width: 50px;\">ĐVT</th>\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: right;\">Giá vốn cũ</th>\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: right;\">Giá vốn mới</th>\r\n      <th style=\"padding: 6px; border: 1px solid #333; text-align: right;\">Chênh lệch</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr data-line-item>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333;\">{line_product_name}</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{line_old_price}</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{line_new_price}</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\">{line_difference}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG KẾT -->\r\n<table style=\"width: 50%; margin-left: auto; border-collapse: collapse; margin-bottom: 15px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Tổng số sản phẩm:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right;\"><strong>{total_items}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Tổng tăng giá vốn:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; color: green;\">{total_increase}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px; background: #f5f5f5; border: 1px solid #333;\">Tổng giảm giá vốn:</td>\r\n      <td style=\"padding: 5px; border: 1px solid #333; text-align: right; color: red;\">{total_decrease}</td>\r\n    </tr>\r\n    <tr style=\"font-weight: bold; font-size: 13px;\">\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333;\">CHÊNH LỆCH:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{total_difference}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin: 15px 0; padding: 10px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center;\">\r\n        <strong>Người lập phiếu</strong>\r\n        <div style=\"margin-top: 50px; font-style: italic;\">{account_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center;\">\r\n        <strong>Người xác nhận</strong>\r\n        <div style=\"margin-top: 50px; font-style: italic;\">{confirmed_by}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- NGÀY IN -->\r\n<div style=\"text-align: right; margin-top: 20px; font-size: 10px; color: #666;\">\r\n  In ngày: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,MAAM,2BAA2B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuHzC,CAAC"}},
    {"offset": {"line": 9180, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/payroll.ts"],"sourcesContent":["/**\r\n * Payroll Template - Bảng lương\r\n * Mẫu in mặc định theo chuẩn TEMPLATE v2\r\n * \r\n * QUAN TRỌNG - Quy tắc template:\r\n * 1. Bảng chứa {line_stt} hoặc {line_index} là bảng line items - sẽ được lặp theo số nhân viên\r\n * 2. Các bảng khác là bảng thông tin - không lặp\r\n * 3. Sử dụng inline styles để đảm bảo hiển thị đúng khi in\r\n * \r\n * CHUẨN TEMPLATE v2 (2025-12-08):\r\n * - Header: Logo trái + Store info phải (dạng table)\r\n * - Title: Căn giữa, border-bottom\r\n * - Info table: Label 22% nền xám\r\n * - Product table: table-layout fixed, responsive\r\n * - Summary: 280px căn phải\r\n * - Footer: border-top dashed, font nhỏ\r\n */\r\nexport const PAYROLL_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 900px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER: Logo trái + Thông tin cửa hàng phải -->\r\n<table style=\"width: 100%; margin-bottom: 12px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 70px; vertical-align: top; padding-right: 10px;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">{store_address}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">ĐT: {store_phone_number} | Email: {store_email}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 12px 0 5px 0; font-size: 16px; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 8px;\">BẢNG LƯƠNG TỔNG HỢP</h2>\r\n<div style=\"text-align: center; margin-bottom: 12px; font-size: 12px;\">\r\n  <div><strong>{batch_title}</strong></div>\r\n  <div>Mã: <strong>{batch_code}</strong> | Kỳ lương: <strong>{pay_period}</strong></div>\r\n</div>\r\n\r\n<!-- THÔNG TIN BẢNG LƯƠNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 20%; border: 1px solid #333; font-size: 11px;\">Trạng thái:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{batch_status}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 20%; border: 1px solid #333; font-size: 11px;\">Ngày thanh toán:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{payroll_date}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tháng chấm công:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{reference_months}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Số nhân viên:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{total_employees}</strong> người</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Người lập:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{created_by}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Ngày lập:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{created_on}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Ghi chú:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{notes}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG CHI TIẾT LƯƠNG TỪNG NHÂN VIÊN - Table layout fixed -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: center; width: 28px; font-size: 10px;\">STT</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; width: 58px; font-size: 10px;\">Mã NV</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; font-size: 10px;\">Họ tên</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: left; width: 80px; font-size: 10px;\">Phòng ban</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 72px; font-size: 10px;\">Thu nhập</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 55px; font-size: 10px;\">Bảo hiểm</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 60px; font-size: 10px;\">Thuế TNCN</th>\r\n      <th style=\"padding: 5px 3px; border: 1px solid #333; text-align: right; width: 72px; font-size: 10px; font-weight: bold;\">Thực lĩnh</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_stt}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 10px;\">{employee_code}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 10px; word-wrap: break-word;\">{employee_name}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; font-size: 10px; word-wrap: break-word;\">{department_name}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{earnings}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{total_insurance}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px;\">{personal_income_tax}</td>\r\n      <td style=\"padding: 4px 3px; border: 1px solid #333; text-align: right; font-size: 10px; font-weight: bold;\">{net_pay}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG TỔNG KẾT -->\r\n<table style=\"width: 300px; margin-left: auto; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng thu nhập:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; width: 120px; font-size: 11px;\">{total_earnings}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng bảo hiểm (NV):</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total_insurance}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng thuế TNCN:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total_tax}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Tổng khấu trừ:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total_deductions}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Đóng góp (DN):</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px;\">{total_contributions}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; font-size: 12px; font-weight: bold; background: #f0f0f0;\">TỔNG THỰC LĨNH:</td>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 12px; font-weight: bold; background: #f0f0f0;\">{total_net}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẰNG CHỮ -->\r\n<p style=\"font-style: italic; margin: 10px 0; font-size: 11px;\">\r\n  <strong>Bằng chữ:</strong> {total_net_text}\r\n</p>\r\n\r\n<!-- FOOTER: Chữ ký -->\r\n<table style=\"width: 100%; margin-top: 25px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 33%; text-align: center; padding: 5px; vertical-align: top;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 50px; font-size: 11px;\">Người lập</div>\r\n      <div style=\"font-size: 11px;\">{created_by}</div>\r\n    </td>\r\n    <td style=\"width: 33%; text-align: center; padding: 5px; vertical-align: top;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 50px; font-size: 11px;\">Kế toán trưởng</div>\r\n      <div style=\"font-size: 11px;\"></div>\r\n    </td>\r\n    <td style=\"width: 33%; text-align: center; padding: 5px; vertical-align: top;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 50px; font-size: 11px;\">Giám đốc</div>\r\n      <div style=\"font-size: 11px;\"></div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- NGÀY IN -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: right;\">\r\n  Ngày in: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;CAgBC;;;;AACM,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIjC,CAAC"}},
    {"offset": {"line": 9345, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/payslip.ts"],"sourcesContent":["/**\r\n * Payslip Template - Phiếu lương cá nhân\r\n * Mẫu in mặc định theo chuẩn TEMPLATE v2\r\n * \r\n * QUAN TRỌNG - Quy tắc template:\r\n * 1. Bảng chứa {line_stt} là bảng line items - sẽ được lặp theo số components\r\n * 2. Các bảng khác là bảng thông tin - không lặp\r\n * 3. Sử dụng inline styles để đảm bảo hiển thị đúng khi in\r\n * \r\n * CHUẨN TEMPLATE v2 (2025-12-08):\r\n * - Header: Logo trái + Store info phải (dạng table)\r\n * - Title: Căn giữa, border-bottom\r\n * - Info table: Label 22% nền xám\r\n * - Component table: table-layout fixed, responsive\r\n * - Summary: 280px căn phải\r\n * - Footer: border-top dashed, font nhỏ\r\n */\r\nexport const PAYSLIP_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 700px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER: Logo trái + Thông tin cửa hàng phải -->\r\n<table style=\"width: 100%; margin-bottom: 12px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 70px; vertical-align: top; padding-right: 10px;\">{store_logo}</td>\r\n    <td style=\"vertical-align: top;\">\r\n      <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">{store_address}</div>\r\n      <div style=\"font-size: 11px; color: #333;\">ĐT: {store_phone_number} | Email: {store_email}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 12px 0 5px 0; font-size: 16px; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 8px;\">PHIẾU LƯƠNG</h2>\r\n<div style=\"text-align: center; margin-bottom: 12px; font-size: 12px;\">\r\n  <div>Kỳ lương: <strong>{pay_period}</strong></div>\r\n  <div>Mã phiếu: <strong>{payslip_code}</strong></div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NHÂN VIÊN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; width: 22%; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Mã nhân viên:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{employee_code}</strong></td>\r\n      <td style=\"padding: 4px 6px; width: 22%; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Họ và tên:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\"><strong>{employee_name}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Phòng ban:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{department_name}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Chức vụ:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{position}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Bảng lương:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\" colspan=\"3\">{batch_title} ({batch_code})</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Ngày thanh toán:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{payroll_date}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; background: #f5f5f5;\">Kỳ lương:</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">{pay_period}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THÔNG TIN CHẤM CÔNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; background: #f8f9fa;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; width: 25%; background: #e8e8e8; font-weight: bold;\">Ngày công</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; width: 25%; text-align: center;\"><strong>{work_days}</strong> / {standard_work_days}</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; width: 25%; background: #e8e8e8; font-weight: bold;\">Nghỉ phép</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; width: 25%; text-align: center;\">{leave_days} ngày</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; background: #e8e8e8; font-weight: bold;\">Tổng giờ OT</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; text-align: center; color: #0066cc;\"><strong>{ot_hours}h</strong></td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; background: #e8e8e8; font-weight: bold;\">Vắng không phép</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; text-align: center;\">{absent_days} ngày</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; background: #e8e8e8;\">OT ngày thường</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; text-align: center;\">{ot_hours_weekday}h</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; background: #e8e8e8;\">Đi trễ/Về sớm</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; text-align: center;\">{late_arrivals} lần / {early_departures} lần</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; background: #e8e8e8;\">OT cuối tuần</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; text-align: center;\">{ot_hours_weekend}h</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; background: #e8e8e8;\">OT ngày lễ</td>\r\n      <td style=\"padding: 6px 8px; border: 1px solid #333; font-size: 11px; text-align: center;\">{ot_hours_holiday}h</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- CHI TIẾT CÁC THÀNH PHẦN LƯƠNG (LINE ITEMS) -->\r\n<h4 style=\"margin: 15px 0 8px 0; font-size: 12px; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 4px;\">I. CHI TIẾT THU NHẬP</h4>\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <thead>\r\n    <tr style=\"background: #e8e8e8;\">\r\n      <th style=\"padding: 5px 6px; border: 1px solid #333; text-align: center; font-size: 11px; width: 30px;\">STT</th>\r\n      <th style=\"padding: 5px 6px; border: 1px solid #333; text-align: left; font-size: 11px; width: 140px;\">Tên thành phần</th>\r\n      <th style=\"padding: 5px 6px; border: 1px solid #333; text-align: left; font-size: 11px;\">Chi tiết tính</th>\r\n      <th style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px; width: 110px;\">Số tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: center; font-size: 10px;\">{line_stt}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 10px;\">{component_name}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 10px; color: #555;\">{component_formula}</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 10px; font-weight: bold;\">{component_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n  <tfoot>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td colspan=\"3\" style=\"padding: 5px 6px; border: 1px solid #333; font-size: 11px; font-weight: bold;\">Tổng thu nhập (Gross)</td>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px; font-weight: bold;\">{total_earnings}</td>\r\n    </tr>\r\n  </tfoot>\r\n</table>\r\n\r\n<!-- CÁC KHOẢN KHẤU TRỪ -->\r\n<h4 style=\"margin: 15px 0 8px 0; font-size: 12px; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 4px;\">II. CÁC KHOẢN KHẤU TRỪ</h4>\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <thead>\r\n    <tr style=\"background: #e8e8e8;\">\r\n      <th style=\"padding: 5px 6px; border: 1px solid #333; text-align: left; font-size: 11px;\">Khoản mục</th>\r\n      <th style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px; width: 120px;\">Số tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; padding-left: 10px;\">BHXH (8%)</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #c00;\">{bhxh_amount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; padding-left: 10px;\">BHYT (1.5%)</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #c00;\">{bhyt_amount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; padding-left: 10px;\">BHTN (1%)</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #c00;\">{bhtn_amount}</td>\r\n    </tr>\r\n    <tr style=\"background: #fff5f5;\">\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; font-weight: bold;\">Tổng bảo hiểm (10.5%)</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; font-weight: bold; color: #c00;\">{total_insurance}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; padding-left: 10px;\">Thuế TNCN</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #c00;\">{personal_income_tax}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; padding-left: 10px;\">Khấu trừ phạt</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #c00;\">{penalty_deductions}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; padding-left: 10px;\">Khấu trừ khác</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #c00;\">{other_deductions}</td>\r\n    </tr>\r\n  </tbody>\r\n  <tfoot>\r\n    <tr style=\"background: #fff5f5;\">\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; font-size: 11px; font-weight: bold;\">Tổng khấu trừ</td>\r\n      <td style=\"padding: 5px 6px; border: 1px solid #333; text-align: right; font-size: 11px; font-weight: bold; color: #c00;\">{total_deductions}</td>\r\n    </tr>\r\n  </tfoot>\r\n</table>\r\n\r\n<!-- TÍNH THUẾ TNCN (Tham khảo) -->\r\n<h4 style=\"margin: 15px 0 8px 0; font-size: 12px; font-weight: bold; border-bottom: 1px solid #333; padding-bottom: 4px;\">III. TÍNH THUẾ TNCN</h4>\r\n<p style=\"font-size: 10px; color: #666; margin: 0 0 8px 0; font-style: italic;\">Công thức: Thu nhập chịu thuế = Tổng thu nhập - BH (NV đóng) - Giảm trừ gia cảnh</p>\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; width: 60%;\">Mức giảm trừ bản thân (theo luật thuế TNCN)</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #666;\">{personal_deduction}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px;\">Mức giảm trừ người phụ thuộc ({dependents_count} người × 4.400.000)</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; color: #666;\">{dependent_deduction}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; font-weight: bold;\">→ Thu nhập chịu thuế</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; font-weight: bold;\">{taxable_income}</td>\r\n    </tr>\r\n    <tr style=\"background: #fff5f5;\">\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; font-size: 11px; font-weight: bold;\">→ Thuế TNCN phải nộp</td>\r\n      <td style=\"padding: 4px 6px; border: 1px solid #333; text-align: right; font-size: 11px; font-weight: bold; color: #c00;\">{personal_income_tax}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THỰC LĨNH -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px;\">\r\n  <tbody>\r\n    <tr style=\"background: #d4edda;\">\r\n      <td style=\"padding: 8px 10px; border: 2px solid #333; font-size: 14px; font-weight: bold; width: 50%;\">THỰC LĨNH</td>\r\n      <td style=\"padding: 8px 10px; border: 2px solid #333; text-align: right; font-size: 14px; font-weight: bold; color: #155724;\">{net_pay}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẰNG CHỮ -->\r\n<p style=\"font-style: italic; margin: 10px 0; font-size: 11px; padding: 8px; border: 1px solid #333; background: #fffde7;\">\r\n  <strong>Số tiền bằng chữ:</strong> {net_pay_text}\r\n</p>\r\n\r\n<!-- FOOTER: Chữ ký -->\r\n<table style=\"width: 100%; margin-top: 25px; border-collapse: collapse;\">\r\n  <tr>\r\n    <td style=\"width: 50%; text-align: center; padding: 5px; vertical-align: top;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 50px; font-size: 11px;\">Người lập phiếu</div>\r\n      <div style=\"font-size: 11px;\"></div>\r\n    </td>\r\n    <td style=\"width: 50%; text-align: center; padding: 5px; vertical-align: top;\">\r\n      <div style=\"font-weight: bold; margin-bottom: 50px; font-size: 11px;\">Người nhận</div>\r\n      <div style=\"font-size: 11px;\">{employee_name}</div>\r\n    </td>\r\n  </tr>\r\n</table>\r\n\r\n<!-- NGÀY IN -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: right;\">\r\n  Ngày in: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;CAgBC;;;;AACM,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqNjC,CAAC"}},
    {"offset": {"line": 9586, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/supplier-order.ts"],"sourcesContent":["/**\r\n * Mẫu in Đơn đặt hàng nhập (Extended) - TipTap compatible\r\n */\r\nexport const SUPPLIER_ORDER_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">{store_address}</div>\r\n  <div style=\"color: #666;\">ĐT: {store_phone_number}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">ĐƠN ĐẶT HÀNG NHẬP</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Số: <strong>{order_supplier_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NHÀ CUNG CẤP -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Nhà cung cấp:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\"><strong>{supplier_name}</strong></td>\r\n      <td style=\"padding: 8px; width: 15%; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Mã NCC:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\">{supplier_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Điện thoại:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\">{supplier_phone_number}</td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Email:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\">{supplier_email}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Địa chỉ:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\" colspan=\"3\">{supplier_address}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Kho nhập:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\">{location_name}</td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #ddd; font-weight: bold;\">Ngày giao dự kiến:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #ddd;\">{expected_on}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">SL Đặt</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: right; width: 100px;\">Đơn giá</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: right; width: 110px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_product_name}<br><small style=\"color: #666;\">{line_variant}</small></td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{line_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG GIÁ TRỊ -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Tổng tiền hàng:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 120px;\">{total}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Chiết khấu:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{total_discount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Thuế VAT:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{total_tax}</td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 10px; border: 1px solid #333; font-weight: bold; font-size: 14px;\">TỔNG CỘNG:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right; font-weight: bold; font-size: 14px;\">{total_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 40px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI LẬP ĐƠN</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{account_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">PHÊ DUYỆT</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: center;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,0BAA0B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4HxC,CAAC"}},
    {"offset": {"line": 9724, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/return-order.ts"],"sourcesContent":["/**\r\n * Mẫu in Đơn trả hàng (Extended) - TipTap compatible\r\n */\r\nexport const RETURN_ORDER_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">{store_address}</div>\r\n  <div style=\"color: #666;\">ĐT: {store_phone_number}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU TRẢ HÀNG</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Số: <strong>{return_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n  <div>Đơn hàng gốc: <strong>{order_code}</strong></div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Khách hàng:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 8px; width: 15%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Mã KH:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{customer_code}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Điện thoại:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{customer_phone_number}</td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Email:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{customer_email}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Lý do trả:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\" colspan=\"3\"><strong>{reason}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG SẢN PHẨM TRẢ -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">ĐVT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">SL Trả</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: right; width: 100px;\">Đơn giá</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: right; width: 110px;\">Thành tiền</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_product_name}<br><small style=\"color: #666;\">{line_variant}</small></td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_unit}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{line_price}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{line_amount}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG GIÁ TRỊ HOÀN -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Tổng số lượng trả:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right; width: 120px;\"><strong>{total_quantity}</strong></td>\r\n    </tr>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 10px; border: 1px solid #333; font-weight: bold; font-size: 14px;\">TỔNG TIỀN HOÀN:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right; font-weight: bold; font-size: 14px;\">{total_amount}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Bằng chữ:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right; font-style: italic;\">{total_text}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">Trạng thái hoàn tiền:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\"><strong>{refund_status}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 40px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">KHÁCH HÀNG</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{customer_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI NHẬN HÀNG</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{account_name}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: center;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,wBAAwB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwHtC,CAAC"}},
    {"offset": {"line": 9858, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/handover.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu bàn giao (Extended) - TipTap compatible\r\n */\r\nexport const HANDOVER_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">{store_address}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU BÀN GIAO</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Số: <strong>{handover_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN BÀN GIAO -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Người bàn giao:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{from_employee}</strong></td>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Bộ phận:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{from_department}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Người nhận:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{to_employee}</strong></td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Bộ phận:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{to_department}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Loại bàn giao:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{handover_type}</td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Trạng thái:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{status}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- BẢNG NỘI DUNG BÀN GIAO -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: left;\">Nội dung bàn giao</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 80px;\">Số lượng</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Tình trạng</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: left; width: 150px;\">Ghi chú</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_description}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_condition}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_note}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ CHUNG -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CAM KẾT -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Cam kết:</strong> Hai bên đã kiểm tra và xác nhận đầy đủ các nội dung bàn giao trên. Người nhận cam kết bảo quản và sử dụng đúng mục đích.\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 40px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI BÀN GIAO</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{from_employee}</div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI NHẬN</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{to_employee}</div>\r\n      </td>\r\n      <td style=\"width: 33%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">XÁC NHẬN</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; color: #666; font-size: 11px;\">\r\n  Phiếu này được lập thành 02 bản, mỗi bên giữ 01 bản có giá trị như nhau.\r\n\n  <div style=\"font-size: 10px; color: #666; margin-top: 5px;\">In lúc: {print_date} {print_time}</div></div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,oBAAoB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyGlC,CAAC"}},
    {"offset": {"line": 9977, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/refund-confirmation.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu xác nhận hoàn (Extended) - TipTap compatible\r\n */\r\nexport const REFUND_CONFIRMATION_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">{store_address}</div>\r\n  <div style=\"color: #666;\">ĐT: {store_phone_number}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU XÁC NHẬN HOÀN TIỀN</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Số: <strong>{refund_code}</strong></div>\r\n  <div>Ngày: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN HOÀN TIỀN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Mã đơn hàng gốc:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{order_code}</strong></td>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Ngày đặt:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{order_date}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Mã phiếu trả:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{return_code}</strong></td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Ngày trả:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{return_date}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Khách hàng:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{customer_name}</strong></td>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Điện thoại:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{customer_phone_number}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Lý do hoàn:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\" colspan=\"3\">{refund_reason}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- CHI TIẾT HOÀN TIỀN -->\r\n<div style=\"background: #f5f5f5; border: 2px solid #333; padding: 20px; margin-bottom: 20px; text-align: center;\">\r\n  <div style=\"font-size: 14px; color: #666; margin-bottom: 10px;\">SỐ TIỀN HOÀN</div>\r\n  <div style=\"font-size: 28px; font-weight: bold;\">{refund_amount}</div>\r\n  <div style=\"font-style: italic; color: #666; margin-top: 5px;\">({refund_amount_text})</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN HOÀN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Hình thức hoàn:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{refund_method}</strong></td>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Trạng thái:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{refund_status}</strong></td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Ngày hoàn tiền:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{refunded_on}</td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Người xử lý:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{account_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THÔNG TIN TÀI KHOẢN (nếu chuyển khoản) -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Ngân hàng:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{bank_name}</td>\r\n      <td style=\"padding: 8px; width: 20%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Chi nhánh:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{bank_branch}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Số tài khoản:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{bank_account}</strong></td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Chủ tài khoản:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{bank_account_name}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 40px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">KHÁCH HÀNG</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký xác nhận đã nhận tiền)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{customer_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI XỬ LÝ</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{account_name}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: center;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,+BAA+B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8H7C,CAAC"}},
    {"offset": {"line": 10117, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/packing-guide.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu hướng dẫn đóng gói (Extended) - TipTap compatible\r\n */\r\nexport const PACKING_GUIDE_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">HƯỚNG DẪN ĐÓNG GÓI</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Đơn hàng: <strong>{order_code}</strong></div>\r\n  <div>Ngày: {created_on}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN NGƯỜI NHẬN -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">THÔNG TIN GIAO HÀNG</div>\r\n  <table style=\"width: 100%;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 5px 0; width: 120px;\"><strong>Người nhận:</strong></td>\r\n        <td>{customer_name}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Điện thoại:</strong></td>\r\n        <td>{customer_phone_number}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Địa chỉ:</strong></td>\r\n        <td>{shipping_address}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- CHECKLIST ĐÓNG GÓI -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">CHECKLIST ĐÓNG GÓI</div>\r\n  <table style=\"width: 100%;\">\r\n    <tbody>\r\n      <tr><td style=\"padding: 5px 0;\">[ ] Kiểm tra đầy đủ sản phẩm theo danh sách</td></tr>\r\n      <tr><td style=\"padding: 5px 0;\">[ ] Kiểm tra tình trạng sản phẩm</td></tr>\r\n      <tr><td style=\"padding: 5px 0;\">[ ] Bọc chống sốc cho sản phẩm dễ vỡ</td></tr>\r\n      <tr><td style=\"padding: 5px 0;\">[ ] Đóng gói chắc chắn, dán kín</td></tr>\r\n      <tr><td style=\"padding: 5px 0;\">[ ] Dán nhãn giao hàng</td></tr>\r\n      <tr><td style=\"padding: 5px 0;\">[ ] Kèm hóa đơn/phiếu giao hàng</td></tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- DANH SÁCH SẢN PHẨM -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">SL</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Vị trí kho</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">Đã lấy</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_product_name}<br><small style=\"color: #666;\">{line_variant}</small></td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold; font-size: 16px;\">{line_quantity}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{bin_location}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-size: 20px;\">[ ]</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- TỔNG QUAN -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <td style=\"padding: 10px; border: 1px solid #333; font-weight: bold;\">Tổng số lượng:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right; font-weight: bold; font-size: 16px;\">{total_quantity}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 10px; border: 1px solid #333;\">COD thu hộ:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right; font-weight: bold;\">{cod}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- LƯU Ý ĐẶC BIỆT -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">LƯU Ý ĐẶC BIỆT</div>\r\n  <div>{packing_note}</div>\r\n  <div style=\"margin-top: 10px; padding-top: 10px; border-top: 1px dashed #333;\">\r\n    <strong>Ghi chú đơn hàng:</strong> {order_note}\r\n  </div>\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI ĐÓNG GÓI</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div>{account_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">KIỂM TRA</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 10px; color: #666;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,yBAAyB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4HvC,CAAC"}},
    {"offset": {"line": 10255, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/sales-summary.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu tổng kết bán hàng (Extended) - TipTap compatible\r\n */\r\nexport const SALES_SUMMARY_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">Chi nhánh: {location_name}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">BÁO CÁO TỔNG KẾT BÁN HÀNG</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Kỳ báo cáo: <strong>{period}</strong></div>\r\n  <div>Từ ngày: {from_date} - Đến ngày: {to_date}</div>\r\n  <div>Người lập: {account_name} | Ngày lập: {created_on}</div>\r\n</div>\r\n\r\n<!-- THỐNG KÊ TỔNG QUAN -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 25%; padding: 15px; text-align: center; background: #f5f5f5; border: 1px solid #333;\">\r\n        <div style=\"font-size: 12px; color: #666;\">Tổng đơn hàng</div>\r\n        <div style=\"font-size: 24px; font-weight: bold;\">{total_orders}</div>\r\n      </td>\r\n      <td style=\"width: 25%; padding: 15px; text-align: center; background: #f5f5f5; border: 1px solid #333;\">\r\n        <div style=\"font-size: 12px; color: #666;\">Doanh thu</div>\r\n        <div style=\"font-size: 24px; font-weight: bold;\">{total_revenue}</div>\r\n      </td>\r\n      <td style=\"width: 25%; padding: 15px; text-align: center; background: #f5f5f5; border: 1px solid #333;\">\r\n        <div style=\"font-size: 12px; color: #666;\">Chiết khấu</div>\r\n        <div style=\"font-size: 24px; font-weight: bold;\">{total_discount}</div>\r\n      </td>\r\n      <td style=\"width: 25%; padding: 15px; text-align: center; background: #f5f5f5; border: 1px solid #333;\">\r\n        <div style=\"font-size: 12px; color: #666;\">Trả hàng</div>\r\n        <div style=\"font-size: 24px; font-weight: bold;\">{total_returns}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- CHI TIẾT DOANH THU -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px; font-size: 14px;\">CHI TIẾT DOANH THU</div>\r\n  <table style=\"width: 100%; border-collapse: collapse;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Doanh thu bán hàng:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right; font-weight: bold;\">{sales_revenue}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Phí giao hàng thu được:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right;\">{delivery_revenue}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Thuế VAT:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right;\">{total_tax}</td>\r\n      </tr>\r\n      <tr style=\"background: #f5f5f5;\">\r\n        <td style=\"padding: 10px; font-weight: bold; font-size: 14px;\">TỔNG DOANH THU:</td>\r\n        <td style=\"padding: 10px; text-align: right; font-weight: bold; font-size: 16px;\">{total_revenue}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- THỐNG KÊ THANH TOÁN -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px; font-size: 14px;\">THỐNG KÊ THANH TOÁN</div>\r\n  <table style=\"width: 100%; border-collapse: collapse;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Tiền mặt:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right; font-weight: bold;\">{cash_amount}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Chuyển khoản:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right;\">{bank_transfer_amount}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Thẻ tín dụng:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right;\">{card_amount}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">Ví điện tử:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right;\">{ewallet_amount}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333;\">COD:</td>\r\n        <td style=\"padding: 8px; border-bottom: 1px solid #333; text-align: right;\">{cod_amount}</td>\r\n      </tr>\r\n      <tr style=\"background: #f5f5f5;\">\r\n        <td style=\"padding: 10px; font-weight: bold;\">TỔNG THU:</td>\r\n        <td style=\"padding: 10px; text-align: right; font-weight: bold; font-size: 14px;\">{total_collected}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- TOP SẢN PHẨM BÁN CHẠY -->\r\n<div style=\"margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px; color: #333; font-size: 14px;\">TOP SẢN PHẨM BÁN CHẠY</div>\r\n  <table style=\"width: 100%; border-collapse: collapse;\">\r\n    <thead>\r\n      <tr style=\"background: #f5f5f5;\">\r\n        <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n        <th style=\"padding: 10px; border: 1px solid #333; text-align: left;\">Sản phẩm</th>\r\n        <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 80px;\">SL bán</th>\r\n        <th style=\"padding: 10px; border: 1px solid #333; text-align: right; width: 120px;\">Doanh thu</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n        <td style=\"padding: 8px; border: 1px solid #333;\">{line_product_name}</td>\r\n        <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold;\">{line_quantity}</td>\r\n        <td style=\"padding: 8px; border: 1px solid #333; text-align: right;\">{line_amount}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 40px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI LẬP BÁO CÁO</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n        <div>{account_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">QUẢN LÝ XÁC NHẬN</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 60px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: center;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,yBAAyB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyJvC,CAAC"}},
    {"offset": {"line": 10422, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/warranty-request.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu yêu cầu bảo hành (Extended) - TipTap compatible\r\n */\r\nexport const WARRANTY_REQUEST_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">{store_address}</div>\r\n  <div style=\"color: #666;\">Hotline: {store_phone_number}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU YÊU CẦU BẢO HÀNH</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Số: <strong>{warranty_request_code}</strong></div>\r\n  <div>Ngày tiếp nhận: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- THÔNG TIN KHÁCH HÀNG -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">THÔNG TIN KHÁCH HÀNG</div>\r\n  <table style=\"width: 100%;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 5px 0; width: 25%;\"><strong>Họ tên:</strong></td>\r\n        <td style=\"padding: 5px 0;\"><strong>{customer_name}</strong></td>\r\n        <td style=\"padding: 5px 0; width: 20%;\"><strong>Mã KH:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{customer_code}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Điện thoại:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{customer_phone_number}</td>\r\n        <td style=\"padding: 5px 0;\"><strong>Email:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{customer_email}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Địa chỉ:</strong></td>\r\n        <td style=\"padding: 5px 0;\" colspan=\"3\">{customer_address}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- THÔNG TIN SẢN PHẨM -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">THÔNG TIN SẢN PHẨM BẢO HÀNH</div>\r\n  <table style=\"width: 100%;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 5px 0; width: 25%;\"><strong>Sản phẩm:</strong></td>\r\n        <td style=\"padding: 5px 0;\"><strong>{product_name}</strong></td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Mã SP:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{product_code}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Serial/IMEI:</strong></td>\r\n        <td style=\"padding: 5px 0;\"><strong>{serial_number}</strong></td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Mã đơn hàng gốc:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{order_code}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Ngày mua:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{purchase_date}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Thời hạn BH:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{warranty_duration}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Hết hạn BH:</strong></td>\r\n        <td style=\"padding: 5px 0;\"><strong>{warranty_expired_on}</strong></td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- TÌNH TRẠNG LỖI -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">TÌNH TRẠNG LỖI</div>\r\n  <table style=\"width: 100%;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 5px 0; width: 25%;\"><strong>Loại lỗi:</strong></td>\r\n        <td style=\"padding: 5px 0;\"><strong>{issue_type}</strong></td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0; vertical-align: top;\"><strong>Mô tả lỗi:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{issue_description}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Tình trạng máy:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{device_condition}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Phụ kiện kèm:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{accessories}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- TRẠNG THÁI XỬ LÝ -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #d9d9d9; font-weight: bold;\">Trạng thái:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #d9d9d9;\"><strong style=\"color: #eb2f96;\">{status}</strong></td>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #d9d9d9; font-weight: bold;\">Ưu tiên:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #d9d9d9;\">{priority}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #d9d9d9; font-weight: bold;\">Người tiếp nhận:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #d9d9d9;\">{received_by}</td>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #d9d9d9; font-weight: bold;\">Kỹ thuật viên:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #d9d9d9;\">{technician_name}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #d9d9d9; font-weight: bold;\">Dự kiến hoàn thành:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #d9d9d9;\" colspan=\"3\">{expected_completion_date}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú:</strong> {note}\r\n</div>\r\n\r\n<!-- QUY ĐỊNH BẢO HÀNH -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333; font-size: 11px;\">\r\n  <strong>QUY ĐỊNH BẢO HÀNH:</strong>\r\n  <ul style=\"margin: 5px 0 0 15px; padding: 0;\">\r\n    <li>Thời gian xử lý: 7-14 ngày làm việc (tùy mức độ lỗi)</li>\r\n    <li>Khách hàng vui lòng mang theo phiếu này khi nhận máy</li>\r\n    <li>Cửa hàng không chịu trách nhiệm nếu máy không được nhận trong 30 ngày</li>\r\n    <li>Hotline hỗ trợ: {store_phone_number}</li>\r\n  </ul>\r\n</div>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">KHÁCH HÀNG</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký xác nhận)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div>{customer_name}</div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NHÂN VIÊN TIẾP NHẬN</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n        <div>{received_by}</div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"margin-top: 15px; padding-top: 8px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; text-align: center;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,4BAA4B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyK1C,CAAC"}},
    {"offset": {"line": 10605, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/packing-request.ts"],"sourcesContent":["/**\r\n * Mẫu in Phiếu yêu cầu đóng gói (Extended) - TipTap compatible\r\n */\r\nexport const PACKING_REQUEST_TEMPLATE = `\r\n<div style=\"font-family: Arial, sans-serif; font-size: 12px; line-height: 1.4; max-width: 800px; margin: 0 auto; padding: 10px;\">\r\n\r\n<!-- HEADER -->\r\n<div style=\"text-align: center; margin-bottom: 10px;\">\r\n  <div style=\"margin-bottom: 5px;\">{store_logo}</div>\r\n  <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 2px;\">{store_name}</div>\r\n  <div style=\"color: #666;\">Kho: {location_name}</div>\r\n</div>\r\n\r\n<!-- TIÊU ĐỀ -->\r\n<h2 style=\"text-align: center; margin: 20px 0 10px 0; font-size: 18px; text-transform: uppercase; border-bottom: 2px solid #333; padding-bottom: 10px;\">PHIẾU YÊU CẦU ĐÓNG GÓI</h2>\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <div style=\"font-size: 14px;\">Mã yêu cầu: <strong>{packing_request_code}</strong></div>\r\n  <div>Đơn hàng: <strong>{order_code}</strong></div>\r\n  <div>Ngày tạo: {created_on} {created_on_time}</div>\r\n</div>\r\n\r\n<!-- ĐỘ ƯU TIÊN -->\r\n<div style=\"text-align: center; margin-bottom: 20px;\">\r\n  <span style=\"background: #f5f5f5; border: 1px solid #333; padding: 8px 20px; font-weight: bold; font-size: 14px;\">\r\n    ĐỘ ƯU TIÊN: {priority}\r\n  </span>\r\n</div>\r\n\r\n<!-- THÔNG TIN GIAO HÀNG -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">THÔNG TIN GIAO HÀNG</div>\r\n  <table style=\"width: 100%;\">\r\n    <tbody>\r\n      <tr>\r\n        <td style=\"padding: 5px 0; width: 25%;\"><strong>Người nhận:</strong></td>\r\n        <td style=\"padding: 5px 0;\"><strong>{customer_name}</strong></td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Điện thoại:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{customer_phone_number}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Địa chỉ:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{shipping_address}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Đơn vị VC:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{carrier_name}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style=\"padding: 5px 0;\"><strong>Dịch vụ:</strong></td>\r\n        <td style=\"padding: 5px 0;\">{service_name}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- DANH SÁCH SẢN PHẨM CẦN ĐÓNG GÓI -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;\">\r\n  <thead>\r\n    <tr style=\"background: #f5f5f5;\">\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 40px;\">STT</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Mã SP</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: left;\">Tên sản phẩm</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">SL</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 100px;\">Vị trí kho</th>\r\n      <th style=\"padding: 10px; border: 1px solid #333; text-align: center; width: 60px;\">Lấy</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center;\">{line_stt}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-family: monospace;\">{line_variant_code}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{line_product_name}<br><small style=\"color: #666;\">{line_variant}</small></td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold; font-size: 16px;\">{line_quantity}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-weight: bold;\">{bin_location}</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333; text-align: center; font-size: 20px;\">[ ]</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- THỐNG KÊ -->\r\n<table style=\"width: 250px; margin-left: auto; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 10px; border: 1px solid #333; background: #f5f5f5; font-weight: bold;\">Tổng số lượng:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right; font-weight: bold; font-size: 16px;\">{total_quantity}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 10px; border: 1px solid #333;\">Tổng khối lượng:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right;\">{total_weight} g</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 10px; border: 1px solid #333;\">COD thu hộ:</td>\r\n      <td style=\"padding: 10px; border: 1px solid #333; text-align: right; font-weight: bold;\">{cod}</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- YÊU CẦU ĐẶC BIỆT -->\r\n<div style=\"background: #f5f5f5; border: 1px solid #333; padding: 15px; margin-bottom: 20px;\">\r\n  <div style=\"font-weight: bold; margin-bottom: 10px;\">YÊU CẦU ĐẶC BIỆT</div>\r\n  <div>{special_request}</div>\r\n</div>\r\n\r\n<!-- GHI CHÚ -->\r\n<div style=\"margin-bottom: 20px; padding: 12px; background: #f5f5f5; border: 1px solid #333;\">\r\n  <strong>Ghi chú đóng gói:</strong> {packing_note}\r\n</div>\r\n\r\n<!-- TRẠNG THÁI -->\r\n<table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Trạng thái:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\"><strong>{status}</strong></td>\r\n      <td style=\"padding: 8px; width: 25%; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Người được gán:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\">{assigned_employee}</td>\r\n    </tr>\r\n    <tr>\r\n      <td style=\"padding: 8px; background: #f5f5f5; border: 1px solid #333; font-weight: bold;\">Thời hạn:</td>\r\n      <td style=\"padding: 8px; border: 1px solid #333;\" colspan=\"3\"><strong>{deadline}</strong></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- CHỮ KÝ -->\r\n<table style=\"width: 100%; margin-top: 30px;\">\r\n  <tbody>\r\n    <tr>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">NGƯỜI ĐÓNG GÓI</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n      <td style=\"width: 50%; text-align: center; padding: 10px; vertical-align: top;\">\r\n        <div style=\"font-weight: bold; margin-bottom: 5px;\">KIỂM TRA</div>\r\n        <div style=\"color: #888; font-size: 12px; font-style: italic;\">(Ký, ghi rõ họ tên)</div>\r\n        <div style=\"height: 50px;\"></div>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n<!-- FOOTER -->\r\n<div style=\"text-align: center; margin-top: 15px; padding-top: 8px; border-top: 1px dashed #333; font-size: 10px; color: #666;\">\r\n  In lúc: {print_date} {print_time}\r\n</div>\r\n\r\n</div>\r\n`;\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM,2BAA2B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmJzC,CAAC"}},
    {"offset": {"line": 10766, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/attendance.ts"],"sourcesContent":["/**\r\n * Attendance Template - Bảng chấm công\r\n * Mẫu in mặc định cho bảng chấm công\r\n * \r\n * CHUẨN TEMPLATE v3 (2025-12-10):\r\n * - Dạng DỌC (portrait) - mỗi nhân viên 1 tờ A4\r\n * - Compact: Chia 2 nửa tháng theo chiều ngang\r\n * - Font nhỏ gọn, vừa 1 trang\r\n */\r\n\r\n// Template cho BÁO CÁO CÁ NHÂN (mỗi nhân viên 1 trang)\r\nexport const ATTENDANCE_TEMPLATE = `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <style>\r\n    * { margin: 0; padding: 0; box-sizing: border-box; }\r\n    body { \r\n      font-family: Arial, sans-serif; \r\n      font-size: 9px; \r\n      line-height: 1.2;\r\n      padding: 8mm;\r\n    }\r\n    @page { size: A4 portrait; margin: 8mm; }\r\n    .page-break { page-break-after: always; }\r\n    \r\n    .header { \r\n      display: flex;\r\n      align-items: center;\r\n      margin-bottom: 8px;\r\n      gap: 10px;\r\n    }\r\n    .store-logo {\r\n      max-width: 40px;\r\n      max-height: 40px;\r\n    }\r\n    .store-info-container { flex: 1; }\r\n    .store-name { \r\n      font-size: 11px; \r\n      font-weight: bold; \r\n    }\r\n    .store-info { \r\n      font-size: 8px; \r\n      color: #333;\r\n    }\r\n    \r\n    .title { \r\n      font-size: 13px; \r\n      font-weight: bold; \r\n      text-align: center;\r\n      margin: 8px 0 4px 0;\r\n      text-transform: uppercase;\r\n    }\r\n    .subtitle {\r\n      font-size: 11px;\r\n      text-align: center;\r\n      margin-bottom: 8px;\r\n      font-weight: bold;\r\n    }\r\n    \r\n    .employee-info {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-bottom: 8px;\r\n      padding: 6px 10px;\r\n      background: #f0f0f0;\r\n      border-radius: 3px;\r\n      font-size: 9px;\r\n    }\r\n    .info-group { display: flex; gap: 20px; }\r\n    .info-item strong { font-weight: bold; }\r\n    \r\n    .legend {\r\n      margin: 6px 0;\r\n      font-size: 8px;\r\n      color: #666;\r\n    }\r\n    .legend span { margin-right: 10px; }\r\n    \r\n    .tables-container {\r\n      display: flex;\r\n      gap: 8px;\r\n    }\r\n    .half-month {\r\n      flex: 1;\r\n    }\r\n    .half-month h4 {\r\n      font-size: 9px;\r\n      text-align: center;\r\n      margin-bottom: 4px;\r\n      background: #333;\r\n      color: white;\r\n      padding: 3px;\r\n    }\r\n    \r\n    table { \r\n      width: 100%; \r\n      border-collapse: collapse; \r\n      font-size: 8px;\r\n    }\r\n    th, td { \r\n      border: 1px solid #999; \r\n      padding: 2px 3px; \r\n      text-align: center;\r\n    }\r\n    th { \r\n      background: #e0e0e0; \r\n      font-weight: bold;\r\n      font-size: 7px;\r\n    }\r\n    .col-day { width: 22px; }\r\n    .col-dow { width: 22px; }\r\n    .col-status { width: 28px; }\r\n    .col-time { width: 38px; font-size: 7px; }\r\n    \r\n    .summary-section {\r\n      margin: 10px 0;\r\n      display: flex;\r\n      gap: 10px;\r\n    }\r\n    .summary-box {\r\n      flex: 1;\r\n      padding: 6px 10px;\r\n      background: #f5f5f5;\r\n      border-radius: 3px;\r\n      border: 1px solid #ddd;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      font-size: 9px;\r\n    }\r\n    .summary-box strong {\r\n      font-size: 11px;\r\n    }\r\n    \r\n    .footer { \r\n      margin-top: 15px;\r\n      display: flex;\r\n      justify-content: space-between;\r\n    }\r\n    .signature-box {\r\n      width: 30%;\r\n      text-align: center;\r\n    }\r\n    .signature-title {\r\n      font-weight: bold;\r\n      font-size: 9px;\r\n      margin-bottom: 35px;\r\n    }\r\n    .signature-line {\r\n      border-top: 1px dotted #333;\r\n      padding-top: 3px;\r\n      font-size: 8px;\r\n    }\r\n    \r\n    .print-date {\r\n      font-size: 8px;\r\n      color: #666;\r\n      text-align: right;\r\n      margin-top: 10px;\r\n    }\r\n    \r\n    @media print {\r\n      body { padding: 5mm; }\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  {{#line_items}}\r\n  <div class=\"employee-page\">\r\n    <!-- Header -->\r\n    <div class=\"header\">\r\n      <img src=\"{store_logo}\" class=\"store-logo\" onerror=\"this.style.display='none'\">\r\n      <div class=\"store-info-container\">\r\n        <div class=\"store-name\">{store_name}</div>\r\n        <div class=\"store-info\">{store_address} | ĐT: {store_phone_number}</div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"title\">BẢNG CHẤM CÔNG CÁ NHÂN</div>\r\n    <div class=\"subtitle\">Tháng {month_year}</div>\r\n\r\n    <!-- Thông tin nhân viên -->\r\n    <div class=\"employee-info\">\r\n      <div class=\"info-group\">\r\n        <div class=\"info-item\"><strong>Mã NV:</strong> {employee_code}</div>\r\n        <div class=\"info-item\"><strong>Họ tên:</strong> {employee_name}</div>\r\n      </div>\r\n      <div class=\"info-group\">\r\n        <div class=\"info-item\"><strong>Phòng ban:</strong> {department_name}</div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Chú thích -->\r\n    <div class=\"legend\">\r\n      <span>✓ Có mặt</span>\r\n      <span>X Vắng</span>\r\n      <span>P Nghỉ phép</span>\r\n      <span>½ Nửa ngày</span>\r\n      <span>L Nghỉ lễ</span>\r\n      <span>- Cuối tuần/Chưa đến</span>\r\n    </div>\r\n\r\n    <!-- 2 bảng song song: Nửa đầu + Nửa cuối tháng -->\r\n    <div class=\"tables-container\">\r\n      <!-- Nửa đầu tháng (1-15) -->\r\n      <div class=\"half-month\">\r\n        <h4>Ngày 1 - 15</h4>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th class=\"col-day\">Ngày</th>\r\n              <th class=\"col-dow\">Thứ</th>\r\n              <th class=\"col-status\">TT</th>\r\n              <th class=\"col-time\">Vào</th>\r\n              <th class=\"col-time\">Ra</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr><td>1</td><td>{dow_1}</td><td>{day_1}</td><td>{checkin_1}</td><td>{checkout_1}</td></tr>\r\n            <tr><td>2</td><td>{dow_2}</td><td>{day_2}</td><td>{checkin_2}</td><td>{checkout_2}</td></tr>\r\n            <tr><td>3</td><td>{dow_3}</td><td>{day_3}</td><td>{checkin_3}</td><td>{checkout_3}</td></tr>\r\n            <tr><td>4</td><td>{dow_4}</td><td>{day_4}</td><td>{checkin_4}</td><td>{checkout_4}</td></tr>\r\n            <tr><td>5</td><td>{dow_5}</td><td>{day_5}</td><td>{checkin_5}</td><td>{checkout_5}</td></tr>\r\n            <tr><td>6</td><td>{dow_6}</td><td>{day_6}</td><td>{checkin_6}</td><td>{checkout_6}</td></tr>\r\n            <tr><td>7</td><td>{dow_7}</td><td>{day_7}</td><td>{checkin_7}</td><td>{checkout_7}</td></tr>\r\n            <tr><td>8</td><td>{dow_8}</td><td>{day_8}</td><td>{checkin_8}</td><td>{checkout_8}</td></tr>\r\n            <tr><td>9</td><td>{dow_9}</td><td>{day_9}</td><td>{checkin_9}</td><td>{checkout_9}</td></tr>\r\n            <tr><td>10</td><td>{dow_10}</td><td>{day_10}</td><td>{checkin_10}</td><td>{checkout_10}</td></tr>\r\n            <tr><td>11</td><td>{dow_11}</td><td>{day_11}</td><td>{checkin_11}</td><td>{checkout_11}</td></tr>\r\n            <tr><td>12</td><td>{dow_12}</td><td>{day_12}</td><td>{checkin_12}</td><td>{checkout_12}</td></tr>\r\n            <tr><td>13</td><td>{dow_13}</td><td>{day_13}</td><td>{checkin_13}</td><td>{checkout_13}</td></tr>\r\n            <tr><td>14</td><td>{dow_14}</td><td>{day_14}</td><td>{checkin_14}</td><td>{checkout_14}</td></tr>\r\n            <tr><td>15</td><td>{dow_15}</td><td>{day_15}</td><td>{checkin_15}</td><td>{checkout_15}</td></tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- Nửa cuối tháng (16-31) -->\r\n      <div class=\"half-month\">\r\n        <h4>Ngày 16 - 31</h4>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th class=\"col-day\">Ngày</th>\r\n              <th class=\"col-dow\">Thứ</th>\r\n              <th class=\"col-status\">TT</th>\r\n              <th class=\"col-time\">Vào</th>\r\n              <th class=\"col-time\">Ra</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr><td>16</td><td>{dow_16}</td><td>{day_16}</td><td>{checkin_16}</td><td>{checkout_16}</td></tr>\r\n            <tr><td>17</td><td>{dow_17}</td><td>{day_17}</td><td>{checkin_17}</td><td>{checkout_17}</td></tr>\r\n            <tr><td>18</td><td>{dow_18}</td><td>{day_18}</td><td>{checkin_18}</td><td>{checkout_18}</td></tr>\r\n            <tr><td>19</td><td>{dow_19}</td><td>{day_19}</td><td>{checkin_19}</td><td>{checkout_19}</td></tr>\r\n            <tr><td>20</td><td>{dow_20}</td><td>{day_20}</td><td>{checkin_20}</td><td>{checkout_20}</td></tr>\r\n            <tr><td>21</td><td>{dow_21}</td><td>{day_21}</td><td>{checkin_21}</td><td>{checkout_21}</td></tr>\r\n            <tr><td>22</td><td>{dow_22}</td><td>{day_22}</td><td>{checkin_22}</td><td>{checkout_22}</td></tr>\r\n            <tr><td>23</td><td>{dow_23}</td><td>{day_23}</td><td>{checkin_23}</td><td>{checkout_23}</td></tr>\r\n            <tr><td>24</td><td>{dow_24}</td><td>{day_24}</td><td>{checkin_24}</td><td>{checkout_24}</td></tr>\r\n            <tr><td>25</td><td>{dow_25}</td><td>{day_25}</td><td>{checkin_25}</td><td>{checkout_25}</td></tr>\r\n            <tr><td>26</td><td>{dow_26}</td><td>{day_26}</td><td>{checkin_26}</td><td>{checkout_26}</td></tr>\r\n            <tr><td>27</td><td>{dow_27}</td><td>{day_27}</td><td>{checkin_27}</td><td>{checkout_27}</td></tr>\r\n            <tr><td>28</td><td>{dow_28}</td><td>{day_28}</td><td>{checkin_28}</td><td>{checkout_28}</td></tr>\r\n            <tr><td>29</td><td>{dow_29}</td><td>{day_29}</td><td>{checkin_29}</td><td>{checkout_29}</td></tr>\r\n            <tr><td>30</td><td>{dow_30}</td><td>{day_30}</td><td>{checkin_30}</td><td>{checkout_30}</td></tr>\r\n            <tr><td>31</td><td>{dow_31}</td><td>{day_31}</td><td>{checkin_31}</td><td>{checkout_31}</td></tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Tổng kết -->\r\n    <div class=\"summary-section\">\r\n      <div class=\"summary-box\"><span>Ngày công:</span> <strong>{work_days}</strong></div>\r\n      <div class=\"summary-box\"><span>Nghỉ phép:</span> <strong>{leave_days}</strong></div>\r\n      <div class=\"summary-box\"><span>Vắng mặt:</span> <strong>{absent_days}</strong></div>\r\n      <div class=\"summary-box\"><span>Đi trễ:</span> <strong>{late_arrivals}</strong></div>\r\n      <div class=\"summary-box\"><span>Về sớm:</span> <strong>{early_departures}</strong></div>\r\n      <div class=\"summary-box\"><span>Giờ làm thêm:</span> <strong>{ot_hours}h</strong></div>\r\n    </div>\r\n\r\n    <!-- Chữ ký -->\r\n    <div class=\"footer\">\r\n      <div class=\"signature-box\">\r\n        <div class=\"signature-title\">Nhân viên</div>\r\n        <div class=\"signature-line\">(Ký, ghi rõ họ tên)</div>\r\n      </div>\r\n      <div class=\"signature-box\">\r\n        <div class=\"signature-title\">Trưởng phòng</div>\r\n        <div class=\"signature-line\">(Ký, ghi rõ họ tên)</div>\r\n      </div>\r\n      <div class=\"signature-box\">\r\n        <div class=\"signature-title\">Giám đốc</div>\r\n        <div class=\"signature-line\">(Ký, đóng dấu)</div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"print-date\">Ngày in: {print_date}</div>\r\n  </div>\r\n  <div class=\"page-break\"></div>\r\n  {{/line_items}}\r\n</body>\r\n</html>`;\r\n\r\n\r\n// ============================================\r\n// Template cho BÁO CÁO TỔNG HỢP (nhiều nhân viên - dạng ngang)\r\n// ============================================\r\nexport const ATTENDANCE_SUMMARY_TEMPLATE = `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <style>\r\n    * { margin: 0; padding: 0; box-sizing: border-box; }\r\n    body { \r\n      font-family: Arial, sans-serif; \r\n      font-size: 8px; \r\n      line-height: 1.2;\r\n      padding: 5mm;\r\n    }\r\n    @page { size: A4 landscape; margin: 5mm; }\r\n    \r\n    .header { \r\n      display: flex;\r\n      align-items: center;\r\n      margin-bottom: 8px;\r\n      gap: 10px;\r\n    }\r\n    .store-logo {\r\n      max-width: 40px;\r\n      max-height: 40px;\r\n    }\r\n    .store-name { \r\n      font-size: 11px; \r\n      font-weight: bold; \r\n    }\r\n    .store-info { \r\n      font-size: 8px; \r\n      color: #333;\r\n    }\r\n    \r\n    .title { \r\n      font-size: 14px; \r\n      font-weight: bold; \r\n      text-align: center;\r\n      margin: 5px 0;\r\n      text-transform: uppercase;\r\n    }\r\n    .subtitle {\r\n      font-size: 10px;\r\n      text-align: center;\r\n      margin-bottom: 8px;\r\n    }\r\n    \r\n    .legend {\r\n      font-size: 7px;\r\n      margin-bottom: 5px;\r\n      color: #666;\r\n    }\r\n    \r\n    table { \r\n      width: 100%; \r\n      border-collapse: collapse; \r\n      font-size: 7px;\r\n    }\r\n    th, td { \r\n      border: 1px solid #999; \r\n      padding: 2px; \r\n      text-align: center;\r\n    }\r\n    th { \r\n      background: #e0e0e0; \r\n      font-weight: bold;\r\n    }\r\n    .col-name { \r\n      text-align: left; \r\n      padding-left: 3px !important;\r\n      min-width: 80px;\r\n    }\r\n    \r\n    .summary {\r\n      margin-top: 8px;\r\n      font-size: 9px;\r\n    }\r\n    \r\n    .footer { \r\n      margin-top: 15px;\r\n      display: flex;\r\n      justify-content: space-between;\r\n    }\r\n    .signature-box {\r\n      width: 25%;\r\n      text-align: center;\r\n    }\r\n    .signature-title {\r\n      font-weight: bold;\r\n      font-size: 9px;\r\n      margin-bottom: 30px;\r\n    }\r\n    \r\n    .print-date {\r\n      font-size: 7px;\r\n      color: #666;\r\n      text-align: right;\r\n      margin-top: 8px;\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  <div class=\"header\">\r\n    <img src=\"{store_logo}\" class=\"store-logo\" onerror=\"this.style.display='none'\">\r\n    <div>\r\n      <div class=\"store-name\">{store_name}</div>\r\n      <div class=\"store-info\">{store_address}</div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"title\">BẢNG CHẤM CÔNG TỔNG HỢP</div>\r\n  <div class=\"subtitle\">Tháng {month_year} | Phòng ban: {department_name}</div>\r\n\r\n  <div class=\"legend\">\r\n    ✓ = Có mặt | X = Vắng | P = Nghỉ phép | ½ = Nửa ngày | L = Nghỉ lễ | - = Cuối tuần\r\n  </div>\r\n\r\n  <table>\r\n    <thead>\r\n      <tr>\r\n        <th rowspan=\"2\">STT</th>\r\n        <th rowspan=\"2\">Mã NV</th>\r\n        <th rowspan=\"2\" class=\"col-name\">Họ và tên</th>\r\n        <th colspan=\"4\">Tổng kết</th>\r\n        <th colspan=\"31\">Ngày trong tháng</th>\r\n      </tr>\r\n      <tr>\r\n        <th>Công</th>\r\n        <th>Phép</th>\r\n        <th>Vắng</th>\r\n        <th>OT</th>\r\n        <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th>\r\n        <th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th>\r\n        <th>16</th><th>17</th><th>18</th><th>19</th><th>20</th><th>21</th><th>22</th>\r\n        <th>23</th><th>24</th><th>25</th><th>26</th><th>27</th><th>28</th><th>29</th><th>30</th><th>31</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      {{#line_items}}\r\n      <tr>\r\n        <td>{line_index}</td>\r\n        <td>{employee_code}</td>\r\n        <td class=\"col-name\">{employee_name}</td>\r\n        <td>{work_days}</td>\r\n        <td>{leave_days}</td>\r\n        <td>{absent_days}</td>\r\n        <td>{ot_hours}</td>\r\n        <td>{day_1}</td><td>{day_2}</td><td>{day_3}</td><td>{day_4}</td><td>{day_5}</td><td>{day_6}</td><td>{day_7}</td>\r\n        <td>{day_8}</td><td>{day_9}</td><td>{day_10}</td><td>{day_11}</td><td>{day_12}</td><td>{day_13}</td><td>{day_14}</td><td>{day_15}</td>\r\n        <td>{day_16}</td><td>{day_17}</td><td>{day_18}</td><td>{day_19}</td><td>{day_20}</td><td>{day_21}</td><td>{day_22}</td>\r\n        <td>{day_23}</td><td>{day_24}</td><td>{day_25}</td><td>{day_26}</td><td>{day_27}</td><td>{day_28}</td><td>{day_29}</td><td>{day_30}</td><td>{day_31}</td>\r\n      </tr>\r\n      {{/line_items}}\r\n    </tbody>\r\n  </table>\r\n\r\n  <div class=\"summary\">\r\n    <strong>Tổng cộng:</strong> {total_employees} nhân viên | \r\n    {total_work_days} công | {total_leave_days} phép | {total_absent_days} vắng | {total_ot_hours}h OT\r\n  </div>\r\n\r\n  <div class=\"footer\">\r\n    <div class=\"signature-box\">\r\n      <div class=\"signature-title\">Người lập</div>\r\n    </div>\r\n    <div class=\"signature-box\">\r\n      <div class=\"signature-title\">Kế toán</div>\r\n    </div>\r\n    <div class=\"signature-box\">\r\n      <div class=\"signature-title\">Trưởng phòng</div>\r\n    </div>\r\n    <div class=\"signature-box\">\r\n      <div class=\"signature-title\">Giám đốc</div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"print-date\">Ngày in: {print_date}</div>\r\n</body>\r\n</html>`;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;CAQC,GAED,uDAAuD;;;;;;;AAChD,MAAM,sBAAsB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAoS7B,CAAC;AAMD,MAAM,8BAA8B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAiLrC,CAAC"}},
    {"offset": {"line": 11259, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/templates/index.ts"],"sourcesContent":["// =============================================\r\n// EXPORT ALL DEFAULT TEMPLATES\r\n// =============================================\r\n\r\n// MAIN TEMPLATES (16 loại chính)\r\nexport { ORDER_TEMPLATE } from './order';\r\nexport { QUOTE_TEMPLATE } from './quote';\r\nexport { RECEIPT_TEMPLATE } from './receipt';\r\nexport { PAYMENT_TEMPLATE } from './payment';\r\nexport { WARRANTY_TEMPLATE } from './warranty';\r\nexport { INVENTORY_CHECK_TEMPLATE } from './inventory-check';\r\nexport { STOCK_TRANSFER_TEMPLATE } from './stock-transfer';\r\nexport { SALES_RETURN_TEMPLATE } from './sales-return';\r\nexport { PURCHASE_ORDER_TEMPLATE } from './purchase-order';\r\nexport { PACKING_TEMPLATE } from './packing';\r\nexport { DELIVERY_TEMPLATE } from './delivery';\r\nexport { SHIPPING_LABEL_TEMPLATE } from './shipping-label';\r\nexport { PRODUCT_LABEL_TEMPLATE } from './product-label';\r\nexport { STOCK_IN_TEMPLATE } from './stock-in';\r\nexport { SUPPLIER_RETURN_TEMPLATE } from './supplier-return';\r\nexport { COMPLAINT_TEMPLATE } from './complaint';\r\nexport { PENALTY_TEMPLATE } from './penalty';\r\nexport { COST_ADJUSTMENT_TEMPLATE } from './cost-adjustment';\r\nexport { PAYROLL_TEMPLATE } from './payroll';\r\nexport { PAYSLIP_TEMPLATE } from './payslip';\r\n\r\n// EXTENDED TEMPLATES (8 loại mở rộng - MỚI)\r\nexport { SUPPLIER_ORDER_TEMPLATE } from './supplier-order';\r\nexport { RETURN_ORDER_TEMPLATE } from './return-order';\r\nexport { HANDOVER_TEMPLATE } from './handover';\r\nexport { REFUND_CONFIRMATION_TEMPLATE } from './refund-confirmation';\r\nexport { PACKING_GUIDE_TEMPLATE } from './packing-guide';\r\nexport { SALES_SUMMARY_TEMPLATE } from './sales-summary';\r\nexport { WARRANTY_REQUEST_TEMPLATE } from './warranty-request';\r\nexport { PACKING_REQUEST_TEMPLATE } from './packing-request';\r\n\r\nimport { TemplateType } from '../types';\r\n\r\n// =============================================\r\n// IMPORT ALL TEMPLATES\r\n// =============================================\r\n\r\n// Main Templates\r\nimport { ORDER_TEMPLATE } from './order';\r\nimport { QUOTE_TEMPLATE } from './quote';\r\nimport { RECEIPT_TEMPLATE } from './receipt';\r\nimport { PAYMENT_TEMPLATE } from './payment';\r\nimport { WARRANTY_TEMPLATE } from './warranty';\r\nimport { INVENTORY_CHECK_TEMPLATE } from './inventory-check';\r\nimport { STOCK_TRANSFER_TEMPLATE } from './stock-transfer';\r\nimport { SALES_RETURN_TEMPLATE } from './sales-return';\r\nimport { PURCHASE_ORDER_TEMPLATE } from './purchase-order';\r\nimport { PACKING_TEMPLATE } from './packing';\r\nimport { DELIVERY_TEMPLATE } from './delivery';\r\nimport { SHIPPING_LABEL_TEMPLATE } from './shipping-label';\r\nimport { PRODUCT_LABEL_TEMPLATE } from './product-label';\r\nimport { STOCK_IN_TEMPLATE } from './stock-in';\r\nimport { SUPPLIER_RETURN_TEMPLATE } from './supplier-return';\r\nimport { COMPLAINT_TEMPLATE } from './complaint';\r\nimport { PENALTY_TEMPLATE } from './penalty';\r\nimport { COST_ADJUSTMENT_TEMPLATE } from './cost-adjustment';\r\nimport { PAYROLL_TEMPLATE } from './payroll';\r\nimport { PAYSLIP_TEMPLATE } from './payslip';\r\nimport { ATTENDANCE_TEMPLATE } from './attendance';\r\n\r\n// Extended Templates\r\nimport { SUPPLIER_ORDER_TEMPLATE } from './supplier-order';\r\nimport { RETURN_ORDER_TEMPLATE } from './return-order';\r\nimport { HANDOVER_TEMPLATE } from './handover';\r\nimport { REFUND_CONFIRMATION_TEMPLATE } from './refund-confirmation';\r\nimport { PACKING_GUIDE_TEMPLATE } from './packing-guide';\r\nimport { SALES_SUMMARY_TEMPLATE } from './sales-summary';\r\nimport { WARRANTY_REQUEST_TEMPLATE } from './warranty-request';\r\nimport { PACKING_REQUEST_TEMPLATE } from './packing-request';\r\n\r\n// =============================================\r\n// MAP TEMPLATE TYPE TO DEFAULT TEMPLATE CONTENT\r\n// =============================================\r\n\r\n// Main Templates (16 loại trong TEMPLATE_TYPES)\r\nexport const DEFAULT_TEMPLATES: Record<TemplateType, string> = {\r\n  'order': ORDER_TEMPLATE,\r\n  'quote': QUOTE_TEMPLATE,\r\n  'receipt': RECEIPT_TEMPLATE,\r\n  'payment': PAYMENT_TEMPLATE,\r\n  'warranty': WARRANTY_TEMPLATE,\r\n  'inventory-check': INVENTORY_CHECK_TEMPLATE,\r\n  'stock-transfer': STOCK_TRANSFER_TEMPLATE,\r\n  'sales-return': SALES_RETURN_TEMPLATE,\r\n  'purchase-order': PURCHASE_ORDER_TEMPLATE,\r\n  'packing': PACKING_TEMPLATE,\r\n  'delivery': DELIVERY_TEMPLATE,\r\n  'shipping-label': SHIPPING_LABEL_TEMPLATE,\r\n  'product-label': PRODUCT_LABEL_TEMPLATE,\r\n  'stock-in': STOCK_IN_TEMPLATE,\r\n  'supplier-return': SUPPLIER_RETURN_TEMPLATE,\r\n  'complaint': COMPLAINT_TEMPLATE,\r\n  'penalty': PENALTY_TEMPLATE,\r\n  'leave': PENALTY_TEMPLATE, // TODO: Create dedicated LEAVE_TEMPLATE\r\n  'cost-adjustment': COST_ADJUSTMENT_TEMPLATE,\r\n  'handover': HANDOVER_TEMPLATE,\r\n  'payroll': PAYROLL_TEMPLATE,\r\n  'payslip': PAYSLIP_TEMPLATE,\r\n  'attendance': ATTENDANCE_TEMPLATE,\r\n};\r\n\r\n// Extended Templates (8 loại mở rộng)\r\nexport const EXTENDED_TEMPLATES: Record<string, string> = {\r\n  'supplier-order': SUPPLIER_ORDER_TEMPLATE,\r\n  'return-order': RETURN_ORDER_TEMPLATE,\r\n  'refund-confirmation': REFUND_CONFIRMATION_TEMPLATE,\r\n  'packing-guide': PACKING_GUIDE_TEMPLATE,\r\n  'sales-summary': SALES_SUMMARY_TEMPLATE,\r\n  'warranty-request': WARRANTY_REQUEST_TEMPLATE,\r\n  'packing-request': PACKING_REQUEST_TEMPLATE,\r\n};\r\n\r\n// Get default template by type (includes extended types)\r\nexport function getDefaultTemplate(type: TemplateType | string): string {\r\n  if (type in DEFAULT_TEMPLATES) {\r\n    return DEFAULT_TEMPLATES[type as TemplateType];\r\n  }\r\n  if (type in EXTENDED_TEMPLATES) {\r\n    return EXTENDED_TEMPLATES[type];\r\n  }\r\n  return '';\r\n}\r\n\r\n// Get all template types\r\nexport function getAllTemplateTypes(): string[] {\r\n  return [\r\n    ...Object.keys(DEFAULT_TEMPLATES),\r\n    ...Object.keys(EXTENDED_TEMPLATES),\r\n  ];\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA,gDAAgD;AAChD,+BAA+B;AAC/B,gDAAgD;AAEhD,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA6BA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiBO,MAAM,oBAAkD;IAC7D,SAAS,0KAAc;IACvB,SAAS,0KAAc;IACvB,WAAW,8KAAgB;IAC3B,WAAW,8KAAgB;IAC3B,YAAY,gLAAiB;IAC7B,mBAAmB,iMAAwB;IAC3C,kBAAkB,+LAAuB;IACzC,gBAAgB,2LAAqB;IACrC,kBAAkB,+LAAuB;IACzC,WAAW,8KAAgB;IAC3B,YAAY,gLAAiB;IAC7B,kBAAkB,+LAAuB;IACzC,iBAAiB,6LAAsB;IACvC,YAAY,mLAAiB;IAC7B,mBAAmB,iMAAwB;IAC3C,aAAa,kLAAkB;IAC/B,WAAW,8KAAgB;IAC3B,SAAS,8KAAgB;IACzB,mBAAmB,iMAAwB;IAC3C,YAAY,gLAAiB;IAC7B,WAAW,8KAAgB;IAC3B,WAAW,8KAAgB;IAC3B,cAAc,oLAAmB;AACnC;AAGO,MAAM,qBAA6C;IACxD,kBAAkB,+LAAuB;IACzC,gBAAgB,2LAAqB;IACrC,uBAAuB,yMAA4B;IACnD,iBAAiB,6LAAsB;IACvC,iBAAiB,6LAAsB;IACvC,oBAAoB,mMAAyB;IAC7C,mBAAmB,iMAAwB;AAC7C;AAGO,SAAS,mBAAmB,IAA2B;IAC5D,IAAI,QAAQ,mBAAmB;QAC7B,OAAO,iBAAiB,CAAC,KAAqB;IAChD;IACA,IAAI,QAAQ,oBAAoB;QAC9B,OAAO,kBAAkB,CAAC,KAAK;IACjC;IACA,OAAO;AACT;AAGO,SAAS;IACd,OAAO;WACF,OAAO,IAAI,CAAC;WACZ,OAAO,IAAI,CAAC;KAChB;AACH"}},
    {"offset": {"line": 11416, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/default-templates.ts"],"sourcesContent":["// Re-export từ templates/index.ts - các template mới đã được tối ưu với inline styles\r\n// Các template này tương thích với TipTap editor và preview\r\nexport { DEFAULT_TEMPLATES, getDefaultTemplate } from './templates';\r\n"],"names":[],"mappings":";AAAA,sFAAsF;AACtF,4DAA4D;AAC5D"}},
    {"offset": {"line": 11428, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/printer/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { PrintTemplate, TemplateType, PaperSize } from './types';\r\nimport { getDefaultTemplate } from './default-templates';\r\n\r\n// Key format: \"type-size-branchId\" e.g. \"order-A4-branch1\" or \"type-size\" for all branches\r\ntype TemplateKey = string;\r\n\r\ninterface PrintTemplateState {\r\n  templates: Record<TemplateKey, PrintTemplate>;\r\n  defaultSizes: Record<TemplateType, PaperSize>; // Khổ in mặc định cho mỗi loại mẫu\r\n  initialized: boolean;\r\n  \r\n  // Actions\r\n  getTemplate: (type: TemplateType, size: PaperSize, branchId?: string) => PrintTemplate;\r\n  updateTemplate: (type: TemplateType, size: PaperSize, content: string, branchId?: string) => void;\r\n  updateTemplateAllBranches: (type: TemplateType, size: PaperSize, content: string) => void;\r\n  resetTemplate: (type: TemplateType, size: PaperSize, branchId?: string) => void;\r\n  setDefaultSize: (type: TemplateType, size: PaperSize) => void;\r\n  getDefaultSize: (type: TemplateType) => PaperSize;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst getTemplateKey = (type: TemplateType, size: PaperSize, branchId?: string): TemplateKey => \r\n  branchId ? `${type}-${size}-${branchId}` : `${type}-${size}`;\r\n\r\n// API sync helper\r\nasync function syncTemplateToAPI(template: PrintTemplate, action: 'create' | 'update' | 'delete'): Promise<boolean> {\r\n  try {\r\n    const response = await fetch('/api/settings/print-templates', {\r\n      method: action === 'create' ? 'POST' : action === 'delete' ? 'DELETE' : 'PUT',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(template),\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('syncTemplateToAPI error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport const usePrintTemplateStore = create<PrintTemplateState>()(\r\n  (set, get) => ({\r\n    templates: {} as Record<TemplateKey, PrintTemplate>,\r\n    defaultSizes: {} as Record<TemplateType, PaperSize>,\r\n    initialized: false,\r\n\r\n      getTemplate: (type: TemplateType, size: PaperSize, branchId?: string) => {\r\n        const state = get();\r\n        const key = getTemplateKey(type, size, branchId);\r\n        \r\n        // Thử tìm template cho branch cụ thể\r\n        const branchTemplate = state.templates[key];\r\n        if (branchTemplate && branchTemplate.content && branchTemplate.content.trim() !== '') {\r\n          // Auto-reset payroll templates nếu phát hiện dùng syntax cũ\r\n          // - {{#line_items}} : Mustache syntax không được hỗ trợ\r\n          // - {line_index} : biến cũ, phải dùng {line_stt}\r\n          if ((type === 'payroll' || type === 'payslip') && \r\n              (branchTemplate.content.includes('{{#line_items}}') || branchTemplate.content.includes('{line_index}'))) {\r\n            // Template đang dùng syntax cũ không được hỗ trợ -> reset về mặc định\r\n            return {\r\n              id: `template-${key}`,\r\n              type,\r\n              name: type === 'payroll' ? 'Bảng lương' : 'Phiếu lương',\r\n              content: getDefaultTemplate(type),\r\n              paperSize: size,\r\n              isActive: true,\r\n              updatedAt: new Date().toISOString(),\r\n            };\r\n          }\r\n          return branchTemplate;\r\n        }\r\n        \r\n        // Nếu không có template cho branch, tìm template chung\r\n        const generalKey = getTemplateKey(type, size);\r\n        const generalTemplate = state.templates[generalKey];\r\n        if (branchId && generalTemplate && generalTemplate.content && generalTemplate.content.trim() !== '') {\r\n          // Auto-reset payroll templates nếu phát hiện dùng syntax cũ\r\n          if ((type === 'payroll' || type === 'payslip') && \r\n              (generalTemplate.content.includes('{{#line_items}}') || generalTemplate.content.includes('{line_index}'))) {\r\n            return {\r\n              id: `template-${key}`,\r\n              type,\r\n              name: type === 'payroll' ? 'Bảng lương' : 'Phiếu lương',\r\n              content: getDefaultTemplate(type),\r\n              paperSize: size,\r\n              isActive: true,\r\n              updatedAt: new Date().toISOString(),\r\n            };\r\n          }\r\n          return generalTemplate;\r\n        }\r\n        \r\n        // Return default template if not exists or empty\r\n        // Đây là điểm quan trọng: nếu chưa có template hoặc template trống\r\n        // thì sử dụng mẫu mặc định của hệ thống\r\n        return {\r\n          id: `template-${key}`,\r\n          type,\r\n          name: type === 'order' ? 'Mẫu hóa đơn bán hàng' : 'Mẫu in',\r\n          content: getDefaultTemplate(type),\r\n          paperSize: size,\r\n          isActive: true,\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n      },\r\n\r\n      updateTemplate: (type, size, content, branchId?) => {\r\n        const key = getTemplateKey(type, size, branchId);\r\n        set((state) => {\r\n          const current = state.templates[key] || {\r\n            id: `template-${key}`,\r\n            type,\r\n            name: 'Mẫu in',\r\n            content: getDefaultTemplate(type),\r\n            paperSize: size,\r\n            isActive: true,\r\n            updatedAt: new Date().toISOString(),\r\n          };\r\n\r\n          return {\r\n            templates: {\r\n              ...state.templates,\r\n              [key]: {\r\n                ...current,\r\n                content,\r\n                updatedAt: new Date().toISOString(),\r\n              },\r\n            },\r\n          };\r\n        });\r\n      },\r\n\r\n      updateTemplateAllBranches: (type, size, content) => {\r\n        // Lưu template chung (không có branchId) - sẽ áp dụng cho tất cả chi nhánh\r\n        const key = getTemplateKey(type, size);\r\n        set((state) => {\r\n          // Xóa tất cả template cụ thể của các branch cho type và size này\r\n          const newTemplates = { ...state.templates };\r\n          Object.keys(newTemplates).forEach((k) => {\r\n            if (k.startsWith(`${type}-${size}-`)) {\r\n              delete newTemplates[k];\r\n            }\r\n          });\r\n\r\n          return {\r\n            templates: {\r\n              ...newTemplates,\r\n              [key]: {\r\n                id: `template-${key}`,\r\n                type,\r\n                name: 'Mẫu in',\r\n                content,\r\n                paperSize: size,\r\n                isActive: true,\r\n                updatedAt: new Date().toISOString(),\r\n              },\r\n            },\r\n          };\r\n        });\r\n      },\r\n\r\n      resetTemplate: (type, size, branchId?) => {\r\n        const key = getTemplateKey(type, size, branchId);\r\n        set((state) => ({\r\n          templates: {\r\n            ...state.templates,\r\n            [key]: {\r\n              id: `template-${key}`,\r\n              type,\r\n              name: 'Mẫu mặc định',\r\n              content: getDefaultTemplate(type),\r\n              paperSize: size,\r\n              isActive: true,\r\n              updatedAt: new Date().toISOString(),\r\n            },\r\n          },\r\n        }));\r\n      },\r\n\r\n      setDefaultSize: (type: TemplateType, size: PaperSize) => {\r\n        set((state) => ({\r\n          defaultSizes: {\r\n            ...state.defaultSizes,\r\n            [type]: size,\r\n          },\r\n        }));\r\n      },\r\n\r\n      getDefaultSize: (type: TemplateType) => {\r\n        const state = get();\r\n        return state.defaultSizes[type] || 'A4';\r\n      },\r\n\r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        try {\r\n          const response = await fetch('/api/settings/print-templates');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            if (json.data) {\r\n              set({ \r\n                templates: json.data.templates || {},\r\n                defaultSizes: json.data.defaultSizes || {},\r\n                initialized: true,\r\n              });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('loadFromAPI error:', error);\r\n        }\r\n        set({ initialized: true });\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11623, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/print-service.ts"],"sourcesContent":["import { usePrintTemplateStore } from '@/features/settings/printer/store';\r\nimport { TemplateType, PaperSize } from '@/features/settings/printer/types';\r\nimport { formatDateForDisplay, formatTimeForDisplay, formatDateTimeForDisplay } from '@/lib/date-utils';\r\nimport { getGeneralSettingsSync } from '@/lib/settings-cache';\r\n\r\n// ============================================\r\n// HELPER FUNCTIONS\r\n// ============================================\r\n\r\n/**\r\n * Lấy general-settings từ cache (loaded from database)\r\n */\r\nexport function getGeneralSettings(): {\r\n  companyName?: string;\r\n  companyAddress?: string;\r\n  phoneNumber?: string;\r\n  email?: string;\r\n  website?: string;\r\n  taxCode?: string;\r\n  logoUrl?: string;\r\n  storeName?: string;\r\n  storeAddress?: string;\r\n  storePhone?: string;\r\n} | null {\r\n  try {\r\n    const settings = getGeneralSettingsSync();\r\n    return {\r\n      companyName: settings.storeName,\r\n      companyAddress: settings.storeAddress,\r\n      phoneNumber: settings.storePhone,\r\n      storeName: settings.storeName,\r\n      storeAddress: settings.storeAddress,\r\n      storePhone: settings.storePhone,\r\n      logoUrl: settings.logoUrl,\r\n    };\r\n  } catch (e) { /* ignore */ }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Lấy logo từ general-settings (fallback khi storeInfo không có logo)\r\n */\r\nexport function getStoreLogo(storeInfoLogo?: string): string | undefined {\r\n  if (storeInfoLogo) return storeInfoLogo;\r\n  try {\r\n    const settings = getGeneralSettingsSync();\r\n    return settings.logoUrl || undefined;\r\n  } catch (e) { /* ignore */ }\r\n  return undefined;\r\n}\r\n\r\n/**\r\n * Format số tiền theo định dạng VN\r\n */\r\nexport function formatCurrency(amount: number | undefined | null): string {\r\n  if (amount === undefined || amount === null) return '0';\r\n  return new Intl.NumberFormat('vi-VN').format(amount);\r\n}\r\n\r\n/**\r\n * Chuyển số sang chữ tiếng Việt\r\n */\r\nexport function numberToWords(amount: number | undefined | null): string {\r\n  if (!amount || amount === 0) return 'Không đồng';\r\n  \r\n  const units = ['', 'một', 'hai', 'ba', 'bốn', 'năm', 'sáu', 'bảy', 'tám', 'chín'];\r\n  const positions = ['', 'nghìn', 'triệu', 'tỷ', 'nghìn tỷ', 'triệu tỷ'];\r\n  \r\n  const readThreeDigits = (num: number): string => {\r\n    const hundred = Math.floor(num / 100);\r\n    const ten = Math.floor((num % 100) / 10);\r\n    const unit = num % 10;\r\n    \r\n    let result = '';\r\n    \r\n    if (hundred > 0) {\r\n      result += units[hundred] + ' trăm ';\r\n    }\r\n    \r\n    if (ten > 1) {\r\n      result += units[ten] + ' mươi ';\r\n      if (unit === 1) {\r\n        result += 'mốt ';\r\n      } else if (unit === 5) {\r\n        result += 'lăm ';\r\n      } else if (unit > 0) {\r\n        result += units[unit] + ' ';\r\n      }\r\n    } else if (ten === 1) {\r\n      result += 'mười ';\r\n      if (unit === 5) {\r\n        result += 'lăm ';\r\n      } else if (unit > 0) {\r\n        result += units[unit] + ' ';\r\n      }\r\n    } else if (ten === 0 && hundred > 0 && unit > 0) {\r\n      result += 'lẻ ' + units[unit] + ' ';\r\n    } else if (unit > 0) {\r\n      result += units[unit] + ' ';\r\n    }\r\n    \r\n    return result.trim();\r\n  };\r\n  \r\n  let result = '';\r\n  let num = Math.abs(Math.round(amount));\r\n  let posIndex = 0;\r\n  \r\n  while (num > 0) {\r\n    const threeDigits = num % 1000;\r\n    if (threeDigits > 0) {\r\n      const words = readThreeDigits(threeDigits);\r\n      result = words + ' ' + positions[posIndex] + ' ' + result;\r\n    }\r\n    num = Math.floor(num / 1000);\r\n    posIndex++;\r\n  }\r\n  \r\n  result = result.trim();\r\n  // Capitalize first letter\r\n  result = result.charAt(0).toUpperCase() + result.slice(1) + ' đồng';\r\n  \r\n  if (amount < 0) {\r\n    result = 'Âm ' + result;\r\n  }\r\n  \r\n  return result;\r\n}\r\n\r\n/**\r\n * Format ngày theo định dạng dd/MM/yyyy\r\n * Uses centralized date-utils for consistent formatting\r\n */\r\nexport function formatDate(date: string | Date | undefined | null): string {\r\n  return formatDateForDisplay(date);\r\n}\r\n\r\n/**\r\n * Format giờ theo định dạng HH:mm\r\n * Uses centralized date-utils for consistent formatting\r\n */\r\nexport function formatTime(date: string | Date | undefined | null): string {\r\n  return formatTimeForDisplay(date);\r\n}\r\n\r\n/**\r\n * Format ngày giờ đầy đủ\r\n * Uses centralized date-utils for consistent formatting\r\n */\r\nexport function formatDateTime(date: string | Date | undefined | null): string {\r\n  return formatDateTimeForDisplay(date);\r\n}\r\n\r\n// ============================================\r\n// PRINT SERVICE\r\n// ============================================\r\n\r\n/**\r\n * CSS styles cho in ấn\r\n */\r\nconst PRINT_STYLES = `\r\n  * { box-sizing: border-box; }\r\n  body { \r\n    font-family: 'Times New Roman', Times, serif;\r\n    font-size: 13px;\r\n    line-height: 1.5;\r\n    margin: 0;\r\n    padding: 20px;\r\n    color: #000;\r\n  }\r\n  h1, h2, h3, h4 { margin: 0.5em 0; }\r\n  h2 { font-size: 18px; font-weight: bold; }\r\n  p { margin: 0.3em 0; }\r\n  table { \r\n    width: 100%; \r\n    border-collapse: collapse; \r\n    margin: 10px 0;\r\n  }\r\n  th, td { \r\n    border: 1px solid #333; \r\n    padding: 6px 8px; \r\n    text-align: left;\r\n    vertical-align: top;\r\n  }\r\n  th { \r\n    background: #f0f0f0; \r\n    font-weight: bold;\r\n  }\r\n  strong { font-weight: bold; }\r\n  em { font-style: italic; }\r\n  hr { border: none; border-top: 1px solid #333; margin: 10px 0; }\r\n  ul { margin: 0.5em 0; padding-left: 25px; list-style-type: disc; }\r\n  ol { margin: 0.5em 0; padding-left: 25px; list-style-type: decimal; }\r\n  li { margin: 0.2em 0; display: list-item; }\r\n  img { max-width: 100%; height: auto; }\r\n  @media print { \r\n    body { padding: 0; } \r\n    @page { margin: 15mm; }\r\n  }\r\n`;\r\n\r\n/**\r\n * Interface cho dữ liệu in\r\n */\r\nexport interface PrintData {\r\n  [key: string]: string | number | boolean | undefined | null | PrintLineItem[];\r\n}\r\n\r\nexport interface PrintLineItem {\r\n  [key: string]: string | number | boolean | undefined | null;\r\n}\r\n\r\n/**\r\n * Replace tất cả variables trong template với data\r\n */\r\nexport function replaceVariables(template: string, data: PrintData): string {\r\n  let result = template;\r\n  \r\n  // Replace các biến đơn lẻ\r\n  Object.entries(data).forEach(([key, value]) => {\r\n    // Nếu không phải array (line items), replace trực tiếp\r\n    if (!Array.isArray(value)) {\r\n      const placeholder = key.startsWith('{') ? key : `{${key}}`;\r\n      const stringValue = value?.toString() || '';\r\n      result = result.split(placeholder).join(stringValue);\r\n    }\r\n  });\r\n  \r\n  return result;\r\n}\r\n\r\n/**\r\n * Tạo HTML rows cho line items (sản phẩm trong đơn hàng)\r\n * Template row sẽ được nhân bản cho mỗi item\r\n */\r\nexport function generateLineItemsHtml(\r\n  templateRow: string, \r\n  items: PrintLineItem[],\r\n  startIndex: number = 1\r\n): string {\r\n  return items.map((item, index) => {\r\n    let row = templateRow;\r\n    \r\n    // Replace {line_stt} với số thứ tự\r\n    row = row.replace(/{line_stt}/g, (startIndex + index).toString());\r\n    \r\n    // Replace các biến line_* khác\r\n    Object.entries(item).forEach(([key, value]) => {\r\n      const placeholder = key.startsWith('{') ? key : `{${key}}`;\r\n      const stringValue = value?.toString() || '';\r\n      row = row.split(placeholder).join(stringValue);\r\n    });\r\n    \r\n    return row;\r\n  }).join('\\n');\r\n}\r\n\r\n/**\r\n * Tạo nội dung HTML để in từ template và data\r\n */\r\nexport function generatePrintHtml(\r\n  templateType: TemplateType,\r\n  data: PrintData,\r\n  branchId?: string\r\n): string {\r\n  const store = usePrintTemplateStore.getState();\r\n  const defaultSize = store.getDefaultSize(templateType);\r\n  const template = store.getTemplate(templateType, defaultSize, branchId);\r\n  \r\n  let html = template.content;\r\n  \r\n  // Replace variables\r\n  html = replaceVariables(html, data);\r\n  \r\n  return html;\r\n}\r\n\r\n/**\r\n * In document với template\r\n */\r\nexport function printDocument(\r\n  templateType: TemplateType,\r\n  data: PrintData,\r\n  options?: {\r\n    branchId?: string;\r\n    paperSize?: PaperSize;\r\n    title?: string;\r\n  }\r\n): void {\r\n  const store = usePrintTemplateStore.getState();\r\n  const paperSize = options?.paperSize || store.getDefaultSize(templateType);\r\n  const template = store.getTemplate(templateType, paperSize, options?.branchId);\r\n  \r\n  // Generate HTML content\r\n  let html = replaceVariables(template.content, data);\r\n  \r\n  // Tạo iframe ẩn để in\r\n  const printFrame = document.createElement('iframe');\r\n  printFrame.style.position = 'absolute';\r\n  printFrame.style.top = '-10000px';\r\n  printFrame.style.left = '-10000px';\r\n  document.body.appendChild(printFrame);\r\n  \r\n  const printDoc = printFrame.contentDocument || printFrame.contentWindow?.document;\r\n  if (printDoc) {\r\n    const title = options?.title || `In ${templateType}`;\r\n    \r\n    printDoc.write(`\r\n      <!DOCTYPE html>\r\n      <html>\r\n      <head>\r\n        <title>${title}</title>\r\n        <style>${PRINT_STYLES}</style>\r\n      </head>\r\n      <body>${html}</body>\r\n      </html>\r\n    `);\r\n    printDoc.close();\r\n    \r\n    // Đợi load xong rồi in\r\n    setTimeout(() => {\r\n      printFrame.contentWindow?.print();\r\n      // Xóa iframe sau khi in\r\n      setTimeout(() => {\r\n        if (document.body.contains(printFrame)) {\r\n          document.body.removeChild(printFrame);\r\n        }\r\n      }, 1000);\r\n    }, 100);\r\n  }\r\n}\r\n\r\n/**\r\n * Preview document (trả về HTML string)\r\n */\r\nexport function getPreviewHtml(\r\n  templateType: TemplateType,\r\n  data: PrintData,\r\n  options?: {\r\n    branchId?: string;\r\n    paperSize?: PaperSize;\r\n  }\r\n): string {\r\n  const store = usePrintTemplateStore.getState();\r\n  const paperSize = options?.paperSize || store.getDefaultSize(templateType);\r\n  const template = store.getTemplate(templateType, paperSize, options?.branchId);\r\n  \r\n  return replaceVariables(template.content, data);\r\n}\r\n\r\n// ============================================\r\n// DATA MAPPERS - Chuyển đổi data từ entity sang print data\r\n// ============================================\r\n\r\n/**\r\n * Base interface cho store settings (cần import từ settings store)\r\n */\r\nexport interface StoreSettings {\r\n  name?: string;\r\n  address?: string;\r\n  phone?: string;\r\n  hotline?: string;\r\n  email?: string;\r\n  logo?: string;\r\n  fax?: string;\r\n  province?: string;\r\n  website?: string;\r\n  taxCode?: string;\r\n}\r\n\r\n/**\r\n * Tạo data cho thông tin cửa hàng\r\n */\r\nexport function getStoreData(settings: StoreSettings): PrintData {\r\n  const now = new Date();\r\n  const logo = getStoreLogo(settings.logo);\r\n  return {\r\n    '{store_logo}': logo \r\n      ? `<img src=\"${logo}\" alt=\"Logo\" style=\"max-height:60px\"/>` \r\n      : '',\r\n    '{store_name}': settings.name || '',\r\n    '{store_address}': settings.address || '',\r\n    '{store_phone_number}': settings.phone || '',\r\n    '{hotline}': settings.hotline || settings.phone || '',\r\n    '{store_hotline}': settings.hotline || settings.phone || '',\r\n    '{store_email}': settings.email || '',\r\n    '{store_fax}': settings.fax || '',\r\n    '{store_website}': settings.website || '',\r\n    '{store_tax_code}': settings.taxCode || '',\r\n    // Print timestamp - always inject current time\r\n    '{print_date}': formatDate(now),\r\n    '{print_time}': formatTime(now),\r\n  };\r\n}\r\n\r\n/**\r\n * Export default cho tiện import\r\n */\r\nexport const PrintService = {\r\n  formatCurrency,\r\n  numberToWords,\r\n  formatDate,\r\n  formatTime,\r\n  formatDateTime,\r\n  replaceVariables,\r\n  generateLineItemsHtml,\r\n  generatePrintHtml,\r\n  printDocument,\r\n  getPreviewHtml,\r\n  getStoreData,\r\n  getStoreLogo,\r\n};\r\n\r\nexport default PrintService;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11936, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/use-print.ts"],"sourcesContent":["/**\r\n * Hook để sử dụng Print Service trong các component\r\n */\r\n\r\nimport * as React from 'react';\r\nimport type { TemplateType, PaperSize } from '../features/settings/printer/types';\r\nimport { \r\n  PrintData, \r\n  PrintLineItem,\r\n  replaceVariables,\r\n} from './print-service';\r\nimport { usePrintTemplateStore } from '../features/settings/printer/store';\r\n\r\ninterface PrintOptions {\r\n  /** Dữ liệu để thay thế biến trong template */\r\n  data: PrintData;\r\n  /** Line items (sản phẩm, hàng hóa) */\r\n  lineItems?: PrintLineItem[];\r\n  /** Khổ giấy cụ thể (nếu muốn override default) */\r\n  paperSize?: PaperSize;\r\n  /** Branch ID cụ thể (nếu muốn override current branch) */\r\n  branchId?: string;\r\n}\r\n\r\ninterface UsePrintResult {\r\n  /** Hàm in tài liệu */\r\n  print: (type: TemplateType, options: PrintOptions) => void;\r\n  /** Hàm in nhiều tài liệu cùng lúc (gộp thành 1 document) */\r\n  printMultiple: (type: TemplateType, optionsList: PrintOptions[]) => void;\r\n  /** Hàm in nhiều loại tài liệu khác nhau cùng lúc (gộp thành 1 popup) */\r\n  printMixedDocuments: (documents: Array<{ type: TemplateType; options: PrintOptions }>) => void;\r\n  /** Hàm lấy HTML preview */\r\n  getPreview: (type: TemplateType, options: PrintOptions) => string;\r\n  /** Kiểm tra template có tồn tại không */\r\n  hasTemplate: (type: TemplateType, paperSize?: PaperSize) => boolean;\r\n  /** Lấy danh sách khổ giấy có template */\r\n  getAvailableSizes: (type: TemplateType) => PaperSize[];\r\n  /** Lấy khổ giấy mặc định cho loại template */\r\n  getDefaultSize: (type: TemplateType) => PaperSize;\r\n  /** Đang loading template store */\r\n  isLoading: boolean;\r\n}\r\n\r\n/**\r\n * Kiểm tra giá trị có \"empty\" không (null, undefined, '', '0', 0)\r\n */\r\nfunction isEmptyValue(value: unknown): boolean {\r\n  if (value === undefined || value === null || value === '') return true;\r\n  // Coi '0' và các biến thể như empty\r\n  const strValue = String(value).trim();\r\n  if (strValue === '0' || strValue === '0đ' || strValue === '0 đ') return true;\r\n  return false;\r\n}\r\n\r\n/**\r\n * Xử lý các điều kiện trong template\r\n * Hỗ trợ:\r\n * - {{#if has_tax}}...{{/if}} - Điều kiện boolean\r\n * - {{#if_empty {field}}}...{{/if_empty}} - Nếu field rỗng\r\n * - {{#if_not_empty {field}}}...{{/if_not_empty}} - Nếu field không rỗng\r\n * - {{#if_gt {field} value}}...{{/if_gt}} - Nếu field > value (greater than)\r\n */\r\nfunction processConditionals(html: string, data: PrintData, lineItems?: PrintLineItem[]): string {\r\n  let result = html;\r\n\r\n  // 1. Xử lý {{#if_not_empty {field}}}...{{/if_not_empty}}\r\n  const ifNotEmptyPattern = /\\{\\{#if_not_empty\\s+\\{([^}]+)\\}\\}\\}([\\s\\S]*?)\\{\\{\\/if_not_empty\\}\\}/gi;\r\n  result = result.replace(ifNotEmptyPattern, (match, field, content) => {\r\n    const key = `{${field}}`;\r\n    const value = data[key];\r\n    if (!isEmptyValue(value)) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  // 2. Xử lý {{#if_empty {field}}}...{{/if_empty}}\r\n  const ifEmptyPattern = /\\{\\{#if_empty\\s+\\{([^}]+)\\}\\}\\}([\\s\\S]*?)\\{\\{\\/if_empty\\}\\}/gi;\r\n  result = result.replace(ifEmptyPattern, (match, field, content) => {\r\n    const key = `{${field}}`;\r\n    const value = data[key];\r\n    if (isEmptyValue(value)) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  // 3. Xử lý {{#if_gt {field} value}}...{{/if_gt}} (greater than 0)\r\n  const ifGtPattern = /\\{\\{#if_gt\\s+\\{([^}]+)\\}\\s+(\\d+)\\}\\}([\\s\\S]*?)\\{\\{\\/if_gt\\}\\}/gi;\r\n  result = result.replace(ifGtPattern, (match, field, compareValue, content) => {\r\n    const key = `{${field}}`;\r\n    const value = data[key];\r\n    // Parse số từ giá trị (loại bỏ dấu chấm, đ, etc.)\r\n    const numValue = parseFloat((value || '0').toString().replace(/[^\\d.-]/g, ''));\r\n    const numCompare = parseFloat(compareValue);\r\n    if (numValue > numCompare) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  // 4. Xử lý {{#if has_tax}}...{{/if}} - Boolean conditions\r\n  // has_tax = true nếu total_tax > 0\r\n  const hasTax = !isEmptyValue(data['{total_tax}']);\r\n  const hasDiscount = !isEmptyValue(data['{total_discount}']);\r\n  const hasDeliveryFee = !isEmptyValue(data['{delivery_fee}']);\r\n  const hasNote = !isEmptyValue(data['{order_note}']);\r\n\r\n  const booleanConditions: Record<string, boolean> = {\r\n    'has_tax': hasTax,\r\n    'has_discount': hasDiscount,\r\n    'has_delivery_fee': hasDeliveryFee,\r\n    'has_note': hasNote,\r\n    'has_shipping_address': !isEmptyValue(data['{shipping_address}']),\r\n    'has_customer_email': !isEmptyValue(data['{customer_email}']),\r\n    'has_customer_phone': !isEmptyValue(data['{customer_phone_number}']),\r\n  };\r\n\r\n  // Xử lý {{#if condition}}...{{/if}}\r\n  const ifPattern = /\\{\\{#if\\s+(\\w+)\\}\\}([\\s\\S]*?)\\{\\{\\/if\\}\\}/gi;\r\n  result = result.replace(ifPattern, (match, condition, content) => {\r\n    if (booleanConditions[condition]) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  // 5. Xử lý {{#unless condition}}...{{/unless}} (ngược lại với if)\r\n  const unlessPattern = /\\{\\{#unless\\s+(\\w+)\\}\\}([\\s\\S]*?)\\{\\{\\/unless\\}\\}/gi;\r\n  result = result.replace(unlessPattern, (match, condition, content) => {\r\n    if (!booleanConditions[condition]) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Xử lý điều kiện cho line items\r\n * Ví dụ: {{#line_if_not_empty {line_tax_amount}}}...{{/line_if_not_empty}}\r\n */\r\nfunction processLineItemConditionals(rowHtml: string, item: PrintLineItem): string {\r\n  let result = rowHtml;\r\n\r\n  // Xử lý {{#line_if_not_empty {field}}}...{{/line_if_not_empty}}\r\n  const lineIfNotEmptyPattern = /\\{\\{#line_if_not_empty\\s+\\{([^}]+)\\}\\}\\}([\\s\\S]*?)\\{\\{\\/line_if_not_empty\\}\\}/gi;\r\n  result = result.replace(lineIfNotEmptyPattern, (match, field, content) => {\r\n    const key = `{${field}}`;\r\n    const value = item[key];\r\n    if (!isEmptyValue(value)) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  // Xử lý {{#line_if_empty {field}}}...{{/line_if_empty}}\r\n  const lineIfEmptyPattern = /\\{\\{#line_if_empty\\s+\\{([^}]+)\\}\\}\\}([\\s\\S]*?)\\{\\{\\/line_if_empty\\}\\}/gi;\r\n  result = result.replace(lineIfEmptyPattern, (match, field, content) => {\r\n    const key = `{${field}}`;\r\n    const value = item[key];\r\n    if (isEmptyValue(value)) {\r\n      return content;\r\n    }\r\n    return '';\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Hook để sử dụng chức năng in trong các trang\r\n * @param currentBranchId - ID của branch hiện tại (optional)\r\n * @example\r\n * const { print, getPreview } = usePrint(currentBranch?.systemId);\r\n * \r\n * // In đơn hàng\r\n * print('order', {\r\n *   data: mapOrderToPrintData(order, storeSettings),\r\n *   lineItems: mapOrderLineItems(order.items),\r\n * });\r\n */\r\nexport function usePrint(currentBranchId?: string): UsePrintResult {\r\n  const templateStore = usePrintTemplateStore();\r\n  const [isLoading] = React.useState(false);\r\n\r\n  const getTemplateContent = React.useCallback((\r\n    type: TemplateType, \r\n    paperSize?: PaperSize, \r\n    branchId?: string\r\n  ): string | null => {\r\n    // Xác định paperSize sử dụng\r\n    const size = paperSize || templateStore.getDefaultSize(type);\r\n    const branch = branchId || currentBranchId;\r\n\r\n    // Lấy template\r\n    const template = templateStore.getTemplate(type, size, branch);\r\n    if (template?.content) {\r\n      return template.content;\r\n    }\r\n\r\n    // Fallback: thử lấy template không có branch\r\n    const defaultTemplate = templateStore.getTemplate(type, size);\r\n    return defaultTemplate?.content || null;\r\n  }, [templateStore, currentBranchId]);\r\n\r\n  const processTemplate = React.useCallback((\r\n    templateContent: string,\r\n    data: PrintData,\r\n    lineItems?: PrintLineItem[]\r\n  ): string => {\r\n    // Bước 1: Xử lý line items nếu có\r\n    let html = templateContent;\r\n    \r\n    console.log('[processTemplate] Starting, lineItems count:', lineItems?.length);\r\n    \r\n    if (lineItems && lineItems.length > 0) {\r\n      // === XỬ LÝ CÚ PHÁP {{#line_items}}...{{/line_items}} ===\r\n      // Dành cho template lặp toàn bộ section (mỗi employee 1 page)\r\n      const lineItemsBlockPattern = /\\{\\{#line_items\\}\\}([\\s\\S]*?)\\{\\{\\/line_items\\}\\}/gi;\r\n      const lineItemsBlockMatch = html.match(lineItemsBlockPattern);\r\n      \r\n      console.log('[processTemplate] Block match found:', !!lineItemsBlockMatch, lineItemsBlockMatch?.length);\r\n      \r\n      if (lineItemsBlockMatch && lineItemsBlockMatch.length > 0) {\r\n        // Có block {{#line_items}} - lặp cả block cho mỗi item\r\n        html = html.replace(lineItemsBlockPattern, (match, blockContent) => {\r\n          return lineItems.map((item, index) => {\r\n            let itemHtml = blockContent;\r\n            \r\n            // Thêm {line_index}\r\n            itemHtml = itemHtml.replace(/\\{line_index\\}/g, String(index + 1));\r\n            \r\n            // Replace các biến từ item (line item data)\r\n            Object.entries(item).forEach(([key, value]) => {\r\n              const placeholder = key.startsWith('{') ? key : `{${key}}`;\r\n              const regex = new RegExp(placeholder.replace(/[{}]/g, '\\\\$&'), 'g');\r\n              itemHtml = itemHtml.replace(regex, value?.toString() || '');\r\n            });\r\n            \r\n            // Replace các biến global (data) cho mỗi item page\r\n            Object.entries(data).forEach(([key, value]) => {\r\n              const placeholder = key.startsWith('{') ? key : `{${key}}`;\r\n              const regex = new RegExp(placeholder.replace(/[{}]/g, '\\\\$&'), 'g');\r\n              itemHtml = itemHtml.replace(regex, value?.toString() || '');\r\n            });\r\n            \r\n            return itemHtml;\r\n          }).join('\\n');\r\n        });\r\n        \r\n        // Đã xử lý xong line items theo block mode, skip table mode\r\n      } else {\r\n        // === XỬ LÝ TABLE MODE (cũ) ===\r\n        // Tìm tất cả các table trong template\r\n        const tablePattern = /<table[^>]*>[\\s\\S]*?<\\/table>/gi;\r\n        const tables = html.match(tablePattern);\r\n      \r\n        if (tables) {\r\n          // Tìm table chứa {line_stt} - đây là bảng line items\r\n          const lineItemsTable = tables.find(table => table.includes('{line_stt}'));\r\n        \r\n          if (lineItemsTable) {\r\n            // Tìm tbody trong table này\r\n            let tbodyMatch = lineItemsTable.match(/<tbody[^>]*>([\\s\\S]*?)<\\/tbody>/i);\r\n          \r\n            // Nếu không có tbody, có thể table chỉ có tr trực tiếp\r\n            // (một số template không dùng thead/tbody)\r\n            if (!tbodyMatch) {\r\n              // Tìm tất cả tr trong table (trừ tr trong thead)\r\n              const theadMatch = lineItemsTable.match(/<thead[^>]*>[\\s\\S]*?<\\/thead>/i);\r\n              let tableWithoutThead = lineItemsTable;\r\n              if (theadMatch) {\r\n                tableWithoutThead = lineItemsTable.replace(theadMatch[0], '');\r\n              }\r\n            \r\n              // Tìm tr chứa {line_stt}\r\n              const rowPattern = /<tr[^>]*>[\\s\\S]*?\\{line_stt\\}[\\s\\S]*?<\\/tr>/i;\r\n              const rowMatch = tableWithoutThead.match(rowPattern);\r\n            \r\n              if (rowMatch) {\r\n                const templateRow = rowMatch[0];\r\n              \r\n                // Tạo các row mới từ template\r\n                const rowsHtml = lineItems.map((item) => {\r\n                  let row = templateRow;\r\n                \r\n                  // Xử lý điều kiện cho line item trước\r\n                  row = processLineItemConditionals(row, item);\r\n                \r\n                  Object.entries(item).forEach(([key, value]) => {\r\n                    const placeholder = key.startsWith('{') ? key : `{${key}}`;\r\n                    const regex = new RegExp(placeholder.replace(/[{}]/g, '\\\\$&'), 'g');\r\n                    row = row.replace(regex, value?.toString() || '');\r\n                  });\r\n                  return row;\r\n                }).join('\\n    ');\r\n              \r\n                // Thay thế row mẫu bằng các rows mới\r\n                const newTable = lineItemsTable.replace(templateRow, rowsHtml);\r\n                html = html.replace(lineItemsTable, newTable);\r\n              }\r\n            } else {\r\n              // Có tbody - xử lý như cũ\r\n              const tbodyContent = tbodyMatch[1];\r\n            \r\n              // Tìm TẤT CẢ các row trong tbody\r\n              const allRowsPattern = /<tr[^>]*>[\\s\\S]*?<\\/tr>/gi;\r\n              const allRows = tbodyContent.match(allRowsPattern);\r\n            \r\n              if (allRows && allRows.length > 0) {\r\n                // Tìm row chứa {line_stt} - đây là row mẫu\r\n                const templateRow = allRows.find(row => row.includes('{line_stt}')) || allRows[0];\r\n              \r\n                // Tạo các row mới từ template\r\n                const rowsHtml = lineItems.map((item) => {\r\n                  let row = templateRow;\r\n                \r\n                  // Xử lý điều kiện cho line item trước\r\n                  row = processLineItemConditionals(row, item);\r\n                \r\n                  // Replace từng biến trong item\r\n                  Object.entries(item).forEach(([key, value]) => {\r\n                    const placeholder = key.startsWith('{') ? key : `{${key}}`;\r\n                    const regex = new RegExp(placeholder.replace(/[{}]/g, '\\\\$&'), 'g');\r\n                    row = row.replace(regex, value?.toString() || '');\r\n                  });\r\n                \r\n                  return row;\r\n                }).join('\\n    ');\r\n              \r\n                // Tạo tbody mới\r\n                const newTbody = `<tbody>\\n    ${rowsHtml}\\n  </tbody>`;\r\n              \r\n                // Thay thế tbody cũ trong table\r\n                const newTable = lineItemsTable.replace(tbodyMatch[0], newTbody);\r\n              \r\n                // Thay thế table cũ bằng table mới trong html\r\n                html = html.replace(lineItemsTable, newTable);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      } // End of else (TABLE MODE)\r\n    }\r\n\r\n    // Bước 2: Xử lý các điều kiện (conditionals)\r\n    html = processConditionals(html, data, lineItems);\r\n\r\n    // Bước 3: Thay thế các biến còn lại\r\n    html = replaceVariables(html, data);\r\n\r\n    return html;\r\n  }, []);\r\n\r\n  const print = React.useCallback((type: TemplateType, options: PrintOptions) => {\r\n    const { data, lineItems, paperSize, branchId } = options;\r\n\r\n    console.log('[usePrint] Starting print for type:', type);\r\n    console.log('[usePrint] Data keys:', Object.keys(data));\r\n    console.log('[usePrint] LineItems count:', lineItems?.length || 0);\r\n\r\n    // Lấy template content\r\n    const size = paperSize || templateStore.getDefaultSize(type);\r\n    const templateContent = getTemplateContent(type, size, branchId);\r\n    \r\n    if (!templateContent) {\r\n      console.error(`[usePrint] No template found for type: ${type}`);\r\n      return;\r\n    }\r\n\r\n    console.log('[usePrint] Template found, length:', templateContent.length);\r\n\r\n    // Xử lý template\r\n    let html: string;\r\n    try {\r\n      html = processTemplate(templateContent, data, lineItems);\r\n      console.log('[usePrint] Template processed, html length:', html.length);\r\n    } catch (err) {\r\n      console.error('[usePrint] Error processing template:', err);\r\n      return;\r\n    }\r\n\r\n    // Tạo iframe ẩn để in\r\n    const printFrame = document.createElement('iframe');\r\n    printFrame.style.position = 'absolute';\r\n    printFrame.style.top = '-10000px';\r\n    printFrame.style.left = '-10000px';\r\n    document.body.appendChild(printFrame);\r\n    \r\n    const printDoc = printFrame.contentDocument || printFrame.contentWindow?.document;\r\n    if (printDoc) {\r\n      // CSS cơ bản cho print - giống với Settings preview\r\n      const printCSS = `\r\n        body { font-family: Arial, sans-serif; font-size: 12px; line-height: 1.5; }\r\n        table { width: 100%; border-collapse: collapse; margin: 8px 0; }\r\n        th, td { border: 1px solid #333; padding: 6px 8px; }\r\n        th { background-color: #f5f5f5; font-weight: bold; }\r\n        .text-center, [style*=\"text-align: center\"] { text-align: center; }\r\n        .text-right, [style*=\"text-align: right\"] { text-align: right; }\r\n        img { max-width: 100%; height: auto; }\r\n        h1, h2, h3 { margin: 8px 0; }\r\n        p { margin: 4px 0; }\r\n      `;\r\n      \r\n      printDoc.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n          <title>In ${type}</title>\r\n          <style>${printCSS}</style>\r\n        </head>\r\n        <body>${html}</body>\r\n        </html>\r\n      `);\r\n      printDoc.close();\r\n      \r\n      // Đợi load xong rồi in\r\n      setTimeout(() => {\r\n        printFrame.contentWindow?.print();\r\n        // Xóa iframe sau khi in\r\n        setTimeout(() => {\r\n          if (document.body.contains(printFrame)) {\r\n            document.body.removeChild(printFrame);\r\n          }\r\n        }, 1000);\r\n      }, 100);\r\n    }\r\n  }, [getTemplateContent, processTemplate]);\r\n\r\n  /**\r\n   * In nhiều tài liệu cùng lúc - gộp thành 1 document với page break giữa các tài liệu\r\n   */\r\n  const printMultiple = React.useCallback((type: TemplateType, optionsList: PrintOptions[]) => {\r\n    if (optionsList.length === 0) return;\r\n\r\n    // Lấy template content (dùng paperSize của item đầu tiên hoặc default)\r\n    const firstOptions = optionsList[0];\r\n    const size = firstOptions.paperSize || templateStore.getDefaultSize(type);\r\n    const templateContent = getTemplateContent(type, size, firstOptions.branchId);\r\n    \r\n    if (!templateContent) {\r\n      console.error(`[usePrint] No template found for type: ${type}`);\r\n      return;\r\n    }\r\n\r\n    // Xử lý từng document và gộp lại với page break\r\n    const allHtmlParts = optionsList.map((options, index) => {\r\n      const html = processTemplate(templateContent, options.data, options.lineItems);\r\n      // Thêm page break sau mỗi document (trừ document cuối)\r\n      if (index < optionsList.length - 1) {\r\n        return `<div class=\"print-page\" style=\"page-break-after: always; break-after: page;\">${html}</div>`;\r\n      }\r\n      return `<div class=\"print-page-last\">${html}</div>`;\r\n    });\r\n\r\n    const combinedHtml = allHtmlParts.join('\\n');\r\n\r\n    // Tạo iframe ẩn để in\r\n    const printFrame = document.createElement('iframe');\r\n    printFrame.style.position = 'absolute';\r\n    printFrame.style.top = '-10000px';\r\n    printFrame.style.left = '-10000px';\r\n    document.body.appendChild(printFrame);\r\n    \r\n    const printDoc = printFrame.contentDocument || printFrame.contentWindow?.document;\r\n    if (printDoc) {\r\n      // CSS cơ bản cho print với page break\r\n      const printCSS = `\r\n        * { box-sizing: border-box; }\r\n        body { font-family: Arial, sans-serif; font-size: 12px; line-height: 1.5; margin: 0; padding: 0; }\r\n        table { width: 100%; border-collapse: collapse; margin: 8px 0; }\r\n        th, td { border: 1px solid #333; padding: 6px 8px; }\r\n        th { background-color: #f5f5f5; font-weight: bold; }\r\n        .text-center, [style*=\"text-align: center\"] { text-align: center; }\r\n        .text-right, [style*=\"text-align: right\"] { text-align: right; }\r\n        img { max-width: 100%; height: auto; }\r\n        h1, h2, h3 { margin: 8px 0; }\r\n        p { margin: 4px 0; }\r\n        .print-page { \r\n          page-break-after: always !important; \r\n          break-after: page !important;\r\n          page-break-inside: avoid;\r\n        }\r\n        .print-page-last { \r\n          page-break-after: auto; \r\n        }\r\n        @media print {\r\n          .print-page { \r\n            page-break-after: always !important; \r\n            break-after: page !important;\r\n          }\r\n          .print-page-last { \r\n            page-break-after: auto; \r\n          }\r\n        }\r\n      `;\r\n      \r\n      printDoc.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n          <title>In ${optionsList.length} ${type}</title>\r\n          <style>${printCSS}</style>\r\n        </head>\r\n        <body>${combinedHtml}</body>\r\n        </html>\r\n      `);\r\n      printDoc.close();\r\n      \r\n      // Đợi load xong rồi in\r\n      setTimeout(() => {\r\n        printFrame.contentWindow?.print();\r\n        // Xóa iframe sau khi in\r\n        setTimeout(() => {\r\n          if (document.body.contains(printFrame)) {\r\n            document.body.removeChild(printFrame);\r\n          }\r\n        }, 1000);\r\n      }, 100);\r\n    }\r\n  }, [templateStore, getTemplateContent, processTemplate]);\r\n\r\n  /**\r\n   * In nhiều loại tài liệu khác nhau cùng lúc - gộp thành 1 popup duy nhất\r\n   * Ví dụ: In đơn hàng + phiếu giao hàng + phiếu đóng gói trong 1 lần\r\n   */\r\n  const printMixedDocuments = React.useCallback((documents: Array<{ type: TemplateType; options: PrintOptions }>) => {\r\n    if (documents.length === 0) return;\r\n\r\n    // Xử lý từng document và gộp lại với page break\r\n    const allHtmlParts: string[] = [];\r\n    \r\n    documents.forEach((doc, docIndex) => {\r\n      const { type, options } = doc;\r\n      const { data, lineItems, paperSize, branchId } = options;\r\n      \r\n      // Lấy template content cho loại này\r\n      const size = paperSize || templateStore.getDefaultSize(type);\r\n      const templateContent = getTemplateContent(type, size, branchId);\r\n      \r\n      if (!templateContent) {\r\n        console.warn(`[printMixedDocuments] No template found for type: ${type}, skipping`);\r\n        return;\r\n      }\r\n      \r\n      const html = processTemplate(templateContent, data, lineItems);\r\n      \r\n      // Thêm page break sau mỗi document (trừ document cuối)\r\n      if (docIndex < documents.length - 1) {\r\n        allHtmlParts.push(`<div class=\"print-page\" style=\"page-break-after: always; break-after: page;\">${html}</div>`);\r\n      } else {\r\n        allHtmlParts.push(`<div class=\"print-page-last\">${html}</div>`);\r\n      }\r\n    });\r\n\r\n    if (allHtmlParts.length === 0) {\r\n      console.error('[printMixedDocuments] No documents to print');\r\n      return;\r\n    }\r\n\r\n    const combinedHtml = allHtmlParts.join('\\n');\r\n\r\n    // Tạo iframe ẩn để in\r\n    const printFrame = document.createElement('iframe');\r\n    printFrame.style.position = 'absolute';\r\n    printFrame.style.top = '-10000px';\r\n    printFrame.style.left = '-10000px';\r\n    document.body.appendChild(printFrame);\r\n    \r\n    const printDoc = printFrame.contentDocument || printFrame.contentWindow?.document;\r\n    if (printDoc) {\r\n      // CSS cơ bản cho print với page break\r\n      const printCSS = `\r\n        * { box-sizing: border-box; }\r\n        body { font-family: Arial, sans-serif; font-size: 12px; line-height: 1.5; margin: 0; padding: 0; }\r\n        table { width: 100%; border-collapse: collapse; margin: 8px 0; }\r\n        th, td { border: 1px solid #333; padding: 6px 8px; }\r\n        th { background-color: #f5f5f5; font-weight: bold; }\r\n        .text-center, [style*=\"text-align: center\"] { text-align: center; }\r\n        .text-right, [style*=\"text-align: right\"] { text-align: right; }\r\n        img { max-width: 100%; height: auto; }\r\n        h1, h2, h3 { margin: 8px 0; }\r\n        p { margin: 4px 0; }\r\n        .print-page { \r\n          page-break-after: always !important; \r\n          break-after: page !important;\r\n          page-break-inside: avoid;\r\n        }\r\n        .print-page-last { \r\n          page-break-after: auto; \r\n        }\r\n        @media print {\r\n          .print-page { \r\n            page-break-after: always !important; \r\n            break-after: page !important;\r\n          }\r\n          .print-page-last { \r\n            page-break-after: auto; \r\n          }\r\n        }\r\n      `;\r\n      \r\n      printDoc.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n          <title>In ${documents.length} tài liệu</title>\r\n          <style>${printCSS}</style>\r\n        </head>\r\n        <body>${combinedHtml}</body>\r\n        </html>\r\n      `);\r\n      printDoc.close();\r\n      \r\n      // Đợi load xong rồi in\r\n      setTimeout(() => {\r\n        printFrame.contentWindow?.print();\r\n        // Xóa iframe sau khi in\r\n        setTimeout(() => {\r\n          if (document.body.contains(printFrame)) {\r\n            document.body.removeChild(printFrame);\r\n          }\r\n        }, 1000);\r\n      }, 100);\r\n    }\r\n  }, [templateStore, getTemplateContent, processTemplate]);\r\n\r\n  const getPreview = React.useCallback((type: TemplateType, options: PrintOptions): string => {\r\n    const { data, lineItems, paperSize, branchId } = options;\r\n\r\n    // Lấy template content\r\n    const templateContent = getTemplateContent(type, paperSize, branchId);\r\n    if (!templateContent) {\r\n      return '<p style=\"color: red;\">Không tìm thấy mẫu in</p>';\r\n    }\r\n\r\n    // Xử lý template\r\n    return processTemplate(templateContent, data, lineItems);\r\n  }, [getTemplateContent, processTemplate]);\r\n\r\n  const hasTemplate = React.useCallback((type: TemplateType, paperSize?: PaperSize): boolean => {\r\n    const size = paperSize || templateStore.getDefaultSize(type);\r\n    const template = templateStore.getTemplate(type, size, currentBranchId);\r\n    return !!template?.content;\r\n  }, [templateStore, currentBranchId]);\r\n\r\n  const getAvailableSizes = React.useCallback((type: TemplateType): PaperSize[] => {\r\n    const sizes: PaperSize[] = ['K57', 'K80', 'A4', 'A5'];\r\n    return sizes.filter(size => {\r\n      const template = templateStore.getTemplate(type, size, currentBranchId);\r\n      return !!template?.content;\r\n    });\r\n  }, [templateStore, currentBranchId]);\r\n\r\n  const getDefaultSize = React.useCallback((type: TemplateType): PaperSize => {\r\n    return templateStore.getDefaultSize(type);\r\n  }, [templateStore]);\r\n\r\n  return {\r\n    print,\r\n    printMultiple,\r\n    printMixedDocuments,\r\n    getPreview,\r\n    hasTemplate,\r\n    getAvailableSizes,\r\n    getDefaultSize,\r\n    isLoading,\r\n  };\r\n}\r\n\r\nexport type { PrintOptions, UsePrintResult };\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 12564, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/departments/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Department } from './types';\r\n\r\nexport const useDepartmentStore = createCrudStore<Department>([], 'departments', {\r\n  apiEndpoint: '/api/departments',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,qBAAqB,IAAA,6IAAe,EAAa,EAAE,EAAE,eAAe;IAC/E,aAAa;AACf"}},
    {"offset": {"line": 12580, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/store-info/store-info-store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n\r\nexport type StoreGeneralInfoInput = {\r\n  companyName: string;\r\n  brandName: string;\r\n  logo?: string;\r\n  taxCode: string;\r\n  registrationNumber: string;\r\n  representativeName: string;\r\n  representativeTitle: string;\r\n  hotline: string;\r\n  email: string;\r\n  website: string;\r\n  headquartersAddress: string;\r\n  ward: string;\r\n  district: string;\r\n  province: string;\r\n  note: string;\r\n  bankAccountName: string;\r\n  bankAccountNumber: string;\r\n  bankName: string;\r\n};\r\n\r\nexport type StoreGeneralInfo = StoreGeneralInfoInput & {\r\n  updatedAt?: string | undefined;\r\n  updatedBySystemId?: string | undefined;\r\n  updatedByName?: string | undefined;\r\n};\r\n\r\ninterface StoreInfoState {\r\n  info: StoreGeneralInfo;\r\n  updateInfo: (\r\n    values: StoreGeneralInfoInput,\r\n    metadata?: { updatedBySystemId?: string | undefined; updatedByName?: string | undefined }\r\n  ) => void;\r\n  reset: () => void;\r\n  loadFromAPI: () => Promise<void>;\r\n  saveToAPI: () => Promise<void>;\r\n}\r\n\r\nconst defaultInfo: StoreGeneralInfo = {\r\n  companyName: '',\r\n  brandName: '',\r\n  logo: '',\r\n  taxCode: '',\r\n  registrationNumber: '',\r\n  representativeName: '',\r\n  representativeTitle: '',\r\n  hotline: '',\r\n  email: '',\r\n  website: '',\r\n  headquartersAddress: '',\r\n  ward: '',\r\n  district: '',\r\n  province: '',\r\n  note: '',\r\n  bankAccountName: '',\r\n  bankAccountNumber: '',\r\n  bankName: '',\r\n  updatedAt: undefined,\r\n  updatedBySystemId: undefined,\r\n  updatedByName: undefined,\r\n};\r\n\r\nexport const useStoreInfoStore = create<StoreInfoState>()(\r\n  (set) => ({\r\n    info: { ...defaultInfo },\r\n    updateInfo: (values, metadata) =>\r\n      set(() => ({\r\n        info: {\r\n          ...values,\r\n          updatedAt: new Date().toISOString(),\r\n          updatedBySystemId: metadata?.updatedBySystemId,\r\n          updatedByName: metadata?.updatedByName,\r\n        },\r\n      })),\r\n    reset: () => set(() => ({ info: { ...defaultInfo } })),\r\n    // Load from API - should be called on app init\r\n    loadFromAPI: async () => {\r\n      try {\r\n        const res = await fetch('/api/settings?key=store-info');\r\n        if (res.ok) {\r\n          const data = await res.json();\r\n          if (data?.value) {\r\n            set({ info: { ...defaultInfo, ...data.value } });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[StoreInfo] Failed to load from API:', error);\r\n      }\r\n    },\r\n    // Save to API\r\n    saveToAPI: async () => {\r\n      try {\r\n        const state = useStoreInfoStore.getState();\r\n        await fetch('/api/settings', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            key: 'store-info',\r\n            group: 'store',\r\n            value: state.info,\r\n          }),\r\n        });\r\n      } catch (error) {\r\n        console.error('[StoreInfo] Failed to save to API:', error);\r\n      }\r\n    },\r\n  })\r\n);\r\n\r\nexport function getDefaultStoreInfo(): StoreGeneralInfo {\r\n  return { ...defaultInfo };\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAwCA,MAAM,cAAgC;IACpC,aAAa;IACb,WAAW;IACX,MAAM;IACN,SAAS;IACT,oBAAoB;IACpB,oBAAoB;IACpB,qBAAqB;IACrB,SAAS;IACT,OAAO;IACP,SAAS;IACT,qBAAqB;IACrB,MAAM;IACN,UAAU;IACV,UAAU;IACV,MAAM;IACN,iBAAiB;IACjB,mBAAmB;IACnB,UAAU;IACV,WAAW;IACX,mBAAmB;IACnB,eAAe;AACjB;AAEO,MAAM,oBAAoB,IAAA,qJAAM,IACrC,CAAC,MAAQ,CAAC;QACR,MAAM;YAAE,GAAG,WAAW;QAAC;QACvB,YAAY,CAAC,QAAQ,WACnB,IAAI,IAAM,CAAC;oBACT,MAAM;wBACJ,GAAG,MAAM;wBACT,WAAW,IAAI,OAAO,WAAW;wBACjC,mBAAmB,UAAU;wBAC7B,eAAe,UAAU;oBAC3B;gBACF,CAAC;QACH,OAAO,IAAM,IAAI,IAAM,CAAC;oBAAE,MAAM;wBAAE,GAAG,WAAW;oBAAC;gBAAE,CAAC;QACpD,+CAA+C;QAC/C,aAAa;YACX,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,IAAI,EAAE,EAAE;oBACV,MAAM,OAAO,MAAM,IAAI,IAAI;oBAC3B,IAAI,MAAM,OAAO;wBACf,IAAI;4BAAE,MAAM;gCAAE,GAAG,WAAW;gCAAE,GAAG,KAAK,KAAK;4BAAC;wBAAE;oBAChD;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wCAAwC;YACxD;QACF;QACA,cAAc;QACd,WAAW;YACT,IAAI;gBACF,MAAM,QAAQ,kBAAkB,QAAQ;gBACxC,MAAM,MAAM,iBAAiB;oBAC3B,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBACnB,KAAK;wBACL,OAAO;wBACP,OAAO,MAAM,IAAI;oBACnB;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,sCAAsC;YACtD;QACF;IACF,CAAC;AAGI,SAAS;IACd,OAAO;QAAE,GAAG,WAAW;IAAC;AAC1B"}},
    {"offset": {"line": 12679, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/attendance-snapshot-service.ts"],"sourcesContent":["import { useAttendanceStore } from '../features/attendance/store';\r\nimport type { AttendanceDataRow } from '../features/attendance/types';\r\nimport type { SystemId, BusinessId } from './id-types';\r\n\r\ntype SnapshotQuery = {\r\n  monthKey: string;\r\n  employeeSystemId: SystemId;\r\n};\r\n\r\nexport type AttendanceSnapshot = {\r\n  monthKey: string;\r\n  employeeSystemId: SystemId;\r\n  employeeId: BusinessId;\r\n  fullName: string;\r\n  department: AttendanceDataRow['department'];\r\n  totals: {\r\n    workDays: number;\r\n    leaveDays: number;\r\n    absentDays: number;\r\n    lateArrivals: number;\r\n    earlyDepartures: number;\r\n    otHours: number;\r\n    // Chi tiết OT theo loại ngày\r\n    otHoursWeekday?: number;   // Làm thêm ngày thường (sau giờ tan làm)\r\n    otHoursWeekend?: number;   // Làm thêm cuối tuần\r\n    otHoursHoliday?: number;   // Làm thêm ngày lễ\r\n  };\r\n  locked: boolean;\r\n  status: 'pending' | 'locked';\r\n  generatedAt: string;\r\n};\r\n\r\nconst buildSnapshot = (\r\n  row: AttendanceDataRow,\r\n  query: SnapshotQuery,\r\n  locked: boolean\r\n): AttendanceSnapshot => ({\r\n  monthKey: query.monthKey,\r\n  employeeSystemId: query.employeeSystemId,\r\n  employeeId: row.employeeId,\r\n  fullName: row.fullName,\r\n  department: row.department,\r\n  totals: {\r\n    workDays: row.workDays,\r\n    leaveDays: row.leaveDays,\r\n    absentDays: row.absentDays,\r\n    lateArrivals: row.lateArrivals,\r\n    earlyDepartures: row.earlyDepartures,\r\n    otHours: row.otHours,\r\n    otHoursWeekday: row.otHoursWeekday ?? 0,\r\n    otHoursWeekend: row.otHoursWeekend ?? 0,\r\n    otHoursHoliday: row.otHoursHoliday ?? 0,\r\n  },\r\n  locked,\r\n  status: locked ? 'locked' : 'pending',\r\n  generatedAt: new Date().toISOString(),\r\n});\r\n\r\nconst getLatestLockedMonthKey = () => {\r\n  const { lockedMonths } = useAttendanceStore.getState();\r\n  const lockedKeys = Object.entries(lockedMonths)\r\n    .filter(([, isLocked]) => Boolean(isLocked))\r\n    .map(([monthKey]) => monthKey)\r\n    .sort()\r\n    .reverse();\r\n  return lockedKeys[0];\r\n};\r\n\r\nexport const attendanceSnapshotService = {\r\n  getSnapshot({ monthKey, employeeSystemId }: SnapshotQuery): AttendanceSnapshot | null {\r\n    const state = useAttendanceStore.getState();\r\n    const monthRows = state.attendanceData[monthKey];\r\n    if (!monthRows?.length) {\r\n      return null;\r\n    }\r\n    const targetRow = monthRows.find((row) => row.employeeSystemId === employeeSystemId);\r\n    if (!targetRow) {\r\n      return null;\r\n    }\r\n    const locked = Boolean(state.lockedMonths[monthKey]);\r\n    return buildSnapshot(targetRow, { monthKey, employeeSystemId }, locked);\r\n  },\r\n  getLatestLockedSnapshot(employeeSystemId: SystemId): AttendanceSnapshot | null {\r\n    const latestLockedKey = getLatestLockedMonthKey();\r\n    if (!latestLockedKey) {\r\n      return null;\r\n    }\r\n    return this.getSnapshot({ monthKey: latestLockedKey, employeeSystemId });\r\n  },\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;AAgCA,MAAM,gBAAgB,CACpB,KACA,OACA,SACuB,CAAC;QACxB,UAAU,MAAM,QAAQ;QACxB,kBAAkB,MAAM,gBAAgB;QACxC,YAAY,IAAI,UAAU;QAC1B,UAAU,IAAI,QAAQ;QACtB,YAAY,IAAI,UAAU;QAC1B,QAAQ;YACN,UAAU,IAAI,QAAQ;YACtB,WAAW,IAAI,SAAS;YACxB,YAAY,IAAI,UAAU;YAC1B,cAAc,IAAI,YAAY;YAC9B,iBAAiB,IAAI,eAAe;YACpC,SAAS,IAAI,OAAO;YACpB,gBAAgB,IAAI,cAAc,IAAI;YACtC,gBAAgB,IAAI,cAAc,IAAI;YACtC,gBAAgB,IAAI,cAAc,IAAI;QACxC;QACA;QACA,QAAQ,SAAS,WAAW;QAC5B,aAAa,IAAI,OAAO,WAAW;IACrC,CAAC;AAED,MAAM,0BAA0B;IAC9B,MAAM,EAAE,YAAY,EAAE,GAAG,wJAAkB,CAAC,QAAQ;IACpD,MAAM,aAAa,OAAO,OAAO,CAAC,cAC/B,MAAM,CAAC,CAAC,GAAG,SAAS,GAAK,QAAQ,WACjC,GAAG,CAAC,CAAC,CAAC,SAAS,GAAK,UACpB,IAAI,GACJ,OAAO;IACV,OAAO,UAAU,CAAC,EAAE;AACtB;AAEO,MAAM,4BAA4B;IACvC,aAAY,EAAE,QAAQ,EAAE,gBAAgB,EAAiB;QACvD,MAAM,QAAQ,wJAAkB,CAAC,QAAQ;QACzC,MAAM,YAAY,MAAM,cAAc,CAAC,SAAS;QAChD,IAAI,CAAC,WAAW,QAAQ;YACtB,OAAO;QACT;QACA,MAAM,YAAY,UAAU,IAAI,CAAC,CAAC,MAAQ,IAAI,gBAAgB,KAAK;QACnE,IAAI,CAAC,WAAW;YACd,OAAO;QACT;QACA,MAAM,SAAS,QAAQ,MAAM,YAAY,CAAC,SAAS;QACnD,OAAO,cAAc,WAAW;YAAE;YAAU;QAAiB,GAAG;IAClE;IACA,yBAAwB,gBAA0B;QAChD,MAAM,kBAAkB;QACxB,IAAI,CAAC,iBAAiB;YACpB,OAAO;QACT;QACA,OAAO,IAAI,CAAC,WAAW,CAAC;YAAE,UAAU;YAAiB;QAAiB;IACxE;AACF"}},
    {"offset": {"line": 12746, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/print-mappers/types.ts"],"sourcesContent":["/**\r\n * Print Mappers - Shared Types\r\n * Types và utilities dùng chung cho tất cả mappers\r\n */\r\n\r\nexport { \r\n  formatCurrency, \r\n  numberToWords, \r\n  formatDate, \r\n  formatTime,\r\n  getStoreData,\r\n} from '../print-service';\r\n\r\nexport type { \r\n  PrintData, \r\n  PrintLineItem, \r\n  StoreSettings\r\n} from '../print-service';\r\n\r\n/**\r\n * Helper: Ẩn 4 số giữa của SĐT\r\n * VD: 0912345678 -> 0912***678\r\n */\r\nexport const hidePhoneMiddle = (phone?: string): string => {\r\n  if (!phone || phone.length < 8) return phone || '';\r\n  return phone.slice(0, 4) + '***' + phone.slice(-3);\r\n};\r\n\r\n/**\r\n * Helper: Format ngày dạng chữ\r\n * VD: 05/12/2025 -> Ngày 05 tháng 12 năm 2025\r\n * Note: This is a specific Vietnamese text format, not using date-utils\r\n */\r\nexport const formatDateText = (date?: string | Date): string => {\r\n  if (!date) return '';\r\n  const d = typeof date === 'string' ? new Date(date) : date;\r\n  if (isNaN(d.getTime())) return '';\r\n  const day = d.getDate();\r\n  const month = d.getMonth() + 1;\r\n  const year = d.getFullYear();\r\n  return `Ngày ${day} tháng ${month} năm ${year}`;\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;;;CAGC,GAED;;AAkBO,MAAM,kBAAkB,CAAC;IAC9B,IAAI,CAAC,SAAS,MAAM,MAAM,GAAG,GAAG,OAAO,SAAS;IAChD,OAAO,MAAM,KAAK,CAAC,GAAG,KAAK,QAAQ,MAAM,KAAK,CAAC,CAAC;AAClD;AAOO,MAAM,iBAAiB,CAAC;IAC7B,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;IACtD,IAAI,MAAM,EAAE,OAAO,KAAK,OAAO;IAC/B,MAAM,MAAM,EAAE,OAAO;IACrB,MAAM,QAAQ,EAAE,QAAQ,KAAK;IAC7B,MAAM,OAAO,EAAE,WAAW;IAC1B,OAAO,CAAC,KAAK,EAAE,IAAI,OAAO,EAAE,MAAM,KAAK,EAAE,MAAM;AACjD"}},
    {"offset": {"line": 12777, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/print-mappers/payroll.mapper.ts"],"sourcesContent":["/**\r\n * Payroll Mapper - Bảng lương & Phiếu lương\r\n * Đồng bộ với variables/bang-luong.ts\r\n */\r\n\r\nimport { \r\n  PrintData, \r\n  PrintLineItem,\r\n  formatCurrency, \r\n  numberToWords, \r\n  formatDate,\r\n  formatTime,\r\n  getStoreData,\r\n  StoreSettings\r\n} from './types';\r\n\r\n// Helper: Format số khấu trừ (có dấu âm khi > 0, không dấu khi = 0)\r\nconst formatDeduction = (value: number | undefined): string => {\r\n  if (!value || value === 0) return '0';\r\n  return `-${formatCurrency(value)}`;\r\n};\r\n\r\n// ============================================\r\n// TYPES\r\n// ============================================\r\n\r\nexport interface PayrollBatchForPrint {\r\n  // Thông tin cơ bản\r\n  code: string;\r\n  title: string;\r\n  status: string;\r\n  \r\n  // Kỳ lương\r\n  payPeriod: string; // MM/yyyy\r\n  payPeriodStart?: string | Date;\r\n  payPeriodEnd?: string | Date;\r\n  payrollDate: string | Date;\r\n  referenceMonths?: string[]; // ['2024-01', '2024-02']\r\n  \r\n  // Tổng kết\r\n  totalEmployees: number;\r\n  totalGross: number;\r\n  totalEarnings: number;\r\n  totalDeductions: number;\r\n  totalContributions: number;\r\n  totalNet: number;\r\n  \r\n  // Tổng bảo hiểm & Thuế (cho template in)\r\n  totalInsurance: number;      // Tổng BH nhân viên đóng\r\n  totalTax: number;            // Tổng thuế TNCN\r\n  \r\n  // Audit\r\n  createdAt: string | Date;\r\n  createdBy?: string;\r\n  lockedAt?: string | Date;\r\n  lockedBy?: string;\r\n  notes?: string;\r\n  \r\n  // Chi tiết nhân viên\r\n  payslips?: PayslipForPrint[];\r\n}\r\n\r\nexport interface PayslipForPrint {\r\n  // Thông tin phiếu\r\n  code: string;\r\n  batchCode?: string;\r\n  batchTitle?: string;\r\n  payPeriod?: string;\r\n  payrollDate?: string | Date;\r\n  \r\n  // Thông tin nhân viên\r\n  employeeCode: string;\r\n  employeeName: string;\r\n  departmentName?: string;\r\n  position?: string;\r\n  \r\n  // Thông tin chấm công\r\n  workDays?: number;\r\n  standardWorkDays?: number;\r\n  leaveDays?: number;\r\n  absentDays?: number;\r\n  otHours?: number;\r\n  otHoursWeekday?: number;\r\n  otHoursWeekend?: number;\r\n  otHoursHoliday?: number;\r\n  lateArrivals?: number;\r\n  earlyDepartures?: number;\r\n  \r\n  // Chi tiết lương\r\n  earnings: number;\r\n  deductions: number;\r\n  contributions: number;\r\n  taxableIncome: number;\r\n  socialInsuranceBase: number;\r\n  netPay: number;\r\n  \r\n  // Bảo hiểm chi tiết (NV đóng)\r\n  totalEmployeeInsurance: number;\r\n  employeeSocialInsurance: number;\r\n  employeeHealthInsurance: number;\r\n  employeeUnemploymentInsurance: number;\r\n  \r\n  // Thuế TNCN\r\n  personalIncomeTax: number;\r\n  \r\n  // Khấu trừ phạt & khác\r\n  penaltyDeductions?: number;\r\n  otherDeductions?: number;\r\n  \r\n  // Giảm trừ gia cảnh\r\n  personalDeduction: number;\r\n  dependentDeduction: number;\r\n  numberOfDependents: number;\r\n  \r\n  // Components\r\n  components?: PayrollComponentForPrint[];\r\n}\r\n\r\nexport interface PayrollComponentForPrint {\r\n  code?: string;\r\n  name: string;\r\n  category: 'earning' | 'deduction' | 'contribution';\r\n  amount: number;\r\n  // Thông tin để tạo công thức\r\n  calculationType?: 'fixed' | 'formula';\r\n  formula?: string;\r\n  metadata?: {\r\n    context?: {\r\n      baseSalary?: number;\r\n      workDays?: number;\r\n      standardWorkDays?: number;\r\n      otHoursWeekday?: number;\r\n      otHoursWeekend?: number;\r\n      otHoursHoliday?: number;\r\n      otPayWeekday?: number;\r\n      otPayWeekend?: number;\r\n      otPayHoliday?: number;\r\n      // OT rate settings\r\n      otHourlyRate?: number;\r\n      otRateWeekend?: number;\r\n      otRateHoliday?: number;\r\n      // Phụ cấp ăn trưa\r\n      mealAllowancePerDay?: number;\r\n    };\r\n    [key: string]: unknown;\r\n  };\r\n}\r\n\r\n// ============================================\r\n// BATCH MAPPER (Tổng bảng lương)\r\n// ============================================\r\n\r\nconst STATUS_MAP: Record<string, string> = {\r\n  'draft': 'Nháp',\r\n  'reviewed': 'Đã duyệt',\r\n  'locked': 'Đã khóa',\r\n};\r\n\r\nexport function mapPayrollBatchToPrintData(batch: PayrollBatchForPrint, storeSettings: StoreSettings): PrintData {\r\n  return {\r\n    ...getStoreData(storeSettings),\r\n    \r\n    // === THÔNG TIN BẢNG LƯƠNG ===\r\n    '{batch_code}': batch.code,\r\n    '{batch_title}': batch.title,\r\n    '{batch_status}': STATUS_MAP[batch.status] || batch.status,\r\n    '{pay_period}': batch.payPeriod,\r\n    '{pay_period_start}': formatDate(batch.payPeriodStart),\r\n    '{pay_period_end}': formatDate(batch.payPeriodEnd),\r\n    '{payroll_date}': formatDate(batch.payrollDate),\r\n    '{reference_months}': batch.referenceMonths?.join(', ') || '',\r\n    '{created_on}': formatDate(batch.createdAt),\r\n    '{created_by}': batch.createdBy || '',\r\n    '{locked_on}': formatDate(batch.lockedAt),\r\n    '{locked_by}': batch.lockedBy || '',\r\n    '{notes}': batch.notes || '',\r\n    \r\n    // === TỔNG KẾT ===\r\n    '{total_employees}': String(batch.totalEmployees),\r\n    '{total_gross}': formatCurrency(batch.totalGross),\r\n    '{total_gross_text}': numberToWords(batch.totalGross),\r\n    '{total_earnings}': formatCurrency(batch.totalEarnings),\r\n    '{total_deductions}': formatCurrency(batch.totalDeductions),\r\n    '{total_contributions}': formatCurrency(batch.totalContributions),\r\n    '{total_insurance}': formatCurrency(batch.totalInsurance),\r\n    '{total_tax}': formatCurrency(batch.totalTax),\r\n    '{total_net}': formatCurrency(batch.totalNet),\r\n    '{total_net_text}': numberToWords(batch.totalNet),\r\n  };\r\n}\r\n\r\nexport function mapPayrollBatchLineItems(payslips?: PayslipForPrint[]): PrintLineItem[] {\r\n  if (!payslips?.length) return [];\r\n  \r\n  return payslips.map((slip, index) => ({\r\n    '{line_stt}': String(index + 1),\r\n    '{employee_code}': slip.employeeCode,\r\n    '{employee_name}': slip.employeeName,\r\n    '{department_name}': slip.departmentName || '',\r\n    '{earnings}': formatCurrency(slip.earnings),\r\n    '{deductions}': formatCurrency(slip.deductions),\r\n    '{contributions}': formatCurrency(slip.contributions),\r\n    '{total_insurance}': formatDeduction(slip.totalEmployeeInsurance),\r\n    '{personal_income_tax}': formatDeduction(slip.personalIncomeTax),\r\n    '{net_pay}': formatCurrency(slip.netPay),\r\n  }));\r\n}\r\n\r\n// ============================================\r\n// PAYSLIP MAPPER (Phiếu lương cá nhân)\r\n// ============================================\r\n\r\nconst COMPONENT_CATEGORY_MAP: Record<string, string> = {\r\n  'earning': 'Khoản cộng',\r\n  'deduction': 'Khoản trừ',\r\n  'contribution': 'Đóng góp',\r\n};\r\n\r\nexport function mapPayslipToPrintData(payslip: PayslipForPrint, storeSettings: StoreSettings): PrintData {\r\n  return {\r\n    ...getStoreData(storeSettings),\r\n    \r\n    // === THÔNG TIN PHIẾU LƯƠNG ===\r\n    '{payslip_code}': payslip.code,\r\n    '{batch_code}': payslip.batchCode || '',\r\n    '{batch_title}': payslip.batchTitle || '',\r\n    '{pay_period}': payslip.payPeriod || '',\r\n    '{payroll_date}': formatDate(payslip.payrollDate),\r\n    \r\n    // === THÔNG TIN NHÂN VIÊN ===\r\n    '{employee_code}': payslip.employeeCode,\r\n    '{employee_name}': payslip.employeeName,\r\n    '{department_name}': payslip.departmentName || '',\r\n    '{position}': payslip.position || '',\r\n    \r\n    // === THÔNG TIN CHẤM CÔNG ===\r\n    '{work_days}': String(payslip.workDays ?? 0),\r\n    '{standard_work_days}': String(payslip.standardWorkDays ?? 26),\r\n    '{leave_days}': String(payslip.leaveDays ?? 0),\r\n    '{absent_days}': String(payslip.absentDays ?? 0),\r\n    '{ot_hours}': String(payslip.otHours ?? 0),\r\n    '{ot_hours_weekday}': String(payslip.otHoursWeekday ?? 0),\r\n    '{ot_hours_weekend}': String(payslip.otHoursWeekend ?? 0),\r\n    '{ot_hours_holiday}': String(payslip.otHoursHoliday ?? 0),\r\n    '{late_arrivals}': String(payslip.lateArrivals ?? 0),\r\n    '{early_departures}': String(payslip.earlyDepartures ?? 0),\r\n    \r\n    // === CHI TIẾT LƯƠNG ===\r\n    '{total_earnings}': formatCurrency(payslip.earnings),\r\n    '{total_deductions}': formatCurrency(payslip.deductions),\r\n    '{total_contributions}': formatCurrency(payslip.contributions),\r\n    '{total_insurance}': formatDeduction(payslip.totalEmployeeInsurance),\r\n    \r\n    // === BẢO HIỂM CHI TIẾT ===\r\n    '{bhxh_amount}': formatDeduction(payslip.employeeSocialInsurance),\r\n    '{bhyt_amount}': formatDeduction(payslip.employeeHealthInsurance),\r\n    '{bhtn_amount}': formatDeduction(payslip.employeeUnemploymentInsurance),\r\n    \r\n    // === GIẢM TRỪ GIA CẢNH ===\r\n    '{personal_deduction}': formatCurrency(payslip.personalDeduction),\r\n    '{dependent_deduction}': formatCurrency(payslip.dependentDeduction),\r\n    '{dependents_count}': String(payslip.numberOfDependents || 0),\r\n    \r\n    // === THUẾ & THỰC LĨNH ===\r\n    '{personal_income_tax}': formatDeduction(payslip.personalIncomeTax),\r\n    '{taxable_income}': formatCurrency(payslip.taxableIncome),\r\n    '{social_insurance_base}': formatCurrency(payslip.socialInsuranceBase),\r\n    '{penalty_deductions}': formatDeduction(payslip.penaltyDeductions),\r\n    '{other_deductions}': formatDeduction(payslip.otherDeductions),\r\n    '{net_pay}': formatCurrency(payslip.netPay),\r\n    '{net_pay_text}': numberToWords(payslip.netPay),\r\n  };\r\n}\r\n\r\n/**\r\n * Tạo công thức đọc được cho component\r\n * Ví dụ: \"35,000,000 × (16.98 / 26)\" hoặc \"Cố định\"\r\n */\r\nfunction formatComponentFormula(comp: PayrollComponentForPrint): string {\r\n  // Fixed amount\r\n  if (comp.calculationType === 'fixed' || !comp.formula) {\r\n    return 'Cố định';\r\n  }\r\n  \r\n  const ctx = comp.metadata?.context;\r\n  if (!ctx) return comp.formula || '';\r\n  \r\n  // Lương cơ bản: baseSalary × (workDays / standardWorkDays)\r\n  if (comp.formula?.includes('baseSalary') && comp.formula?.includes('workDays')) {\r\n    const baseSalary = ctx.baseSalary ?? 0;\r\n    const workDays = ctx.workDays ?? 0;\r\n    const standardWorkDays = ctx.standardWorkDays ?? 26;\r\n    return `${formatCurrency(baseSalary)} × (${workDays} / ${standardWorkDays})`;\r\n  }\r\n  \r\n  // Phụ cấp ăn trưa: workDays × mealAllowancePerDay\r\n  if (comp.formula?.includes('mealAllowancePerDay') || comp.name.toLowerCase().includes('ăn trưa')) {\r\n    const workDays = ctx.workDays ?? 0;\r\n    const mealAllowancePerDay = ctx.mealAllowancePerDay ?? 30000;\r\n    return `${workDays} ngày × ${formatCurrency(mealAllowancePerDay)}`;\r\n  }\r\n  \r\n  // OT ngày thường (không có hệ số, chỉ nhân hourlyRate)\r\n  if (comp.formula?.includes('otPayWeekday') || comp.name.toLowerCase().includes('ngày thường')) {\r\n    const hours = ctx.otHoursWeekday ?? 0;\r\n    const hourlyRate = ctx.otHourlyRate ?? 0;\r\n    if (hours > 0 && hourlyRate > 0) {\r\n      return `${hours}h × ${formatCurrency(hourlyRate)}`;\r\n    }\r\n    return hours > 0 ? `${hours}h OT` : '—';\r\n  }\r\n  \r\n  // OT cuối tuần (hourlyRate × hệ số)\r\n  if (comp.formula?.includes('otPayWeekend') || comp.name.toLowerCase().includes('cuối tuần')) {\r\n    const hours = ctx.otHoursWeekend ?? 0;\r\n    const hourlyRate = ctx.otHourlyRate ?? 0;\r\n    const rate = ctx.otRateWeekend ?? 2;\r\n    if (hours > 0 && hourlyRate > 0) {\r\n      return `${hours}h × ${formatCurrency(hourlyRate)} × ${rate}`;\r\n    }\r\n    return hours > 0 ? `${hours}h OT` : '—';\r\n  }\r\n  \r\n  // OT ngày lễ (hourlyRate × hệ số)\r\n  if (comp.formula?.includes('otPayHoliday') || comp.name.toLowerCase().includes('ngày lễ')) {\r\n    const hours = ctx.otHoursHoliday ?? 0;\r\n    const hourlyRate = ctx.otHourlyRate ?? 0;\r\n    const rate = ctx.otRateHoliday ?? 3;\r\n    if (hours > 0 && hourlyRate > 0) {\r\n      return `${hours}h × ${formatCurrency(hourlyRate)} × ${rate}`;\r\n    }\r\n    return hours > 0 ? `${hours}h OT` : '—';\r\n  }\r\n  \r\n  // Fallback - hiển thị formula gốc nếu có\r\n  return comp.formula || 'Cố định';\r\n}\r\n\r\nexport function mapPayslipComponentLineItems(components?: PayrollComponentForPrint[]): PrintLineItem[] {\r\n  if (!components?.length) return [];\r\n  \r\n  return components.map((comp, index) => ({\r\n    '{line_stt}': String(index + 1),\r\n    '{component_code}': comp.code || '',\r\n    '{component_name}': comp.name,\r\n    '{component_category}': COMPONENT_CATEGORY_MAP[comp.category] || comp.category,\r\n    '{component_formula}': formatComponentFormula(comp),    '{component_amount}': formatCurrency(comp.amount),\r\n  }));\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 12980, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/print/payroll-print-helper.ts"],"sourcesContent":["/**\r\n * Payroll Print Helper\r\n * Helpers để chuẩn bị dữ liệu in cho bảng lương và phiếu lương\r\n */\r\n\r\nimport type { Branch } from '../../features/settings/branches/types';\r\nimport type { Employee } from '../../features/employees/types';\r\nimport { attendanceSnapshotService } from '../attendance-snapshot-service';\r\nimport { \r\n  PayrollBatchForPrint,\r\n  PayslipForPrint,\r\n  PayrollComponentForPrint,\r\n  mapPayrollBatchToPrintData, \r\n  mapPayrollBatchLineItems,\r\n  mapPayslipToPrintData,\r\n  mapPayslipComponentLineItems,\r\n} from '../print-mappers/payroll.mapper';\r\nimport { StoreSettings, getStoreLogo, getGeneralSettings } from '../print-service';\r\nimport type { PayrollBatch, Payslip, PayrollComponentEntry, PayrollTotals } from '../payroll-types';\r\nimport type { SystemId } from '../id-types';\r\n\r\n// ============================================\r\n// INTERFACES\r\n// ============================================\r\n\r\n// Interface cho PayrollBatch - flexible\r\ninterface PayrollBatchLike {\r\n  systemId: string;\r\n  id: string;\r\n  title: string;\r\n  status: 'draft' | 'reviewed' | 'locked' | 'cancelled';\r\n  payPeriod?: {\r\n    monthKey?: string;\r\n    startDate?: string;\r\n    endDate?: string;\r\n  };\r\n  payrollDate?: string;\r\n  referenceAttendanceMonthKeys?: string[];\r\n  totalGross?: number;\r\n  totalNet?: number;\r\n  createdAt?: string;\r\n  createdBy?: SystemId;\r\n  reviewedAt?: string;\r\n  reviewedBy?: SystemId;\r\n  lockedAt?: string;\r\n  lockedBy?: SystemId;\r\n  notes?: string;\r\n}\r\n\r\n// Interface cho Payslip - flexible\r\ninterface PayslipLike {\r\n  systemId: string;\r\n  id: string;\r\n  batchSystemId?: string;\r\n  employeeSystemId: string;\r\n  employeeId?: string;\r\n  departmentSystemId?: string;\r\n  periodMonthKey?: string;\r\n  components?: PayrollComponentEntry[];\r\n  totals: PayrollTotals;\r\n  lockedAt?: string;\r\n}\r\n\r\n// ============================================\r\n// CONVERTERS\r\n// ============================================\r\n\r\n/**\r\n * Chuyển đổi PayrollBatch entity sang PayrollBatchForPrint\r\n */\r\nexport function convertPayrollBatchForPrint(\r\n  batch: PayrollBatchLike,\r\n  payslips: PayslipLike[],\r\n  options: {\r\n    employeeLookup?: Record<SystemId, { fullName?: string; id?: string; department?: string }>;\r\n    departmentLookup?: Record<SystemId, { name?: string }>;\r\n    creatorName?: string;\r\n    lockerName?: string;\r\n  } = {}\r\n): PayrollBatchForPrint {\r\n  const { employeeLookup = {}, departmentLookup = {}, creatorName, lockerName } = options;\r\n\r\n  // Calculate totals from payslips\r\n  const totalEarnings = payslips.reduce((sum, p) => sum + p.totals.earnings, 0);\r\n  const totalDeductions = payslips.reduce((sum, p) => sum + p.totals.deductions, 0);\r\n  const totalContributions = payslips.reduce((sum, p) => sum + p.totals.contributions, 0);\r\n  const totalInsurance = payslips.reduce((sum, p) => sum + (p.totals.totalEmployeeInsurance || 0), 0);\r\n  const totalTax = payslips.reduce((sum, p) => sum + (p.totals.personalIncomeTax || 0), 0);\r\n\r\n  // Convert payslips\r\n  const payslipsForPrint: PayslipForPrint[] = payslips.map(payslip => {\r\n    const employee = employeeLookup[payslip.employeeSystemId as SystemId];\r\n    const departmentName = payslip.departmentSystemId\r\n      ? departmentLookup[payslip.departmentSystemId as SystemId]?.name\r\n      : (employee as { departmentName?: string })?.departmentName;\r\n\r\n    return {\r\n      code: payslip.id || payslip.systemId,\r\n      batchCode: batch.id,\r\n      batchTitle: batch.title,\r\n      payPeriod: batch.payPeriod?.monthKey,\r\n      payrollDate: batch.payrollDate,\r\n      employeeCode: employee?.id || payslip.employeeId || '',\r\n      employeeName: employee?.fullName || `Nhân viên ${payslip.employeeId || payslip.employeeSystemId}`,\r\n      departmentName: departmentName || 'Không xác định',\r\n      earnings: payslip.totals.earnings,\r\n      deductions: payslip.totals.deductions,\r\n      contributions: payslip.totals.contributions,\r\n      taxableIncome: payslip.totals.taxableIncome,\r\n      socialInsuranceBase: payslip.totals.socialInsuranceBase,\r\n      netPay: payslip.totals.netPay,\r\n      // Bảo hiểm chi tiết\r\n      totalEmployeeInsurance: payslip.totals.totalEmployeeInsurance || 0,\r\n      employeeSocialInsurance: payslip.totals.employeeSocialInsurance || 0,\r\n      employeeHealthInsurance: payslip.totals.employeeHealthInsurance || 0,\r\n      employeeUnemploymentInsurance: payslip.totals.employeeUnemploymentInsurance || 0,\r\n      // Thuế TNCN\r\n      personalIncomeTax: payslip.totals.personalIncomeTax || 0,\r\n      // Khấu trừ phạt & khác\r\n      penaltyDeductions: payslip.totals.penaltyDeductions || 0,\r\n      otherDeductions: payslip.totals.otherDeductions || 0,\r\n      // Giảm trừ gia cảnh\r\n      personalDeduction: payslip.totals.personalDeduction || 0,\r\n      dependentDeduction: payslip.totals.dependentDeduction || 0,\r\n      numberOfDependents: payslip.totals.numberOfDependents || 0,\r\n      components: payslip.components?.map(c => ({\r\n        code: c.componentId,\r\n        name: c.label,\r\n        category: c.category,\r\n        amount: c.amount,\r\n      })),\r\n    };\r\n  });\r\n\r\n  return {\r\n    code: batch.id,\r\n    title: batch.title,\r\n    status: batch.status,\r\n    payPeriod: batch.payPeriod?.monthKey || '',\r\n    payPeriodStart: batch.payPeriod?.startDate,\r\n    payPeriodEnd: batch.payPeriod?.endDate,\r\n    payrollDate: batch.payrollDate || '',\r\n    referenceMonths: batch.referenceAttendanceMonthKeys,\r\n    totalEmployees: payslips.length,\r\n    totalGross: batch.totalGross || 0,\r\n    totalEarnings,\r\n    totalDeductions,\r\n    totalContributions,\r\n    totalInsurance,\r\n    totalTax,\r\n    totalNet: batch.totalNet || 0,\r\n    createdAt: batch.createdAt || '',\r\n    createdBy: creatorName,\r\n    lockedAt: batch.lockedAt,\r\n    lockedBy: lockerName,\r\n    notes: batch.notes,\r\n    payslips: payslipsForPrint,\r\n  };\r\n}\r\n\r\n/**\r\n * Chuyển đổi Payslip entity sang PayslipForPrint (cho in phiếu lương cá nhân)\r\n */\r\nexport function convertPayslipForPrint(\r\n  payslip: PayslipLike,\r\n  batch: PayrollBatchLike,\r\n  options: {\r\n    employee?: { fullName?: string; id?: string; department?: string; position?: string };\r\n    departmentName?: string;\r\n  } = {}\r\n): PayslipForPrint {\r\n  const { employee, departmentName } = options;\r\n\r\n  // Lấy attendance info: từ totals trước, nếu không có thì lấy từ snapshot\r\n  let attendance = {\r\n    workDays: payslip.totals.workDays,\r\n    standardWorkDays: payslip.totals.standardWorkDays ?? 26,\r\n    leaveDays: payslip.totals.leaveDays ?? 0,\r\n    absentDays: payslip.totals.absentDays ?? 0,\r\n    otHours: payslip.totals.otHours ?? 0,\r\n    otHoursWeekday: payslip.totals.otHoursWeekday ?? 0,\r\n    otHoursWeekend: payslip.totals.otHoursWeekend ?? 0,\r\n    otHoursHoliday: payslip.totals.otHoursHoliday ?? 0,\r\n    lateArrivals: payslip.totals.lateArrivals ?? 0,\r\n    earlyDepartures: payslip.totals.earlyDepartures ?? 0,\r\n  };\r\n\r\n  // Nếu totals không có workDays (dữ liệu cũ), thử lấy từ attendance snapshot\r\n  if (attendance.workDays === undefined || attendance.workDays === null) {\r\n    const monthKey = payslip.periodMonthKey || batch.payPeriod?.monthKey;\r\n    if (monthKey) {\r\n      const snapshot = attendanceSnapshotService.getSnapshot({\r\n        monthKey,\r\n        employeeSystemId: payslip.employeeSystemId as SystemId,\r\n      });\r\n      if (snapshot) {\r\n        attendance = {\r\n          workDays: snapshot.totals.workDays,\r\n          standardWorkDays: 26,\r\n          leaveDays: snapshot.totals.leaveDays,\r\n          absentDays: snapshot.totals.absentDays,\r\n          otHours: snapshot.totals.otHours,\r\n          otHoursWeekday: snapshot.totals.otHoursWeekday ?? 0,\r\n          otHoursWeekend: snapshot.totals.otHoursWeekend ?? 0,\r\n          otHoursHoliday: snapshot.totals.otHoursHoliday ?? 0,\r\n          lateArrivals: snapshot.totals.lateArrivals,\r\n          earlyDepartures: snapshot.totals.earlyDepartures,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    code: payslip.id || payslip.systemId,\r\n    batchCode: batch.id,\r\n    batchTitle: batch.title,\r\n    payPeriod: batch.payPeriod?.monthKey,\r\n    payrollDate: batch.payrollDate,\r\n    employeeCode: employee?.id || payslip.employeeId || '',\r\n    employeeName: employee?.fullName || `Nhân viên ${payslip.employeeId || payslip.employeeSystemId}`,\r\n    departmentName: departmentName || employee?.department || 'Không xác định',\r\n    position: employee?.position,\r\n    // Thông tin chấm công (từ attendance object đã resolve)\r\n    workDays: attendance.workDays,\r\n    standardWorkDays: attendance.standardWorkDays,\r\n    leaveDays: attendance.leaveDays,\r\n    absentDays: attendance.absentDays,\r\n    otHours: attendance.otHours,\r\n    otHoursWeekday: attendance.otHoursWeekday,\r\n    otHoursWeekend: attendance.otHoursWeekend,\r\n    otHoursHoliday: attendance.otHoursHoliday,\r\n    lateArrivals: attendance.lateArrivals,\r\n    earlyDepartures: attendance.earlyDepartures,\r\n    // Chi tiết lương\r\n    earnings: payslip.totals.earnings,\r\n    deductions: payslip.totals.deductions,\r\n    contributions: payslip.totals.contributions,\r\n    taxableIncome: payslip.totals.taxableIncome,\r\n    socialInsuranceBase: payslip.totals.socialInsuranceBase,\r\n    netPay: payslip.totals.netPay,\r\n    // Bảo hiểm chi tiết\r\n    totalEmployeeInsurance: payslip.totals.totalEmployeeInsurance || 0,\r\n    employeeSocialInsurance: payslip.totals.employeeSocialInsurance || 0,\r\n    employeeHealthInsurance: payslip.totals.employeeHealthInsurance || 0,\r\n    employeeUnemploymentInsurance: payslip.totals.employeeUnemploymentInsurance || 0,\r\n    // Thuế TNCN\r\n    personalIncomeTax: payslip.totals.personalIncomeTax || 0,\r\n    // Khấu trừ phạt & khác\r\n    penaltyDeductions: payslip.totals.penaltyDeductions || 0,\r\n    otherDeductions: payslip.totals.otherDeductions || 0,\r\n    // Giảm trừ gia cảnh\r\n    personalDeduction: payslip.totals.personalDeduction || 0,\r\n    dependentDeduction: payslip.totals.dependentDeduction || 0,\r\n    numberOfDependents: payslip.totals.numberOfDependents || 0,\r\n    components: payslip.components?.map(c => ({\r\n      code: c.componentId,\r\n      name: c.label,\r\n      category: c.category,\r\n      amount: c.amount,\r\n      calculationType: c.calculationType,\r\n      formula: c.formula,\r\n      metadata: c.metadata as PayrollComponentForPrint['metadata'],\r\n    })),\r\n  };\r\n}\r\n\r\n/**\r\n * Tạo StoreSettings từ storeInfo\r\n */\r\nexport function createStoreSettings(storeInfo?: {\r\n  companyName?: string;\r\n  brandName?: string;\r\n  hotline?: string;\r\n  email?: string;\r\n  website?: string;\r\n  taxCode?: string;\r\n  headquartersAddress?: string;\r\n  province?: string;\r\n  logo?: string;\r\n}): StoreSettings {\r\n  const generalSettings = getGeneralSettings();\r\n  \r\n  // Fallback: lấy từ store nếu storeInfo rỗng\r\n  let storeInfoFromStorage: typeof storeInfo | null = null;\r\n  if (!storeInfo?.companyName && !storeInfo?.brandName) {\r\n    try {\r\n      // Import store dynamically để tránh circular dependency\r\n      const { useStoreInfoStore } = require('@/features/settings/store-info/store-info-store');\r\n      storeInfoFromStorage = useStoreInfoStore.getState().info;\r\n    } catch (e) { /* ignore */ }\r\n  }\r\n  \r\n  const info = storeInfo?.companyName || storeInfo?.brandName ? storeInfo : storeInfoFromStorage;\r\n  \r\n  return {\r\n    name: info?.companyName || info?.brandName || generalSettings?.companyName || '',\r\n    address: info?.headquartersAddress || generalSettings?.companyAddress || '',\r\n    phone: info?.hotline || generalSettings?.phoneNumber || '',\r\n    email: info?.email || generalSettings?.email || '',\r\n    website: info?.website,\r\n    taxCode: info?.taxCode,\r\n    province: info?.province,\r\n    logo: getStoreLogo(info?.logo),\r\n  };\r\n}\r\n\r\n// Re-export mappers\r\nexport {\r\n  mapPayrollBatchToPrintData,\r\n  mapPayrollBatchLineItems,\r\n  mapPayslipToPrintData,\r\n  mapPayslipComponentLineItems,\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 13194, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/dialog.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\r\nimport { X } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { useModal } from \"../../contexts/modal-context\"\r\n\r\n// Use the original Dialog component\r\nconst Dialog = DialogPrimitive.Root\r\n\r\n// Create a Context to pass ID through the Dialog component tree\r\nconst DialogContext = React.createContext<string>(\"\");\r\n\r\n// Provider component that accepts an ID\r\nconst DialogProvider = ({ id, children }: { id: string; children: React.ReactNode }) => {\r\n  return <DialogContext.Provider value={id}>{children}</DialogContext.Provider>;\r\n};\r\n\r\nconst DialogTrigger = DialogPrimitive.Trigger\r\n\r\nconst DialogPortal = DialogPrimitive.Portal\r\n\r\nconst DialogClose = DialogPrimitive.Close\r\n\r\nconst DialogOverlay = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Overlay\r\n    ref={ref}\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\r\n\r\nconst DialogContent = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> & { \r\n    id?: string;\r\n    open?: boolean;\r\n  }\r\n>(({ className, children, id: propId, open, ...props }, ref) => {\r\n  // Use either the prop id or the id from context\r\n  const contextId = React.useContext(DialogContext);\r\n  const id = propId || contextId || `dialog-${React.useId()}`;\r\n  \r\n  // Register with our modal context using the open prop\r\n  const { zIndex } = useModal(id, !!open, 'dialog');\r\n  \r\n  return (\r\n    <DialogPortal>\r\n      {/* Sử dụng overlay chỉ dành cho Dialog */}\r\n      <DialogOverlay style={{ zIndex: zIndex - 1 }} />\r\n      <DialogPrimitive.Content\r\n        ref={ref}\r\n        className={cn(\r\n          \"dialog-content fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg sm:rounded-lg\",\r\n          className\r\n        )}\r\n        style={{ zIndex }}\r\n        {...props}\r\n      >\r\n        <DialogProvider id={id}>\r\n          {children}\r\n          <DialogPrimitive.Close\r\n            aria-label=\"Đóng\"\r\n            className=\"absolute right-4 top-4 flex h-9 w-9 items-center justify-center rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">Đóng</span>\r\n          </DialogPrimitive.Close>\r\n        </DialogProvider>\r\n      </DialogPrimitive.Content>\r\n    </DialogPortal>\r\n  );\r\n})\r\nDialogContent.displayName = DialogPrimitive.Content.displayName\r\n\r\nconst DialogHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nDialogHeader.displayName = \"DialogHeader\"\r\n\r\nconst DialogFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nDialogFooter.displayName = \"DialogFooter\"\r\n\r\nconst DialogTitle = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\r\n      \"text-lg font-semibold leading-none tracking-tight\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDialogTitle.displayName = DialogPrimitive.Title.displayName\r\n\r\nconst DialogDescription = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nDialogDescription.displayName = DialogPrimitive.Description.displayName\r\n\r\nexport {\r\n  Dialog,\r\n  DialogPortal,\r\n  DialogOverlay,\r\n  DialogClose,\r\n  DialogTrigger,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogFooter,\r\n  DialogTitle,\r\n  DialogDescription,\r\n  DialogProvider,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;;;;;;;;AAEA,oCAAoC;AACpC,MAAM,SAAS,6KAAoB;AAEnC,gEAAgE;AAChE,MAAM,8BAAgB,8KAAmB,CAAS;AAElD,wCAAwC;AACxC,MAAM,iBAAiB,CAAC,EAAE,EAAE,EAAE,QAAQ,EAA6C;IACjF,qBAAO,6LAAC,cAAc,QAAQ;QAAC,OAAO;kBAAK;;;;;;AAC7C;KAFM;AAIN,MAAM,gBAAgB,gLAAuB;AAE7C,MAAM,eAAe,+KAAsB;AAE3C,MAAM,cAAc,8KAAqB;AAEzC,MAAM,8BAAgB,2KAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,gLAAuB;QACtB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;MAVP;AAaN,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,GAAA,2KAAgB,UAMpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,MAAM,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;;IACtD,gDAAgD;IAChD,MAAM,YAAY,2KAAgB,CAAC;IACnC,MAAM,KAAK,UAAU,aAAa,CAAC,OAAO,EAAE,sKAAW,IAAI;IAE3D,sDAAsD;IACtD,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,4IAAQ,EAAC,IAAI,CAAC,CAAC,MAAM;IAExC,qBACE,6LAAC;;0BAEC,6LAAC;gBAAc,OAAO;oBAAE,QAAQ,SAAS;gBAAE;;;;;;0BAC3C,6LAAC,gLAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,qHAAE,EACX,kLACA;gBAEF,OAAO;oBAAE;gBAAO;gBACf,GAAG,KAAK;0BAET,cAAA,6LAAC;oBAAe,IAAI;;wBACjB;sCACD,6LAAC,8KAAqB;4BACpB,cAAW;4BACX,WAAU;;8CAEV,6LAAC,oMAAC;oCAAC,WAAU;;;;;;8CACb,6LAAC;oCAAK,WAAU;8CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;;QA5BqB,4IAAQ;;;;QAAR,4IAAQ;;;;AA6B7B,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,oLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 13404, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/label.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"../../lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB;AAGF,MAAM,sBAAQ,2KAAgB,MAI5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,4KAAmB;QAClB,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,4KAAmB,CAAC,WAAW"}},
    {"offset": {"line": 13441, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/api/branches-api.ts"],"sourcesContent":["/**\r\n * Branches API functions\r\n * \r\n * ⚠️ Direct import: import { fetchBranches } from '@/features/settings/branches/api/branches-api'\r\n */\r\n\r\nimport type { BranchModel as Branch } from '@/generated/prisma/models/Branch';\r\n\r\nconst BASE_URL = '/api/branches';\r\n\r\nexport interface BranchesParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  isDefault?: boolean;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface BranchesResponse {\r\n  data: Branch[];\r\n  total: number;\r\n  page: number;\r\n  pageSize: number;\r\n}\r\n\r\nexport async function fetchBranches(params: BranchesParams = {}): Promise<BranchesResponse> {\r\n  const searchParams = new URLSearchParams();\r\n  \r\n  if (params.page) searchParams.set('page', String(params.page));\r\n  if (params.limit) searchParams.set('limit', String(params.limit));\r\n  if (params.search) searchParams.set('search', params.search);\r\n  if (params.isDefault !== undefined) searchParams.set('isDefault', String(params.isDefault));\r\n  if (params.sortBy) searchParams.set('sortBy', params.sortBy);\r\n  if (params.sortOrder) searchParams.set('sortOrder', params.sortOrder);\r\n  \r\n  const url = searchParams.toString() ? `${BASE_URL}?${searchParams}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branches: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function fetchBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch branch: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function createBranch(data: Omit<Branch, 'systemId' | 'createdAt' | 'updatedAt'>): Promise<Branch> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to create branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function updateBranch(systemId: string, data: Partial<Branch>): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PUT',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to update branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function deleteBranch(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to delete branch: ${response.statusText}`);\r\n  }\r\n}\r\n\r\nexport async function setDefaultBranch(systemId: string): Promise<Branch> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to set default branch');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport type { Branch };\r\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;;;;AAID,MAAM,WAAW;AAkBV,eAAe,cAAc,SAAyB,CAAC,CAAC;IAC7D,MAAM,eAAe,IAAI;IAEzB,IAAI,OAAO,IAAI,EAAE,aAAa,GAAG,CAAC,QAAQ,OAAO,OAAO,IAAI;IAC5D,IAAI,OAAO,KAAK,EAAE,aAAa,GAAG,CAAC,SAAS,OAAO,OAAO,KAAK;IAC/D,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,KAAK,WAAW,aAAa,GAAG,CAAC,aAAa,OAAO,OAAO,SAAS;IACzF,IAAI,OAAO,MAAM,EAAE,aAAa,GAAG,CAAC,UAAU,OAAO,MAAM;IAC3D,IAAI,OAAO,SAAS,EAAE,aAAa,GAAG,CAAC,aAAa,OAAO,SAAS;IAEpE,MAAM,MAAM,aAAa,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,cAAc,GAAG;IACtE,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,SAAS,UAAU,EAAE;IACpE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,YAAY,QAAgB;IAChD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IAEtD,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,wBAAwB,EAAE,SAAS,UAAU,EAAE;IAClE;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,IAA0D;IAC3F,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB,EAAE,IAAqB;IACxE,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,SAAS,UAAU,EAAE;IACnE;AACF;AAEO,eAAe,iBAAiB,QAAgB;IACrD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;IAChD;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACnD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;IAEA,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 13538, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-branches.ts"],"sourcesContent":["/**\r\n * useBranches - React Query hooks\r\n * \r\n * ⚠️ Direct import: import { useBranches } from '@/features/settings/branches/hooks/use-branches'\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchBranches,\r\n  fetchBranch,\r\n  createBranch,\r\n  updateBranch,\r\n  deleteBranch,\r\n  setDefaultBranch,\r\n  type BranchesParams,\r\n  type Branch,\r\n} from '../api/branches-api';\r\n\r\nexport const branchKeys = {\r\n  all: ['branches'] as const,\r\n  lists: () => [...branchKeys.all, 'list'] as const,\r\n  list: (params: BranchesParams) => [...branchKeys.lists(), params] as const,\r\n  details: () => [...branchKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...branchKeys.details(), id] as const,\r\n};\r\n\r\nexport function useBranches(params: BranchesParams = {}) {\r\n  return useQuery({\r\n    queryKey: branchKeys.list(params),\r\n    queryFn: () => fetchBranches(params),\r\n    staleTime: 10 * 60 * 1000, // Branches rarely change\r\n    gcTime: 60 * 60 * 1000,\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\nexport function useBranch(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: branchKeys.detail(id!),\r\n    queryFn: () => fetchBranch(id!),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\ninterface UseBranchMutationsOptions {\r\n  onCreateSuccess?: (branch: Branch) => void;\r\n  onUpdateSuccess?: (branch: Branch) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onSetDefaultSuccess?: (branch: Branch) => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useBranchMutations(options: UseBranchMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: Partial<Branch> }) => \r\n      updateBranch(systemId, data),\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.lists() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: deleteBranch,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const makeDefault = useMutation({\r\n    mutationFn: setDefaultBranch,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: branchKeys.all });\r\n      options.onSetDefaultSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return { create, update, remove, makeDefault };\r\n}\r\n\r\nexport function useAllBranches() {\r\n  return useBranches({ limit: 100 });\r\n}\r\n\r\nexport function useDefaultBranch() {\r\n  const { data, ...rest } = useBranches({ isDefault: true, limit: 1 });\r\n  return {\r\n    ...rest,\r\n    data: data?.data?.[0] ?? null,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;CAIC,GAED;AAAA;AAAA;AAAA;AACA;;;;AAWO,MAAM,aAAa;IACxB,KAAK;QAAC;KAAW;IACjB,OAAO,IAAM;eAAI,WAAW,GAAG;YAAE;SAAO;IACxC,MAAM,CAAC,SAA2B;eAAI,WAAW,KAAK;YAAI;SAAO;IACjE,SAAS,IAAM;eAAI,WAAW,GAAG;YAAE;SAAS;IAC5C,QAAQ,CAAC,KAAe;eAAI,WAAW,OAAO;YAAI;SAAG;AACvD;AAEO,SAAS,YAAY,SAAyB,CAAC,CAAC;;IACrD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,WAAW,IAAI,CAAC;QAC1B,OAAO;oCAAE,IAAM,IAAA,8KAAa,EAAC;;QAC7B,WAAW,KAAK,KAAK;QACrB,QAAQ,KAAK,KAAK;QAClB,iBAAiB,8LAAgB;IACnC;AACF;GARgB;;QACP,0LAAQ;;;AASV,SAAS,UAAU,EAA6B;;IACrD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,WAAW,MAAM,CAAC;QAC5B,OAAO;kCAAE,IAAM,IAAA,4KAAW,EAAC;;QAC3B,SAAS,CAAC,CAAC;QACX,WAAW,KAAK,KAAK;IACvB;AACF;IAPgB;;QACP,0LAAQ;;;AAgBV,SAAS,mBAAmB,UAAqC,CAAC,CAAC;;IACxE,MAAM,cAAc,IAAA,2MAAc;IAElC,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,YAAY,6KAAY;QACxB,SAAS;sDAAE,CAAC;gBACV,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,eAAe,GAAG;YAC5B;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;sDAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAA+C,GAC1E,IAAA,6KAAY,EAAC,UAAU;;QACzB,SAAS;sDAAE,CAAC,MAAM;gBAChB,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,MAAM,CAAC,UAAU,QAAQ;gBAAE;gBAChF,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,KAAK;gBAAG;gBAC7D,QAAQ,eAAe,GAAG;YAC5B;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,YAAY,6KAAY;QACxB,SAAS;sDAAE;gBACT,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,eAAe;YACzB;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,cAAc,IAAA,gMAAW,EAAC;QAC9B,YAAY,iLAAgB;QAC5B,SAAS;2DAAE,CAAC;gBACV,YAAY,iBAAiB,CAAC;oBAAE,UAAU,WAAW,GAAG;gBAAC;gBACzD,QAAQ,mBAAmB,GAAG;YAChC;;QACA,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QAAE;QAAQ;QAAQ;QAAQ;IAAY;AAC/C;IA1CgB;;QACM,2MAAc;QAEnB,gMAAW;QASX,gMAAW;QAWX,gMAAW;QASN,gMAAW;;;AAY1B,SAAS;;IACd,OAAO,YAAY;QAAE,OAAO;IAAI;AAClC;IAFgB;;QACP;;;AAGF,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,GAAG,YAAY;QAAE,WAAW;QAAM,OAAO;IAAE;IAClE,OAAO;QACL,GAAG,IAAI;QACP,MAAM,MAAM,MAAM,CAAC,EAAE,IAAI;IAC3B;AACF;IANgB;;QACY"}},
    {"offset": {"line": 13724, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/hooks/use-all-branches.ts"],"sourcesContent":["/**\r\n * useAllBranches - Convenience hook for components needing all branches as flat array\r\n * \r\n * Use case: Dropdowns, selects that need branch options\r\n * \r\n * ⚠️ For paginated views, use useBranches() instead\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { useBranches } from './use-branches';\r\nimport type { Branch } from '../types';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\n/**\r\n * Returns all branches as a flat array\r\n * Compatible with legacy store pattern: { data: branches }\r\n * \r\n * Note: API returns string systemIds, but we cast to Branch[] for internal use\r\n */\r\nexport function useAllBranches() {\r\n  const query = useBranches({ limit: 100 });\r\n  \r\n  return {\r\n    // Cast to Branch[] - API returns string systemId, but we trust the data structure\r\n    data: (query.data?.data || []) as unknown as Branch[],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n\r\n/**\r\n * Returns branches formatted as options for Select/Combobox\r\n */\r\nexport function useBranchOptions() {\r\n  const { data, isLoading } = useAllBranches();\r\n  \r\n  const options = data.map(b => ({\r\n    value: b.systemId,\r\n    label: b.name,\r\n  }));\r\n  \r\n  return { options, isLoading };\r\n}\r\n\r\n/**\r\n * Returns the default branch\r\n */\r\nexport function useDefaultBranch() {\r\n  const { data, isLoading } = useAllBranches();\r\n  const defaultBranch = data.find(b => b.isDefault) || data[0];\r\n  \r\n  return { defaultBranch, isLoading };\r\n}\r\n\r\n/**\r\n * Helper hook to find a branch by ID from cached data\r\n * Replaces legacy findById() method\r\n */\r\nexport function useBranchFinder() {\r\n  const { data } = useAllBranches();\r\n  \r\n  const findById = React.useCallback(\r\n    (systemId: SystemId | string | undefined) => {\r\n      if (!systemId) return undefined;\r\n      return data.find(b => b.systemId === systemId);\r\n    },\r\n    [data]\r\n  );\r\n  \r\n  return { findById };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;CAMC,GAED;AACA;;;;AAUO,SAAS;;IACd,MAAM,QAAQ,IAAA,8KAAW,EAAC;QAAE,OAAO;IAAI;IAEvC,OAAO;QACL,kFAAkF;QAClF,MAAO,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC7B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GAVgB;;QACA,8KAAW;;;AAcpB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAE5B,MAAM,UAAU,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;YAC7B,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,IAAI;QACf,CAAC;IAED,OAAO;QAAE;QAAS;IAAU;AAC9B;IATgB;;QACc;;;AAavB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;IAC5B,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,IAAI,CAAC,EAAE;IAE5D,OAAO;QAAE;QAAe;IAAU;AACpC;IALgB;;QACc;;;AAUvB,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG;IAEjB,MAAM,WAAW,4KAAiB;iDAChC,CAAC;YACC,IAAI,CAAC,UAAU,OAAO;YACtB,OAAO,KAAK,IAAI;yDAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;;QACvC;gDACA;QAAC;KAAK;IAGR,OAAO;QAAE;IAAS;AACpB;IAZgB;;QACG"}},
    {"offset": {"line": 13823, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/shared/simple-print-options-dialog.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Dialog, DialogContent, DialogFooter, DialogHeader, DialogTitle } from \"../ui/dialog\";\r\nimport { Button } from \"../ui/button\";\r\nimport { Label } from \"../ui/label\";\r\nimport { Checkbox } from \"../ui/checkbox\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../ui/select\";\r\nimport { cn } from \"../../lib/utils\";\r\nimport { useAllBranches } from \"../../features/settings/branches/hooks/use-all-branches\";\r\n\r\n// Paper size options matching the order print dialog\r\nconst PAPER_SIZE_OPTIONS = [\r\n  { label: 'A4', value: 'A4' },\r\n  { label: 'A5', value: 'A5' },\r\n  { label: 'A6', value: 'A6' },\r\n  { label: 'K80', value: 'K80' },\r\n  { label: 'K57', value: 'K57' },\r\n] as const;\r\n\r\nexport type PaperSize = typeof PAPER_SIZE_OPTIONS[number]['value'];\r\n\r\n// In-memory session cache for print defaults\r\nlet sessionDefaults: Partial<SimplePrintOptionsResult> = {};\r\n\r\nexport interface SimplePrintOptionsResult {\r\n  branchSystemId: string;\r\n  paperSize: PaperSize;\r\n}\r\n\r\ninterface SimplePrintOptionsDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onConfirm: (options: SimplePrintOptionsResult) => void;\r\n  selectedCount: number;\r\n  title?: string;\r\n}\r\n\r\n// Helper to load saved defaults (in-memory only)\r\nfunction loadSavedDefaults(): Partial<SimplePrintOptionsResult> {\r\n  return sessionDefaults;\r\n}\r\n\r\n// Helper to save defaults (in-memory only)\r\nfunction saveDefaults(options: SimplePrintOptionsResult) {\r\n  sessionDefaults = options;\r\n}\r\n\r\nexport function SimplePrintOptionsDialog({\r\n  open,\r\n  onOpenChange,\r\n  onConfirm,\r\n  selectedCount,\r\n  title = 'Tùy chọn in',\r\n}: SimplePrintOptionsDialogProps) {\r\n  const { data: branches } = useAllBranches();\r\n  const activeBranches = branches;\r\n\r\n  // Form state with saved defaults\r\n  const savedDefaults = React.useMemo(() => loadSavedDefaults(), []);\r\n  const defaultBranch = activeBranches.find(b => b.isDefault)?.systemId ?? activeBranches[0]?.systemId ?? '';\r\n  \r\n  const [branchSystemId, setBranchSystemId] = React.useState<string>(\r\n    savedDefaults.branchSystemId ?? defaultBranch\r\n  );\r\n  const [paperSize, setPaperSize] = React.useState<PaperSize>(\r\n    savedDefaults.paperSize ?? 'A4'\r\n  );\r\n  const [saveAsDefault, setSaveAsDefault] = React.useState(false);\r\n\r\n  // Reset form when dialog opens\r\n  React.useEffect(() => {\r\n    if (open) {\r\n      const defaults = loadSavedDefaults();\r\n      setBranchSystemId(defaults.branchSystemId ?? defaultBranch);\r\n      setPaperSize(defaults.paperSize ?? 'A4');\r\n      setSaveAsDefault(false);\r\n    }\r\n  }, [open, defaultBranch]);\r\n\r\n  const handleConfirm = () => {\r\n    const options: SimplePrintOptionsResult = {\r\n      branchSystemId,\r\n      paperSize,\r\n    };\r\n\r\n    if (saveAsDefault) {\r\n      saveDefaults(options);\r\n    }\r\n\r\n    onConfirm(options);\r\n    onOpenChange(false);\r\n  };\r\n\r\n  // Get branch display name\r\n  const selectedBranchName = React.useMemo(() => {\r\n    if (!branchSystemId) return 'Chi nhánh mặc định';\r\n    const branch = activeBranches.find(b => b.systemId === branchSystemId);\r\n    return branch?.name ?? 'Chi nhánh mặc định';\r\n  }, [branchSystemId, activeBranches]);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[480px]\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"text-lg\">\r\n            {title}\r\n            {selectedCount > 1 && (\r\n              <span className=\"ml-2 text-sm font-normal text-muted-foreground\">\r\n                ({selectedCount} phiếu)\r\n              </span>\r\n            )}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"grid gap-6 py-4\">\r\n          {/* Chi nhánh */}\r\n          <div className=\"flex items-center gap-4\">\r\n            <Label className=\"min-w-[160px] text-right text-muted-foreground\">\r\n              Chọn mẫu in tại chi nhánh\r\n            </Label>\r\n            <Select value={branchSystemId} onValueChange={setBranchSystemId}>\r\n              <SelectTrigger className=\"flex-1\">\r\n                <SelectValue placeholder=\"Chi nhánh mặc định\">\r\n                  {selectedBranchName}\r\n                </SelectValue>\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {activeBranches.map(branch => (\r\n                  <SelectItem key={branch.systemId} value={branch.systemId}>\r\n                    {branch.name} {branch.isDefault ? '(mặc định)' : ''}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Khổ giấy - Button group */}\r\n          <div className=\"space-y-3\">\r\n            <Label className=\"text-muted-foreground\">Chọn mẫu in phiếu</Label>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {PAPER_SIZE_OPTIONS.map(option => (\r\n                <Button\r\n                  key={option.value}\r\n                  type=\"button\"\r\n                  variant={paperSize === option.value ? \"default\" : \"outline\"}\r\n                  size=\"sm\"\r\n                  className={cn(\r\n                    \"min-w-[70px]\",\r\n                    paperSize === option.value && \"bg-primary text-primary-foreground\"\r\n                  )}\r\n                  onClick={() => setPaperSize(option.value)}\r\n                >\r\n                  {option.label}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Save as default checkbox */}\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Checkbox\r\n              id=\"save-default\"\r\n              checked={saveAsDefault}\r\n              onCheckedChange={(checked) => setSaveAsDefault(checked === true)}\r\n            />\r\n            <Label \r\n              htmlFor=\"save-default\" \r\n              className=\"text-sm cursor-pointer text-muted-foreground\"\r\n            >\r\n              Đặt làm mặc định cho chức năng in tùy chọn\r\n            </Label>\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n            Thoát\r\n          </Button>\r\n          <Button onClick={handleConfirm}>\r\n            In\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 14147, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payroll/list-page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { AlertTriangle, ClipboardList, PlusCircle, ShieldCheck, Wallet, Printer, XCircle } from 'lucide-react';\r\nimport { Button } from '../../components/ui/button';\r\nimport { usePageHeader } from '../../contexts/page-header-context';\r\nimport { ROUTES } from '../../lib/router';\r\nimport { usePayrollBatchStore } from './payroll-batch-store';\r\nimport { PayrollSummaryCards, type PayrollSummaryCard } from './components/summary-cards';\r\nimport type { PayrollBatch } from '../../lib/payroll-types';\r\nimport { ResponsiveDataTable } from '../../components/data-table/responsive-data-table';\r\nimport { PageFilters } from '../../components/layout/page-filters';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../components/ui/select';\r\nimport { getBatchColumns } from './components/batch-columns';\r\nimport { BatchCard } from './components/batch-card';\r\nimport { useDefaultPageSize } from '../settings/global-settings-store';\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\nimport { toast } from 'sonner';\r\nimport { usePaymentStore } from '../payments/store';\r\nimport { usePenaltyStore } from '../settings/penalties/store';\r\nimport { usePrint } from '../../lib/use-print';\r\nimport { useEmployeeStore } from '../employees/store';\r\nimport { useDepartmentStore } from '../settings/departments/store';\r\nimport { useStoreInfoStore } from '../settings/store-info/store-info-store';\r\nimport {\r\n  convertPayrollBatchForPrint,\r\n  createStoreSettings,\r\n  mapPayrollBatchToPrintData,\r\n  mapPayrollBatchLineItems,\r\n} from '../../lib/print/payroll-print-helper';\r\nimport { SimplePrintOptionsDialog, SimplePrintOptionsResult, PaperSize } from '../../components/shared/simple-print-options-dialog';\r\nimport { formatDateForDisplay } from '@/lib/date-utils';\r\n\r\ntype FilterValues = {\r\n  status: 'all' | 'draft' | 'reviewed' | 'locked' | 'cancelled';\r\n  keyword: string;\r\n  monthKey?: string;\r\n};\r\n\r\nconst defaultFilters: FilterValues = {\r\n  status: 'all',\r\n  keyword: '',\r\n  monthKey: undefined,\r\n};\r\n\r\nconst currencyFormatter = new Intl.NumberFormat('vi-VN', {\r\n  style: 'currency',\r\n  currency: 'VND',\r\n  maximumFractionDigits: 0,\r\n});\r\n\r\nconst formatCurrency = (value?: number) =>\r\n  typeof value === 'number' ? currencyFormatter.format(value) : '—';\r\n\r\nconst formatMonthKey = (monthKey: string) => {\r\n  if (!monthKey) {\r\n    return '—';\r\n  }\r\n  const [year, month] = monthKey.split('-');\r\n  return `Tháng ${month}/${year}`;\r\n};\r\n\r\nconst formatDate = (value: string) => {\r\n  if (!value) {\r\n    return '—';\r\n  }\r\n  return formatDateForDisplay(value);\r\n};\r\n\r\nconst getMonthKey = (date: Date) => `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\r\n\r\nconst matchesKeyword = (batch: PayrollBatch, keyword: string) => {\r\n  if (!keyword) return true;\r\n  const normalized = keyword.trim().toLowerCase();\r\n  return (\r\n    batch.id.toLowerCase().includes(normalized) ||\r\n    batch.title.toLowerCase().includes(normalized)\r\n  );\r\n};\r\n\r\nconst matchesMonthFilter = (batch: PayrollBatch, monthKey?: string) => {\r\n  if (!monthKey) return true;\r\n  return batch.referenceAttendanceMonthKeys.includes(monthKey);\r\n};\r\n\r\nconst matchesStatusFilter = (\r\n  batch: PayrollBatch,\r\n  status: FilterValues['status']\r\n) => {\r\n  if (status === 'all') {\r\n    return true;\r\n  }\r\n  return batch.status === status;\r\n};\r\n\r\nexport function PayrollListPage() {\r\n  const router = useRouter();\r\n  const { batches, updateBatchStatus, payslips } = usePayrollBatchStore();\r\n  const defaultPageSize = useDefaultPageSize();\r\n  const { print } = usePrint();\r\n  const { data: employees } = useEmployeeStore();\r\n  const { data: departments } = useDepartmentStore();\r\n  const { info: storeInfo } = useStoreInfoStore();\r\n  \r\n  // Filters state\r\n  const [filters, setFilters] = React.useState<FilterValues>(defaultFilters);\r\n  const [globalFilter, setGlobalFilter] = React.useState('');\r\n  const [debouncedGlobalFilter, setDebouncedGlobalFilter] = React.useState('');\r\n  \r\n  // Table state\r\n  const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({});\r\n  const [sorting, setSorting] = React.useState<{ id: string; desc: boolean }>({ id: 'createdAt', desc: true });\r\n  const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: defaultPageSize });\r\n  const [expanded, setExpanded] = React.useState<Record<string, boolean>>({});\r\n  const [columnVisibility, setColumnVisibility] = React.useState<Record<string, boolean>>({});\r\n  const [columnOrder, setColumnOrder] = React.useState<string[]>([]);\r\n  const [pinnedColumns, setPinnedColumns] = React.useState<string[]>([]);\r\n  \r\n  // Debounce search input\r\n  React.useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedGlobalFilter(globalFilter);\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [globalFilter]);\r\n  \r\n  // Actions for columns\r\n  const handleLock = React.useCallback((systemId: string) => {\r\n    updateBatchStatus(asSystemId(systemId), 'locked');\r\n    toast.success('Đã khóa bảng lương');\r\n  }, [updateBatchStatus]);\r\n  \r\n  const handleUnlock = React.useCallback((systemId: string) => {\r\n    updateBatchStatus(asSystemId(systemId), 'reviewed');\r\n    toast.success('Đã mở khóa bảng lương');\r\n  }, [updateBatchStatus]);\r\n\r\n  const cancelBatch = usePayrollBatchStore((state) => state.cancelBatch);\r\n  const allPayments = usePaymentStore((state) => state.data);\r\n  const cancelPayment = usePaymentStore((state) => state.cancel);\r\n  const penaltyStore = usePenaltyStore();\r\n  \r\n  const handleCancel = React.useCallback((systemId: string) => {\r\n    const batchSystemId = asSystemId(systemId);\r\n    const batch = batches.find(b => b.systemId === batchSystemId);\r\n    \r\n    // Cancel related payments first\r\n    const relatedPayments = allPayments.filter(\r\n      (p) => p.linkedPayrollBatchSystemId === batchSystemId && p.status !== 'cancelled'\r\n    );\r\n    \r\n    relatedPayments.forEach((payment) => {\r\n      cancelPayment(payment.systemId, 'Hủy do bảng lương bị hủy');\r\n    });\r\n    \r\n    // Rollback penalties linked to this batch\r\n    // Get all payslips in this batch\r\n    const batchPayslipIds = batch?.payslipSystemIds || [];\r\n    const batchPayslips = payslips.filter(p => batchPayslipIds.includes(p.systemId));\r\n    \r\n    // Collect all penalty IDs that were deducted in this batch\r\n    const penaltyIdsToRollback: SystemId[] = [];\r\n    batchPayslips.forEach(payslip => {\r\n      if (payslip.deductedPenaltySystemIds?.length) {\r\n        penaltyIdsToRollback.push(...payslip.deductedPenaltySystemIds);\r\n      }\r\n    });\r\n    \r\n    // Also check penalties linked via deductedInPayrollId\r\n    const linkedPenalties = penaltyStore.data.filter(\r\n      p => p.deductedInPayrollId === batchSystemId\r\n    );\r\n    linkedPenalties.forEach(p => {\r\n      if (!penaltyIdsToRollback.includes(p.systemId)) {\r\n        penaltyIdsToRollback.push(p.systemId);\r\n      }\r\n    });\r\n    \r\n    // Rollback each penalty\r\n    const now = new Date().toISOString();\r\n    penaltyIdsToRollback.forEach(penaltyId => {\r\n      const penalty = penaltyStore.data.find(p => p.systemId === penaltyId);\r\n      if (penalty) {\r\n        penaltyStore.update(penalty.systemId, {\r\n          ...penalty,\r\n          status: 'Chưa thanh toán',\r\n          deductedInPayrollId: undefined,\r\n          deductedAt: undefined,\r\n          updatedAt: now,\r\n        });\r\n      }\r\n    });\r\n    \r\n    // Then cancel the batch\r\n    const result = cancelBatch(batchSystemId);\r\n    if (result.success) {\r\n      const paymentMsg = relatedPayments.length > 0 \r\n        ? ` (đã hủy ${relatedPayments.length} phiếu thu liên quan)` \r\n        : '';\r\n      const penaltyMsg = penaltyIdsToRollback.length > 0\r\n        ? ` Đã khôi phục ${penaltyIdsToRollback.length} phiếu phạt về trạng thái chưa thanh toán.`\r\n        : '';\r\n      toast.success(`Đã hủy bảng lương${paymentMsg}`, {\r\n        description: penaltyMsg || undefined,\r\n      });\r\n    } else {\r\n      toast.error(result.error ?? 'Không thể hủy bảng lương');\r\n    }\r\n  }, [cancelBatch, batches, payslips, allPayments, cancelPayment, penaltyStore]);\r\n  \r\n  const columns = React.useMemo(() => getBatchColumns({\r\n    navigate: (path: string) => router.push(path),\r\n    onLock: handleLock,\r\n    onUnlock: handleUnlock,\r\n    onCancel: handleCancel,\r\n  }), [router, handleLock, handleUnlock, handleCancel]);\r\n\r\n  const filteredBatches = React.useMemo(() => {\r\n    return batches\r\n      .filter((batch) => matchesStatusFilter(batch, filters.status))\r\n      .filter((batch) => matchesMonthFilter(batch, filters.monthKey))\r\n      .filter((batch) => matchesKeyword(batch, debouncedGlobalFilter))\r\n      .sort((a, b) => new Date(b.payrollDate).getTime() - new Date(a.payrollDate).getTime());\r\n  }, [batches, filters, debouncedGlobalFilter]);\r\n\r\n  const summaryCards = React.useMemo<PayrollSummaryCard[]>(() => {\r\n    const now = new Date();\r\n    const currentMonthKey = getMonthKey(now);\r\n    const previousMonthKey = getMonthKey(new Date(now.getFullYear(), now.getMonth() - 1, 1));\r\n\r\n    const currentMonthTotal = batches\r\n      .filter((batch) => batch.referenceAttendanceMonthKeys.includes(currentMonthKey))\r\n      .reduce((sum, batch) => sum + batch.totalNet, 0);\r\n\r\n    const draftCount = batches.filter((batch) => batch.status === 'draft').length;\r\n    const reviewedCount = batches.filter((batch) => batch.status === 'reviewed').length;\r\n\r\n    const previousMonthLocked = batches.some(\r\n      (batch) =>\r\n        batch.referenceAttendanceMonthKeys.includes(previousMonthKey) && batch.status === 'locked'\r\n    );\r\n\r\n    const cards: PayrollSummaryCard[] = [\r\n      {\r\n        id: 'current-month-total',\r\n        title: 'Tổng chi phí kỳ hiện tại',\r\n        value: formatCurrency(currentMonthTotal),\r\n        description: `Theo ${formatMonthKey(currentMonthKey)}`,\r\n        icon: Wallet,\r\n      },\r\n      {\r\n        id: 'pending-review',\r\n        title: 'Batch cần duyệt',\r\n        value: draftCount,\r\n        description: 'Đang ở trạng thái Nháp',\r\n        icon: ClipboardList,\r\n      },\r\n      {\r\n        id: 'awaiting-lock',\r\n        title: 'Chờ khóa',\r\n        value: reviewedCount,\r\n        description: 'Đã duyệt, chờ khóa',\r\n        icon: ShieldCheck,\r\n      },\r\n      previousMonthLocked\r\n        ? {\r\n            id: 'previous-month-locked',\r\n            title: 'Kỳ trước đã khóa',\r\n            value: 'Đã hoàn tất',\r\n            description: formatMonthKey(previousMonthKey),\r\n            icon: ShieldCheck,\r\n          }\r\n        : {\r\n            id: 'previous-month-warning',\r\n            title: 'Cảnh báo: chưa khóa kỳ trước',\r\n            value: 'Chưa khóa',\r\n            description: formatMonthKey(previousMonthKey),\r\n            icon: AlertTriangle,\r\n            className: 'border-amber-300 bg-amber-50 dark:bg-amber-950/40',\r\n          },\r\n    ];\r\n\r\n    return cards;\r\n  }, [batches]);\r\n\r\n  const headerActions = React.useMemo(\r\n    () => [\r\n      <Button\r\n        key=\"run\"\r\n        className=\"h-9\"\r\n        size=\"sm\"\r\n        onClick={() => router.push(ROUTES.PAYROLL.RUN)}\r\n      >\r\n        <PlusCircle className=\"mr-2 h-4 w-4\" />\r\n        Chạy bảng lương\r\n      </Button>,\r\n    ],\r\n    [router]\r\n  );\r\n  \r\n  // Filter + search + sort the data\r\n  const processedBatches = React.useMemo(() => {\r\n    let result = batches\r\n      .filter((batch) => matchesStatusFilter(batch, filters.status))\r\n      .filter((batch) => matchesMonthFilter(batch, filters.monthKey));\r\n    \r\n    // Apply text search\r\n    if (debouncedGlobalFilter) {\r\n      result = result.filter((batch) => matchesKeyword(batch, debouncedGlobalFilter));\r\n    }\r\n    \r\n    // Apply sorting\r\n    if (sorting.id) {\r\n      result = [...result].sort((a, b) => {\r\n        const aValue = (a as any)[sorting.id];\r\n        const bValue = (b as any)[sorting.id];\r\n        if (aValue === null || aValue === undefined) return 1;\r\n        if (bValue === null || bValue === undefined) return -1;\r\n        // Special handling for date columns\r\n        if (sorting.id === 'createdAt' || sorting.id === 'payrollDate') {\r\n          const aTime = aValue ? new Date(aValue).getTime() : 0;\r\n          const bTime = bValue ? new Date(bValue).getTime() : 0;\r\n          return sorting.desc ? bTime - aTime : aTime - bTime;\r\n        }\r\n        if (aValue < bValue) return sorting.desc ? 1 : -1;\r\n        if (aValue > bValue) return sorting.desc ? -1 : 1;\r\n        return 0;\r\n      });\r\n    }\r\n    \r\n    return result;\r\n  }, [batches, filters.status, filters.monthKey, debouncedGlobalFilter, sorting]);\r\n  \r\n  // Reset pagination when filters change\r\n  React.useEffect(() => {\r\n    setPagination(p => ({ ...p, pageIndex: 0 }));\r\n  }, [debouncedGlobalFilter, filters.status, filters.monthKey]);\r\n  \r\n  // Pagination\r\n  const pageCount = Math.ceil(processedBatches.length / pagination.pageSize);\r\n  const paginatedBatches = React.useMemo(() => {\r\n    const start = pagination.pageIndex * pagination.pageSize;\r\n    const end = start + pagination.pageSize;\r\n    return processedBatches.slice(start, end);\r\n  }, [processedBatches, pagination]);\r\n  \r\n  const allSelectedRows = React.useMemo(() =>\r\n    batches.filter(batch => rowSelection[batch.systemId]),\r\n    [batches, rowSelection]\r\n  );\r\n\r\n  // Bulk actions\r\n  const handleBulkCancel = React.useCallback(() => {\r\n    const cancellableBatches = allSelectedRows.filter(b => b.status !== 'locked' && b.status !== 'cancelled');\r\n    if (cancellableBatches.length === 0) {\r\n      toast.error('Không có bảng lương nào có thể hủy');\r\n      return;\r\n    }\r\n    \r\n    let totalPaymentsCancelled = 0;\r\n    let totalPenaltiesRolledBack = 0;\r\n    const now = new Date().toISOString();\r\n    \r\n    cancellableBatches.forEach((batch) => {\r\n      // Cancel related payments\r\n      const relatedPayments = allPayments.filter(\r\n        (p) => p.linkedPayrollBatchSystemId === batch.systemId && p.status !== 'cancelled'\r\n      );\r\n      relatedPayments.forEach((payment) => {\r\n        cancelPayment(payment.systemId, 'Hủy do bảng lương bị hủy');\r\n        totalPaymentsCancelled++;\r\n      });\r\n      \r\n      // Rollback penalties linked to this batch\r\n      const batchPayslipIds = batch.payslipSystemIds || [];\r\n      const batchPayslips = payslips.filter(p => batchPayslipIds.includes(p.systemId));\r\n      \r\n      // Collect all penalty IDs that were deducted in this batch\r\n      const penaltyIdsToRollback: SystemId[] = [];\r\n      batchPayslips.forEach(payslip => {\r\n        if (payslip.deductedPenaltySystemIds?.length) {\r\n          penaltyIdsToRollback.push(...payslip.deductedPenaltySystemIds);\r\n        }\r\n      });\r\n      \r\n      // Also check penalties linked via deductedInPayrollId\r\n      const linkedPenalties = penaltyStore.data.filter(\r\n        p => p.deductedInPayrollId === batch.systemId\r\n      );\r\n      linkedPenalties.forEach(p => {\r\n        if (!penaltyIdsToRollback.includes(p.systemId)) {\r\n          penaltyIdsToRollback.push(p.systemId);\r\n        }\r\n      });\r\n      \r\n      // Rollback each penalty\r\n      penaltyIdsToRollback.forEach(penaltyId => {\r\n        const penalty = penaltyStore.data.find(p => p.systemId === penaltyId);\r\n        if (penalty) {\r\n          penaltyStore.update(penalty.systemId, {\r\n            ...penalty,\r\n            status: 'Chưa thanh toán',\r\n            deductedInPayrollId: undefined,\r\n            deductedAt: undefined,\r\n            updatedAt: now,\r\n          });\r\n          totalPenaltiesRolledBack++;\r\n        }\r\n      });\r\n      \r\n      cancelBatch(batch.systemId);\r\n    });\r\n    \r\n    const paymentMsg = totalPaymentsCancelled > 0 ? ` (đã hủy ${totalPaymentsCancelled} phiếu thu liên quan)` : '';\r\n    const penaltyMsg = totalPenaltiesRolledBack > 0 ? ` Đã khôi phục ${totalPenaltiesRolledBack} phiếu phạt.` : '';\r\n    toast.success(`Đã hủy ${cancellableBatches.length} bảng lương${paymentMsg}`, {\r\n      description: penaltyMsg || undefined,\r\n    });\r\n    setRowSelection({});\r\n  }, [allSelectedRows, allPayments, payslips, cancelBatch, cancelPayment, penaltyStore]);\r\n\r\n  // Lookups for printing\r\n  const employeeLookup = React.useMemo(() => {\r\n    return employees.reduce<Record<SystemId, (typeof employees)[number]>>(\r\n      (acc, emp) => {\r\n        acc[emp.systemId] = emp;\r\n        return acc;\r\n      },\r\n      {} as Record<SystemId, (typeof employees)[number]>\r\n    );\r\n  }, [employees]);\r\n\r\n  const departmentLookup = React.useMemo(() => {\r\n    return departments.reduce<Record<SystemId, (typeof departments)[number]>>(\r\n      (acc, dept) => {\r\n        acc[dept.systemId] = dept;\r\n        return acc;\r\n      },\r\n      {} as Record<SystemId, (typeof departments)[number]>\r\n    );\r\n  }, [departments]);\r\n\r\n  // Print dialog state\r\n  const [isPrintDialogOpen, setIsPrintDialogOpen] = React.useState(false);\r\n  const [pendingPrintBatches, setPendingPrintBatches] = React.useState<PayrollBatch[]>([]);\r\n  const { printMultiple } = usePrint();\r\n\r\n  const handleBulkPrint = React.useCallback(() => {\r\n    if (allSelectedRows.length === 0) {\r\n      toast.error('Vui lòng chọn bảng lương để in');\r\n      return;\r\n    }\r\n    setPendingPrintBatches(allSelectedRows);\r\n    setIsPrintDialogOpen(true);\r\n  }, [allSelectedRows]);\r\n\r\n  // Handle print confirm from dialog\r\n  const handlePrintConfirm = React.useCallback((options: SimplePrintOptionsResult) => {\r\n    const { paperSize } = options;\r\n    const storeSettings = createStoreSettings(storeInfo);\r\n    \r\n    const printOptionsList: Array<{\r\n      data: ReturnType<typeof mapPayrollBatchToPrintData>;\r\n      lineItems: ReturnType<typeof mapPayrollBatchLineItems>;\r\n      paperSize: PaperSize;\r\n    }> = [];\r\n    \r\n    // Prepare print data for each batch\r\n    pendingPrintBatches.forEach((batch) => {\r\n      const batchPayslips = payslips.filter((p) => p.batchSystemId === batch.systemId);\r\n      if (batchPayslips.length === 0) return;\r\n      \r\n      const batchForPrint = convertPayrollBatchForPrint(\r\n        batch,\r\n        batchPayslips,\r\n        {\r\n          employeeLookup: employeeLookup as Record<SystemId, { fullName?: string; id?: string; department?: string }>,\r\n          departmentLookup: departmentLookup as Record<SystemId, { name?: string }>,\r\n        }\r\n      );\r\n\r\n      printOptionsList.push({\r\n        data: mapPayrollBatchToPrintData(batchForPrint, storeSettings),\r\n        lineItems: mapPayrollBatchLineItems(batchForPrint.payslips),\r\n        paperSize,\r\n      });\r\n    });\r\n    \r\n    if (printOptionsList.length > 0) {\r\n      printMultiple('payroll', printOptionsList);\r\n      toast.success(`Đã gửi lệnh in ${printOptionsList.length} bảng lương`);\r\n    }\r\n    \r\n    setRowSelection({});\r\n    setPendingPrintBatches([]);\r\n  }, [pendingPrintBatches, payslips, storeInfo, employeeLookup, departmentLookup, printMultiple]);\r\n\r\n  const bulkActions = React.useMemo(() => [\r\n    {\r\n      label: 'In bảng lương',\r\n      icon: Printer,\r\n      onSelect: handleBulkPrint,\r\n    },\r\n    {\r\n      label: 'Hủy bảng lương',\r\n      icon: XCircle,\r\n      onSelect: handleBulkCancel,\r\n      variant: 'destructive' as const,\r\n    },\r\n  ], [handleBulkPrint, handleBulkCancel]);\r\n  \r\n  // Generate month options for filter\r\n  const monthOptions = React.useMemo(() => {\r\n    const months = new Set<string>();\r\n    batches.forEach(batch => {\r\n      batch.referenceAttendanceMonthKeys.forEach(mk => months.add(mk));\r\n    });\r\n    return Array.from(months).sort().reverse();\r\n  }, [batches]);\r\n  \r\n  const handleRowClick = (row: PayrollBatch) => {\r\n    router.push(ROUTES.PAYROLL.DETAIL.replace(':systemId', row.systemId));\r\n  };\r\n\r\n  usePageHeader({\r\n    title: 'Danh sách bảng lương',\r\n    subtitle: 'Theo dõi trạng thái batch, khóa kỳ trước và điều phối chạy lương mỗi tháng',\r\n    breadcrumb: [\r\n      { label: 'Trang chủ', href: ROUTES.DASHBOARD },\r\n      { label: 'Bảng lương', href: ROUTES.PAYROLL.LIST },\r\n    ],\r\n    showBackButton: false,\r\n    actions: headerActions,\r\n  });\r\n\r\n  return (\r\n    <div className=\"flex flex-col w-full h-full\">\r\n      {/* Summary Cards */}\r\n      <PayrollSummaryCards items={summaryCards} />\r\n      \r\n      {/* Filters */}\r\n      <PageFilters\r\n        searchValue={globalFilter}\r\n        onSearchChange={setGlobalFilter}\r\n        searchPlaceholder=\"Tìm kiếm bảng lương (mã, tiêu đề)...\"\r\n      >\r\n        {/* Status Filter */}\r\n        <Select\r\n          value={filters.status}\r\n          onValueChange={(value) => setFilters(f => ({ ...f, status: value as FilterValues['status'] }))}\r\n        >\r\n          <SelectTrigger className=\"w-full sm:w-[160px] h-9\">\r\n            <SelectValue placeholder=\"Tất cả trạng thái\" />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            <SelectItem value=\"all\">Tất cả trạng thái</SelectItem>\r\n            <SelectItem value=\"draft\">Nháp</SelectItem>\r\n            <SelectItem value=\"reviewed\">Đã duyệt</SelectItem>\r\n            <SelectItem value=\"locked\">Đã khóa</SelectItem>\r\n            <SelectItem value=\"cancelled\">Đã hủy</SelectItem>\r\n          </SelectContent>\r\n        </Select>\r\n        \r\n        {/* Month Filter */}\r\n        <Select\r\n          value={filters.monthKey ?? 'all'}\r\n          onValueChange={(value) => setFilters(f => ({ ...f, monthKey: value === 'all' ? undefined : value }))}\r\n        >\r\n          <SelectTrigger className=\"w-full sm:w-[160px] h-9\">\r\n            <SelectValue placeholder=\"Tháng tham chiếu\" />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            <SelectItem value=\"all\">Tất cả tháng</SelectItem>\r\n            {monthOptions.map(mk => (\r\n              <SelectItem key={mk} value={mk}>\r\n                {formatMonthKey(mk)}\r\n              </SelectItem>\r\n            ))}\r\n          </SelectContent>\r\n        </Select>\r\n      </PageFilters>\r\n\r\n      {/* Data Table */}\r\n      <div className=\"w-full py-4\">\r\n        <ResponsiveDataTable\r\n          columns={columns}\r\n          data={paginatedBatches}\r\n          renderMobileCard={(batch) => (\r\n            <BatchCard\r\n              batch={batch}\r\n              actions={{\r\n                onLock: handleLock,\r\n                onUnlock: handleUnlock,\r\n                onCancel: handleCancel,\r\n              }}\r\n            />\r\n          )}\r\n          pageCount={pageCount}\r\n          pagination={pagination}\r\n          setPagination={setPagination}\r\n          rowCount={processedBatches.length}\r\n          rowSelection={rowSelection}\r\n          setRowSelection={setRowSelection}\r\n          allSelectedRows={allSelectedRows}\r\n          expanded={expanded}\r\n          setExpanded={setExpanded}\r\n          sorting={sorting}\r\n          setSorting={setSorting as React.Dispatch<React.SetStateAction<{ id: string; desc: boolean }>>}\r\n          columnVisibility={columnVisibility}\r\n          setColumnVisibility={setColumnVisibility}\r\n          columnOrder={columnOrder}\r\n          setColumnOrder={setColumnOrder}\r\n          pinnedColumns={pinnedColumns}\r\n          setPinnedColumns={setPinnedColumns}\r\n          onRowClick={handleRowClick}\r\n          bulkActions={bulkActions}\r\n          emptyTitle=\"Chưa có bảng lương nào\"\r\n          emptyDescription=\"Bắt đầu chạy bảng lương để tạo batch mới\"\r\n        />\r\n      </div>\r\n\r\n      {/* Print Options Dialog */}\r\n      <SimplePrintOptionsDialog\r\n        open={isPrintDialogOpen}\r\n        onOpenChange={setIsPrintDialogOpen}\r\n        onConfirm={handlePrintConfirm}\r\n        selectedCount={pendingPrintBatches.length}\r\n        title=\"In bảng lương\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 15059, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/app/%28authenticated%29/payroll/page.tsx"],"sourcesContent":["\"use client\"\r\nimport { PayrollListPage } from '@/features/payroll/list-page'\r\nexport default PayrollListPage\r\n"],"names":[],"mappings":";;;;AACA;AADA;;uCAEe,0JAAe"}}]
}