{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/api/payments-api.ts"],"sourcesContent":["/**\r\n * Payments (Phiếu Chi) API functions\r\n * \r\n * ⚠️ Direct import: import { fetchPayments } from '@/features/payments/api/payments-api'\r\n */\r\n\r\nimport type { SystemId } from '@/lib/id-types';\r\nimport type { Payment, PaymentStatus, PaymentCategory } from '../types';\r\n\r\nconst BASE_URL = '/api/payments';\r\n\r\nexport interface PaymentsParams {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  status?: PaymentStatus;\r\n  category?: PaymentCategory;\r\n  recipientTypeSystemId?: string;\r\n  recipientSystemId?: string;\r\n  branchId?: string;\r\n  accountId?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n}\r\n\r\nexport interface PaymentsResponse {\r\n  data: Payment[];\r\n  total: number;\r\n  page: number;\r\n  pageSize: number;\r\n}\r\n\r\nexport async function fetchPayments(params: PaymentsParams = {}): Promise<PaymentsResponse> {\r\n  const searchParams = new URLSearchParams();\r\n  \r\n  if (params.page) searchParams.set('page', String(params.page));\r\n  if (params.limit) searchParams.set('limit', String(params.limit));\r\n  if (params.search) searchParams.set('search', params.search);\r\n  if (params.status) searchParams.set('status', params.status);\r\n  if (params.category) searchParams.set('category', params.category);\r\n  if (params.recipientTypeSystemId) searchParams.set('recipientTypeSystemId', params.recipientTypeSystemId);\r\n  if (params.recipientSystemId) searchParams.set('recipientSystemId', params.recipientSystemId);\r\n  if (params.branchId) searchParams.set('branchId', params.branchId);\r\n  if (params.accountId) searchParams.set('accountId', params.accountId);\r\n  if (params.startDate) searchParams.set('startDate', params.startDate);\r\n  if (params.endDate) searchParams.set('endDate', params.endDate);\r\n  if (params.sortBy) searchParams.set('sortBy', params.sortBy);\r\n  if (params.sortOrder) searchParams.set('sortOrder', params.sortOrder);\r\n  \r\n  const url = searchParams.toString() ? `${BASE_URL}?${searchParams}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch payments: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function fetchPayment(systemId: SystemId): Promise<Payment> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch payment: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function createPayment(data: Omit<Payment, 'systemId' | 'id' | 'createdAt' | 'updatedAt'>): Promise<Payment> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to create payment');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function updatePayment(systemId: SystemId, data: Partial<Payment>): Promise<Payment> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PUT',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to update payment');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function deletePayment(systemId: SystemId): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to delete payment: ${response.statusText}`);\r\n  }\r\n}\r\n\r\nexport async function cancelPayment(systemId: SystemId, reason?: string): Promise<Payment> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/cancel`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ reason }),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.message || 'Failed to cancel payment');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\nexport async function fetchPaymentStats(): Promise<{\r\n  total: number;\r\n  completed: number;\r\n  cancelled: number;\r\n  totalAmount: number;\r\n}> {\r\n  const response = await fetch(`${BASE_URL}/stats`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch payment stats: ${response.statusText}`);\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/hooks/use-payments.ts"],"sourcesContent":["/**\r\n * usePayments - React Query hooks (Phiếu Chi)\r\n * \r\n * ⚠️ Direct import: import { usePayments } from '@/features/payments/hooks/use-payments'\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient, keepPreviousData } from '@tanstack/react-query';\r\nimport {\r\n  fetchPayments,\r\n  fetchPayment,\r\n  createPayment,\r\n  updatePayment,\r\n  deletePayment,\r\n  cancelPayment,\r\n  fetchPaymentStats,\r\n  type PaymentsParams,\r\n} from '../api/payments-api';\r\nimport type { Payment } from '../types';\r\nimport { asSystemId } from '@/lib/id-types';\r\n\r\nexport const paymentKeys = {\r\n  all: ['payments'] as const,\r\n  lists: () => [...paymentKeys.all, 'list'] as const,\r\n  list: (params: PaymentsParams) => [...paymentKeys.lists(), params] as const,\r\n  details: () => [...paymentKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...paymentKeys.details(), id] as const,\r\n  stats: () => [...paymentKeys.all, 'stats'] as const,\r\n};\r\n\r\nexport function usePayments(params: PaymentsParams = {}) {\r\n  return useQuery({\r\n    queryKey: paymentKeys.list(params),\r\n    queryFn: () => fetchPayments(params),\r\n    staleTime: 30_000,\r\n    gcTime: 5 * 60 * 1000,\r\n    placeholderData: keepPreviousData,\r\n  });\r\n}\r\n\r\nexport function usePayment(id: string | null | undefined) {\r\n  return useQuery({\r\n    queryKey: paymentKeys.detail(id!),\r\n    queryFn: () => fetchPayment(asSystemId(id!)),\r\n    enabled: !!id,\r\n    staleTime: 60_000,\r\n  });\r\n}\r\n\r\nexport function usePaymentStats() {\r\n  return useQuery({\r\n    queryKey: paymentKeys.stats(),\r\n    queryFn: fetchPaymentStats,\r\n    staleTime: 60_000,\r\n  });\r\n}\r\n\r\ninterface UsePaymentMutationsOptions {\r\n  onCreateSuccess?: (payment: Payment) => void;\r\n  onUpdateSuccess?: (payment: Payment) => void;\r\n  onDeleteSuccess?: () => void;\r\n  onCancelSuccess?: (payment: Payment) => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function usePaymentMutations(options: UsePaymentMutationsOptions = {}) {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const create = useMutation({\r\n    mutationFn: createPayment,\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.lists() });\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.stats() });\r\n      options.onCreateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: Partial<Payment> }) => \r\n      updatePayment(asSystemId(systemId), data),\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.lists() });\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.stats() });\r\n      options.onUpdateSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deletePayment(asSystemId(systemId)),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.all });\r\n      options.onDeleteSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  const cancel = useMutation({\r\n    mutationFn: ({ systemId, reason }: { systemId: string; reason?: string }) => \r\n      cancelPayment(asSystemId(systemId), reason),\r\n    onSuccess: (data, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.detail(variables.systemId) });\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.lists() });\r\n      queryClient.invalidateQueries({ queryKey: paymentKeys.stats() });\r\n      options.onCancelSuccess?.(data);\r\n    },\r\n    onError: options.onError,\r\n  });\r\n  \r\n  return { create, update, remove, cancel };\r\n}\r\n\r\nexport function usePaymentsByRecipient(recipientSystemId: string | null | undefined) {\r\n  return usePayments({\r\n    recipientSystemId: recipientSystemId || undefined,\r\n    limit: 50,\r\n  });\r\n}\r\n\r\nexport function usePaymentsByBranch(branchId: string | null | undefined) {\r\n  return usePayments({\r\n    branchId: branchId || undefined,\r\n    limit: 100,\r\n  });\r\n}\r\n\r\nexport function usePaymentsByDateRange(startDate: string, endDate: string) {\r\n  return usePayments({ startDate, endDate });\r\n}\r\n\r\nexport function usePaymentsByCategory(category: Payment['category']) {\r\n  return usePayments({ category: category as any });\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 367, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/columns.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { formatDateCustom } from '../../lib/date-utils';\r\nimport type { Payment } from './types';\r\nimport type { CashAccount } from \"../cashbook/types\";\r\nimport type { SystemId } from '../../lib/id-types';\r\nimport { Checkbox } from \"../../components/ui/checkbox\";\r\nimport { DataTableColumnHeader } from \"../../components/data-table/data-table-column-header\";\r\nimport { Badge } from \"../../components/ui/badge\";\r\nimport type { ColumnDef } from '../../components/data-table/types';\r\nimport { Button } from \"../../components/ui/button\";\r\nimport { Pencil, Trash2, RotateCcw, Eye, MoreHorizontal, XCircle, CheckCircle, Printer } from \"lucide-react\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"../../components/ui/tooltip\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from \"../../components/ui/dropdown-menu\";\r\n\r\nconst formatCurrency = (value?: number) => {\r\n    if (typeof value !== 'number') return '0';\r\n    return new Intl.NumberFormat('vi-VN').format(value);\r\n};\r\n\r\nconst formatDateDisplay = (dateString?: string) => {\r\n    if (!dateString) return '';\r\n    const date = new Date(dateString);\r\n    return formatDateCustom(date, \"dd/MM/yyyy\");\r\n};\r\n\r\nconst formatDateTimeDisplay = (dateString?: string) => {\r\n    if (!dateString) return '';\r\n    const date = new Date(dateString);\r\n    return formatDateCustom(date, \"dd/MM/yyyy HH:mm\");\r\n};\r\n\r\nconst getStatusBadge = (status?: Payment['status']) => {\r\n    const normalizedStatus: Payment['status'] = status === 'cancelled' ? 'cancelled' : 'completed';\r\n    const variants: Record<Payment['status'], { label: string; variant: 'default' | 'destructive' }> = {\r\n        completed: { label: 'Hoàn thành', variant: 'default' },\r\n        cancelled: { label: 'Đã hủy', variant: 'destructive' },\r\n    };\r\n    const config = variants[normalizedStatus];\r\n    return <Badge variant={config.variant}>{config.label}</Badge>;\r\n};\r\n\r\ninterface EmployeeLike {\r\n    systemId: SystemId;\r\n    fullName: string;\r\n}\r\n\r\nexport const getColumns = (\r\n    accounts: CashAccount[],\r\n    onCancel: (systemId: SystemId) => void,\r\n    navigate: (path: string) => void,\r\n    onPrint?: (payment: Payment) => void,\r\n    employees: EmployeeLike[] = []\r\n): ColumnDef<Payment>[] => [\r\n    {\r\n        id: \"select\",\r\n        header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n            <Checkbox\r\n                checked={isAllPageRowsSelected ? true : isSomePageRowsSelected ? \"indeterminate\" : false}\r\n                onCheckedChange={(value) => onToggleAll?.(!!value)}\r\n                aria-label=\"Select all\"\r\n            />\r\n        ),\r\n        cell: ({ onToggleSelect, isSelected }) => (\r\n            <Checkbox\r\n                checked={isSelected}\r\n                onCheckedChange={onToggleSelect}\r\n                aria-label=\"Select row\"\r\n            />\r\n        ),\r\n        size: 48,\r\n        meta: {\r\n            displayName: \"Chọn\",\r\n            sticky: \"left\",\r\n        }\r\n    },\r\n    {\r\n        id: \"id\",\r\n        accessorKey: \"id\",\r\n        header: ({ sorting, setSorting }) => (\r\n            <DataTableColumnHeader\r\n                title=\"Mã phiếu\"\r\n                sortKey=\"id\"\r\n                isSorted={sorting?.id === 'id'}\r\n                sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n                onSort={() => setSorting?.((s: any) => ({ id: 'id', desc: s.id === 'id' ? !s.desc : false }))}\r\n            />\r\n        ),\r\n        cell: ({ row }) => <div className=\"font-medium\">{row.id}</div>,\r\n        meta: {\r\n            displayName: \"Mã phiếu\",\r\n            group: \"Thông tin chung\"\r\n        },\r\n    },\r\n    {\r\n        id: \"date\",\r\n        accessorKey: \"date\",\r\n        header: ({ sorting, setSorting }) => (\r\n            <DataTableColumnHeader\r\n                title=\"Ngày chi\"\r\n                sortKey=\"date\"\r\n                isSorted={sorting?.id === 'date'}\r\n                sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n                onSort={() => setSorting?.((s: any) => ({ id: 'date', desc: s.id === 'date' ? !s.desc : false }))}\r\n            />\r\n        ),\r\n        cell: ({ row }) => formatDateDisplay(row.date),\r\n        meta: {\r\n            displayName: \"Ngày chi\",\r\n            group: \"Thông tin chung\"\r\n        },\r\n    },\r\n    {\r\n        id: \"amount\",\r\n        accessorKey: \"amount\",\r\n        header: ({ sorting, setSorting }) => (\r\n            <DataTableColumnHeader\r\n                title=\"Số tiền\"\r\n                sortKey=\"amount\"\r\n                isSorted={sorting?.id === 'amount'}\r\n                sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n                onSort={() => setSorting?.((s: any) => ({ id: 'amount', desc: s.id === 'amount' ? !s.desc : false }))}\r\n            />\r\n        ),\r\n        cell: ({ row }) => (\r\n            <div className=\"text-right font-medium text-red-600\">\r\n                {formatCurrency(row.amount)} ₫\r\n            </div>\r\n        ),\r\n        meta: {\r\n            displayName: \"Số tiền\",\r\n            group: \"Thông tin chung\"\r\n        },\r\n    },\r\n    {\r\n        id: \"recipientName\",\r\n        accessorKey: \"recipientName\",\r\n        header: \"Người nhận\",\r\n        cell: ({ row }) => (\r\n            <div className=\"max-w-[200px] truncate\" title={row.recipientName}>\r\n                {row.recipientName}\r\n            </div>\r\n        ),\r\n        meta: {\r\n            displayName: \"Người nhận\",\r\n            group: \"Thông tin người nhận\"\r\n        },\r\n    },\r\n    {\r\n        id: \"recipientTypeName\",\r\n        accessorKey: \"recipientTypeName\",\r\n        header: \"Loại người nhận\",\r\n        cell: ({ row }) => row.recipientTypeName,\r\n        meta: {\r\n            displayName: \"Loại người nhận\",\r\n            group: \"Thông tin người nhận\"\r\n        },\r\n    },\r\n    {\r\n        id: \"paymentMethodName\",\r\n        accessorKey: \"paymentMethodName\",\r\n        header: \"Hình thức\",\r\n        cell: ({ row }) => row.paymentMethodName,\r\n        meta: {\r\n            displayName: \"Hình thức thanh toán\",\r\n            group: \"Thông tin thanh toán\"\r\n        },\r\n    },\r\n    {\r\n        id: \"accountSystemId\",\r\n        accessorKey: \"accountSystemId\",\r\n        header: \"Tài khoản\",\r\n        cell: ({ row }) => {\r\n            const account = accounts.find(a => a.systemId === row.accountSystemId);\r\n            return (\r\n                <div className=\"max-w-[150px] truncate\" title={account?.name}>\r\n                    {account?.name || row.accountSystemId}\r\n                </div>\r\n            );\r\n        },\r\n        meta: {\r\n            displayName: \"Tài khoản\",\r\n            group: \"Thông tin thanh toán\"\r\n        },\r\n    },\r\n    {\r\n        id: \"paymentReceiptTypeName\",\r\n        accessorKey: \"paymentReceiptTypeName\",\r\n        header: \"Loại phiếu\",\r\n        cell: ({ row }) => row.paymentReceiptTypeName,\r\n        meta: {\r\n            displayName: \"Loại phiếu chi\",\r\n            group: \"Phân loại\"\r\n        },\r\n    },\r\n    {\r\n        id: \"status\",\r\n        accessorKey: \"status\",\r\n        header: \"Trạng thái\",\r\n        cell: ({ row }) => getStatusBadge(row.status),\r\n        meta: {\r\n            displayName: \"Trạng thái\",\r\n            group: \"Thông tin chung\"\r\n        },\r\n    },\r\n    {\r\n        id: \"branchName\",\r\n        accessorKey: \"branchName\",\r\n        header: \"Chi nhánh\",\r\n        cell: ({ row }) => row.branchName,\r\n        meta: {\r\n            displayName: \"Chi nhánh\",\r\n            group: \"Thông tin chi nhánh\"\r\n        },\r\n    },\r\n    {\r\n        id: \"description\",\r\n        accessorKey: \"description\",\r\n        header: \"Diễn giải\",\r\n        cell: ({ row }) => (\r\n            <div className=\"max-w-[300px] truncate\" title={row.description}>\r\n                {row.description}\r\n            </div>\r\n        ),\r\n        meta: {\r\n            displayName: \"Diễn giải\",\r\n            group: \"Thông tin chung\"\r\n        },\r\n    },\r\n    {\r\n        id: \"originalDocumentId\",\r\n        accessorKey: \"originalDocumentId\",\r\n        header: \"Chứng từ gốc\",\r\n        cell: ({ row }) => row.originalDocumentId,\r\n        meta: {\r\n            displayName: \"Chứng từ gốc\",\r\n            group: \"Liên kết\"\r\n        },\r\n    },\r\n    {\r\n        id: \"customerName\",\r\n        accessorKey: \"customerName\",\r\n        header: \"Khách hàng\",\r\n        cell: ({ row }) => row.customerName || '-',\r\n        meta: {\r\n            displayName: \"Khách hàng\",\r\n            group: \"Liên kết\"\r\n        },\r\n    },\r\n    {\r\n        id: \"affectsDebt\",\r\n        accessorKey: \"affectsDebt\",\r\n        header: \"Ảnh hưởng CN\",\r\n        cell: ({ row }) => row.affectsDebt ? <CheckCircle className=\"h-4 w-4 text-green-600\" /> : <XCircle className=\"h-4 w-4 text-gray-400\" />,\r\n        meta: {\r\n            displayName: \"Ảnh hưởng công nợ\",\r\n            group: \"Tài chính\"\r\n        },\r\n    },\r\n    {\r\n        id: \"runningBalance\",\r\n        accessorKey: \"runningBalance\",\r\n        header: \"Số dư\",\r\n        cell: ({ row }) => row.runningBalance != null ? (\r\n            <div className=\"text-right\">{formatCurrency(row.runningBalance)} ₫</div>\r\n        ) : '-',\r\n        meta: {\r\n            displayName: \"Số dư\",\r\n            group: \"Tài chính\"\r\n        },\r\n    },\r\n    {\r\n        id: \"recognitionDate\",\r\n        accessorKey: \"recognitionDate\",\r\n        header: \"Ngày ghi nhận\",\r\n        cell: ({ row }) => formatDateDisplay(row.recognitionDate),\r\n        meta: {\r\n            displayName: \"Ngày ghi nhận\",\r\n            group: \"Thông tin bổ sung\"\r\n        },\r\n    },\r\n    {\r\n        id: \"createdBy\",\r\n        accessorKey: \"createdBy\",\r\n        header: \"Người tạo\",\r\n        cell: ({ row }) => {\r\n            const employee = employees.find(e => e.systemId === row.createdBy);\r\n            return employee?.fullName || row.createdBy || '';\r\n        },\r\n        meta: {\r\n            displayName: \"Người tạo\",\r\n            group: \"Thông tin hệ thống\"\r\n        },\r\n    },\r\n    {\r\n        id: \"createdAt\",\r\n        accessorKey: \"createdAt\",\r\n        header: ({ sorting, setSorting }) => (\r\n            <DataTableColumnHeader\r\n                title=\"Ngày tạo\"\r\n                sortKey=\"createdAt\"\r\n                isSorted={sorting?.id === 'createdAt'}\r\n                sortDirection={sorting?.desc ? 'desc' : 'asc'}\r\n                onSort={() => setSorting?.((s: any) => ({ id: 'createdAt', desc: s.id === 'createdAt' ? !s.desc : false }))}\r\n            />\r\n        ),\r\n        cell: ({ row }) => formatDateTimeDisplay(row.createdAt),\r\n        meta: {\r\n            displayName: \"Ngày tạo\",\r\n            group: \"Thông tin hệ thống\"\r\n        },\r\n    },\r\n    {\r\n        id: \"actions\",\r\n        header: () => <div className=\"text-center\">Hành động</div>,\r\n        cell: ({ row }) => {\r\n            const payment = row as unknown as Payment;\r\n            const isCancelled = payment.status === 'cancelled';\r\n\r\n            return (\r\n                <div className=\"flex items-center justify-center gap-0.5\">\r\n                    {isCancelled ? (\r\n                        <TooltipProvider>\r\n                            <Tooltip>\r\n                                <TooltipTrigger asChild>\r\n                                    <div className=\"text-xs text-muted-foreground px-2\">Đã hủy</div>\r\n                                </TooltipTrigger>\r\n                                <TooltipContent>Phiếu đã bị hủy</TooltipContent>\r\n                            </Tooltip>\r\n                        </TooltipProvider>\r\n                    ) : (\r\n                        <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                                <Button\r\n                                    variant=\"ghost\"\r\n                                    size=\"icon\"\r\n                                    className=\"h-7 w-7 p-0\"\r\n                                    onClick={(e) => e.stopPropagation()}\r\n                                >\r\n                                    <MoreHorizontal className=\"h-4 w-4\" />\r\n                                </Button>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"end\" className=\"w-48\">\r\n                                <DropdownMenuItem\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        onPrint?.(payment);\r\n                                    }}\r\n                                >\r\n                                    <Printer className=\"mr-2 h-4 w-4\" />\r\n                                    In phiếu\r\n                                </DropdownMenuItem>\r\n                                <DropdownMenuItem\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        navigate(`/payments/${payment.systemId}/edit`);\r\n                                    }}\r\n                                >\r\n                                    Chỉnh sửa\r\n                                </DropdownMenuItem>\r\n                                <DropdownMenuSeparator />\r\n                                <DropdownMenuItem\r\n                                    className=\"text-destructive focus:text-destructive\"\r\n                                    onClick={(e) => {\r\n                                        e.stopPropagation();\r\n                                        onCancel(payment.systemId);\r\n                                    }}\r\n                                >\r\n                                    Hủy phiếu\r\n                                </DropdownMenuItem>\r\n                            </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                    )}\r\n                </div>\r\n            );\r\n        },\r\n        size: 90,\r\n        meta: {\r\n            displayName: \"Hành động\",\r\n            sticky: \"right\",\r\n        },\r\n    },\r\n];\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 916, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/card.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { formatDateCustom } from '../../lib/date-utils';\r\nimport type { Payment } from './types';\r\nimport type { SystemId } from '../../lib/id-types';\r\nimport { Card, CardContent, CardTitle } from \"../../components/ui/card\";\r\nimport { Badge } from \"../../components/ui/badge\";\r\nimport { TouchButton } from \"../../components/mobile/touch-button\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from \"../../components/ui/dropdown-menu\";\r\nimport { MoreHorizontal, Calendar, User, Building2, FileText, XCircle, Eye, Pencil } from \"lucide-react\";\r\n\r\nconst formatCurrency = (value?: number) => {\r\n    if (typeof value !== 'number') return '0';\r\n    return new Intl.NumberFormat('vi-VN').format(value);\r\n};\r\n\r\nconst formatDateDisplay = (dateString?: string) => {\r\n    if (!dateString) return '';\r\n    const date = new Date(dateString);\r\n    return formatDateCustom(date, \"dd/MM/yyyy\");\r\n};\r\n\r\nconst getStatusBadge = (status?: Payment['status']) => {\r\n    const normalizedStatus: Payment['status'] = status === 'cancelled' ? 'cancelled' : 'completed';\r\n    const variants: Record<Payment['status'], { label: string; variant: 'default' | 'destructive' }> = {\r\n        completed: { label: 'Hoàn thành', variant: 'default' },\r\n        cancelled: { label: 'Đã hủy', variant: 'destructive' },\r\n    };\r\n    const config = variants[normalizedStatus];\r\n    return <Badge variant={config.variant}>{config.label}</Badge>;\r\n};\r\n\r\nexport interface MobilePaymentCardProps {\r\n    payment: Payment;\r\n    onCancel: (systemId: SystemId) => void;\r\n    navigate: (path: string) => void;\r\n    handleRowClick: (payment: Payment) => void;\r\n}\r\n\r\nexport const MobilePaymentCard = ({ payment, onCancel, navigate, handleRowClick }: MobilePaymentCardProps) => {\r\n    const getInitials = (name: string) => {\r\n        return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);\r\n    };\r\n\r\n    return (\r\n        <Card \r\n            className=\"hover:shadow-md transition-shadow cursor-pointer\"\r\n            onClick={() => handleRowClick(payment)}\r\n        >\r\n            <CardContent className=\"p-4\">\r\n                {/* Header: ID + Amount + Menu */}\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                    <div className=\"flex items-center gap-2 flex-1 min-w-0\">\r\n                        <div className=\"flex items-center gap-1.5 min-w-0 flex-1\">\r\n                            <CardTitle className=\"font-semibold text-sm truncate\">{payment.id}</CardTitle>\r\n                            <span className=\"text-xs text-muted-foreground\">•</span>\r\n                            <span className=\"text-sm font-medium text-destructive\">{formatCurrency(payment.amount)} ₫</span>\r\n                        </div>\r\n                    </div>\r\n                    {payment.status !== 'cancelled' && (\r\n                        <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                                <TouchButton\r\n                                    variant=\"ghost\"\r\n                                    size=\"sm\"\r\n                                    className=\"h-9 w-10 p-0 flex-shrink-0\"\r\n                                    onClick={(e) => e.stopPropagation()}\r\n                                >\r\n                                    <MoreHorizontal className=\"h-4 w-4\" />\r\n                                </TouchButton>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"end\">\r\n                                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); navigate(`/payments/${payment.systemId}`); }}>\r\n                                    <Eye className=\"mr-2 h-4 w-4\" />\r\n                                    Xem chi tiết\r\n                                </DropdownMenuItem>\r\n                                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); navigate(`/payments/${payment.systemId}/edit`); }}>\r\n                                    <Pencil className=\"mr-2 h-4 w-4\" />\r\n                                    Chỉnh sửa\r\n                                </DropdownMenuItem>\r\n                                <DropdownMenuSeparator />\r\n                                <DropdownMenuItem \r\n                                    className=\"text-destructive focus:text-destructive\"\r\n                                    onClick={(e) => { e.stopPropagation(); onCancel(payment.systemId); }}\r\n                                >\r\n                                    <XCircle className=\"mr-2 h-4 w-4\" />\r\n                                    Hủy phiếu\r\n                                </DropdownMenuItem>\r\n                            </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Recipient + Payment Method */}\r\n                <div className=\"text-xs text-muted-foreground mb-3 flex items-center\">\r\n                    <User className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n                    <span className=\"truncate\">{payment.recipientName} • {payment.paymentMethodName}</span>\r\n                </div>\r\n\r\n                {/* Divider */}\r\n                <div className=\"border-t mb-3\" />\r\n\r\n                {/* Details */}\r\n                <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center text-xs text-muted-foreground\">\r\n                        <Calendar className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n                        <span>{formatDateDisplay(payment.date)}</span>\r\n                    </div>\r\n                    {payment.branchName && (\r\n                        <div className=\"flex items-center text-xs text-muted-foreground\">\r\n                            <Building2 className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n                            <span className=\"truncate\">{payment.branchName}</span>\r\n                        </div>\r\n                    )}\r\n                    {payment.description && (\r\n                        <div className=\"flex items-center text-xs text-muted-foreground\">\r\n                            <FileText className=\"h-3 w-3 mr-1.5 flex-shrink-0\" />\r\n                            <span className=\"truncate\">{payment.description}</span>\r\n                        </div>\r\n                    )}\r\n                    <div className=\"flex items-center justify-between text-xs pt-1\">\r\n                        <div className=\"flex items-center text-muted-foreground\">\r\n                            {payment.paymentReceiptTypeName && (\r\n                                <span className=\"text-xs\">{payment.paymentReceiptTypeName}</span>\r\n                            )}\r\n                        </div>\r\n                        {getStatusBadge(payment.status)}\r\n                    </div>\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1303, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from \"react\";\r\nimport { useRouter } from 'next/navigation';\r\nimport { useColumnVisibility } from '@/hooks/use-column-visibility';\r\nimport { usePayments, usePaymentMutations } from \"./hooks/use-payments\";\r\nimport { useReceipts } from \"../receipts/hooks/use-receipts\";\r\nimport { useCashbookAccounts } from \"../cashbook/hooks/use-cashbook\";\r\nimport { useAllBranches } from \"../settings/branches/hooks/use-branches\";\r\nimport { usePaymentTypes } from \"../settings/payments/types/hooks/use-payment-types\";\r\nimport { useCustomers } from \"../customers/hooks/use-customers\";\r\nimport { useStoreInfo } from \"../settings/store-info/hooks/use-store-info\";\r\nimport { useAllEmployees } from \"../employees/hooks/use-employees\";\r\nimport type { Payment } from \"./types\";\r\nimport type { Receipt } from \"../receipts/types\";\r\nimport { usePageHeader } from \"../../contexts/page-header-context\";\r\nimport { ResponsiveDataTable, type BulkAction } from \"../../components/data-table/responsive-data-table\";\r\nimport { Card, CardContent } from \"../../components/ui/card\";\r\nimport { Button } from \"../../components/ui/button\";\r\nimport { Minus, ReceiptText, Printer, FileSpreadsheet, Download } from \"lucide-react\";\r\nimport { GenericImportDialogV2 } from \"../../components/shared/generic-import-dialog-v2\";\r\nimport { GenericExportDialogV2 } from \"../../components/shared/generic-export-dialog-v2\";\r\nimport { paymentImportExportConfig } from \"../../lib/import-export/configs/payment.config\";\r\nimport { useAuth } from \"../../contexts/auth-context\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"../../components/ui/alert-dialog\";\r\nimport Fuse from \"fuse.js\";\r\nimport { DataTableColumnCustomizer } from \"../../components/data-table/data-table-column-toggle\";\r\nimport { DataTableImportDialog } from \"../../components/data-table/data-table-import-dialog\";\r\nimport { DataTableDateFilter } from \"../../components/data-table/data-table-date-filter\";\r\nimport { DataTableFacetedFilter } from \"../../components/data-table/data-table-faceted-filter\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../components/ui/select\";\r\nimport { PageToolbar } from \"../../components/layout/page-toolbar\";\r\nimport { PageFilters } from \"../../components/layout/page-filters\";\r\nimport { useMediaQuery } from \"../../lib/use-media-query\";\r\nimport { ROUTES, generatePath } from \"../../lib/router\";\r\nimport { toast } from \"sonner\";\r\nimport { toISODate, toISODateTime } from '../../lib/date-utils';\r\nimport { isAfter, isBefore, isSameDay, differenceInMilliseconds } from 'date-fns';\r\nimport { getColumns } from \"./columns\";\r\nimport { asSystemId, type SystemId } from \"../../lib/id-types\";\r\nimport { MobilePaymentCard } from \"./card\";\r\nimport { usePrint } from \"../../lib/use-print\";\r\nimport { \r\n  convertPaymentForPrint,\r\n  mapPaymentToPrintData,\r\n  createStoreSettings,\r\n} from \"../../lib/print/payment-print-helper\";\r\nimport { SimplePrintOptionsDialog, type SimplePrintOptionsResult } from \"../../components/shared/simple-print-options-dialog\";\r\n\r\nexport function PaymentsPage() {\r\n    const router = useRouter();\r\n    const isMobile = useMediaQuery(\"(max-width: 768px)\");\r\n\r\n    // React Query hooks\r\n    const { data: paymentsData } = usePayments();\r\n    const payments = paymentsData?.data || [];\r\n    const { remove: removeMutation, cancel: cancelMutation } = usePaymentMutations();\r\n    \r\n    const { data: receiptsData } = useReceipts();\r\n    const receipts = receiptsData?.data || [];\r\n    const { data: accountsData } = useCashbookAccounts();\r\n    const accounts = accountsData || [];\r\n    const { data: branchesData } = useAllBranches();\r\n    const branches = branchesData?.data || [];\r\n    const { data: paymentTypesData } = usePaymentTypes();\r\n    const paymentTypes = paymentTypesData?.data || [];\r\n    const { data: customersData } = useCustomers();\r\n    const customers = customersData?.data || [];\r\n    const { data: storeInfoData } = useStoreInfo();\r\n    const storeInfo = storeInfoData || null;\r\n    const { data: employeesData } = useAllEmployees();\r\n    const employees = employeesData || [];\r\n    \r\n    // Remove helper\r\n    const remove = React.useCallback((systemId: SystemId) => {\r\n      removeMutation.mutate(systemId);\r\n    }, [removeMutation]);\r\n    \r\n    // Cancel helper\r\n    const cancel = React.useCallback((systemId: SystemId, reason?: string) => {\r\n      cancelMutation.mutate({ systemId, reason });\r\n    }, [cancelMutation]);\r\n    \r\n    const { print, printMultiple } = usePrint();\r\n    const { employee } = useAuth();\r\n\r\n    // Print dialog state\r\n    const [printDialogOpen, setPrintDialogOpen] = React.useState(false);\r\n    const [itemsToPrint, setItemsToPrint] = React.useState<Payment[]>([]);\r\n    \r\n    // Import/Export dialog state\r\n    const [showImportDialog, setShowImportDialog] = React.useState(false);\r\n    const [showExportDialog, setShowExportDialog] = React.useState(false);\r\n    \r\n    // ✅ Header Actions\r\n    const headerActions = React.useMemo(() => [\r\n        <Button\r\n            key=\"cashbook\"\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"h-9 gap-2\"\r\n            onClick={() => router.push(ROUTES.FINANCE.CASHBOOK)}\r\n        >\r\n            <ReceiptText className=\"h-4 w-4\" />\r\n            Nhật ký quỹ\r\n        </Button>,\r\n        <Button key=\"add\" size=\"sm\" className=\"h-9 gap-2\" onClick={() => router.push(ROUTES.FINANCE.PAYMENT_NEW)}>\r\n            <Minus className=\"mr-2 h-4 w-4\" />\r\n            Tạo phiếu chi\r\n        </Button>\r\n    ], [router]);\r\n    \r\n    usePageHeader({\r\n        title: 'Danh sách phiếu chi',\r\n        breadcrumb: [\r\n            { label: 'Trang chủ', href: '/', isCurrent: false },\r\n            { label: 'Phiếu chi', href: '/payments', isCurrent: true }\r\n        ],\r\n        showBackButton: false,\r\n        actions: headerActions\r\n    });\r\n\r\n    const [rowSelection, setRowSelection] = React.useState<Record<string, boolean>>({});\r\n    const [isAlertOpen, setIsAlertOpen] = React.useState(false);\r\n    const [idToDelete, setIdToDelete] = React.useState<SystemId | null>(null);\r\n    const [isBulkDeleteAlertOpen, setIsBulkDeleteAlertOpen] = React.useState(false);\r\n\r\n    const [sorting, setSorting] = React.useState({ id: 'createdAt', desc: true });\r\n    const [globalFilter, setGlobalFilter] = React.useState('');\r\n    const [debouncedGlobalFilter, setDebouncedGlobalFilter] = React.useState('');\r\n    const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 20 });\r\n    const [mobileLoadedCount, setMobileLoadedCount] = React.useState(20);\r\n    const [columnVisibility, setColumnVisibility] = useColumnVisibility('payments', {});\r\n    \r\n    const [columnOrder, setColumnOrder] = React.useState<string[]>([]);\r\n    const [pinnedColumns, setPinnedColumns] = React.useState<string[]>(['select', 'id']);\r\n    \r\n    // ✅ New Filters\r\n    const [branchFilter, setBranchFilter] = React.useState<'all' | SystemId>('all');\r\n    const [statusFilter, setStatusFilter] = React.useState<Set<string>>(new Set());\r\n    const [typeFilter, setTypeFilter] = React.useState<Set<string>>(new Set());\r\n    const [customerFilter, setCustomerFilter] = React.useState<Set<string>>(new Set());\r\n    const [dateRange, setDateRange] = React.useState<[string | undefined, string | undefined] | undefined>();\r\n    \r\n    // ✅ Debounce search\r\n    React.useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            setDebouncedGlobalFilter(globalFilter);\r\n        }, 300);\r\n        return () => clearTimeout(timer);\r\n    }, [globalFilter]);\r\n    \r\n    const handleCancel = React.useCallback((systemId: SystemId) => {\r\n        setIdToDelete(systemId);\r\n        setIsAlertOpen(true);\r\n    }, []);\r\n    \r\n    const handleEdit = React.useCallback((payment: Payment) => {\r\n        router.push(generatePath(ROUTES.FINANCE.PAYMENT_EDIT, { systemId: payment.systemId }));\r\n    }, [router]);\r\n    \r\n    const handleRowClick = React.useCallback((payment: Payment) => {\r\n        router.push(generatePath(ROUTES.FINANCE.PAYMENT_VIEW, { systemId: payment.systemId }));\r\n    }, [router]);\r\n\r\n    // Single print handler for dropdown action\r\n    const handleSinglePrint = React.useCallback((payment: Payment) => {\r\n        const branch = branches.find(b => b.systemId === payment.branchSystemId);\r\n        const storeSettings = branch \r\n            ? createStoreSettings(branch)\r\n            : createStoreSettings(storeInfo);\r\n        const paymentData = convertPaymentForPrint(payment, {});\r\n        \r\n        print('payment', {\r\n            data: mapPaymentToPrintData(paymentData, storeSettings),\r\n            lineItems: [],\r\n        });\r\n    }, [branches, storeInfo, print]);\r\n\r\n    const columns = React.useMemo(() => getColumns(accounts, handleCancel, (path: string) => router.push(path), handleSinglePrint, employees), [accounts, handleCancel, router, handleSinglePrint, employees]);\r\n    \r\n    // ✅ Set default column visibility - Run ONCE on mount\r\n        const hasInitializedVisibility = React.useRef(false);\r\n        React.useEffect(() => {\r\n            if (hasInitializedVisibility.current) return;\r\n            hasInitializedVisibility.current = true;\r\n\r\n            const defaultVisibleColumns = [\r\n                'id', 'date', 'amount', 'recipientName', 'recipientTypeName', 'paymentMethodName', \r\n                'accountSystemId', 'paymentReceiptTypeName', 'status', 'branchName', \r\n                'description', 'originalDocumentId', 'customerName', 'createdBy', 'createdAt'\r\n            ];\r\n            const initialVisibility: Record<string, boolean> = {};\r\n            columns.forEach(c => {\r\n                    if (c.id === 'select' || c.id === 'actions') {\r\n                            initialVisibility[c.id!] = true;\r\n                    } else {\r\n                            initialVisibility[c.id!] = defaultVisibleColumns.includes(c.id!);\r\n                    }\r\n            });\r\n            setColumnVisibility(initialVisibility);\r\n            setColumnOrder(columns.map(c => c.id).filter(Boolean) as string[]);\r\n        }, [columns]); // ✅ Depends on columns\r\n    \r\n    const fuse = React.useMemo(() => new Fuse(payments, { \r\n        keys: [\"id\", \"description\", \"recipientName\", \"originalDocumentId\", \"createdBy\"],\r\n        threshold: 0.3,\r\n        ignoreLocation: true\r\n    }), [payments]);\r\n    \r\n    const confirmCancel = () => { \r\n        if (idToDelete) {\r\n            cancel(idToDelete);\r\n            toast.success(\"Đã hủy phiếu chi\");\r\n        }\r\n        setIsAlertOpen(false); \r\n    };\r\n\r\n    const confirmBulkCancel = () => {\r\n        const idsToCancel = Object.keys(rowSelection).map(id => asSystemId(id));\r\n        idsToCancel.forEach(id => cancel(id));\r\n        toast.success(`Đã hủy ${idsToCancel.length} phiếu chi`);\r\n        setRowSelection({});\r\n        setIsBulkDeleteAlertOpen(false);\r\n    };\r\n\r\n    const handleAddNew = () => {\r\n        router.push(ROUTES.FINANCE.PAYMENT_NEW);\r\n    };\r\n    \r\n    // ✅ Filter options\r\n    const statusOptions = React.useMemo(() => [\r\n        { value: 'completed', label: 'Hoàn thành' },\r\n        { value: 'cancelled', label: 'Đã hủy' }\r\n    ], []);\r\n    \r\n    const typeOptions = React.useMemo(() => \r\n        paymentTypes.map(pt => ({ value: pt.systemId, label: pt.name }))\r\n    , [paymentTypes]);\r\n    \r\n    const customerOptions = React.useMemo(() => \r\n        customers.map(c => ({ value: c.systemId, label: c.name }))\r\n    , [customers]);\r\n    \r\n    // ✅ Apply all filters\r\n    const filteredData = React.useMemo(() => {\r\n        let result = payments;\r\n        \r\n        // Branch filter\r\n        if (branchFilter !== 'all') {\r\n            result = result.filter(r => r.branchSystemId === branchFilter);\r\n        }\r\n        \r\n        // Status filter\r\n        if (statusFilter.size > 0) {\r\n            result = result.filter(r => r.status && statusFilter.has(r.status));\r\n        }\r\n        \r\n        // Type filter\r\n        if (typeFilter.size > 0) {\r\n            result = result.filter(r => r.paymentReceiptTypeSystemId && typeFilter.has(r.paymentReceiptTypeSystemId));\r\n        }\r\n        \r\n        // Customer filter\r\n        if (customerFilter.size > 0) {\r\n            result = result.filter(r => r.customerSystemId && customerFilter.has(r.customerSystemId));\r\n        }\r\n        \r\n        // Date range filter\r\n        if (dateRange && (dateRange[0] || dateRange[1])) {\r\n            result = result.filter(r => {\r\n                if (!r.date) return false;\r\n                const voucherDate = new Date(r.date);\r\n                const start = dateRange[0] ? new Date(dateRange[0]) : null;\r\n                const end = dateRange[1] ? new Date(dateRange[1]) : null;\r\n                \r\n                if (start && end) {\r\n                    return (isAfter(voucherDate, start) || isSameDay(voucherDate, start)) && \r\n                           (isBefore(voucherDate, end) || isSameDay(voucherDate, end));\r\n                } else if (start) {\r\n                    return isAfter(voucherDate, start) || isSameDay(voucherDate, start);\r\n                } else if (end) {\r\n                    return isBefore(voucherDate, end) || isSameDay(voucherDate, end);\r\n                }\r\n                return true;\r\n            });\r\n        }\r\n        \r\n        // Text search (debounced)\r\n        if (debouncedGlobalFilter) {\r\n            const searchResults = fuse.search(debouncedGlobalFilter);\r\n            const searchIds = new Set(searchResults.map(r => r.item.systemId));\r\n            result = result.filter(r => searchIds.has(r.systemId));\r\n        }\r\n        \r\n        return result;\r\n    }, [payments, branchFilter, statusFilter, typeFilter, customerFilter, dateRange, debouncedGlobalFilter, fuse]);\r\n    \r\n    const filteredPaymentIds = React.useMemo(() => new Set(filteredData.map(p => p.systemId)), [filteredData]);\r\n\r\n    const runningBalanceByPayment = React.useMemo(() => {\r\n        if (filteredPaymentIds.size === 0) {\r\n            return new Map<SystemId, number>();\r\n        }\r\n\r\n        const startDate = dateRange?.[0] ? new Date(dateRange[0]) : null;\r\n        const endDate = dateRange?.[1] ? new Date(dateRange[1]) : null;\r\n\r\n        const trackedAccounts = branchFilter === 'all'\r\n            ? accounts\r\n            : accounts.filter(acc => acc.branchSystemId === branchFilter);\r\n\r\n        const accountBalances = new Map<SystemId, number>();\r\n        trackedAccounts.forEach(account => {\r\n            accountBalances.set(account.systemId, account.initialBalance);\r\n        });\r\n\r\n        let aggregateRunningBalance = 0;\r\n        accountBalances.forEach(value => {\r\n            aggregateRunningBalance += value;\r\n        });\r\n\r\n        const ensureAccountTracked = (accountId?: SystemId): SystemId | null => {\r\n            if (!accountId) {\r\n                return null;\r\n            }\r\n            if (!accountBalances.has(accountId)) {\r\n                const fallback = accounts.find(acc => acc.systemId === accountId);\r\n                const initial = fallback?.initialBalance ?? 0;\r\n                accountBalances.set(accountId, initial);\r\n                aggregateRunningBalance += initial;\r\n            }\r\n            return accountId;\r\n        };\r\n\r\n        const matchesBranch = (branchId?: SystemId) => branchFilter === 'all' || branchId === branchFilter;\r\n\r\n        type BalanceTransaction = (Receipt & { kind: 'receipt' }) | (Payment & { kind: 'payment' });\r\n\r\n        const receiptTransactions: BalanceTransaction[] = (receipts ?? [])\r\n            .filter(r => r && r.accountSystemId && r.date && matchesBranch(r.branchSystemId))\r\n            .map(r => ({ ...r, kind: 'receipt' as const }));\r\n\r\n        const paymentTransactions: BalanceTransaction[] = payments\r\n            .filter(p => p && p.accountSystemId && p.date && matchesBranch(p.branchSystemId))\r\n            .map(p => ({ ...p, kind: 'payment' as const }));\r\n\r\n        const transactions = [...receiptTransactions, ...paymentTransactions].sort((a, b) => {\r\n            const primary = differenceInMilliseconds(new Date(a.date), new Date(b.date));\r\n            if (primary !== 0) {\r\n                return primary;\r\n            }\r\n            const aCreated = ('createdAt' in a && a.createdAt) ? new Date(a.createdAt) : new Date(a.date);\r\n            const bCreated = ('createdAt' in b && b.createdAt) ? new Date(b.createdAt) : new Date(b.date);\r\n            return differenceInMilliseconds(aCreated, bCreated);\r\n        });\r\n\r\n        const runningBalances = new Map<SystemId, number>();\r\n\r\n        transactions.forEach(transaction => {\r\n            const accountId = ensureAccountTracked(transaction.accountSystemId);\r\n            if (!accountId) {\r\n                return;\r\n            }\r\n\r\n            const transactionDate = new Date(transaction.date);\r\n            const delta = transaction.kind === 'receipt'\r\n                ? (transaction.status === 'cancelled' ? 0 : transaction.amount)\r\n                : (transaction.status === 'cancelled' ? 0 : -transaction.amount);\r\n\r\n            if (startDate && transactionDate < startDate) {\r\n                const current = accountBalances.get(accountId) ?? 0;\r\n                accountBalances.set(accountId, current + delta);\r\n                aggregateRunningBalance += delta;\r\n                return;\r\n            }\r\n\r\n            if (endDate && transactionDate > endDate) {\r\n                return;\r\n            }\r\n\r\n            const currentBalance = accountBalances.get(accountId) ?? 0;\r\n            const updatedBalance = currentBalance + delta;\r\n            accountBalances.set(accountId, updatedBalance);\r\n            aggregateRunningBalance += delta;\r\n\r\n            if (transaction.kind === 'payment' && filteredPaymentIds.has(transaction.systemId)) {\r\n                runningBalances.set(transaction.systemId, aggregateRunningBalance);\r\n            }\r\n        });\r\n\r\n        return runningBalances;\r\n    }, [accounts, branchFilter, receipts, payments, filteredPaymentIds, dateRange]);\r\n\r\n    const dataWithRunningBalance = React.useMemo(() =>\r\n        filteredData.map(payment => ({\r\n            ...payment,\r\n            runningBalance: runningBalanceByPayment.get(payment.systemId) ?? undefined,\r\n        })),\r\n    [filteredData, runningBalanceByPayment]);\r\n    \r\n    const sortedData = React.useMemo(() => {\r\n      const sorted = [...dataWithRunningBalance];\r\n      if (sorting.id) {\r\n        sorted.sort((a, b) => {\r\n          const aValue = (a as any)[sorting.id];\r\n          const bValue = (b as any)[sorting.id];\r\n          // Special handling for date columns - parse as Date for proper comparison\r\n          if (sorting.id === 'createdAt' || sorting.id === 'date') {\r\n            const aTime = aValue ? new Date(aValue).getTime() : 0;\r\n            const bTime = bValue ? new Date(bValue).getTime() : 0;\r\n            // Nếu thời gian bằng nhau, sort theo systemId (ID mới hơn = số lớn hơn)\r\n            if (aTime === bTime) {\r\n              const aNum = parseInt(a.systemId.replace(/\\D/g, '')) || 0;\r\n              const bNum = parseInt(b.systemId.replace(/\\D/g, '')) || 0;\r\n              return sorting.desc ? bNum - aNum : aNum - bNum;\r\n            }\r\n            return sorting.desc ? bTime - aTime : aTime - bTime;\r\n          }\r\n          if (aValue < bValue) return sorting.desc ? 1 : -1;\r\n          if (aValue > bValue) return sorting.desc ? -1 : 1;\r\n          return 0;\r\n        });\r\n      }\r\n      return sorted;\r\n    }, [dataWithRunningBalance, sorting]);\r\n    \r\n    const allSelectedRows = React.useMemo(() => \r\n            payments.filter(v => rowSelection[v.systemId]),\r\n        [payments, rowSelection]);\r\n\r\n    // Bulk print handlers\r\n    const handleBulkPrint = React.useCallback((rows: Payment[]) => {\r\n        setItemsToPrint(rows);\r\n        setPrintDialogOpen(true);\r\n    }, []);\r\n\r\n    const handlePrintConfirm = React.useCallback((options: SimplePrintOptionsResult) => {\r\n        if (itemsToPrint.length === 0) return;\r\n        \r\n        const printItems = itemsToPrint.map(payment => {\r\n            const selectedBranch = options.branchSystemId \r\n                ? branches.find(b => b.systemId === options.branchSystemId)\r\n                : branches.find(b => b.systemId === payment.branchSystemId);\r\n            const storeSettings = selectedBranch \r\n                ? createStoreSettings(selectedBranch)\r\n                : createStoreSettings(storeInfo);\r\n            const paymentData = convertPaymentForPrint(payment, {});\r\n            \r\n            return {\r\n                data: mapPaymentToPrintData(paymentData, storeSettings),\r\n                lineItems: [],\r\n                paperSize: options.paperSize,\r\n            };\r\n        });\r\n\r\n        printMultiple('payment', printItems);\r\n        toast.success(`Đang in ${itemsToPrint.length} phiếu chi`);\r\n        setItemsToPrint([]);\r\n        setPrintDialogOpen(false);\r\n    }, [itemsToPrint, branches, storeInfo, printMultiple]);\r\n\r\n    // Bulk actions\r\n    const bulkActions: BulkAction<Payment>[] = React.useMemo(() => [\r\n        {\r\n            label: 'In phiếu',\r\n            icon: Printer,\r\n            onSelect: handleBulkPrint,\r\n        },\r\n    ], [handleBulkPrint]);\r\n\r\n    // Selected payments for export\r\n    const selectedPayments = React.useMemo(() => {\r\n        return payments.filter(p => rowSelection[p.systemId]);\r\n    }, [payments, rowSelection]);\r\n\r\n    // Import handler\r\n    const handleImport = React.useCallback(async (\r\n        importedPayments: Partial<Payment>[],\r\n        mode: 'insert-only' | 'update-only' | 'upsert',\r\n        _branchId?: string\r\n    ) => {\r\n        let addedCount = 0;\r\n        let updatedCount = 0;\r\n        let skippedCount = 0;\r\n        const errors: Array<{ row: number; message: string }> = [];\r\n        \r\n        // Using mutations for import\r\n        const { create: createMutation, update: updateMutation } = usePaymentMutations();\r\n        \r\n        for (let index = 0; index < importedPayments.length; index++) {\r\n            const payment = importedPayments[index];\r\n            try {\r\n                const existing = payments.find(p => \r\n                    p.id.toLowerCase() === (payment.id || '').toLowerCase()\r\n                );\r\n                \r\n                if (existing) {\r\n                    if (mode === 'update-only' || mode === 'upsert') {\r\n                        await updateMutation.mutateAsync({ \r\n                          systemId: existing.systemId, \r\n                          data: { ...existing, ...payment, systemId: existing.systemId } as Partial<Payment>\r\n                        });\r\n                        updatedCount++;\r\n                    } else {\r\n                        skippedCount++;\r\n                    }\r\n                } else {\r\n                    if (mode === 'insert-only' || mode === 'upsert') {\r\n                        await createMutation.mutateAsync(payment as Payment);\r\n                        addedCount++;\r\n                    } else {\r\n                        skippedCount++;\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                errors.push({ row: index + 1, message: (error as Error).message });\r\n            }\r\n        }\r\n        \r\n        if (addedCount > 0 || updatedCount > 0) {\r\n            const messages = [];\r\n            if (addedCount > 0) messages.push(`${addedCount} phiếu chi mới`);\r\n            if (updatedCount > 0) messages.push(`${updatedCount} phiếu cập nhật`);\r\n            toast.success(`Đã import: ${messages.join(', ')}`);\r\n        }\r\n        \r\n        return {\r\n            success: addedCount + updatedCount,\r\n            failed: errors.length,\r\n            inserted: addedCount,\r\n            updated: updatedCount,\r\n            skipped: skippedCount,\r\n            errors,\r\n        };\r\n    }, [payments]);\r\n\r\n    // ✅ Mobile infinite scroll\r\n    React.useEffect(() => {\r\n        if (!isMobile) return;\r\n\r\n        const handleScroll = () => {\r\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n            const scrollHeight = document.documentElement.scrollHeight;\r\n            const clientHeight = window.innerHeight;\r\n            const scrollPercentage = (scrollTop + clientHeight) / scrollHeight;\r\n\r\n            if (scrollPercentage > 0.8 && mobileLoadedCount < sortedData.length) {\r\n                setMobileLoadedCount(prev => Math.min(prev + 20, sortedData.length));\r\n            }\r\n        };\r\n\r\n        window.addEventListener('scroll', handleScroll);\r\n        return () => window.removeEventListener('scroll', handleScroll);\r\n    }, [isMobile, mobileLoadedCount, sortedData.length]);\r\n\r\n    // ✅ Reset mobile loaded count when filters change\r\n    React.useEffect(() => {\r\n        setMobileLoadedCount(20);\r\n    }, [debouncedGlobalFilter, branchFilter, statusFilter, typeFilter, customerFilter, dateRange]);\r\n\r\n    const pageCount = Math.ceil(sortedData.length / pagination.pageSize);\r\n    const paginatedData = React.useMemo(() => sortedData.slice(pagination.pageIndex * pagination.pageSize, (pagination.pageIndex + 1) * pagination.pageSize), [sortedData, pagination]);\r\n\r\n    return (\r\n        <div className=\"space-y-4 h-full flex flex-col\">\r\n            {/* Desktop-only Toolbar */}\r\n            {!isMobile && (\r\n                <PageToolbar\r\n                    leftActions={\r\n                        <>\r\n                            <Button variant=\"outline\" size=\"sm\" onClick={() => setShowImportDialog(true)}>\r\n                                <FileSpreadsheet className=\"mr-2 h-4 w-4\" />\r\n                                Nhập file\r\n                            </Button>\r\n                            <Button variant=\"outline\" size=\"sm\" onClick={() => setShowExportDialog(true)}>\r\n                                <Download className=\"mr-2 h-4 w-4\" />\r\n                                Xuất Excel\r\n                            </Button>\r\n                        </>\r\n                    }\r\n                    rightActions={[\r\n                        <DataTableColumnCustomizer\r\n                            key=\"customizer\"\r\n                            columns={columns}\r\n                            columnVisibility={columnVisibility}\r\n                            setColumnVisibility={setColumnVisibility}\r\n                            columnOrder={columnOrder}\r\n                            setColumnOrder={setColumnOrder}\r\n                            pinnedColumns={pinnedColumns}\r\n                            setPinnedColumns={setPinnedColumns}\r\n                        />\r\n                    ]}\r\n                />\r\n            )}\r\n\r\n            {/* Filters Row */}\r\n            <PageFilters\r\n                searchValue={globalFilter}\r\n                onSearchChange={setGlobalFilter}\r\n                searchPlaceholder=\"Tìm theo mã phiếu, người nhận, chứng từ...\"\r\n                leftFilters={\r\n                    <DataTableDateFilter\r\n                        value={dateRange}\r\n                        onChange={setDateRange}\r\n                    />\r\n                }\r\n                rightFilters={\r\n                    <>\r\n                        <Select\r\n                            value={branchFilter}\r\n                            onValueChange={(value) => setBranchFilter(value === 'all' ? 'all' : asSystemId(value))}\r\n                        >\r\n                            <SelectTrigger className=\"h-9 w-[150px]\">\r\n                                <SelectValue placeholder=\"Chi nhánh\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                                <SelectItem value=\"all\">Tất cả chi nhánh</SelectItem>\r\n                                {branches.map(branch => (\r\n                                    <SelectItem key={branch.systemId} value={branch.systemId}>\r\n                                        {branch.name}\r\n                                    </SelectItem>\r\n                                ))}\r\n                            </SelectContent>\r\n                        </Select>\r\n                        \r\n                        <DataTableFacetedFilter\r\n                            title=\"Trạng thái\"\r\n                            options={statusOptions}\r\n                            selectedValues={statusFilter}\r\n                            onSelectedValuesChange={setStatusFilter}\r\n                        />\r\n                        \r\n                        <DataTableFacetedFilter\r\n                            title=\"Loại phiếu\"\r\n                            options={typeOptions}\r\n                            selectedValues={typeFilter}\r\n                            onSelectedValuesChange={setTypeFilter}\r\n                        />\r\n                        \r\n                        <DataTableFacetedFilter\r\n                            title=\"Khách hàng\"\r\n                            options={customerOptions}\r\n                            selectedValues={customerFilter}\r\n                            onSelectedValuesChange={setCustomerFilter}\r\n                        />\r\n                    </>\r\n                }\r\n            />\r\n\r\n            {/* Mobile View - Cards */}\r\n            {isMobile ? (\r\n                <div className=\"space-y-2 flex-1 overflow-y-auto\">\r\n                    {sortedData.length === 0 ? (\r\n                        <Card>\r\n                            <CardContent className=\"p-8 text-center text-muted-foreground\">\r\n                                Không tìm thấy phiếu chi nào\r\n                            </CardContent>\r\n                        </Card>\r\n                    ) : (\r\n                        <>\r\n                            {sortedData.slice(0, mobileLoadedCount).map(payment => (\r\n                                <MobilePaymentCard \r\n                                    key={payment.systemId} \r\n                                    payment={payment}\r\n                                    onCancel={handleCancel}\r\n                                    navigate={(path: string) => router.push(path)}\r\n                                    handleRowClick={handleRowClick}\r\n                                />\r\n                            ))}\r\n                            {mobileLoadedCount < sortedData.length && (\r\n                                <Card>\r\n                                    <CardContent className=\"p-4 text-center text-muted-foreground\">\r\n                                        <div className=\"flex items-center justify-center gap-2\">\r\n                                            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-primary\"></div>\r\n                                            <span>Đang tải thêm...</span>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            )}\r\n                            {mobileLoadedCount >= sortedData.length && sortedData.length > 20 && (\r\n                                <Card>\r\n                                    <CardContent className=\"p-4 text-center text-muted-foreground text-sm\">\r\n                                        Đã hiển thị tất cả {sortedData.length} phiếu chi\r\n                                    </CardContent>\r\n                                </Card>\r\n                            )}\r\n                        </>\r\n                    )}\r\n                </div>\r\n            ) : (\r\n                /* Desktop View - Table */\r\n                <div className=\"w-full py-4\">\r\n                    <ResponsiveDataTable\r\n                        columns={columns}\r\n                        data={paginatedData}\r\n                        pageCount={pageCount}\r\n                        pagination={pagination}\r\n                        setPagination={setPagination}\r\n                        rowCount={dataWithRunningBalance.length}\r\n                        rowSelection={rowSelection}\r\n                        setRowSelection={setRowSelection}\r\n                        onBulkDelete={() => setIsBulkDeleteAlertOpen(true)}\r\n                        sorting={sorting}\r\n                    setSorting={setSorting as React.Dispatch<React.SetStateAction<{ id: string; desc: boolean; }>>}\r\n                    allSelectedRows={allSelectedRows}\r\n                    bulkActions={bulkActions}\r\n                    expanded={{}}\r\n                    setExpanded={() => {}}\r\n                    columnVisibility={columnVisibility}\r\n                    setColumnVisibility={setColumnVisibility}\r\n                    columnOrder={columnOrder}\r\n                    setColumnOrder={setColumnOrder}\r\n                    pinnedColumns={pinnedColumns}\r\n                    setPinnedColumns={setPinnedColumns}\r\n                    onRowClick={handleRowClick}\r\n                    renderMobileCard={(payment) => (\r\n                        <MobilePaymentCard \r\n                            payment={payment}\r\n                            onCancel={handleCancel}\r\n                            navigate={(path: string) => router.push(path)}\r\n                            handleRowClick={handleRowClick}\r\n                        />\r\n                    )}\r\n                />\r\n                </div>\r\n            )}\r\n\r\n            {/* Delete Alert Dialog */}\r\n            <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n                <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Hủy phiếu chi?</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                            Phiếu chi sẽ được chuyển sang trạng thái \"Đã hủy\". Bạn có thể xem lại phiếu đã hủy trong danh sách.\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel className=\"h-9\">Đóng</AlertDialogCancel>\r\n                        <AlertDialogAction className=\"h-9\" onClick={confirmCancel}>Hủy phiếu</AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n\r\n            {/* Bulk Delete Alert Dialog */}\r\n            <AlertDialog open={isBulkDeleteAlertOpen} onOpenChange={setIsBulkDeleteAlertOpen}>\r\n                <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Hủy {Object.keys(rowSelection).length} phiếu chi?</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                            Các phiếu chi sẽ được chuyển sang trạng thái \"Đã hủy\".\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel className=\"h-9\">Đóng</AlertDialogCancel>\r\n                        <AlertDialogAction className=\"h-9\" onClick={confirmBulkCancel}>Hủy tất cả</AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n\r\n            {/* Print Options Dialog */}\r\n            <SimplePrintOptionsDialog\r\n                open={printDialogOpen}\r\n                onOpenChange={setPrintDialogOpen}\r\n                onConfirm={handlePrintConfirm}\r\n                selectedCount={itemsToPrint.length}\r\n                title=\"In phiếu chi\"\r\n            />\r\n\r\n            {/* Import Dialog */}\r\n            <GenericImportDialogV2<Payment>\r\n                open={showImportDialog}\r\n                onOpenChange={setShowImportDialog}\r\n                config={paymentImportExportConfig}\r\n                branches={branches.map(b => ({ systemId: b.systemId, name: b.name }))}\r\n                existingData={payments}\r\n                onImport={handleImport}\r\n                currentUser={{\r\n                    name: employee?.fullName || 'Hệ thống',\r\n                    systemId: employee?.systemId || asSystemId('SYSTEM'),\r\n                }}\r\n            />\r\n\r\n            {/* Export Dialog */}\r\n            <GenericExportDialogV2<Payment>\r\n                open={showExportDialog}\r\n                onOpenChange={setShowExportDialog}\r\n                config={paymentImportExportConfig}\r\n                allData={payments}\r\n                filteredData={sortedData}\r\n                currentPageData={paginatedData}\r\n                selectedData={selectedPayments}\r\n                currentUser={{\r\n                    name: employee?.fullName || 'Hệ thống',\r\n                    systemId: employee?.systemId || asSystemId('SYSTEM'),\r\n                }}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}