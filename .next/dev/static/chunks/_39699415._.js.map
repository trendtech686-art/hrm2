{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"../../lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border border-border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-h3 font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,0EACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/tabs.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Tabs = TabsPrimitive.Root\r\n\r\nconst TabsList = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.List\r\n    ref={ref}\r\n    className={cn(\r\n      \"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsList.displayName = TabsPrimitive.List.displayName\r\n\r\nconst TabsTrigger = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium text-muted-foreground ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\r\n\r\nconst TabsContent = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.Content\r\n    ref={ref}\r\n    className={cn(\r\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsContent.displayName = TabsPrimitive.Content.displayName\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,OAAO,2KAAkB;AAE/B,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,2KAAkB;QACjB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,uEACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG,2KAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,6ZACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,mIACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/use-settings-page-header.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { usePathname } from 'next/navigation';\r\nimport { Settings2 } from 'lucide-react';\r\nimport { usePageHeader, type PageHeaderState, type PageHeaderDocLink } from '../../contexts/page-header-context';\r\nimport type { BreadcrumbItem } from '../../lib/breadcrumb-system';\r\n\r\nexport type SettingsPageHeaderOptions = Omit<PageHeaderState, 'title' | 'docLink'> & {\r\n  title: string;\r\n  icon?: React.ReactNode;\r\n  docLink?: string | PageHeaderDocLink;\r\n};\r\n\r\nconst defaultDocLabel = 'Xem hướng dẫn';\r\nconst baseBreadcrumb: BreadcrumbItem[] = [\r\n  { label: 'Trang chủ', href: '/', isCurrent: false },\r\n  { label: 'Cài đặt', href: '/settings', isCurrent: false },\r\n];\r\n\r\nconst normalizeLabel = (label?: string) => label?.trim().toLocaleLowerCase('vi');\r\nconst isHomeCrumb = (item: BreadcrumbItem) => item.href === '/' || normalizeLabel(item.label) === 'trang chủ';\r\nconst isSettingsCrumb = (item: BreadcrumbItem) => item.href === '/settings' || normalizeLabel(item.label) === 'cài đặt';\r\n\r\nexport function useSettingsPageHeader(options: SettingsPageHeaderOptions) {\r\n  const pathname = usePathname();\r\n  const { title, icon, docLink, breadcrumb, ...rest } = options;\r\n\r\n  const normalizedDocLink = React.useMemo<PageHeaderDocLink | undefined>(() => {\r\n    if (!docLink) return undefined;\r\n    if (typeof docLink === 'string') {\r\n      return { href: docLink, label: defaultDocLabel };\r\n    }\r\n    return {\r\n      href: docLink.href,\r\n      label: docLink.label ?? defaultDocLabel,\r\n    };\r\n  }, [docLink]);\r\n\r\n  const decoratedTitle = React.useMemo(() => (\r\n    <span className=\"inline-flex items-center gap-2\">\r\n      {(icon ?? <Settings2 className=\"h-5 w-5 text-muted-foreground\" aria-hidden=\"true\" />)}\r\n      <span>{title}</span>\r\n    </span>\r\n  ), [icon, title]);\r\n\r\n  const normalizedBreadcrumb = React.useMemo(() => {\r\n    const custom = (breadcrumb ?? []).map((item) => ({\r\n      ...item,\r\n      href: item.href || pathname,\r\n    }));\r\n\r\n    let merged: BreadcrumbItem[] = custom.length\r\n      ? [...custom]\r\n      : [{ label: title, href: pathname, isCurrent: true }];\r\n\r\n    if (!merged.some(isHomeCrumb)) {\r\n      merged = [{ ...baseBreadcrumb[0] }, ...merged];\r\n    }\r\n\r\n    if (!merged.some(isSettingsCrumb)) {\r\n      const homeIndex = merged.findIndex(isHomeCrumb);\r\n      const insertionIndex = homeIndex >= 0 ? homeIndex + 1 : 0;\r\n      merged = [\r\n        ...merged.slice(0, insertionIndex),\r\n        { ...baseBreadcrumb[1] },\r\n        ...merged.slice(insertionIndex),\r\n      ];\r\n    }\r\n\r\n    return merged.map((item, index) => ({\r\n      ...item,\r\n      isCurrent: index === merged.length - 1,\r\n    }));\r\n  }, [breadcrumb, pathname, title]);\r\n\r\n  return usePageHeader({\r\n    ...rest,\r\n    breadcrumb: normalizedBreadcrumb,\r\n    title: decoratedTitle,\r\n    docLink: normalizedDocLink,\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;AASA,MAAM,kBAAkB;AACxB,MAAM,iBAAmC;IACvC;QAAE,OAAO;QAAa,MAAM;QAAK,WAAW;IAAM;IAClD;QAAE,OAAO;QAAW,MAAM;QAAa,WAAW;IAAM;CACzD;AAED,MAAM,iBAAiB,CAAC,QAAmB,OAAO,OAAO,kBAAkB;AAC3E,MAAM,cAAc,CAAC,OAAyB,KAAK,IAAI,KAAK,OAAO,eAAe,KAAK,KAAK,MAAM;AAClG,MAAM,kBAAkB,CAAC,OAAyB,KAAK,IAAI,KAAK,eAAe,eAAe,KAAK,KAAK,MAAM;AAEvG,SAAS,sBAAsB,OAAkC;;IACtE,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG,MAAM,GAAG;IAEtD,MAAM,oBAAoB,wKAAa;4DAAgC;YACrE,IAAI,CAAC,SAAS,OAAO;YACrB,IAAI,OAAO,YAAY,UAAU;gBAC/B,OAAO;oBAAE,MAAM;oBAAS,OAAO;gBAAgB;YACjD;YACA,OAAO;gBACL,MAAM,QAAQ,IAAI;gBAClB,OAAO,QAAQ,KAAK,IAAI;YAC1B;QACF;2DAAG;QAAC;KAAQ;IAEZ,MAAM,iBAAiB,wKAAa;yDAAC,kBACnC,6LAAC;gBAAK,WAAU;;oBACZ,sBAAQ,6LAAC,gOAAS;wBAAC,WAAU;wBAAgC,eAAY;;;;;;kCAC3E,6LAAC;kCAAM;;;;;;;;;;;;wDAER;QAAC;QAAM;KAAM;IAEhB,MAAM,uBAAuB,wKAAa;+DAAC;YACzC,MAAM,SAAS,CAAC,cAAc,EAAE,EAAE,GAAG;8EAAC,CAAC,OAAS,CAAC;wBAC/C,GAAG,IAAI;wBACP,MAAM,KAAK,IAAI,IAAI;oBACrB,CAAC;;YAED,IAAI,SAA2B,OAAO,MAAM,GACxC;mBAAI;aAAO,GACX;gBAAC;oBAAE,OAAO;oBAAO,MAAM;oBAAU,WAAW;gBAAK;aAAE;YAEvD,IAAI,CAAC,OAAO,IAAI,CAAC,cAAc;gBAC7B,SAAS;oBAAC;wBAAE,GAAG,cAAc,CAAC,EAAE;oBAAC;uBAAM;iBAAO;YAChD;YAEA,IAAI,CAAC,OAAO,IAAI,CAAC,kBAAkB;gBACjC,MAAM,YAAY,OAAO,SAAS,CAAC;gBACnC,MAAM,iBAAiB,aAAa,IAAI,YAAY,IAAI;gBACxD,SAAS;uBACJ,OAAO,KAAK,CAAC,GAAG;oBACnB;wBAAE,GAAG,cAAc,CAAC,EAAE;oBAAC;uBACpB,OAAO,KAAK,CAAC;iBACjB;YACH;YAEA,OAAO,OAAO,GAAG;uEAAC,CAAC,MAAM,QAAU,CAAC;wBAClC,GAAG,IAAI;wBACP,WAAW,UAAU,OAAO,MAAM,GAAG;oBACvC,CAAC;;QACH;8DAAG;QAAC;QAAY;QAAU;KAAM;IAEhC,OAAO,IAAA,0JAAa,EAAC;QACnB,GAAG,IAAI;QACP,YAAY;QACZ,OAAO;QACP,SAAS;IACX;AACF;GA1DgB;;QACG,oJAAW;QAmDrB,0JAAa"}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/id-types.ts"],"sourcesContent":["/**\r\n * Type-safe ID System\r\n * \r\n * Prevents mixing systemId with business ID at compile time\r\n */\r\n\r\n// Branded types for type safety\r\nexport type SystemId = string & { readonly __brand: 'SystemId' };\r\nexport type BusinessId = string & { readonly __brand: 'BusinessId' };\r\n\r\n/**\r\n * Create a SystemId from a string\r\n * Use this when you know for sure it's a systemId\r\n */\r\nexport function asSystemId(id: string): SystemId {\r\n  return id as SystemId;\r\n}\r\n\r\n/**\r\n * Create a BusinessId from a string\r\n * Use this when you know for sure it's a business ID\r\n */\r\nexport function asBusinessId(id: string): BusinessId {\r\n  return id as BusinessId;\r\n}\r\n\r\n/**\r\n * Check if a string is a valid systemId format\r\n */\r\nexport function isSystemIdFormat(id: string): boolean {\r\n  // SystemId: 8 digits + prefix (e.g., NV00000001, VOUCHER00000123)\r\n  return /^[A-Z]+\\d{8}$/.test(id);\r\n}\r\n\r\n/**\r\n * Check if a string is a valid business ID format\r\n */\r\nexport function isBusinessIdFormat(id: string): boolean {\r\n  // Business ID: shorter, variable length (e.g., NV001, PT000001)\r\n  return /^[A-Z]+\\d{3,6}$/.test(id);\r\n}\r\n\r\n/**\r\n * Safely convert unknown ID to proper type\r\n */\r\nexport function parseId(id: string): { type: 'system' | 'business'; value: SystemId | BusinessId } {\r\n  if (isSystemIdFormat(id)) {\r\n    return { type: 'system', value: asSystemId(id) };\r\n  }\r\n  if (isBusinessIdFormat(id)) {\r\n    return { type: 'business', value: asBusinessId(id) };\r\n  }\r\n  throw new Error(`Invalid ID format: ${id}`);\r\n}\r\n\r\n/**\r\n * ID Pair - Always keep systemId and businessId together\r\n */\r\nexport interface IDPair {\r\n  systemId: SystemId;\r\n  businessId: BusinessId;\r\n}\r\n\r\n/**\r\n * Entity with dual IDs\r\n */\r\nexport interface DualIDEntity {\r\n  systemId: SystemId;\r\n  id: BusinessId;\r\n}\r\n\r\n/**\r\n * Store methods with type-safe IDs\r\n */\r\nexport interface TypeSafeStore<T extends DualIDEntity> {\r\n  /** Find by systemId (for queries, relationships) */\r\n  findBySystemId(systemId: SystemId): T | null;\r\n  \r\n  /** Find by business ID (for user input, display) */\r\n  findByBusinessId(businessId: BusinessId): T | null;\r\n  \r\n  /** Update by systemId (always use systemId for updates) */\r\n  updateBySystemId(systemId: SystemId, updates: Partial<T>): void;\r\n  \r\n  /** Delete by systemId (always use systemId for deletes) */\r\n  deleteBySystemId(systemId: SystemId): void;\r\n}\r\n\r\n/**\r\n * Route params with type-safe IDs\r\n */\r\nexport interface RouteParams {\r\n  systemId?: SystemId;\r\n  id?: BusinessId;\r\n}\r\n\r\n/**\r\n * Link builder - always uses systemId\r\n */\r\nexport function buildEntityLink(path: string, entity: DualIDEntity): string {\r\n  return path.replace(':systemId', entity.systemId);\r\n}\r\n\r\n/**\r\n * Display ID - always uses business ID\r\n */\r\nexport function getDisplayId(entity: DualIDEntity): string {\r\n  return entity.id;\r\n}\r\n\r\n/**\r\n * Runtime guard: ensures a string is valid SystemId format and casts it\r\n * Logs warning if format is invalid\r\n */\r\nexport function ensureSystemId(id: string, context?: string): SystemId {\r\n  if (!isSystemIdFormat(id)) {\r\n    console.warn(`[ensureSystemId] Invalid SystemId format: \"${id}\"${context ? ` in ${context}` : ''}`);\r\n  }\r\n  return asSystemId(id);\r\n}\r\n\r\n/**\r\n * Runtime guard: ensures a string is valid BusinessId format and casts it\r\n * Logs warning if format is invalid\r\n */\r\nexport function ensureBusinessId(id: string, context?: string): BusinessId {\r\n  if (!isBusinessIdFormat(id)) {\r\n    console.warn(`[ensureBusinessId] Invalid BusinessId format: \"${id}\"${context ? ` in ${context}` : ''}`);\r\n  }\r\n  return asBusinessId(id);\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,gCAAgC;;;;;;;;;;;;;;;;;;;;;AAQzB,SAAS,WAAW,EAAU;IACnC,OAAO;AACT;AAMO,SAAS,aAAa,EAAU;IACrC,OAAO;AACT;AAKO,SAAS,iBAAiB,EAAU;IACzC,kEAAkE;IAClE,OAAO,gBAAgB,IAAI,CAAC;AAC9B;AAKO,SAAS,mBAAmB,EAAU;IAC3C,gEAAgE;IAChE,OAAO,kBAAkB,IAAI,CAAC;AAChC;AAKO,SAAS,QAAQ,EAAU;IAChC,IAAI,iBAAiB,KAAK;QACxB,OAAO;YAAE,MAAM;YAAU,OAAO,WAAW;QAAI;IACjD;IACA,IAAI,mBAAmB,KAAK;QAC1B,OAAO;YAAE,MAAM;YAAY,OAAO,aAAa;QAAI;IACrD;IACA,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,IAAI;AAC5C;AA8CO,SAAS,gBAAgB,IAAY,EAAE,MAAoB;IAChE,OAAO,KAAK,OAAO,CAAC,aAAa,OAAO,QAAQ;AAClD;AAKO,SAAS,aAAa,MAAoB;IAC/C,OAAO,OAAO,EAAE;AAClB;AAMO,SAAS,eAAe,EAAU,EAAE,OAAgB;IACzD,IAAI,CAAC,iBAAiB,KAAK;QACzB,QAAQ,IAAI,CAAC,CAAC,2CAA2C,EAAE,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI;IACpG;IACA,OAAO,WAAW;AACpB;AAMO,SAAS,iBAAiB,EAAU,EAAE,OAAgB;IAC3D,IAAI,CAAC,mBAAmB,KAAK;QAC3B,QAAQ,IAAI,CAAC,CAAC,+CAA+C,EAAE,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,SAAS,GAAG,IAAI;IACxG;IACA,OAAO,aAAa;AACtB"}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/api/receipt-types-api.ts"],"sourcesContent":["/**\r\n * Receipt Types API Layer\r\n */\r\n\r\nimport type { ReceiptType } from '../types';\r\n\r\nexport interface ReceiptTypeFilters {\r\n  page?: number;\r\n  limit?: number;\r\n  isActive?: boolean;\r\n  isBusinessResult?: boolean;\r\n}\r\n\r\nexport interface ReceiptTypeResponse {\r\n  data: ReceiptType[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface ReceiptTypeCreateInput {\r\n  systemId?: string;\r\n  id?: string;\r\n  name: string;\r\n  description?: string;\r\n  isBusinessResult?: boolean;\r\n  isActive?: boolean;\r\n  isDefault?: boolean;\r\n  color?: string;\r\n  createdAt?: string;\r\n}\r\n\r\nexport interface ReceiptTypeUpdateInput extends Partial<ReceiptTypeCreateInput> {}\r\n\r\nconst BASE_URL = '/api/settings/receipt-types';\r\n\r\nexport async function fetchReceiptTypes(\r\n  filters: ReceiptTypeFilters = {}\r\n): Promise<ReceiptTypeResponse> {\r\n  const params = new URLSearchParams();\r\n  if (filters.page) params.set('page', String(filters.page));\r\n  if (filters.limit) params.set('limit', String(filters.limit));\r\n  if (filters.isActive !== undefined) params.set('isActive', String(filters.isActive));\r\n  if (filters.isBusinessResult !== undefined) params.set('isBusinessResult', String(filters.isBusinessResult));\r\n\r\n  const url = params.toString() ? `${BASE_URL}?${params}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) throw new Error('Failed to fetch receipt types');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchReceiptTypeById(systemId: string): Promise<ReceiptType> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  if (!response.ok) throw new Error('Failed to fetch receipt type');\r\n  return response.json();\r\n}\r\n\r\nexport async function createReceiptType(data: ReceiptTypeCreateInput): Promise<ReceiptType> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to create receipt type');\r\n  return response.json();\r\n}\r\n\r\nexport async function updateReceiptType(\r\n  systemId: string,\r\n  data: ReceiptTypeUpdateInput\r\n): Promise<ReceiptType> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to update receipt type');\r\n  return response.json();\r\n}\r\n\r\nexport async function deleteReceiptType(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, { method: 'DELETE' });\r\n  if (!response.ok) throw new Error('Failed to delete receipt type');\r\n}\r\n\r\nexport async function setDefaultReceiptType(systemId: string): Promise<ReceiptType> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, { method: 'POST' });\r\n  if (!response.ok) throw new Error('Failed to set default');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchActiveReceiptTypes(): Promise<ReceiptType[]> {\r\n  const response = await fetchReceiptTypes({ isActive: true, limit: 100 });\r\n  return response.data;\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;AAmCD,MAAM,WAAW;AAEV,eAAe,kBACpB,UAA8B,CAAC,CAAC;IAEhC,MAAM,SAAS,IAAI;IACnB,IAAI,QAAQ,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,OAAO,QAAQ,IAAI;IACxD,IAAI,QAAQ,KAAK,EAAE,OAAO,GAAG,CAAC,SAAS,OAAO,QAAQ,KAAK;IAC3D,IAAI,QAAQ,QAAQ,KAAK,WAAW,OAAO,GAAG,CAAC,YAAY,OAAO,QAAQ,QAAQ;IAClF,IAAI,QAAQ,gBAAgB,KAAK,WAAW,OAAO,GAAG,CAAC,oBAAoB,OAAO,QAAQ,gBAAgB;IAE1G,MAAM,MAAM,OAAO,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,QAAQ,GAAG;IAC1D,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,qBAAqB,QAAgB;IACzD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IACtD,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,IAA4B;IAClE,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBACpB,QAAgB,EAChB,IAA4B;IAE5B,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC3E,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;AACpC;AAEO,eAAe,sBAAsB,QAAgB;IAC1D,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAAE,QAAQ;IAAO;IACrF,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,kBAAkB;QAAE,UAAU;QAAM,OAAO;IAAI;IACtE,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 490, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/hooks/use-receipt-types.ts"],"sourcesContent":["/**\r\n * Receipt Types React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchReceiptTypes,\r\n  fetchReceiptTypeById,\r\n  createReceiptType,\r\n  updateReceiptType,\r\n  deleteReceiptType,\r\n  setDefaultReceiptType,\r\n  fetchActiveReceiptTypes,\r\n  type ReceiptTypeFilters,\r\n  type ReceiptTypeCreateInput,\r\n  type ReceiptTypeUpdateInput,\r\n} from '../api/receipt-types-api';\r\n\r\nexport const receiptTypeKeys = {\r\n  all: ['receipt-types'] as const,\r\n  lists: () => [...receiptTypeKeys.all, 'list'] as const,\r\n  list: (filters: ReceiptTypeFilters) => [...receiptTypeKeys.lists(), filters] as const,\r\n  details: () => [...receiptTypeKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...receiptTypeKeys.details(), id] as const,\r\n  active: () => [...receiptTypeKeys.all, 'active'] as const,\r\n};\r\n\r\nexport function useReceiptTypes(filters: ReceiptTypeFilters = {}) {\r\n  return useQuery({\r\n    queryKey: receiptTypeKeys.list(filters),\r\n    queryFn: () => fetchReceiptTypes(filters),\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useReceiptTypeById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: receiptTypeKeys.detail(systemId!),\r\n    queryFn: () => fetchReceiptTypeById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useActiveReceiptTypes() {\r\n  return useQuery({\r\n    queryKey: receiptTypeKeys.active(),\r\n    queryFn: fetchActiveReceiptTypes,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useReceiptTypeMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n  const invalidate = () => queryClient.invalidateQueries({ queryKey: receiptTypeKeys.all });\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: ReceiptTypeCreateInput) => createReceiptType(data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: ReceiptTypeUpdateInput }) =>\r\n      updateReceiptType(systemId, data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deleteReceiptType(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const setDefault = useMutation({\r\n    mutationFn: (systemId: string) => setDefaultReceiptType(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create, update, remove, setDefault,\r\n    isLoading: create.isPending || update.isPending || remove.isPending || setDefault.isPending,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;CAEC,GAED;AAAA;AAAA;AACA;;;;AAaO,MAAM,kBAAkB;IAC7B,KAAK;QAAC;KAAgB;IACtB,OAAO,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAO;IAC7C,MAAM,CAAC,UAAgC;eAAI,gBAAgB,KAAK;YAAI;SAAQ;IAC5E,SAAS,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;IACjD,QAAQ,CAAC,KAAe;eAAI,gBAAgB,OAAO;YAAI;SAAG;IAC1D,QAAQ,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;AAClD;AAEO,SAAS,gBAAgB,UAA8B,CAAC,CAAC;;IAC9D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,IAAI,CAAC;QAC/B,OAAO;wCAAE,IAAM,IAAA,kMAAiB,EAAC;;QACjC,WAAW,OAAO,KAAK;IACzB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,mBAAmB,QAA4B;;IAC7D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM,CAAC;QACjC,OAAO;2CAAE,IAAM,IAAA,qMAAoB,EAAC;;QACpC,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IACzB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM;QAChC,SAAS,wMAAuB;QAChC,WAAW,OAAO,KAAK;IACzB;AACF;IANgB;;QACP,0LAAQ;;;AAYV,SAAS,wBAAwB,UAA6B,CAAC,CAAC;;IACrE,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,aAAa,IAAM,YAAY,iBAAiB,CAAC;YAAE,UAAU,gBAAgB,GAAG;QAAC;IAEvF,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,OAAiC,IAAA,kMAAiB,EAAC;;QAChE,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAsD,GACjF,IAAA,kMAAiB,EAAC,UAAU;;QAC9B,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,WAAqB,IAAA,kMAAiB,EAAC;;QACpD,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,aAAa,IAAA,gMAAW,EAAC;QAC7B,UAAU;+DAAE,CAAC,WAAqB,IAAA,sMAAqB,EAAC;;QACxD,SAAS;+DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QACL;QAAQ;QAAQ;QAAQ;QACxB,WAAW,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,WAAW,SAAS;IAC7F;AACF;IAjCgB;;QACM,2MAAc;QAGnB,gMAAW;QAMX,gMAAW;QAOX,gMAAW;QAMP,gMAAW"}},
    {"offset": {"line": 658, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/label.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"../../lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB;AAGF,MAAM,sBAAQ,2KAAgB,MAI5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,4KAAmB;QAClB,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,4KAAmB,CAAC,WAAW"}},
    {"offset": {"line": 695, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport {\r\n  Controller,\r\n  FormProvider,\r\n  useFormContext,\r\n  type ControllerProps,\r\n  type FieldPath,\r\n  type FieldValues,\r\n} from \"react-hook-form\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { Label } from \"./label\"\r\n\r\nconst Form = FormProvider\r\n\r\ntype FormFieldContextValue<\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n> = {\r\n  name: TName\r\n}\r\n\r\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\r\n\r\nconst FormField = <\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\r\n>({\r\n  ...props\r\n}: ControllerProps<TFieldValues, TName>) => {\r\n  return (\r\n    <FormFieldContext.Provider value={{ name: props.name }}>\r\n      <Controller {...props} />\r\n    </FormFieldContext.Provider>\r\n  )\r\n}\r\n\r\nconst useFormField = () => {\r\n  const fieldContext = React.useContext(FormFieldContext)\r\n  const itemContext = React.useContext(FormItemContext)\r\n  const { getFieldState, formState } = useFormContext()\r\n\r\n  if (!fieldContext) {\r\n    throw new Error(\"useFormField should be used within <FormField>\")\r\n  }\r\n\r\n  if (!itemContext) {\r\n    throw new Error(\"useFormField should be used within <FormItem>\")\r\n  }\r\n\r\n  const fieldState = getFieldState(fieldContext.name, formState)\r\n\r\n  const { id } = itemContext\r\n\r\n  return {\r\n    id,\r\n    name: fieldContext.name,\r\n    formItemId: `${id}-form-item`,\r\n    formDescriptionId: `${id}-form-item-description`,\r\n    formMessageId: `${id}-form-item-message`,\r\n    ...fieldState,\r\n  }\r\n}\r\n\r\ntype FormItemContextValue = {\r\n  id: string\r\n}\r\n\r\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\r\n\r\nconst FormItem = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => {\r\n  const id = React.useId()\r\n\r\n  return (\r\n    <FormItemContext.Provider value={{ id }}>\r\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\r\n    </FormItemContext.Provider>\r\n  )\r\n})\r\nFormItem.displayName = \"FormItem\"\r\n\r\nconst FormLabel = React.forwardRef<\r\n  React.ElementRef<typeof LabelPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\r\n>(({ className, ...props }, ref) => {\r\n  const { error, formItemId } = useFormField()\r\n\r\n  return (\r\n    <Label\r\n      ref={ref}\r\n      className={cn(error && \"text-destructive\", className)}\r\n      htmlFor={formItemId}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormLabel.displayName = \"FormLabel\"\r\n\r\nconst FormControl = React.forwardRef<\r\n  React.ElementRef<typeof Slot>,\r\n  React.ComponentPropsWithoutRef<typeof Slot>\r\n>(({ children, ...props }, ref) => {\r\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\r\n\r\n  const childElements = React.Children\r\n    .toArray(children)\r\n    .filter((child): child is React.ReactElement => React.isValidElement(child))\r\n\r\n  if (childElements.length === 0) {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.warn('FormControl cần ít nhất một phần tử con hợp lệ')\r\n    }\r\n    return null\r\n  }\r\n\r\n  if (childElements.length > 1 && process.env.NODE_ENV === 'development') {\r\n    console.warn('FormControl chỉ hỗ trợ một phần tử con. Đang dùng phần tử đầu tiên.')\r\n  }\r\n\r\n  return (\r\n    <Slot\r\n      ref={ref}\r\n      id={formItemId}\r\n      aria-describedby={\r\n        !error\r\n          ? `${formDescriptionId}`\r\n          : `${formDescriptionId} ${formMessageId}`\r\n      }\r\n      aria-invalid={!!error}\r\n      {...props}\r\n    >\r\n      {childElements[0]}\r\n    </Slot>\r\n  )\r\n})\r\nFormControl.displayName = \"FormControl\"\r\n\r\nconst FormDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => {\r\n  const { formDescriptionId } = useFormField()\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formDescriptionId}\r\n      className={cn(\"text-sm text-muted-foreground\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormDescription.displayName = \"FormDescription\"\r\n\r\nconst FormMessage = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, children, ...props }, ref) => {\r\n  const { error, formMessageId } = useFormField()\r\n  const body = error ? String(error?.message ?? \"\") : children\r\n\r\n  if (!body) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <p\r\n      ref={ref}\r\n      id={formMessageId}\r\n      className={cn(\"text-sm font-medium text-destructive\", className)}\r\n      {...props}\r\n    >\r\n      {body}\r\n    </p>\r\n  )\r\n})\r\nFormMessage.displayName = \"FormMessage\"\r\n\r\nexport {\r\n  useFormField,\r\n  Form,\r\n  FormItem,\r\n  FormLabel,\r\n  FormControl,\r\n  FormDescription,\r\n  FormMessage,\r\n  FormField,\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 934, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Textarea = React.forwardRef<\r\n  HTMLTextAreaElement,\r\n  React.ComponentProps<\"textarea\">\r\n>(({ className, ...props }, ref) => {\r\n  return (\r\n    <textarea\r\n      className={cn(\r\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className\r\n      )}\r\n      ref={ref}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,qBACE,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AACA,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 968, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\r\nimport { Check } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\ntype BaseCheckboxProps = React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\r\n\r\ntype CheckboxProps = Omit<BaseCheckboxProps, \"checked\" | \"defaultChecked\"> & {\r\n  checked?: CheckboxPrimitive.CheckedState | undefined\r\n  defaultChecked?: CheckboxPrimitive.CheckedState | undefined\r\n}\r\n\r\nconst Checkbox = React.forwardRef<\r\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\r\n  CheckboxProps\r\n>(({ className, checked, defaultChecked, ...props }, ref) => (\r\n  <CheckboxPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n    {...(checked !== undefined ? { checked } : {})}\r\n    {...(defaultChecked !== undefined ? { defaultChecked } : {})}\r\n  >\r\n    <CheckboxPrimitive.Indicator\r\n      className={cn(\"flex items-center justify-center text-current\")}\r\n    >\r\n      <Check className=\"h-4 w-4\" />\r\n    </CheckboxPrimitive.Indicator>\r\n  </CheckboxPrimitive.Root>\r\n))\r\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\r\n\r\nexport { Checkbox }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AASA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,oBACnD,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,kTACA;QAED,GAAG,KAAK;QACR,GAAI,YAAY,YAAY;YAAE;QAAQ,IAAI,CAAC,CAAC;QAC5C,GAAI,mBAAmB,YAAY;YAAE;QAAe,IAAI,CAAC,CAAC;kBAE3D,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,qHAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 1024, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\ntype SwitchProps = Omit<\r\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>,\r\n  \"checked\" | \"defaultChecked\"\r\n> & {\r\n  checked?: boolean | undefined\r\n  defaultChecked?: boolean | undefined\r\n}\r\n\r\nconst Switch = React.forwardRef<\r\n  React.ElementRef<typeof SwitchPrimitives.Root>,\r\n  SwitchProps\r\n>(({ className, checked, defaultChecked, ...props }, ref) => (\r\n  <SwitchPrimitives.Root\r\n    className={cn(\r\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\r\n      className\r\n    )}\r\n    {...props}\r\n    {...(checked !== undefined ? { checked } : {})}\r\n    {...(defaultChecked !== undefined ? { defaultChecked } : {})}\r\n    ref={ref}\r\n  >\r\n    <SwitchPrimitives.Thumb\r\n      className={cn(\r\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n      )}\r\n    />\r\n  </SwitchPrimitives.Root>\r\n))\r\nSwitch.displayName = SwitchPrimitives.Root.displayName\r\n\r\nexport { Switch }\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAeA,MAAM,uBAAS,2KAAgB,MAG7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,oBACnD,6LAAC,6KAAqB;QACpB,WAAW,IAAA,qHAAE,EACX,sXACA;QAED,GAAG,KAAK;QACR,GAAI,YAAY,YAAY;YAAE;QAAQ,IAAI,CAAC,CAAC;QAC5C,GAAI,mBAAmB,YAAY;YAAE;QAAe,IAAI,CAAC,CAAC;QAC3D,KAAK;kBAEL,cAAA,6LAAC,8KAAsB;YACrB,WAAW,IAAA,qHAAE,EACX;;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,6KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 1072, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport type { ReceiptType } from \"./types\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"../../../components/ui/form\";\r\nimport { Input } from \"../../../components/ui/input\";\r\nimport { Textarea } from \"../../../components/ui/textarea\";\r\nimport { Checkbox } from \"../../../components/ui/checkbox\";\r\nimport { Label } from \"../../../components/ui/label\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\n\r\nconst formSchema = z.object({\r\n  id: z.string().min(1, \"Mã loại là bắt buộc\"),\r\n  name: z.string().min(1, \"Tên loại là bắt buộc\").max(100, \"Tên không được vượt quá 100 ký tự\"),\r\n  description: z.string().optional(),\r\n  isBusinessResult: z.boolean(),\r\n  isActive: z.boolean(),\r\n  color: z.string().optional(),\r\n});\r\n\r\nexport type ReceiptTypeFormValues = z.infer<typeof formSchema>;\r\n\r\ntype FormProps = {\r\n  initialData?: ReceiptType | null;\r\n  onSubmit: (values: ReceiptTypeFormValues) => void;\r\n};\r\n\r\nexport function ReceiptTypeForm({ initialData, onSubmit }: FormProps) {\r\n  const defaultValues: ReceiptTypeFormValues = React.useMemo(() => ({\r\n    id: '',\r\n    name: \"\",\r\n    description: \"\",\r\n    isBusinessResult: true,\r\n    isActive: true,\r\n    color: '#22c55e',\r\n  }), []);\r\n\r\n  const form = useForm<ReceiptTypeFormValues>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: initialData\r\n      ? {\r\n          id: initialData.id,\r\n          name: initialData.name,\r\n          description: initialData.description ?? '',\r\n          isBusinessResult: initialData.isBusinessResult,\r\n          isActive: initialData.isActive,\r\n          color: initialData.color ?? '',\r\n        }\r\n      : defaultValues,\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (initialData) {\r\n      form.reset({\r\n        id: initialData.id,\r\n        name: initialData.name,\r\n        description: initialData.description ?? '',\r\n        isBusinessResult: initialData.isBusinessResult,\r\n        isActive: initialData.isActive,\r\n        color: initialData.color ?? '',\r\n      });\r\n    } else {\r\n      form.reset(defaultValues);\r\n    }\r\n  }, [form, initialData, defaultValues]);\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form id=\"receipt-type-form\" onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 pt-4 max-h-[70vh] overflow-y-auto px-1\">\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <FormField control={form.control} name=\"name\" render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Tên <span className=\"text-destructive\">*</span></FormLabel>\r\n              <FormControl>\r\n                <Input {...field} value={field.value ?? ''} className=\"h-9\" />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )} />\r\n          <FormField control={form.control} name=\"id\" render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Mã</FormLabel>\r\n              <FormControl>\r\n                <Input\r\n                  {...field}\r\n                  value={field.value ?? ''}\r\n                  className=\"h-9 uppercase\"\r\n                  onChange={(event) => field.onChange(event.target.value.toUpperCase())}\r\n                />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )} />\r\n        </div>\r\n        <FormField control={form.control} name=\"description\" render={({ field }) => (\r\n          <FormItem>\r\n            <FormLabel>Mô tả</FormLabel>\r\n            <FormControl>\r\n              <Textarea {...field} value={field.value ?? ''} rows={3} />\r\n            </FormControl>\r\n            <FormMessage />\r\n          </FormItem>\r\n        )} />\r\n\r\n        <FormField control={form.control} name=\"color\" render={({ field }) => (\r\n          <FormItem>\r\n            <FormLabel>Màu hiển thị</FormLabel>\r\n            <FormControl>\r\n              <Input {...field} value={field.value ?? ''} placeholder=\"#22c55e\" />\r\n            </FormControl>\r\n            <FormDescription>Giúp phân biệt loại phiếu thu trên báo cáo</FormDescription>\r\n            <FormMessage />\r\n          </FormItem>\r\n        )} />\r\n        \r\n        <FormField control={form.control} name=\"isBusinessResult\" render={({ field }) => (\r\n          <FormItem className=\"flex items-center space-x-2\">\r\n            <FormControl>\r\n              <Checkbox\r\n                checked={field.value}\r\n                onCheckedChange={(checked) => field.onChange(Boolean(checked))}\r\n              />\r\n            </FormControl>\r\n            <Label>Hạch toán kết quả kinh doanh</Label>\r\n          </FormItem>\r\n        )} />\r\n        \r\n        <FormField control={form.control} name=\"isActive\" render={({ field }) => (\r\n          <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3\">\r\n            <div className=\"space-y-0.5\">\r\n              <FormLabel>Trạng thái hoạt động</FormLabel>\r\n              <FormDescription>Cho phép sử dụng loại phiếu thu này</FormDescription>\r\n            </div>\r\n            <FormControl>\r\n              <Switch checked={field.value} onCheckedChange={field.onChange} />\r\n            </FormControl>\r\n          </FormItem>\r\n        )} />\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1475, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/dialog.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\r\nimport { X } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { useModal } from \"../../contexts/modal-context\"\r\n\r\n// Use the original Dialog component\r\nconst Dialog = DialogPrimitive.Root\r\n\r\n// Create a Context to pass ID through the Dialog component tree\r\nconst DialogContext = React.createContext<string>(\"\");\r\n\r\n// Provider component that accepts an ID\r\nconst DialogProvider = ({ id, children }: { id: string; children: React.ReactNode }) => {\r\n  return <DialogContext.Provider value={id}>{children}</DialogContext.Provider>;\r\n};\r\n\r\nconst DialogTrigger = DialogPrimitive.Trigger\r\n\r\nconst DialogPortal = DialogPrimitive.Portal\r\n\r\nconst DialogClose = DialogPrimitive.Close\r\n\r\nconst DialogOverlay = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Overlay\r\n    ref={ref}\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\r\n\r\nconst DialogContent = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> & { \r\n    id?: string;\r\n    open?: boolean;\r\n  }\r\n>(({ className, children, id: propId, open, ...props }, ref) => {\r\n  // Use either the prop id or the id from context\r\n  const contextId = React.useContext(DialogContext);\r\n  const id = propId || contextId || `dialog-${React.useId()}`;\r\n  \r\n  // Register with our modal context using the open prop\r\n  const { zIndex } = useModal(id, !!open, 'dialog');\r\n  \r\n  return (\r\n    <DialogPortal>\r\n      {/* Sử dụng overlay chỉ dành cho Dialog */}\r\n      <DialogOverlay style={{ zIndex: zIndex - 1 }} />\r\n      <DialogPrimitive.Content\r\n        ref={ref}\r\n        className={cn(\r\n          \"dialog-content fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg sm:rounded-lg\",\r\n          className\r\n        )}\r\n        style={{ zIndex }}\r\n        {...props}\r\n      >\r\n        <DialogProvider id={id}>\r\n          {children}\r\n          <DialogPrimitive.Close\r\n            aria-label=\"Đóng\"\r\n            className=\"absolute right-4 top-4 flex h-9 w-9 items-center justify-center rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">Đóng</span>\r\n          </DialogPrimitive.Close>\r\n        </DialogProvider>\r\n      </DialogPrimitive.Content>\r\n    </DialogPortal>\r\n  );\r\n})\r\nDialogContent.displayName = DialogPrimitive.Content.displayName\r\n\r\nconst DialogHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nDialogHeader.displayName = \"DialogHeader\"\r\n\r\nconst DialogFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nDialogFooter.displayName = \"DialogFooter\"\r\n\r\nconst DialogTitle = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\r\n      \"text-lg font-semibold leading-none tracking-tight\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDialogTitle.displayName = DialogPrimitive.Title.displayName\r\n\r\nconst DialogDescription = React.forwardRef<\r\n  React.ElementRef<typeof DialogPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <DialogPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nDialogDescription.displayName = DialogPrimitive.Description.displayName\r\n\r\nexport {\r\n  Dialog,\r\n  DialogPortal,\r\n  DialogOverlay,\r\n  DialogClose,\r\n  DialogTrigger,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogFooter,\r\n  DialogTitle,\r\n  DialogDescription,\r\n  DialogProvider,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;;;;;;;;AAEA,oCAAoC;AACpC,MAAM,SAAS,6KAAoB;AAEnC,gEAAgE;AAChE,MAAM,8BAAgB,8KAAmB,CAAS;AAElD,wCAAwC;AACxC,MAAM,iBAAiB,CAAC,EAAE,EAAE,EAAE,QAAQ,EAA6C;IACjF,qBAAO,6LAAC,cAAc,QAAQ;QAAC,OAAO;kBAAK;;;;;;AAC7C;KAFM;AAIN,MAAM,gBAAgB,gLAAuB;AAE7C,MAAM,eAAe,+KAAsB;AAE3C,MAAM,cAAc,8KAAqB;AAEzC,MAAM,8BAAgB,2KAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,gLAAuB;QACtB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;MAVP;AAaN,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,GAAA,2KAAgB,UAMpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,MAAM,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;;IACtD,gDAAgD;IAChD,MAAM,YAAY,2KAAgB,CAAC;IACnC,MAAM,KAAK,UAAU,aAAa,CAAC,OAAO,EAAE,sKAAW,IAAI;IAE3D,sDAAsD;IACtD,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,4IAAQ,EAAC,IAAI,CAAC,CAAC,MAAM;IAExC,qBACE,6LAAC;;0BAEC,6LAAC;gBAAc,OAAO;oBAAE,QAAQ,SAAS;gBAAE;;;;;;0BAC3C,6LAAC,gLAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,qHAAE,EACX,kLACA;gBAEF,OAAO;oBAAE;gBAAO;gBACf,GAAG,KAAK;0BAET,cAAA,6LAAC;oBAAe,IAAI;;wBACjB;sCACD,6LAAC,8KAAqB;4BACpB,cAAW;4BACX,WAAU;;8CAEV,6LAAC,oMAAC;oCAAC,WAAU;;;;;;8CACb,6LAAC;oCAAK,WAAU;8CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;;QA5BqB,4IAAQ;;;;QAAR,4IAAQ;;;;AA6B7B,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,oLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 1685, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/alert-dialog.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { buttonVariants } from \"./button\"\r\n\r\nconst AlertDialog = AlertDialogPrimitive.Root\r\n\r\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\r\n\r\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\r\n\r\nconst AlertDialogOverlay = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Overlay\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/80 transition-opacity duration-200 opacity-0 data-[state=open]:opacity-100 data-[state=closed]:opacity-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  />\r\n))\r\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\r\n\r\nconst AlertDialogContent = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPortal>\r\n    <AlertDialogOverlay />\r\n    <AlertDialogPrimitive.Content\r\n      ref={ref}\r\n      className={cn(\r\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg transition-opacity duration-200 opacity-0 data-[state=open]:opacity-100 data-[state=closed]:opacity-0 sm:rounded-lg\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </AlertDialogPortal>\r\n))\r\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\r\n\r\nconst AlertDialogHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-2 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\r\n\r\nconst AlertDialogFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\r\n\r\nconst AlertDialogTitle = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\"text-lg font-semibold\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\r\n\r\nconst AlertDialogDescription = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogDescription.displayName =\r\n  AlertDialogPrimitive.Description.displayName\r\n\r\nconst AlertDialogAction = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Action\r\n    ref={ref}\r\n    className={cn(buttonVariants(), className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\r\n\r\nconst AlertDialogCancel = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Cancel\r\n    ref={ref}\r\n    className={cn(\r\n      buttonVariants({ variant: \"outline\" }),\r\n      \"mt-2 sm:mt-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\r\n\r\nexport {\r\n  AlertDialog,\r\n  AlertDialogPortal,\r\n  AlertDialogOverlay,\r\n  AlertDialogTrigger,\r\n  AlertDialogContent,\r\n  AlertDialogHeader,\r\n  AlertDialogFooter,\r\n  AlertDialogTitle,\r\n  AlertDialogDescription,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;;;;;;AAEA,MAAM,cAAc,sLAAyB;AAE7C,MAAM,qBAAqB,yLAA4B;AAEvD,MAAM,oBAAoB,wLAA2B;AAErD,MAAM,mCAAqB,2KAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,yLAA4B;QAC3B,WAAW,IAAA,qHAAE,EACX,wIACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;KAVH;AAaN,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,2KAAgB,OAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,yLAA4B;gBAC3B,KAAK;gBACL,WAAW,IAAA,qHAAE,EACX,yQACA;gBAED,GAAG,KAAK;;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,qHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,2KAAgB,OAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,uLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,uLAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,2KAAgB,OAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,uBAAuB,WAAW,GAChC,6LAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,IAAA,gJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,2KAAgB,QAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,IAAA,gJAAc,EAAC;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 1845, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/columns.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport type { ReceiptType } from \"./types\";\r\nimport type { ColumnDef } from \"../../../components/data-table/types\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"../../../components/ui/dropdown-menu\";\r\nimport { Button } from \"../../../components/ui/button\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\nimport { MoreHorizontal } from \"lucide-react\";\r\n\r\ninterface ColumnOptions {\r\n  onEdit: (receiptType: ReceiptType) => void;\r\n  onToggleDefault: (receiptType: ReceiptType, isDefault: boolean) => void;\r\n  onToggleStatus: (receiptType: ReceiptType, isActive: boolean) => void;\r\n  onDelete: (systemId: ReceiptType[\"systemId\"]) => void;\r\n}\r\n\r\nexport const getReceiptTypeColumns = ({\r\n  onEdit,\r\n  onToggleDefault,\r\n  onToggleStatus,\r\n  onDelete,\r\n}: ColumnOptions): ColumnDef<ReceiptType>[] => [\r\n  {\r\n    id: \"id\",\r\n    header: \"Mã loại\",\r\n    cell: ({ row }) => <span className=\"font-semibold uppercase\">{row.id}</span>,\r\n    meta: { displayName: \"Mã loại\" },\r\n  },\r\n  {\r\n    id: \"name\",\r\n    header: \"Tên loại\",\r\n    cell: ({ row }) => <span className=\"font-medium\">{row.name}</span>,\r\n    meta: { displayName: \"Tên loại\" },\r\n  },\r\n  {\r\n    id: \"description\",\r\n    header: \"Mô tả\",\r\n    cell: ({ row }) => (\r\n      <span className=\"text-sm text-muted-foreground\">{row.description || \"—\"}</span>\r\n    ),\r\n    meta: { displayName: \"Mô tả\" },\r\n  },\r\n  {\r\n    id: \"default\",\r\n    header: \"Mặc định\",\r\n    cell: ({ row }) => (\r\n      <Switch \r\n        checked={row.isDefault ?? false} \r\n        onCheckedChange={(checked) => onToggleDefault(row, checked)}\r\n      />\r\n    ),\r\n    meta: { displayName: \"Mặc định\" },\r\n  },\r\n  {\r\n    id: \"status\",\r\n    header: \"Trạng thái\",\r\n    cell: ({ row }) => (\r\n      <Switch \r\n        checked={row.isActive} \r\n        onCheckedChange={(checked) => onToggleStatus(row, checked)}\r\n      />\r\n    ),\r\n    meta: { displayName: \"Trạng thái\" },\r\n  },\r\n  {\r\n    id: \"actions\",\r\n    header: () => <div className=\"text-right\">Thao tác</div>,\r\n    cell: ({ row }) => (\r\n      <div className=\"text-right\">\r\n        <DropdownMenu>\r\n          <DropdownMenuTrigger asChild>\r\n            <Button variant=\"ghost\" className=\"h-8 w-8 p-0\">\r\n              <span className=\"sr-only\">Mở menu</span>\r\n              <MoreHorizontal className=\"h-4 w-4\" />\r\n            </Button>\r\n          </DropdownMenuTrigger>\r\n          <DropdownMenuContent align=\"end\">\r\n            <DropdownMenuLabel>Thao tác</DropdownMenuLabel>\r\n            <DropdownMenuSeparator />\r\n            <DropdownMenuItem onSelect={() => onEdit(row)}>\r\n              Chỉnh sửa\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem\r\n              className=\"text-destructive\"\r\n              onSelect={() => onDelete(row.systemId)}\r\n            >\r\n              Xóa\r\n            </DropdownMenuItem>\r\n          </DropdownMenuContent>\r\n        </DropdownMenu>\r\n      </div>\r\n    ),\r\n    meta: { displayName: \"Thao tác\" },\r\n    size: 130,\r\n  },\r\n];\r\n"],"names":[],"mappings":";;;;;AAGA;AAQA;AACA;AACA;;;;;;AASO,MAAM,wBAAwB,CAAC,EACpC,MAAM,EACN,eAAe,EACf,cAAc,EACd,QAAQ,EACM,GAA+B;QAC7C;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC;oBAAK,WAAU;8BAA2B,IAAI,EAAE;;;;;;YACpE,MAAM;gBAAE,aAAa;YAAU;QACjC;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC;oBAAK,WAAU;8BAAe,IAAI,IAAI;;;;;;YAC1D,MAAM;gBAAE,aAAa;YAAW;QAClC;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC;oBAAK,WAAU;8BAAiC,IAAI,WAAW,IAAI;;;;;;YAEtE,MAAM;gBAAE,aAAa;YAAQ;QAC/B;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC,wIAAM;oBACL,SAAS,IAAI,SAAS,IAAI;oBAC1B,iBAAiB,CAAC,UAAY,gBAAgB,KAAK;;;;;;YAGvD,MAAM;gBAAE,aAAa;YAAW;QAClC;QACA;YACE,IAAI;YACJ,QAAQ;YACR,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC,wIAAM;oBACL,SAAS,IAAI,QAAQ;oBACrB,iBAAiB,CAAC,UAAY,eAAe,KAAK;;;;;;YAGtD,MAAM;gBAAE,aAAa;YAAa;QACpC;QACA;YACE,IAAI;YACJ,QAAQ,kBAAM,6LAAC;oBAAI,WAAU;8BAAa;;;;;;YAC1C,MAAM,CAAC,EAAE,GAAG,EAAE,iBACZ,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,wJAAY;;0CACX,6LAAC,+JAAmB;gCAAC,OAAO;0CAC1B,cAAA,6LAAC,wIAAM;oCAAC,SAAQ;oCAAQ,WAAU;;sDAChC,6LAAC;4CAAK,WAAU;sDAAU;;;;;;sDAC1B,6LAAC,qOAAc;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAG9B,6LAAC,+JAAmB;gCAAC,OAAM;;kDACzB,6LAAC,6JAAiB;kDAAC;;;;;;kDACnB,6LAAC,iKAAqB;;;;;kDACtB,6LAAC,4JAAgB;wCAAC,UAAU,IAAM,OAAO;kDAAM;;;;;;kDAG/C,6LAAC,4JAAgB;wCACf,WAAU;wCACV,UAAU,IAAM,SAAS,IAAI,QAAQ;kDACtC;;;;;;;;;;;;;;;;;;;;;;;YAOT,MAAM;gBAAE,aAAa;YAAW;YAChC,MAAM;QACR;KACD"}},
    {"offset": {"line": 2043, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\n\r\nconst Table = React.forwardRef<\r\n  HTMLTableElement,\r\n  React.HTMLAttributes<HTMLTableElement>\r\n>(({ className, ...props }, ref) => (\r\n    <table\r\n      ref={ref}\r\n      className={cn(\"w-full caption-bottom text-sm\", className)}\r\n      {...props}\r\n    />\r\n))\r\nTable.displayName = \"Table\"\r\n\r\nconst TableHeader = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <thead ref={ref} className={cn(\"[&_tr]:border-b [&_tr]:border-border\", className)} {...props} />\r\n))\r\nTableHeader.displayName = \"TableHeader\"\r\n\r\nconst TableBody = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tbody\r\n    ref={ref}\r\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableBody.displayName = \"TableBody\"\r\n\r\nconst TableFooter = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tfoot\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-t border-border bg-muted/50 font-medium [&>tr]:last:border-b-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableFooter.displayName = \"TableFooter\"\r\n\r\nconst TableRow = React.forwardRef<\r\n  HTMLTableRowElement,\r\n  React.HTMLAttributes<HTMLTableRowElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tr\r\n    ref={ref}\r\n    className={cn(\r\n      \"group border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableRow.displayName = \"TableRow\"\r\n\r\nconst TableHead = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.ThHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <th\r\n    ref={ref}\r\n    className={cn(\r\n      \"h-9 px-4 text-left align-middle font-medium text-foreground [&:has([role=checkbox])]:px-3 [&:has([role=checkbox])]:w-12 [&:has([role=checkbox])]:text-center whitespace-nowrap\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableHead.displayName = \"TableHead\"\r\n\r\nconst TableCell = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.TdHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <td\r\n    ref={ref}\r\n    className={cn(\r\n      \"px-4 py-1 align-middle whitespace-nowrap [&:has([role=checkbox])]:px-3 [&:has([role=checkbox])]:w-12 [&:has([role=checkbox])]:text-center\", \r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableCell.displayName = \"TableCell\"\r\n\r\nconst TableCaption = React.forwardRef<\r\n  HTMLTableCaptionElement,\r\n  React.HTMLAttributes<HTMLTableCaptionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <caption\r\n    ref={ref}\r\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCaption.displayName = \"TableCaption\"\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGf,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,qHAAE,EAAC,wCAAwC;QAAa,GAAG,KAAK;;;;;;;AAE9F,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,yEACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,mGACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,kLACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EACX,6IACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,qHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGb,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 2180, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/settings/SimpleSettingsTable.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"../ui/table\";\r\nimport type { ColumnDef } from \"../data-table/types\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\ninterface SimpleSettingsTableProps<TData extends { systemId: string }> {\r\n  data: TData[];\r\n  columns: ColumnDef<TData>[];\r\n  emptyTitle: string;\r\n  emptyDescription?: string;\r\n  emptyAction?: React.ReactNode;\r\n  className?: string;\r\n}\r\n\r\nexport function SimpleSettingsTable<TData extends { systemId: string }>(\r\n  props: SimpleSettingsTableProps<TData>\r\n) {\r\n  const { data, columns, emptyTitle, emptyDescription, emptyAction, className } = props;\r\n\r\n  const renderedColumns = React.useMemo(() => columns.filter(Boolean), [columns]);\r\n  const colSpan = Math.max(renderedColumns.length, 1);\r\n\r\n  const renderHeader = (column: ColumnDef<TData>) => {\r\n    if (typeof column.header === \"function\") {\r\n      return column.header({\r\n        isAllPageRowsSelected: false,\r\n        isSomePageRowsSelected: false,\r\n        onToggleAll: () => {},\r\n        setSorting: () => {},\r\n      });\r\n    }\r\n    return column.header;\r\n  };\r\n\r\n  const renderCell = (column: ColumnDef<TData>, row: TData) =>\r\n    column.cell({\r\n      row,\r\n      isSelected: false,\r\n      isExpanded: false,\r\n      onToggleSelect: () => {},\r\n      onToggleExpand: () => {},\r\n    });\r\n\r\n  return (\r\n    <div className={cn(\"overflow-x-auto\", className)}>\r\n      <Table>\r\n        <TableHeader>\r\n          <TableRow>\r\n            {renderedColumns.map((column) => (\r\n              <TableHead key={column.id} style={column.size ? { width: column.size } : undefined}>\r\n                {renderHeader(column)}\r\n              </TableHead>\r\n            ))}\r\n          </TableRow>\r\n        </TableHeader>\r\n        <TableBody>\r\n          {data.length === 0 ? (\r\n            <TableRow>\r\n              <TableCell colSpan={colSpan} className=\"h-24 text-center\">\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"font-medium text-muted-foreground\">{emptyTitle}</p>\r\n                  {emptyDescription ? (\r\n                    <p className=\"text-sm text-muted-foreground\">{emptyDescription}</p>\r\n                  ) : null}\r\n                  {emptyAction}\r\n                </div>\r\n              </TableCell>\r\n            </TableRow>\r\n          ) : (\r\n            data.map((item) => (\r\n              <TableRow key={item.systemId}>\r\n                {renderedColumns.map((column) => (\r\n                  <TableCell key={column.id}>{renderCell(column, item)}</TableCell>\r\n                ))}\r\n              </TableRow>\r\n            ))\r\n          )}\r\n        </TableBody>\r\n      </Table>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AASA;;;;;;AAWO,SAAS,oBACd,KAAsC;;IAEtC,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,gBAAgB,EAAE,WAAW,EAAE,SAAS,EAAE,GAAG;IAEhF,MAAM,kBAAkB,wKAAa;wDAAC,IAAM,QAAQ,MAAM,CAAC;uDAAU;QAAC;KAAQ;IAC9E,MAAM,UAAU,KAAK,GAAG,CAAC,gBAAgB,MAAM,EAAE;IAEjD,MAAM,eAAe,CAAC;QACpB,IAAI,OAAO,OAAO,MAAM,KAAK,YAAY;YACvC,OAAO,OAAO,MAAM,CAAC;gBACnB,uBAAuB;gBACvB,wBAAwB;gBACxB,aAAa,KAAO;gBACpB,YAAY,KAAO;YACrB;QACF;QACA,OAAO,OAAO,MAAM;IACtB;IAEA,MAAM,aAAa,CAAC,QAA0B,MAC5C,OAAO,IAAI,CAAC;YACV;YACA,YAAY;YACZ,YAAY;YACZ,gBAAgB,KAAO;YACvB,gBAAgB,KAAO;QACzB;IAEF,qBACE,6LAAC;QAAI,WAAW,IAAA,qHAAE,EAAC,mBAAmB;kBACpC,cAAA,6LAAC,sIAAK;;8BACJ,6LAAC,4IAAW;8BACV,cAAA,6LAAC,yIAAQ;kCACN,gBAAgB,GAAG,CAAC,CAAC,uBACpB,6LAAC,0IAAS;gCAAiB,OAAO,OAAO,IAAI,GAAG;oCAAE,OAAO,OAAO,IAAI;gCAAC,IAAI;0CACtE,aAAa;+BADA,OAAO,EAAE;;;;;;;;;;;;;;;8BAM/B,6LAAC,0IAAS;8BACP,KAAK,MAAM,KAAK,kBACf,6LAAC,yIAAQ;kCACP,cAAA,6LAAC,0IAAS;4BAAC,SAAS;4BAAS,WAAU;sCACrC,cAAA,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAqC;;;;;;oCACjD,iCACC,6LAAC;wCAAE,WAAU;kDAAiC;;;;;+CAC5C;oCACH;;;;;;;;;;;;;;;;+BAKP,KAAK,GAAG,CAAC,CAAC,qBACR,6LAAC,yIAAQ;sCACN,gBAAgB,GAAG,CAAC,CAAC,uBACpB,6LAAC,0IAAS;8CAAkB,WAAW,QAAQ;mCAA/B,OAAO,EAAE;;;;;2BAFd,KAAK,QAAQ;;;;;;;;;;;;;;;;;;;;;AAW1C;GAnEgB;KAAA"}},
    {"offset": {"line": 2327, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/settings/SettingsActionButton.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Button, type ButtonProps } from '../ui/button';\r\nimport { cn } from '../../lib/utils';\r\n\r\n/**\r\n * SettingsActionButton chuẩn hóa các nút hành động của module Cài đặt\r\n * để luôn tuân thủ chiều cao h-9 và padding đồng nhất.\r\n */\r\nexport const SettingsActionButton = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, size, children, ...props }, ref) => {\r\n    return (\r\n      <Button\r\n        ref={ref}\r\n        size={size ?? 'sm'}\r\n        className={cn('h-9 px-4 font-medium gap-2', className)}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </Button>\r\n    );\r\n  }\r\n);\r\n\r\nSettingsActionButton.displayName = 'SettingsActionButton';\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAMO,MAAM,qCAAuB,2KAAgB,MAClD,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IACxC,qBACE,6LAAC,wIAAM;QACL,KAAK;QACL,MAAM,QAAQ;QACd,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;kBAER;;;;;;AAGP;;AAGF,qBAAqB,WAAW,GAAG"}},
    {"offset": {"line": 2364, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/page-content.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Plus } from \"lucide-react\";\r\nimport { asBusinessId, asSystemId, type SystemId } from \"@/lib/id-types\";\r\nimport { useReceiptTypes, useReceiptTypeMutations } from \"./hooks/use-receipt-types\";\r\nimport type { ReceiptType } from \"./types\";\r\nimport { ReceiptTypeForm, type ReceiptTypeFormValues } from \"./form\";\r\nimport { Button } from \"../../../components/ui/button\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"../../../components/ui/dialog\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"../../../components/ui/alert-dialog\";\r\nimport { getReceiptTypeColumns } from \"./columns\";\r\nimport { toast } from \"sonner\";\r\nimport { SimpleSettingsTable } from \"../../../components/settings/SimpleSettingsTable\";\r\nimport { SettingsActionButton } from \"../../../components/settings/SettingsActionButton\";\r\nimport type { RegisterTabActions } from \"../use-tab-action-registry\";\r\n\r\ntype ReceiptTypesPageContentProps = {\r\n  isActive: boolean;\r\n  onRegisterActions: RegisterTabActions;\r\n};\r\n\r\nexport function ReceiptTypesPageContent({ isActive, onRegisterActions }: ReceiptTypesPageContentProps) {\r\n  const { data: receiptTypesData } = useReceiptTypes();\r\n  const data = receiptTypesData?.data || [];\r\n  const { create, update, remove, setDefault } = useReceiptTypeMutations();\r\n  \r\n  const [isFormOpen, setIsFormOpen] = React.useState(false);\r\n  const [editingItem, setEditingItem] = React.useState<ReceiptType | null>(null);\r\n  const [isAlertOpen, setIsAlertOpen] = React.useState(false);\r\n  const [idToDelete, setIdToDelete] = React.useState<SystemId | null>(null);\r\n\r\n  const handleAddNew = React.useCallback(() => {\r\n    setEditingItem(null);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n  \r\n  const handleEdit = React.useCallback((item: ReceiptType) => {\r\n    setEditingItem(item);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n\r\n  const handleDeleteRequest = React.useCallback((systemId: SystemId) => {\r\n    setIdToDelete(systemId);\r\n    setIsAlertOpen(true);\r\n  }, []);\r\n  \r\n  const handleToggleDefault = React.useCallback((item: ReceiptType, isDefault: boolean) => {\r\n    if (isDefault) {\r\n      // Use setDefault mutation\r\n      setDefault.mutate(item.systemId as string);\r\n      toast.success(`Đã đặt \"${item.name}\" làm mặc định`);\r\n    } else {\r\n      const other = data.find(d => d.systemId !== item.systemId && d.isActive);\r\n      if (other) {\r\n        setDefault.mutate(other.systemId as string);\r\n        toast.success(`Đã chuyển mặc định sang \"${other.name}\"`);\r\n      } else {\r\n        toast.error(\"Phải có ít nhất một loại phiếu thu mặc định\");\r\n      }\r\n    }\r\n  }, [data, setDefault]);\r\n\r\n  const handleToggleStatus = React.useCallback((item: ReceiptType, isActive: boolean) => {\r\n    update.mutate({ systemId: item.systemId as string, data: { isActive } });\r\n    toast.success(isActive ? `Đã kích hoạt \"${item.name}\"` : `Đã tắt \"${item.name}\"`);\r\n  }, [update]);\r\n  \r\n  const confirmDelete = () => {\r\n    if (idToDelete) {\r\n      const item = data.find(d => d.systemId === idToDelete);\r\n      remove.mutate(idToDelete as string);\r\n      toast.success(`Đã xóa \"${item?.name}\"`);\r\n    }\r\n    setIsAlertOpen(false);\r\n    setIdToDelete(null);\r\n  };\r\n  \r\n  const handleFormSubmit = (values: ReceiptTypeFormValues) => {\r\n    try {\r\n      const now = new Date().toISOString();\r\n      const normalized = {\r\n        id: asBusinessId(values.id.trim().toUpperCase()),\r\n        name: values.name.trim(),\r\n        description: values.description?.trim() || undefined,\r\n        isBusinessResult: values.isBusinessResult,\r\n        isActive: values.isActive,\r\n        color: values.color?.trim() || undefined,\r\n      } satisfies Omit<ReceiptType, 'systemId' | 'createdAt'>;\r\n\r\n      if (editingItem) {\r\n        update.mutate({ systemId: editingItem.systemId as string, data: normalized });\r\n        toast.success(`Đã cập nhật \"${normalized.name}\"`);\r\n      } else {\r\n        create.mutate({\r\n          ...normalized,\r\n          createdAt: now,\r\n        });\r\n        toast.success(`Đã thêm \"${normalized.name}\"`);\r\n      }\r\n      setIsFormOpen(false);\r\n    } catch (error) {\r\n      toast.error(\"Có lỗi xảy ra\", {\r\n        description: error instanceof Error ? error.message : \"Lỗi không xác định\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const columns = React.useMemo(\r\n    () =>\r\n      getReceiptTypeColumns({\r\n        onEdit: handleEdit,\r\n        onToggleDefault: handleToggleDefault,\r\n        onToggleStatus: handleToggleStatus,\r\n        onDelete: handleDeleteRequest,\r\n      }),\r\n    [handleEdit, handleToggleDefault, handleToggleStatus, handleDeleteRequest]\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (!isActive) {\r\n      return;\r\n    }\r\n\r\n    onRegisterActions([\r\n      <SettingsActionButton key=\"add-receipt-type\" onClick={handleAddNew}>\r\n        <Plus className=\"mr-2 h-4 w-4\" /> Thêm loại phiếu thu\r\n      </SettingsActionButton>,\r\n    ]);\r\n  }, [handleAddNew, isActive, onRegisterActions]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-md border bg-background\">\r\n        <SimpleSettingsTable\r\n          data={data}\r\n          columns={columns}\r\n          emptyTitle=\"Chưa có dữ liệu\"\r\n          emptyDescription=\"Thêm loại phiếu thu đầu tiên để bắt đầu cấu hình\"\r\n          emptyAction={\r\n            <Button size=\"sm\" onClick={handleAddNew}>\r\n              Thêm loại mới\r\n            </Button>\r\n          }\r\n        />\r\n      </div>\r\n      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{editingItem ? 'Cập nhật loại phiếu thu' : 'Thêm loại phiếu thu'}</DialogTitle>\r\n          </DialogHeader>\r\n          <ReceiptTypeForm initialData={editingItem} onSubmit={handleFormSubmit} />\r\n          <DialogFooter>\r\n            <Button type=\"button\" variant=\"outline\" className=\"h-9\" onClick={() => setIsFormOpen(false)}>Đóng</Button>\r\n            <Button type=\"submit\" form=\"receipt-type-form\" className=\"h-9\">Lưu</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Hành động này không thể hoàn tác. Loại phiếu thu sẽ bị xóa vĩnh viễn.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={confirmDelete}>Xóa</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2719, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/api/payment-types-api.ts"],"sourcesContent":["/**\r\n * Payment Types API\r\n */\r\n\r\nimport type { PaymentType } from '../types';\r\n\r\ninterface ApiResponse<T> {\r\n  data: T;\r\n  pagination?: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nconst API_BASE = '/api/settings/payment-types';\r\n\r\nexport type PaymentTypeFilters = {\r\n  isActive?: boolean;\r\n};\r\n\r\nexport type PaymentTypeCreateInput = Omit<PaymentType, 'systemId' | 'isDefault' | 'updatedAt'>;\r\nexport type PaymentTypeUpdateInput = Partial<Omit<PaymentType, 'systemId'>>;\r\n\r\nexport async function fetchPaymentTypes(filters: PaymentTypeFilters = {}): Promise<ApiResponse<PaymentType[]>> {\r\n  const params = new URLSearchParams();\r\n  if (filters.isActive !== undefined) params.append('isActive', String(filters.isActive));\r\n  \r\n  const url = params.toString() ? `${API_BASE}?${params}` : API_BASE;\r\n  const response = await fetch(url);\r\n  if (!response.ok) throw new Error('Failed to fetch payment types');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchPaymentTypeById(systemId: string): Promise<ApiResponse<PaymentType>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}`);\r\n  if (!response.ok) throw new Error('Failed to fetch payment type');\r\n  return response.json();\r\n}\r\n\r\nexport async function createPaymentType(data: PaymentTypeCreateInput): Promise<ApiResponse<PaymentType>> {\r\n  const response = await fetch(API_BASE, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to create payment type');\r\n  return response.json();\r\n}\r\n\r\nexport async function updatePaymentType(\r\n  systemId: string,\r\n  data: PaymentTypeUpdateInput\r\n): Promise<ApiResponse<PaymentType>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to update payment type');\r\n  return response.json();\r\n}\r\n\r\nexport async function deletePaymentType(systemId: string): Promise<ApiResponse<void>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  if (!response.ok) throw new Error('Failed to delete payment type');\r\n  return response.json();\r\n}\r\n\r\nexport async function setDefaultPaymentType(systemId: string): Promise<ApiResponse<PaymentType>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}/set-default`, {\r\n    method: 'PATCH',\r\n  });\r\n  if (!response.ok) throw new Error('Failed to set default payment type');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchActivePaymentTypes(): Promise<ApiResponse<PaymentType[]>> {\r\n  return fetchPaymentTypes({ isActive: true });\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;AAcD,MAAM,WAAW;AASV,eAAe,kBAAkB,UAA8B,CAAC,CAAC;IACtE,MAAM,SAAS,IAAI;IACnB,IAAI,QAAQ,QAAQ,KAAK,WAAW,OAAO,MAAM,CAAC,YAAY,OAAO,QAAQ,QAAQ;IAErF,MAAM,MAAM,OAAO,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,QAAQ,GAAG;IAC1D,MAAM,WAAW,MAAM,MAAM;IAC7B,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,qBAAqB,QAAgB;IACzD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IACtD,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,IAA4B;IAClE,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBACpB,QAAgB,EAChB,IAA4B;IAE5B,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,sBAAsB,QAAgB;IAC1D,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;IACV;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe;IACpB,OAAO,kBAAkB;QAAE,UAAU;IAAK;AAC5C"}},
    {"offset": {"line": 2799, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/hooks/use-payment-types.ts"],"sourcesContent":["/**\r\n * Payment Types React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchPaymentTypes,\r\n  fetchPaymentTypeById,\r\n  createPaymentType,\r\n  updatePaymentType,\r\n  deletePaymentType,\r\n  setDefaultPaymentType,\r\n  fetchActivePaymentTypes,\r\n  type PaymentTypeFilters,\r\n  type PaymentTypeCreateInput,\r\n  type PaymentTypeUpdateInput,\r\n} from '../api/payment-types-api';\r\n\r\nexport const paymentTypeKeys = {\r\n  all: ['payment-types'] as const,\r\n  lists: () => [...paymentTypeKeys.all, 'list'] as const,\r\n  list: (filters: PaymentTypeFilters) => [...paymentTypeKeys.lists(), filters] as const,\r\n  details: () => [...paymentTypeKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...paymentTypeKeys.details(), id] as const,\r\n  active: () => [...paymentTypeKeys.all, 'active'] as const,\r\n};\r\n\r\nexport function usePaymentTypes(filters: PaymentTypeFilters = {}) {\r\n  return useQuery({\r\n    queryKey: paymentTypeKeys.list(filters),\r\n    queryFn: () => fetchPaymentTypes(filters),\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function usePaymentTypeById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: paymentTypeKeys.detail(systemId!),\r\n    queryFn: () => fetchPaymentTypeById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useActivePaymentTypes() {\r\n  return useQuery({\r\n    queryKey: paymentTypeKeys.active(),\r\n    queryFn: fetchActivePaymentTypes,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function usePaymentTypeMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n  const invalidate = () => queryClient.invalidateQueries({ queryKey: paymentTypeKeys.all });\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: PaymentTypeCreateInput) => createPaymentType(data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: PaymentTypeUpdateInput }) =>\r\n      updatePaymentType(systemId, data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deletePaymentType(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const setDefault = useMutation({\r\n    mutationFn: (systemId: string) => setDefaultPaymentType(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create, update, remove, setDefault,\r\n    isLoading: create.isPending || update.isPending || remove.isPending || setDefault.isPending,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;CAEC,GAED;AAAA;AAAA;AACA;;;;AAaO,MAAM,kBAAkB;IAC7B,KAAK;QAAC;KAAgB;IACtB,OAAO,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAO;IAC7C,MAAM,CAAC,UAAgC;eAAI,gBAAgB,KAAK;YAAI;SAAQ;IAC5E,SAAS,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;IACjD,QAAQ,CAAC,KAAe;eAAI,gBAAgB,OAAO;YAAI;SAAG;IAC1D,QAAQ,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;AAClD;AAEO,SAAS,gBAAgB,UAA8B,CAAC,CAAC;;IAC9D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,IAAI,CAAC;QAC/B,OAAO;wCAAE,IAAM,IAAA,mMAAiB,EAAC;;QACjC,WAAW,OAAO,KAAK;IACzB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,mBAAmB,QAA4B;;IAC7D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM,CAAC;QACjC,OAAO;2CAAE,IAAM,IAAA,sMAAoB,EAAC;;QACpC,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IACzB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM;QAChC,SAAS,yMAAuB;QAChC,WAAW,OAAO,KAAK;IACzB;AACF;IANgB;;QACP,0LAAQ;;;AAYV,SAAS,wBAAwB,UAA6B,CAAC,CAAC;;IACrE,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,aAAa,IAAM,YAAY,iBAAiB,CAAC;YAAE,UAAU,gBAAgB,GAAG;QAAC;IAEvF,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,OAAiC,IAAA,mMAAiB,EAAC;;QAChE,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAsD,GACjF,IAAA,mMAAiB,EAAC,UAAU;;QAC9B,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,WAAqB,IAAA,mMAAiB,EAAC;;QACpD,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,aAAa,IAAA,gMAAW,EAAC;QAC7B,UAAU;+DAAE,CAAC,WAAqB,IAAA,uMAAqB,EAAC;;QACxD,SAAS;+DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QACL;QAAQ;QAAQ;QAAQ;QACxB,WAAW,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,WAAW,SAAS;IAC7F;AACF;IAjCgB;;QACM,2MAAc;QAGnB,gMAAW;QAMX,gMAAW;QAOX,gMAAW;QAMP,gMAAW"}},
    {"offset": {"line": 2967, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport type { PaymentType } from \"./types\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"../../../../components/ui/form\";\r\nimport { Input } from \"../../../../components/ui/input\";\r\nimport { Textarea } from \"../../../../components/ui/textarea\";\r\nimport { Checkbox } from \"../../../../components/ui/checkbox\";\r\nimport { Label } from \"../../../../components/ui/label\";\r\nimport { Switch } from \"../../../../components/ui/switch\";\r\n\r\nconst formSchema = z.object({\r\n  id: z.string().min(1, \"Mã loại là bắt buộc\"),\r\n  name: z.string().min(1, \"Tên loại là bắt buộc\").max(100, \"Tên không được vượt quá 100 ký tự\"),\r\n  description: z.string().optional(),\r\n  isBusinessResult: z.boolean(),\r\n  isActive: z.boolean(),\r\n  color: z.string().optional(),\r\n});\r\n\r\nexport type PaymentTypeFormValues = z.infer<typeof formSchema>;\r\n\r\ntype FormProps = {\r\n  initialData?: PaymentType | null;\r\n  onSubmit: (values: PaymentTypeFormValues) => void;\r\n};\r\n\r\nexport function PaymentTypeForm({ initialData, onSubmit }: FormProps) {\r\n  const defaultValues: PaymentTypeFormValues = React.useMemo(() => ({\r\n    id: \"\",\r\n    name: \"\",\r\n    description: \"\",\r\n    isBusinessResult: true,\r\n    isActive: true,\r\n    color: '#0ea5e9',\r\n  }), []);\r\n\r\n  const form = useForm<PaymentTypeFormValues>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: initialData\r\n      ? {\r\n          id: initialData.id,\r\n          name: initialData.name,\r\n          description: initialData.description ?? '',\r\n          isBusinessResult: initialData.isBusinessResult,\r\n          isActive: initialData.isActive,\r\n          color: initialData.color ?? '',\r\n        }\r\n      : defaultValues,\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (initialData) {\r\n      form.reset({\r\n        id: initialData.id,\r\n        name: initialData.name,\r\n        description: initialData.description ?? '',\r\n        isBusinessResult: initialData.isBusinessResult,\r\n        isActive: initialData.isActive,\r\n        color: initialData.color ?? '',\r\n      });\r\n    } else {\r\n      form.reset(defaultValues);\r\n    }\r\n  }, [form, initialData, defaultValues]);\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form id=\"payment-type-form\" onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 pt-4 max-h-[70vh] overflow-y-auto px-1\">\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <FormField control={form.control} name=\"name\" render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Tên <span className=\"text-destructive\">*</span></FormLabel>\r\n              <FormControl>\r\n                <Input {...field} value={field.value ?? ''} className=\"h-9\" />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )} />\r\n          <FormField control={form.control} name=\"id\" render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Mã</FormLabel>\r\n              <FormControl>\r\n                <Input\r\n                  {...field}\r\n                  value={field.value ?? ''}\r\n                  className=\"h-9 uppercase\"\r\n                  onChange={(event) => field.onChange(event.target.value.toUpperCase())}\r\n                />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )} />\r\n        </div>\r\n        <FormField control={form.control} name=\"description\" render={({ field }) => (\r\n          <FormItem>\r\n            <FormLabel>Mô tả</FormLabel>\r\n            <FormControl>\r\n              <Textarea {...field} value={field.value ?? ''} rows={3} />\r\n            </FormControl>\r\n            <FormMessage />\r\n          </FormItem>\r\n        )} />\r\n\r\n        <FormField control={form.control} name=\"color\" render={({ field }) => (\r\n          <FormItem>\r\n            <FormLabel>Màu hiển thị</FormLabel>\r\n            <FormControl>\r\n              <Input {...field} value={field.value ?? ''} placeholder=\"#0ea5e9\" />\r\n            </FormControl>\r\n            <FormDescription>Dùng để phân biệt trên biểu đồ/báo cáo</FormDescription>\r\n            <FormMessage />\r\n          </FormItem>\r\n        )} />\r\n        \r\n        <FormField control={form.control} name=\"isBusinessResult\" render={({ field }) => (\r\n          <FormItem className=\"flex items-center space-x-2\">\r\n            <FormControl>\r\n              <Checkbox\r\n                checked={field.value}\r\n                onCheckedChange={(checked) => field.onChange(Boolean(checked))}\r\n              />\r\n            </FormControl>\r\n            <Label>Hạch toán kết quả kinh doanh</Label>\r\n          </FormItem>\r\n        )} />\r\n        \r\n        <FormField control={form.control} name=\"isActive\" render={({ field }) => (\r\n          <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3\">\r\n            <div className=\"space-y-0.5\">\r\n              <FormLabel>Trạng thái hoạt động</FormLabel>\r\n              <FormDescription>Cho phép sử dụng loại phiếu chi này</FormDescription>\r\n            </div>\r\n            <FormControl>\r\n              <Switch checked={field.value} onCheckedChange={field.onChange} />\r\n            </FormControl>\r\n          </FormItem>\r\n        )} />\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3370, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/page-content.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Plus, MoreHorizontal } from \"lucide-react\";\r\nimport { asBusinessId, asSystemId, type SystemId } from \"@/lib/id-types\";\r\nimport { usePaymentTypes, usePaymentTypeMutations } from \"./hooks/use-payment-types\";\r\nimport type { PaymentType } from \"./types\";\r\nimport { PaymentTypeForm, type PaymentTypeFormValues } from \"./form\";\r\nimport { Button } from \"../../../../components/ui/button\";\r\nimport { Switch } from \"../../../../components/ui/switch\";\r\nimport { Dialog, DialogContent, DialogFooter, DialogHeader, DialogTitle } from \"../../../../components/ui/dialog\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"../../../../components/ui/alert-dialog\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../../../components/ui/table\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuLabel, DropdownMenuSeparator, DropdownMenuTrigger } from \"../../../../components/ui/dropdown-menu\";\r\nimport { toast } from \"sonner\";\r\nimport { SettingsActionButton } from \"../../../../components/settings/SettingsActionButton\";\r\nimport type { RegisterTabActions } from \"../../use-tab-action-registry\";\r\n\r\ntype PaymentTypesPageContentProps = {\r\n  isActive: boolean;\r\n  onRegisterActions: RegisterTabActions;\r\n};\r\n\r\nexport function PaymentTypesPageContent({ isActive, onRegisterActions }: PaymentTypesPageContentProps) {\r\n  const { data: paymentTypesData } = usePaymentTypes();\r\n  const data = paymentTypesData?.data || [];\r\n  const { create, update, remove, setDefault } = usePaymentTypeMutations();\r\n  \r\n  const [isFormOpen, setIsFormOpen] = React.useState(false);\r\n  const [editingItem, setEditingItem] = React.useState<PaymentType | null>(null);\r\n  const [isAlertOpen, setIsAlertOpen] = React.useState(false);\r\n  const [idToDelete, setIdToDelete] = React.useState<SystemId | null>(null);\r\n\r\n  const handleAddNew = React.useCallback(() => {\r\n    setEditingItem(null);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n\r\n  const handleEdit = (item: PaymentType) => { setEditingItem(item); setIsFormOpen(true); };\r\n  const handleDeleteRequest = (systemId: SystemId) => { \r\n    setIdToDelete(systemId);\r\n    setIsAlertOpen(true);\r\n  };\r\n  \r\n  const handleToggleDefault = (item: PaymentType, isDefault: boolean) => {\r\n    if (isDefault) {\r\n      // Use setDefault mutation\r\n      setDefault.mutate(item.systemId as string);\r\n      toast.success(`Đã đặt \"${item.name}\" làm mặc định`);\r\n    } else {\r\n      const other = data.find(d => d.systemId !== item.systemId && d.isActive);\r\n      if (other) {\r\n        setDefault.mutate(other.systemId as string);\r\n        toast.success(`Đã chuyển mặc định sang \"${other.name}\"`);\r\n      } else {\r\n        toast.error(\"Phải có ít nhất một loại phiếu chi mặc định\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleToggleStatus = (item: PaymentType, isActive: boolean) => {\r\n    update.mutate({ systemId: item.systemId as string, data: { isActive } });\r\n    toast.success(isActive ? `Đã kích hoạt \"${item.name}\"` : `Đã tắt \"${item.name}\"`);\r\n  };\r\n  \r\n  const confirmDelete = () => {\r\n    if (idToDelete) {\r\n      const item = data.find(d => d.systemId === idToDelete);\r\n      remove.mutate(idToDelete as string);\r\n      toast.success(`Đã xóa \"${item?.name}\"`);\r\n    }\r\n    setIsAlertOpen(false);\r\n    setIdToDelete(null);\r\n  };\r\n  \r\n  const handleFormSubmit = (values: PaymentTypeFormValues) => {\r\n    try {\r\n      const now = new Date().toISOString();\r\n      const normalized = {\r\n        id: asBusinessId(values.id.trim().toUpperCase()),\r\n        name: values.name.trim(),\r\n        description: values.description?.trim() || undefined,\r\n        isBusinessResult: values.isBusinessResult,\r\n        isActive: values.isActive,\r\n        color: values.color?.trim() || undefined,\r\n      } satisfies Omit<PaymentType, 'systemId' | 'createdAt'>;\r\n\r\n      if (editingItem) {\r\n        update.mutate({ systemId: editingItem.systemId as string, data: normalized });\r\n        toast.success(\"Cập nhật thành công\");\r\n      } else {\r\n        create.mutate({\r\n          ...normalized,\r\n          createdAt: now,\r\n        });\r\n        toast.success(\"Thêm mới thành công\");\r\n      }\r\n      setIsFormOpen(false);\r\n    } catch (error) {\r\n      toast.error(\"Có lỗi xảy ra\", {\r\n        description: error instanceof Error ? error.message : \"Lỗi không xác định\",\r\n      });\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (!isActive) {\r\n      return;\r\n    }\r\n\r\n    onRegisterActions([\r\n      <SettingsActionButton key=\"add-payment-type\" onClick={handleAddNew}>\r\n        <Plus className=\"mr-2 h-4 w-4\" /> Thêm loại phiếu chi\r\n      </SettingsActionButton>,\r\n    ]);\r\n  }, [handleAddNew, isActive, onRegisterActions]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n\r\n      <div className=\"rounded-md border\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>Mã loại</TableHead>\r\n              <TableHead>Tên loại</TableHead>\r\n              <TableHead>Mô tả</TableHead>\r\n              <TableHead>Mặc định</TableHead>\r\n              <TableHead>Trạng thái</TableHead>\r\n              <TableHead className=\"text-right\">Thao tác</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n          <TableBody>\r\n            {data.length === 0 ? (\r\n              <TableRow>\r\n                <TableCell colSpan={6} className=\"h-24 text-center\">\r\n                  Chưa có dữ liệu\r\n                </TableCell>\r\n              </TableRow>\r\n            ) : (\r\n              data.map((item) => (\r\n                <TableRow key={item.systemId}>\r\n                  <TableCell className=\"font-medium\">{item.id}</TableCell>\r\n                  <TableCell className=\"font-medium\">{item.name}</TableCell>\r\n                  <TableCell className=\"text-sm text-muted-foreground\">\r\n                    {item.description || \"—\"}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Switch \r\n                      checked={item.isDefault ?? false} \r\n                      onCheckedChange={(checked) => handleToggleDefault(item, checked)}\r\n                    />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Switch \r\n                      checked={item.isActive} \r\n                      onCheckedChange={(checked) => handleToggleStatus(item, checked)}\r\n                    />\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right\">\r\n                    <DropdownMenu>\r\n                      <DropdownMenuTrigger asChild>\r\n                        <Button variant=\"ghost\" className=\"h-8 w-8 p-0\">\r\n                          <span className=\"sr-only\">Mở menu</span>\r\n                          <MoreHorizontal className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </DropdownMenuTrigger>\r\n                      <DropdownMenuContent align=\"end\">\r\n                        <DropdownMenuLabel>Thao tác</DropdownMenuLabel>\r\n                        <DropdownMenuSeparator />\r\n                        <DropdownMenuItem onClick={() => handleEdit(item)}>\r\n                          Chỉnh sửa\r\n                        </DropdownMenuItem>\r\n                        <DropdownMenuItem\r\n                          onClick={() => handleDeleteRequest(item.systemId)}\r\n                          className=\"text-destructive\"\r\n                        >\r\n                          Xóa\r\n                        </DropdownMenuItem>\r\n                      </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </div>      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{editingItem ? 'Cập nhật loại phiếu chi' : 'Thêm loại phiếu chi'}</DialogTitle>\r\n          </DialogHeader>\r\n          <PaymentTypeForm initialData={editingItem} onSubmit={handleFormSubmit} />\r\n          <DialogFooter>\r\n            <Button type=\"button\" variant=\"outline\" className=\"h-9\" onClick={() => setIsFormOpen(false)}>Đóng</Button>\r\n            <Button type=\"submit\" form=\"payment-type-form\" className=\"h-9\">Lưu</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Hành động này không thể hoàn tác. Loại phiếu chi sẽ bị xóa vĩnh viễn.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={confirmDelete}>Xóa</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3912, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/api/payment-methods-api.ts"],"sourcesContent":["/**\r\n * Payment Methods API\r\n */\r\n\r\nimport type { PaymentMethod } from '../types';\r\n\r\ninterface ApiResponse<T> {\r\n  data: T;\r\n  pagination?: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nconst API_BASE = '/api/settings/payment-methods';\r\n\r\nexport type PaymentMethodFilters = {\r\n  isActive?: boolean;\r\n};\r\n\r\nexport type PaymentMethodCreateInput = Omit<PaymentMethod, 'systemId' | 'isDefault' | 'createdAt' | 'updatedAt'>;\r\nexport type PaymentMethodUpdateInput = Partial<PaymentMethodCreateInput>;\r\n\r\nexport async function fetchPaymentMethods(filters: PaymentMethodFilters = {}): Promise<ApiResponse<PaymentMethod[]>> {\r\n  const params = new URLSearchParams();\r\n  if (filters.isActive !== undefined) params.append('isActive', String(filters.isActive));\r\n  \r\n  const url = params.toString() ? `${API_BASE}?${params}` : API_BASE;\r\n  const response = await fetch(url);\r\n  if (!response.ok) throw new Error('Failed to fetch payment methods');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchPaymentMethodById(systemId: string): Promise<ApiResponse<PaymentMethod>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}`);\r\n  if (!response.ok) throw new Error('Failed to fetch payment method');\r\n  return response.json();\r\n}\r\n\r\nexport async function createPaymentMethod(data: PaymentMethodCreateInput): Promise<ApiResponse<PaymentMethod>> {\r\n  const response = await fetch(API_BASE, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to create payment method');\r\n  return response.json();\r\n}\r\n\r\nexport async function updatePaymentMethod(\r\n  systemId: string,\r\n  data: PaymentMethodUpdateInput\r\n): Promise<ApiResponse<PaymentMethod>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to update payment method');\r\n  return response.json();\r\n}\r\n\r\nexport async function deletePaymentMethod(systemId: string): Promise<ApiResponse<void>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  if (!response.ok) throw new Error('Failed to delete payment method');\r\n  return response.json();\r\n}\r\n\r\nexport async function setDefaultPaymentMethod(systemId: string): Promise<ApiResponse<PaymentMethod>> {\r\n  const response = await fetch(`${API_BASE}/${systemId}/set-default`, {\r\n    method: 'PATCH',\r\n  });\r\n  if (!response.ok) throw new Error('Failed to set default payment method');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchActivePaymentMethods(): Promise<ApiResponse<PaymentMethod[]>> {\r\n  return fetchPaymentMethods({ isActive: true });\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;AAcD,MAAM,WAAW;AASV,eAAe,oBAAoB,UAAgC,CAAC,CAAC;IAC1E,MAAM,SAAS,IAAI;IACnB,IAAI,QAAQ,QAAQ,KAAK,WAAW,OAAO,MAAM,CAAC,YAAY,OAAO,QAAQ,QAAQ;IAErF,MAAM,MAAM,OAAO,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,QAAQ,GAAG;IAC1D,MAAM,WAAW,MAAM,MAAM;IAC7B,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,uBAAuB,QAAgB;IAC3D,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IACtD,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,oBAAoB,IAA8B;IACtE,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,oBACpB,QAAgB,EAChB,IAA8B;IAE9B,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,oBAAoB,QAAgB;IACxD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;IACV;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,wBAAwB,QAAgB;IAC5D,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAClE,QAAQ;IACV;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe;IACpB,OAAO,oBAAoB;QAAE,UAAU;IAAK;AAC9C"}},
    {"offset": {"line": 3992, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/hooks/use-payment-methods.ts"],"sourcesContent":["/**\r\n * Payment Methods React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchPaymentMethods,\r\n  fetchPaymentMethodById,\r\n  createPaymentMethod,\r\n  updatePaymentMethod,\r\n  deletePaymentMethod,\r\n  setDefaultPaymentMethod,\r\n  fetchActivePaymentMethods,\r\n  type PaymentMethodFilters,\r\n  type PaymentMethodCreateInput,\r\n  type PaymentMethodUpdateInput,\r\n} from '../api/payment-methods-api';\r\n\r\nexport const paymentMethodKeys = {\r\n  all: ['payment-methods'] as const,\r\n  lists: () => [...paymentMethodKeys.all, 'list'] as const,\r\n  list: (filters: PaymentMethodFilters) => [...paymentMethodKeys.lists(), filters] as const,\r\n  details: () => [...paymentMethodKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...paymentMethodKeys.details(), id] as const,\r\n  active: () => [...paymentMethodKeys.all, 'active'] as const,\r\n};\r\n\r\nexport function usePaymentMethods(filters: PaymentMethodFilters = {}) {\r\n  return useQuery({\r\n    queryKey: paymentMethodKeys.list(filters),\r\n    queryFn: () => fetchPaymentMethods(filters),\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function usePaymentMethodById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: paymentMethodKeys.detail(systemId!),\r\n    queryFn: () => fetchPaymentMethodById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useActivePaymentMethods() {\r\n  return useQuery({\r\n    queryKey: paymentMethodKeys.active(),\r\n    queryFn: fetchActivePaymentMethods,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function usePaymentMethodMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n  const invalidate = () => queryClient.invalidateQueries({ queryKey: paymentMethodKeys.all });\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: PaymentMethodCreateInput) => createPaymentMethod(data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: PaymentMethodUpdateInput }) =>\r\n      updatePaymentMethod(systemId, data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deletePaymentMethod(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const setDefault = useMutation({\r\n    mutationFn: (systemId: string) => setDefaultPaymentMethod(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create, update, remove, setDefault,\r\n    isLoading: create.isPending || update.isPending || remove.isPending || setDefault.isPending,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;CAEC,GAED;AAAA;AAAA;AACA;;;;AAaO,MAAM,oBAAoB;IAC/B,KAAK;QAAC;KAAkB;IACxB,OAAO,IAAM;eAAI,kBAAkB,GAAG;YAAE;SAAO;IAC/C,MAAM,CAAC,UAAkC;eAAI,kBAAkB,KAAK;YAAI;SAAQ;IAChF,SAAS,IAAM;eAAI,kBAAkB,GAAG;YAAE;SAAS;IACnD,QAAQ,CAAC,KAAe;eAAI,kBAAkB,OAAO;YAAI;SAAG;IAC5D,QAAQ,IAAM;eAAI,kBAAkB,GAAG;YAAE;SAAS;AACpD;AAEO,SAAS,kBAAkB,UAAgC,CAAC,CAAC;;IAClE,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,kBAAkB,IAAI,CAAC;QACjC,OAAO;0CAAE,IAAM,IAAA,yMAAmB,EAAC;;QACnC,WAAW,OAAO,KAAK;IACzB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,qBAAqB,QAA4B;;IAC/D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,kBAAkB,MAAM,CAAC;QACnC,OAAO;6CAAE,IAAM,IAAA,4MAAsB,EAAC;;QACtC,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IACzB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,kBAAkB,MAAM;QAClC,SAAS,+MAAyB;QAClC,WAAW,OAAO,KAAK;IACzB;AACF;IANgB;;QACP,0LAAQ;;;AAYV,SAAS,0BAA0B,UAA6B,CAAC,CAAC;;IACvE,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,aAAa,IAAM,YAAY,iBAAiB,CAAC;YAAE,UAAU,kBAAkB,GAAG;QAAC;IAEzF,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;6DAAE,CAAC,OAAmC,IAAA,yMAAmB,EAAC;;QACpE,SAAS;6DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;6DAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAwD,GACnF,IAAA,yMAAmB,EAAC,UAAU;;QAChC,SAAS;6DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;6DAAE,CAAC,WAAqB,IAAA,yMAAmB,EAAC;;QACtD,SAAS;6DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,aAAa,IAAA,gMAAW,EAAC;QAC7B,UAAU;iEAAE,CAAC,WAAqB,IAAA,6MAAuB,EAAC;;QAC1D,SAAS;iEAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QACL;QAAQ;QAAQ;QAAQ;QACxB,WAAW,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,WAAW,SAAS;IAC7F;AACF;IAjCgB;;QACM,2MAAc;QAGnB,gMAAW;QAMX,gMAAW;QAOX,gMAAW;QAMP,gMAAW"}},
    {"offset": {"line": 4160, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport type { PaymentMethod } from \"./types\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"../../../../components/ui/form\";\r\nimport { Input } from \"../../../../components/ui/input\";\r\nimport { Switch } from \"../../../../components/ui/switch\";\r\n\r\nconst formSchema = z.object({\r\n  name: z.string().min(1, \"Tên hình thức là bắt buộc\").max(100, \"Tên không được vượt quá 100 ký tự\"),\r\n  isActive: z.boolean(),\r\n  description: z.string().optional(),\r\n  accountNumber: z.string().optional(),\r\n  accountName: z.string().optional(),\r\n  bankName: z.string().optional(),\r\n  color: z.string().optional(),\r\n  icon: z.string().optional(),\r\n});\r\n\r\nexport type PaymentMethodFormValues = z.infer<typeof formSchema>;\r\n\r\ntype FormProps = {\r\n  initialData?: PaymentMethod | null;\r\n  onSubmit: (values: PaymentMethodFormValues) => void;\r\n};\r\n\r\nexport function PaymentMethodForm({ initialData, onSubmit }: FormProps) {\r\n  const form = useForm<PaymentMethodFormValues>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: initialData\r\n      ? {\r\n          name: initialData.name,\r\n          isActive: initialData.isActive,\r\n          description: initialData.description ?? '',\r\n          accountNumber: initialData.accountNumber ?? '',\r\n          accountName: initialData.accountName ?? '',\r\n          bankName: initialData.bankName ?? '',\r\n          color: initialData.color ?? '',\r\n          icon: initialData.icon ?? '',\r\n        }\r\n      : {\r\n          name: '',\r\n          isActive: true,\r\n          description: '',\r\n          accountNumber: '',\r\n          accountName: '',\r\n          bankName: '',\r\n          color: '#10b981',\r\n          icon: '',\r\n        },\r\n  });\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form id=\"payment-method-form\" onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 pt-4\">\r\n        <FormField control={form.control} name=\"name\" render={({ field }) => (\r\n          <FormItem><FormLabel>Tên hình thức thanh toán <span className=\"text-destructive\">*</span></FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n        \r\n        <FormField control={form.control} name=\"description\" render={({ field }) => (\r\n          <FormItem><FormLabel>Mô tả</FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <FormField control={form.control} name=\"color\" render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Màu hiển thị</FormLabel>\r\n              <FormControl>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Input\r\n                    type=\"color\"\r\n                    value={field.value || '#10b981'}\r\n                    onChange={(event) => field.onChange(event.target.value)}\r\n                    className=\"h-9 w-14 p-1\"\r\n                  />\r\n                  <Input\r\n                    value={field.value || ''}\r\n                    onChange={(event) => field.onChange(event.target.value)}\r\n                    placeholder=\"#10b981\"\r\n                  />\r\n                </div>\r\n              </FormControl>\r\n              <FormDescription>Hiển thị nền icon trong bảng</FormDescription>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )} />\r\n\r\n          <FormField control={form.control} name=\"icon\" render={({ field }) => (\r\n            <FormItem>\r\n              <FormLabel>Tên icon</FormLabel>\r\n              <FormControl>\r\n                <Input {...field} value={field.value ?? ''} placeholder=\"VD: Wallet, CreditCard\" />\r\n              </FormControl>\r\n              <FormDescription>Trùng tên icon của Lucide</FormDescription>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )} />\r\n        </div>\r\n        \r\n        {/* Bank account fields (for transfer methods) */}\r\n        <div className=\"space-y-4 p-4 border border-border rounded-lg bg-muted/50\">\r\n          <p className=\"text-sm font-medium text-muted-foreground\">Thông tin tài khoản (dành cho chuyển khoản)</p>\r\n          \r\n          <FormField control={form.control} name=\"accountNumber\" render={({ field }) => (\r\n            <FormItem><FormLabel>Số tài khoản</FormLabel><FormControl><Input {...field} value={field.value ?? ''} placeholder=\"VD: 1234567890\" /></FormControl><FormMessage /></FormItem>\r\n          )} />\r\n          \r\n          <FormField control={form.control} name=\"accountName\" render={({ field }) => (\r\n            <FormItem><FormLabel>Tên chủ tài khoản</FormLabel><FormControl><Input {...field} value={field.value ?? ''} placeholder=\"VD: NGUYEN VAN A\" /></FormControl><FormMessage /></FormItem>\r\n          )} />\r\n          \r\n          <FormField control={form.control} name=\"bankName\" render={({ field }) => (\r\n            <FormItem><FormLabel>Tên ngân hàng</FormLabel><FormControl><Input {...field} value={field.value ?? ''} placeholder=\"VD: Vietcombank - CN HCM\" /></FormControl><FormMessage /></FormItem>\r\n          )} />\r\n        </div>\r\n        \r\n        <FormField control={form.control} name=\"isActive\" render={({ field }) => (\r\n          <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3\">\r\n            <div className=\"space-y-0.5\">\r\n              <FormLabel>Trạng thái hoạt động</FormLabel>\r\n              <FormDescription>Cho phép sử dụng hình thức thanh toán này</FormDescription>\r\n            </div>\r\n            <FormControl>\r\n              <Switch checked={field.value} onCheckedChange={field.onChange} />\r\n            </FormControl>\r\n          </FormItem>\r\n        )} />\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4669, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/page-content.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Plus, MoreHorizontal } from \"lucide-react\";\r\nimport { usePaymentMethods, usePaymentMethodMutations } from \"./hooks/use-payment-methods\";\r\nimport type { PaymentMethod } from \"./types\";\r\nimport { PaymentMethodForm, type PaymentMethodFormValues } from \"./form\";\r\nimport { Button } from \"../../../../components/ui/button\";\r\nimport { Switch } from \"../../../../components/ui/switch\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"../../../../components/ui/dialog\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"../../../../components/ui/alert-dialog\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"../../../../components/ui/dropdown-menu\";\r\nimport { toast } from \"sonner\";\r\nimport { asBusinessId, type SystemId } from \"@/lib/id-types\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../../../components/ui/table\";\r\nimport { SettingsActionButton } from \"../../../../components/settings/SettingsActionButton\";\r\nimport type { RegisterTabActions } from \"../../use-tab-action-registry\";\r\n\r\ntype PaymentMethodsPageContentProps = {\r\n  isActive: boolean;\r\n  onRegisterActions: RegisterTabActions;\r\n};\r\n\r\nexport function PaymentMethodsPageContent({ isActive, onRegisterActions }: PaymentMethodsPageContentProps) {\r\n  const { data: paymentMethodsData } = usePaymentMethods();\r\n  const data = paymentMethodsData?.data || [];\r\n  const { create, update, remove, setDefault } = usePaymentMethodMutations();\r\n  \r\n  const [isFormOpen, setIsFormOpen] = React.useState(false);\r\n  const [editingItem, setEditingItem] = React.useState<PaymentMethod | null>(null);\r\n  const [isAlertOpen, setIsAlertOpen] = React.useState(false);\r\n  const [idToDelete, setIdToDelete] = React.useState<SystemId | null>(null);\r\n  \r\n  const handleAddNew = React.useCallback(() => {\r\n    setEditingItem(null);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n\r\n  const handleEdit = React.useCallback((item: PaymentMethod) => {\r\n    setEditingItem(item);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n\r\n  const handleDeleteRequest = React.useCallback((systemId: SystemId) => {\r\n    setIdToDelete(systemId);\r\n    setIsAlertOpen(true);\r\n  }, []);\r\n  \r\n  const handleToggleStatus = React.useCallback((item: PaymentMethod, isActive: boolean) => {\r\n    update.mutate({ systemId: item.systemId as string, data: { isActive } });\r\n    toast.success(isActive ? `Đã kích hoạt \"${item.name}\"` : `Đã tắt \"${item.name}\"`);\r\n  }, [update]);\r\n  \r\n  const confirmDelete = () => {\r\n    if (idToDelete) {\r\n      const method = data.find(m => m.systemId === idToDelete);\r\n      remove.mutate(idToDelete as string);\r\n      toast.success(`Đã xóa \"${method?.name}\"`);\r\n    }\r\n    setIsAlertOpen(false);\r\n    setIdToDelete(null);\r\n  };\r\n  \r\n  const handleToggleDefault = React.useCallback((item: PaymentMethod, checked: boolean) => {\r\n    if (checked) {\r\n      setDefault.mutate(item.systemId as string);\r\n      toast.success(`Đã đặt \"${item.name}\" làm mặc định`);\r\n    } else {\r\n      // Find another method to set as default\r\n      const otherMethods = data.filter(m => m.systemId !== item.systemId);\r\n      if (otherMethods.length > 0) {\r\n        setDefault.mutate(otherMethods[0].systemId as string);\r\n        toast.success(`Đã đặt \"${otherMethods[0].name}\" làm mặc định`);\r\n      } else {\r\n        toast.error('Phải có ít nhất một phương thức thanh toán mặc định');\r\n      }\r\n    }\r\n  }, [data, setDefault]);\r\n  \r\n  const handleSetDefault = React.useCallback((systemId: SystemId) => {\r\n    const method = data.find(m => m.systemId === systemId);\r\n    setDefault.mutate(systemId as string);\r\n    toast.success(`Đã đặt \"${method?.name}\" làm mặc định`);\r\n  }, [data, setDefault]);\r\n  \r\n  const normalizeValues = (\r\n    values: PaymentMethodFormValues,\r\n    fallbackId?: string\r\n  ): Omit<PaymentMethod, 'systemId' | 'isDefault'> => {\r\n    const candidateId = fallbackId\r\n      || values.name.trim().toUpperCase().replace(/\\s+/g, '_')\r\n      || `PM_${Date.now()}`;\r\n\r\n    return {\r\n      id: asBusinessId(candidateId),\r\n      name: values.name.trim(),\r\n      isActive: values.isActive,\r\n      color: values.color?.trim() || undefined,\r\n      icon: values.icon?.trim() || undefined,\r\n      description: values.description?.trim() || undefined,\r\n      accountNumber: values.accountNumber?.trim() || undefined,\r\n      accountName: values.accountName?.trim() || undefined,\r\n      bankName: values.bankName?.trim() || undefined,\r\n    };\r\n  };\r\n\r\n  const handleFormSubmit = (values: PaymentMethodFormValues) => {\r\n    try {\r\n      const payload = normalizeValues(values, editingItem?.id);\r\n      if (editingItem) {\r\n        update.mutate({ systemId: editingItem.systemId as string, data: payload });\r\n        toast.success(\"Cập nhật thành công\");\r\n      } else {\r\n        create.mutate(payload);\r\n        toast.success(\"Thêm mới thành công\");\r\n      }\r\n      setIsFormOpen(false);\r\n    } catch (error) {\r\n      toast.error(\"Có lỗi xảy ra\", {\r\n        description: error instanceof Error ? error.message : \"Lỗi không xác định\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const sortedMethods = React.useMemo(() => {\r\n    return [...data].sort((a, b) => a.name.localeCompare(b.name));\r\n  }, [data]);\r\n\r\n  React.useEffect(() => {\r\n    if (!isActive) {\r\n      return;\r\n    }\r\n\r\n    onRegisterActions([\r\n      <SettingsActionButton key=\"add-payment-method\" onClick={handleAddNew}>\r\n        <Plus className=\"mr-2 h-4 w-4\" /> Thêm hình thức thanh toán\r\n      </SettingsActionButton>,\r\n    ]);\r\n  }, [handleAddNew, isActive, onRegisterActions]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-md border bg-card\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead className=\"w-[110px]\">Mã</TableHead>\r\n              <TableHead>Tên & mô tả</TableHead>\r\n              <TableHead className=\"w-[220px]\">Thông tin tài khoản</TableHead>\r\n              <TableHead className=\"w-[100px]\">Mặc định</TableHead>\r\n              <TableHead className=\"w-[100px]\">Trạng thái</TableHead>\r\n              <TableHead className=\"w-[80px] text-right\">Thao tác</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n          <TableBody>\r\n            {sortedMethods.length === 0 ? (\r\n              <TableRow>\r\n                <TableCell colSpan={6} className=\"h-24 text-center text-sm text-muted-foreground\">\r\n                  Hãy thêm hình thức thanh toán đầu tiên\r\n                </TableCell>\r\n              </TableRow>\r\n            ) : (\r\n              sortedMethods.map((method) => {\r\n                return (\r\n                  <TableRow key={method.systemId}>\r\n                    <TableCell className=\"font-mono text-xs uppercase text-muted-foreground\">\r\n                      {method.id ?? '—'}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex items-start gap-3\">\r\n                        <div>\r\n                          <p className=\"font-medium\">{method.name}</p>\r\n                          {method.description ? (\r\n                            <p className=\"text-sm text-muted-foreground\">{method.description}</p>\r\n                          ) : null}\r\n                        </div>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {method.accountName || method.accountNumber || method.bankName ? (\r\n                        <div className=\"text-sm leading-relaxed\">\r\n                          {method.accountName && <p className=\"font-medium\">{method.accountName}</p>}\r\n                          {method.accountNumber && (\r\n                            <p className=\"font-mono text-xs text-muted-foreground\">{method.accountNumber}</p>\r\n                          )}\r\n                          {method.bankName && <p className=\"text-muted-foreground\">{method.bankName}</p>}\r\n                        </div>\r\n                      ) : (\r\n                        <span className=\"text-sm text-muted-foreground\">—</span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Switch \r\n                        checked={method.isDefault} \r\n                        onCheckedChange={(checked) => handleToggleDefault(method, checked)}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Switch \r\n                        checked={method.isActive} \r\n                        onCheckedChange={(checked) => handleToggleStatus(method, checked)}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                          <Button variant=\"ghost\" className=\"h-8 w-8 p-0\">\r\n                            <span className=\"sr-only\">Mở menu</span>\r\n                            <MoreHorizontal className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                          <DropdownMenuLabel>Thao tác</DropdownMenuLabel>\r\n                          <DropdownMenuSeparator />\r\n                          <DropdownMenuItem onClick={() => handleEdit(method)}>\r\n                            Chỉnh sửa\r\n                          </DropdownMenuItem>\r\n                          {!method.isDefault && (\r\n                            <DropdownMenuItem onClick={() => handleSetDefault(method.systemId)}>\r\n                              Đặt làm mặc định\r\n                            </DropdownMenuItem>\r\n                          )}\r\n                          <DropdownMenuItem\r\n                            onClick={() => handleDeleteRequest(method.systemId)}\r\n                            className=\"text-destructive\"\r\n                          >\r\n                            Xóa\r\n                          </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                      </DropdownMenu>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                );\r\n              })\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{editingItem ? 'Cập nhật hình thức thanh toán' : 'Thêm hình thức thanh toán'}</DialogTitle>\r\n          </DialogHeader>\r\n          <PaymentMethodForm initialData={editingItem} onSubmit={handleFormSubmit} />\r\n          <DialogFooter>\r\n            <Button type=\"button\" variant=\"outline\" onClick={() => setIsFormOpen(false)}>Hủy</Button>\r\n            <Button type=\"submit\" form=\"payment-method-form\">Lưu</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Hành động này không thể hoàn tác. Hình thức thanh toán sẽ bị xóa vĩnh viễn.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={confirmDelete}>Xóa</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5330, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/api/target-groups-api.ts"],"sourcesContent":["/**\r\n * Target Groups API Layer\r\n */\r\n\r\nimport type { TargetGroup } from '../types';\r\n\r\nexport interface TargetGroupFilters {\r\n  page?: number;\r\n  limit?: number;\r\n  isActive?: boolean;\r\n}\r\n\r\nexport interface TargetGroupResponse {\r\n  data: TargetGroup[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface TargetGroupCreateInput {\r\n  systemId?: string;\r\n  id?: string;\r\n  name: string;\r\n  isActive?: boolean;\r\n  isDefault?: boolean;\r\n}\r\n\r\nexport interface TargetGroupUpdateInput extends Partial<TargetGroupCreateInput> {}\r\n\r\nconst BASE_URL = '/api/settings/target-groups';\r\n\r\nexport async function fetchTargetGroups(\r\n  filters: TargetGroupFilters = {}\r\n): Promise<TargetGroupResponse> {\r\n  const params = new URLSearchParams();\r\n  if (filters.page) params.set('page', String(filters.page));\r\n  if (filters.limit) params.set('limit', String(filters.limit));\r\n  if (filters.isActive !== undefined) params.set('isActive', String(filters.isActive));\r\n\r\n  const url = params.toString() ? `${BASE_URL}?${params}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) throw new Error('Failed to fetch target groups');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchTargetGroupById(systemId: string): Promise<TargetGroup> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  if (!response.ok) throw new Error('Failed to fetch target group');\r\n  return response.json();\r\n}\r\n\r\nexport async function createTargetGroup(data: TargetGroupCreateInput): Promise<TargetGroup> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to create target group');\r\n  return response.json();\r\n}\r\n\r\nexport async function updateTargetGroup(\r\n  systemId: string,\r\n  data: TargetGroupUpdateInput\r\n): Promise<TargetGroup> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  if (!response.ok) throw new Error('Failed to update target group');\r\n  return response.json();\r\n}\r\n\r\nexport async function deleteTargetGroup(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, { method: 'DELETE' });\r\n  if (!response.ok) throw new Error('Failed to delete target group');\r\n}\r\n\r\nexport async function setDefaultTargetGroup(systemId: string): Promise<TargetGroup> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/set-default`, { method: 'POST' });\r\n  if (!response.ok) throw new Error('Failed to set default');\r\n  return response.json();\r\n}\r\n\r\nexport async function fetchActiveTargetGroups(): Promise<TargetGroup[]> {\r\n  const response = await fetchTargetGroups({ isActive: true, limit: 100 });\r\n  return response.data;\r\n}\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;;;;;;;;;AA8BD,MAAM,WAAW;AAEV,eAAe,kBACpB,UAA8B,CAAC,CAAC;IAEhC,MAAM,SAAS,IAAI;IACnB,IAAI,QAAQ,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,OAAO,QAAQ,IAAI;IACxD,IAAI,QAAQ,KAAK,EAAE,OAAO,GAAG,CAAC,SAAS,OAAO,QAAQ,KAAK;IAC3D,IAAI,QAAQ,QAAQ,KAAK,WAAW,OAAO,GAAG,CAAC,YAAY,OAAO,QAAQ,QAAQ;IAElF,MAAM,MAAM,OAAO,QAAQ,KAAK,GAAG,SAAS,CAAC,EAAE,QAAQ,GAAG;IAC1D,MAAM,WAAW,MAAM,MAAM;IAE7B,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,qBAAqB,QAAgB;IACzD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU;IACtD,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,IAA4B;IAClE,MAAM,WAAW,MAAM,MAAM,UAAU;QACrC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBACpB,QAAgB,EAChB,IAA4B;IAE5B,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QACtD,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,UAAU,EAAE;QAAE,QAAQ;IAAS;IAC3E,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;AACpC;AAEO,eAAe,sBAAsB,QAAgB;IAC1D,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,CAAC,EAAE,SAAS,YAAY,CAAC,EAAE;QAAE,QAAQ;IAAO;IACrF,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,MAAM;IAClC,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,kBAAkB;QAAE,UAAU;QAAM,OAAO;IAAI;IACtE,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 5413, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/hooks/use-target-groups.ts"],"sourcesContent":["/**\r\n * Target Groups React Query Hooks\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchTargetGroups,\r\n  fetchTargetGroupById,\r\n  createTargetGroup,\r\n  updateTargetGroup,\r\n  deleteTargetGroup,\r\n  setDefaultTargetGroup,\r\n  fetchActiveTargetGroups,\r\n  type TargetGroupFilters,\r\n  type TargetGroupCreateInput,\r\n  type TargetGroupUpdateInput,\r\n} from '../api/target-groups-api';\r\n\r\nexport const targetGroupKeys = {\r\n  all: ['target-groups'] as const,\r\n  lists: () => [...targetGroupKeys.all, 'list'] as const,\r\n  list: (filters: TargetGroupFilters) => [...targetGroupKeys.lists(), filters] as const,\r\n  details: () => [...targetGroupKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...targetGroupKeys.details(), id] as const,\r\n  active: () => [...targetGroupKeys.all, 'active'] as const,\r\n};\r\n\r\nexport function useTargetGroups(filters: TargetGroupFilters = {}) {\r\n  return useQuery({\r\n    queryKey: targetGroupKeys.list(filters),\r\n    queryFn: () => fetchTargetGroups(filters),\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useTargetGroupById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: targetGroupKeys.detail(systemId!),\r\n    queryFn: () => fetchTargetGroupById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\nexport function useActiveTargetGroups() {\r\n  return useQuery({\r\n    queryKey: targetGroupKeys.active(),\r\n    queryFn: fetchActiveTargetGroups,\r\n    staleTime: 1000 * 60 * 10,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport function useTargetGroupMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n  const invalidate = () => queryClient.invalidateQueries({ queryKey: targetGroupKeys.all });\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: TargetGroupCreateInput) => createTargetGroup(data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: TargetGroupUpdateInput }) =>\r\n      updateTargetGroup(systemId, data),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deleteTargetGroup(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const setDefault = useMutation({\r\n    mutationFn: (systemId: string) => setDefaultTargetGroup(systemId),\r\n    onSuccess: () => { invalidate(); options.onSuccess?.(); },\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create, update, remove, setDefault,\r\n    isLoading: create.isPending || update.isPending || remove.isPending || setDefault.isPending,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;CAEC,GAED;AAAA;AAAA;AACA;;;;AAaO,MAAM,kBAAkB;IAC7B,KAAK;QAAC;KAAgB;IACtB,OAAO,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAO;IAC7C,MAAM,CAAC,UAAgC;eAAI,gBAAgB,KAAK;YAAI;SAAQ;IAC5E,SAAS,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;IACjD,QAAQ,CAAC,KAAe;eAAI,gBAAgB,OAAO;YAAI;SAAG;IAC1D,QAAQ,IAAM;eAAI,gBAAgB,GAAG;YAAE;SAAS;AAClD;AAEO,SAAS,gBAAgB,UAA8B,CAAC,CAAC;;IAC9D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,IAAI,CAAC;QAC/B,OAAO;wCAAE,IAAM,IAAA,kMAAiB,EAAC;;QACjC,WAAW,OAAO,KAAK;IACzB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,mBAAmB,QAA4B;;IAC7D,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM,CAAC;QACjC,OAAO;2CAAE,IAAM,IAAA,qMAAoB,EAAC;;QACpC,SAAS,CAAC,CAAC;QACX,WAAW,OAAO,KAAK;IACzB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,gBAAgB,MAAM;QAChC,SAAS,wMAAuB;QAChC,WAAW,OAAO,KAAK;IACzB;AACF;IANgB;;QACP,0LAAQ;;;AAYV,SAAS,wBAAwB,UAA6B,CAAC,CAAC;;IACrE,MAAM,cAAc,IAAA,2MAAc;IAClC,MAAM,aAAa,IAAM,YAAY,iBAAiB,CAAC;YAAE,UAAU,gBAAgB,GAAG;QAAC;IAEvF,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,OAAiC,IAAA,kMAAiB,EAAC;;QAChE,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAsD,GACjF,IAAA,kMAAiB,EAAC,UAAU;;QAC9B,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,SAAS,IAAA,gMAAW,EAAC;QACzB,UAAU;2DAAE,CAAC,WAAqB,IAAA,kMAAiB,EAAC;;QACpD,SAAS;2DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,MAAM,aAAa,IAAA,gMAAW,EAAC;QAC7B,UAAU;+DAAE,CAAC,WAAqB,IAAA,sMAAqB,EAAC;;QACxD,SAAS;+DAAE;gBAAQ;gBAAc,QAAQ,SAAS;YAAM;;QACxD,SAAS,QAAQ,OAAO;IAC1B;IAEA,OAAO;QACL;QAAQ;QAAQ;QAAQ;QACxB,WAAW,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,OAAO,SAAS,IAAI,WAAW,SAAS;IAC7F;AACF;IAjCgB;;QACM,2MAAc;QAGnB,gMAAW;QAMX,gMAAW;QAOX,gMAAW;QAMP,gMAAW"}},
    {"offset": {"line": 5581, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport type { TargetGroup } from \"./types\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"../../../components/ui/form\";\r\nimport { Input } from \"../../../components/ui/input\";\r\n\r\nconst formSchema = z.object({\r\n  id: z.string().default(\"\"),\r\n  name: z.string().min(1, \"Tên nhóm là bắt buộc\").max(100, \"Tên không được vượt quá 100 ký tự\"),\r\n});\r\n\r\nexport type TargetGroupFormValues = z.input<typeof formSchema>;\r\n\r\ntype FormProps = {\r\n  initialData?: TargetGroup | null;\r\n  onSubmit: (values: TargetGroupFormValues) => void;\r\n};\r\n\r\nexport function TargetGroupForm({ initialData, onSubmit }: FormProps) {\r\n  const form = useForm<TargetGroupFormValues>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: initialData\r\n      ? {\r\n          id: String(initialData.id ?? \"\"),\r\n          name: initialData.name ?? \"\",\r\n        }\r\n      : {\r\n          id: \"\",\r\n          name: \"\",\r\n        },\r\n    mode: \"onBlur\",\r\n  });\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form\r\n        id=\"target-group-form\"\r\n        onSubmit={form.handleSubmit((values) => onSubmit(formSchema.parse(values)))}\r\n        className=\"space-y-4 pt-4 max-h-[70vh] overflow-y-auto px-1\"\r\n      >\r\n        <FormField control={form.control} name=\"name\" render={({ field }) => (\r\n          <FormItem><FormLabel>Tên nhóm <span className=\"text-destructive\">*</span></FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n        <FormField control={form.control} name=\"id\" render={({ field }) => (\r\n          <FormItem><FormLabel>Mã nhóm</FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAEA;AACA;;;;;;;;AAEA,MAAM,aAAa,4JAAQ,CAAC;IAC1B,IAAI,4JAAQ,GAAG,OAAO,CAAC;IACvB,MAAM,4JAAQ,GAAG,GAAG,CAAC,GAAG,wBAAwB,GAAG,CAAC,KAAK;AAC3D;AASO,SAAS,gBAAgB,EAAE,WAAW,EAAE,QAAQ,EAAa;;IAClE,MAAM,OAAO,IAAA,4KAAO,EAAwB;QAC1C,UAAU,IAAA,gLAAW,EAAC;QACtB,eAAe,cACX;YACE,IAAI,OAAO,YAAY,EAAE,IAAI;YAC7B,MAAM,YAAY,IAAI,IAAI;QAC5B,IACA;YACE,IAAI;YACJ,MAAM;QACR;QACJ,MAAM;IACR;IAEA,qBACE,6LAAC,oIAAI;QAAE,GAAG,IAAI;kBACZ,cAAA,6LAAC;YACC,IAAG;YACH,UAAU,KAAK,YAAY,CAAC,CAAC,SAAW,SAAS,WAAW,KAAK,CAAC;YAClE,WAAU;;8BAEV,6LAAC,yIAAS;oBAAC,SAAS,KAAK,OAAO;oBAAE,MAAK;oBAAO,QAAQ,CAAC,EAAE,KAAK,EAAE,iBAC9D,6LAAC,wIAAQ;;8CAAC,6LAAC,yIAAS;;wCAAC;sDAAS,6LAAC;4CAAK,WAAU;sDAAmB;;;;;;;;;;;;8CAAoB,6LAAC,2IAAW;8CAAC,cAAA,6LAAC,sIAAK;wCAAE,GAAG,KAAK;wCAAE,OAAO,MAAM,KAAK,IAAI;;;;;;;;;;;8CAAoB,6LAAC,2IAAW;;;;;;;;;;;;;;;;8BAE5K,6LAAC,yIAAS;oBAAC,SAAS,KAAK,OAAO;oBAAE,MAAK;oBAAK,QAAQ,CAAC,EAAE,KAAK,EAAE,iBAC5D,6LAAC,wIAAQ;;8CAAC,6LAAC,yIAAS;8CAAC;;;;;;8CAAmB,6LAAC,2IAAW;8CAAC,cAAA,6LAAC,sIAAK;wCAAE,GAAG,KAAK;wCAAE,OAAO,MAAM,KAAK,IAAI;;;;;;;;;;;8CAAoB,6LAAC,2IAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKvI;GA/BgB;;QACD,4KAAO;;;KADN"}},
    {"offset": {"line": 5743, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/page-content.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Plus, MoreHorizontal } from \"lucide-react\";\r\nimport { useTargetGroups, useTargetGroupMutations } from \"./hooks/use-target-groups\";\r\nimport type { TargetGroup } from \"./types\";\r\nimport { TargetGroupForm, type TargetGroupFormValues } from \"./form\";\r\nimport { asBusinessId, type SystemId } from \"@/lib/id-types\";\r\nimport { Button } from \"../../../components/ui/button\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\nimport { Dialog, DialogContent, DialogFooter, DialogHeader, DialogTitle } from \"../../../components/ui/dialog\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"../../../components/ui/alert-dialog\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../../components/ui/table\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuLabel, DropdownMenuSeparator, DropdownMenuTrigger } from \"../../../components/ui/dropdown-menu\";\r\nimport { toast } from \"sonner\";\r\nimport { SettingsActionButton } from \"../../../components/settings/SettingsActionButton\";\r\nimport type { RegisterTabActions } from \"../use-tab-action-registry\";\r\n\r\ntype TargetGroupsPageContentProps = {\r\n  isActive: boolean;\r\n  onRegisterActions: RegisterTabActions;\r\n};\r\n\r\nexport function TargetGroupsPageContent({ isActive, onRegisterActions }: TargetGroupsPageContentProps) {\r\n  const { data: targetGroupsData } = useTargetGroups();\r\n  const data = targetGroupsData?.data || [];\r\n  const { create, update, remove, setDefault } = useTargetGroupMutations();\r\n  \r\n  const [isFormOpen, setIsFormOpen] = React.useState(false);\r\n  const [editingItem, setEditingItem] = React.useState<TargetGroup | null>(null);\r\n  const [isAlertOpen, setIsAlertOpen] = React.useState(false);\r\n  const [idToDelete, setIdToDelete] = React.useState<SystemId | null>(null);\r\n  \r\n  const handleAddNew = React.useCallback(() => {\r\n    setEditingItem(null);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n\r\n  const handleEdit = React.useCallback((item: TargetGroup) => { setEditingItem(item); setIsFormOpen(true); }, []);\r\n  const handleDeleteRequest = (systemId: SystemId) => { \r\n    setIdToDelete(systemId);\r\n    setIsAlertOpen(true);\r\n  };\r\n  \r\n  const handleToggleDefault = (item: TargetGroup, isDefault: boolean) => {\r\n    if (isDefault) {\r\n      // Use setDefault mutation to set default and unset others\r\n      setDefault.mutate(item.systemId as string);\r\n      toast.success(`Đã đặt \"${item.name}\" làm mặc định`);\r\n    } else {\r\n      const other = data.find(d => d.systemId !== item.systemId && d.isActive !== false);\r\n      if (other) {\r\n        setDefault.mutate(other.systemId as string);\r\n        toast.success(`Đã chuyển mặc định sang \"${other.name}\"`);\r\n      } else {\r\n        toast.error(\"Phải có ít nhất một nhóm đối tượng mặc định\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleToggleStatus = (item: TargetGroup, isActive: boolean) => {\r\n    update.mutate({ systemId: item.systemId as string, data: { isActive } });\r\n    toast.success(isActive ? \"Đã kích hoạt\" : \"Đã ngừng hoạt động\");\r\n  };\r\n  \r\n  const confirmDelete = () => {\r\n    if (idToDelete) {\r\n      remove.mutate(idToDelete as string);\r\n      toast.success(\"Đã xóa thành công\");\r\n    }\r\n    setIsAlertOpen(false);\r\n    setIdToDelete(null);\r\n  };\r\n  \r\n  const handleFormSubmit = (values: TargetGroupFormValues) => {\r\n    try {\r\n      const name = values.name.trim();\r\n      const normalizedId = values.id?.trim().toUpperCase();\r\n      if (editingItem) {\r\n        const payload = {\r\n          name,\r\n          id: normalizedId ? asBusinessId(normalizedId) : editingItem.id,\r\n        };\r\n        update.mutate({ systemId: editingItem.systemId as string, data: payload });\r\n        toast.success(\"Cập nhật thành công\");\r\n      } else {\r\n        create.mutate({\r\n          id: normalizedId ? asBusinessId(normalizedId) : asBusinessId(\"\"),\r\n          name,\r\n          isActive: true,\r\n        });\r\n        toast.success(\"Thêm mới thành công\");\r\n      }\r\n      setIsFormOpen(false);\r\n    } catch (error) {\r\n      toast.error(\"Có lỗi xảy ra\", {\r\n        description: error instanceof Error ? error.message : \"Lỗi không xác định\",\r\n      });\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (!isActive) {\r\n      return;\r\n    }\r\n\r\n    onRegisterActions([\r\n      <SettingsActionButton key=\"add-target-group\" onClick={handleAddNew}>\r\n        <Plus className=\"mr-2 h-4 w-4\" /> Thêm nhóm đối tượng\r\n      </SettingsActionButton>,\r\n    ]);\r\n  }, [handleAddNew, isActive, onRegisterActions]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-md border\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>Mã nhóm</TableHead>\r\n              <TableHead>Tên nhóm</TableHead>\r\n              <TableHead>Mặc định</TableHead>\r\n              <TableHead>Trạng thái</TableHead>\r\n              <TableHead className=\"text-right\">Thao tác</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n          <TableBody>\r\n            {data.length === 0 ? (\r\n              <TableRow>\r\n                <TableCell colSpan={5} className=\"h-24 text-center\">\r\n                  Chưa có dữ liệu\r\n                </TableCell>\r\n              </TableRow>\r\n            ) : (\r\n              data.map((item) => (\r\n                <TableRow key={item.systemId}>\r\n                  <TableCell className=\"font-medium\">{item.id}</TableCell>\r\n                  <TableCell className=\"font-medium\">{item.name}</TableCell>\r\n                  <TableCell>\r\n                    <Switch \r\n                      checked={item.isDefault ?? false} \r\n                      onCheckedChange={(checked) => handleToggleDefault(item, checked)} \r\n                    />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Switch \r\n                      checked={item.isActive ?? true} \r\n                      onCheckedChange={(checked) => handleToggleStatus(item, checked)} \r\n                    />\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right\">\r\n                    <DropdownMenu>\r\n                      <DropdownMenuTrigger asChild>\r\n                        <Button variant=\"ghost\" className=\"h-8 w-8 p-0\">\r\n                          <span className=\"sr-only\">Mở menu</span>\r\n                          <MoreHorizontal className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </DropdownMenuTrigger>\r\n                      <DropdownMenuContent align=\"end\">\r\n                        <DropdownMenuLabel>Thao tác</DropdownMenuLabel>\r\n                        <DropdownMenuSeparator />\r\n                        <DropdownMenuItem onClick={() => handleEdit(item)}>\r\n                          Chỉnh sửa\r\n                        </DropdownMenuItem>\r\n                        <DropdownMenuItem\r\n                          onClick={() => handleDeleteRequest(item.systemId)}\r\n                          className=\"text-destructive\"\r\n                        >\r\n                          Xóa\r\n                        </DropdownMenuItem>\r\n                      </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n      \r\n      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{editingItem ? 'Cập nhật nhóm đối tượng' : 'Thêm nhóm đối tượng'}</DialogTitle>\r\n          </DialogHeader>\r\n          <TargetGroupForm initialData={editingItem} onSubmit={handleFormSubmit} />\r\n          <DialogFooter>\r\n            <Button type=\"button\" variant=\"outline\" onClick={() => setIsFormOpen(false)}>Hủy</Button>\r\n            <Button type=\"submit\" form=\"target-group-form\">Lưu</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Hành động này không thể hoàn tác. Nhóm đối tượng sẽ bị xóa vĩnh viễn.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={confirmDelete}>Xóa</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6266, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/id-utils.ts"],"sourcesContent":["/**\r\n * ID Utilities\r\n * Helpers for generating and validating IDs (systemId & business id)\r\n */\r\n\r\nimport { getPrefix, type EntityType } from './smart-prefix';\r\nimport { ID_CONFIG } from './id-config';\r\n\r\n// Re-export EntityType for convenience\r\nexport type { EntityType } from './smart-prefix';\r\n\r\n/**\r\n * Generate SystemId (6 digits, immutable, internal use only)\r\n * Format: SYSTEMID_PREFIX + 6 digits (e.g., \"EMP000001\", \"CUSTOMER000001\", \"ORDER000001\")\r\n * Uses systemIdPrefix from ID_CONFIG (English full words)\r\n */\r\nexport function generateSystemId(entityType: EntityType, counter: number): string {\r\n  const config = ID_CONFIG[entityType];\r\n  if (!config) {\r\n    throw new Error(`No configuration found for entity type: ${entityType}`);\r\n  }\r\n  const prefix = config.systemIdPrefix;\r\n  const digitCount = config.digitCount || 6;\r\n  return `${prefix}${String(counter).padStart(digitCount, '0')}`;\r\n}\r\n\r\n/**\r\n * Generate Business ID (6 digits, user-facing, editable)\r\n * Format: PREFIX + 6 digits (e.g., \"NV000001\", \"KH000001\", \"CTV000001\")\r\n * All entities use same 6-digit format for consistency\r\n * \r\n * @param entityType - Entity type from smart-prefix\r\n * @param counter - Current counter value\r\n * @param customId - Optional custom ID from user input\r\n * @returns Generated ID or validated custom ID\r\n */\r\nexport function generateBusinessId(\r\n  entityType: EntityType, \r\n  counter: number,\r\n  customId?: string\r\n): string {\r\n  // If user provided custom ID, validate and return it\r\n  if (customId && customId.trim()) {\r\n    const sanitized = sanitizeBusinessId(customId);\r\n    if (!sanitized) {\r\n      throw new Error('Mã không hợp lệ! Chỉ được phép sử dụng chữ cái và số.');\r\n    }\r\n    return sanitized;\r\n  }\r\n  \r\n  // Otherwise, auto-generate\r\n  const prefix = getPrefix(entityType);\r\n  return `${prefix}${String(counter).padStart(6, '0')}`;\r\n}\r\n\r\n/**\r\n * Sanitize business ID\r\n * - Remove special characters (keep only letters and numbers)\r\n * - Convert to uppercase\r\n * - Trim whitespace\r\n * \r\n * @param id - Raw user input\r\n * @returns Sanitized ID or null if invalid\r\n */\r\nexport function sanitizeBusinessId(id: string): string | null {\r\n  if (!id || typeof id !== 'string') return null;\r\n  \r\n  // Remove all special characters, keep only alphanumeric\r\n  const cleaned = id.trim().replace(/[^a-zA-Z0-9]/g, '');\r\n  \r\n  if (!cleaned) return null;\r\n  \r\n  // Convert to uppercase for consistency\r\n  return cleaned.toUpperCase();\r\n}\r\n\r\n/**\r\n * Validate business ID uniqueness (case-insensitive)\r\n * \r\n * @param id - ID to check\r\n * @param existingIds - Array of existing IDs in the system\r\n * @param currentId - Current ID (for edit mode, to exclude self)\r\n * @returns true if unique, false if duplicate\r\n */\r\nexport function isBusinessIdUnique(\r\n  id: string,\r\n  existingIds: string[],\r\n  currentId?: string\r\n): boolean {\r\n  if (!id) return false;\r\n  \r\n  const normalizedId = id.toUpperCase();\r\n  const normalizedCurrentId = currentId?.toUpperCase();\r\n  \r\n  return !existingIds.some(existingId => {\r\n    // ✅ Filter out empty/undefined IDs\r\n    if (!existingId || existingId.trim() === '') return false;\r\n    \r\n    const normalizedExisting = existingId.toUpperCase();\r\n    // Skip self-comparison in edit mode\r\n    if (normalizedCurrentId && normalizedExisting === normalizedCurrentId) {\r\n      return false;\r\n    }\r\n    return normalizedExisting === normalizedId;\r\n  });\r\n}\r\n\r\n/**\r\n * Extract counter from system ID\r\n * Used to initialize counter when loading from localStorage\r\n * Supports both 6, 7 and 8 digits\r\n * \r\n * @param systemId - System ID to parse (e.g., \"EMP000001\", \"CUSTOMER000001\", \"WARRANTY0000001\")\r\n * @param prefix - Expected systemIdPrefix (e.g., \"EMP\", \"CUSTOMER\", \"WARRANTY\")\r\n * @returns Counter value or 0 if invalid\r\n */\r\nexport function extractCounterFromSystemId(systemId: string, prefix: string): number {\r\n  if (!systemId || typeof systemId !== 'string') return 0;\r\n  \r\n  // Try different digit counts (most entities use 6 digits, some use 7-8)\r\n  const regex8 = new RegExp(`^${prefix}(\\\\d{8})$`);\r\n  const regex7 = new RegExp(`^${prefix}(\\\\d{7})$`);\r\n  const regex6 = new RegExp(`^${prefix}(\\\\d{6})$`);\r\n  \r\n  const match8 = systemId.match(regex8);\r\n  if (match8) return parseInt(match8[1], 10);\r\n  \r\n  const match7 = systemId.match(regex7);\r\n  if (match7) return parseInt(match7[1], 10);\r\n  \r\n  const match6 = systemId.match(regex6);\r\n  if (match6) return parseInt(match6[1], 10);\r\n  \r\n  return 0;\r\n}\r\n\r\n/**\r\n * Extract counter from business ID\r\n * Used to initialize counter when loading from localStorage\r\n * \r\n * @param businessId - Business ID to parse (e.g., \"NV000001\")\r\n * @param prefix - Expected prefix (e.g., \"NV\")\r\n * @returns Counter value or 0 if invalid\r\n */\r\nexport function extractCounterFromBusinessId(businessId: string, prefix: string): number {\r\n  if (!businessId || typeof businessId !== 'string') return 0;\r\n  const regex = new RegExp(`^${prefix}(\\\\d+)$`);\r\n  const match = businessId.match(regex);\r\n  return match ? parseInt(match[1], 10) : 0;\r\n}\r\n\r\n/**\r\n * Get max counter from array of items (for systemId)\r\n * \r\n * @param items - Array of items with systemId\r\n * @param prefix - Prefix to match\r\n * @returns Maximum counter value\r\n */\r\nexport function getMaxSystemIdCounter<T extends { systemId: string }>(\r\n  items: T[],\r\n  prefix: string\r\n): number {\r\n  if (!items || !Array.isArray(items)) return 0;\r\n  \r\n  let maxCounter = 0;\r\n  \r\n  items.forEach(item => {\r\n    if (!item || !item.systemId) return;\r\n    const counter = extractCounterFromSystemId(item.systemId, prefix);\r\n    if (counter > maxCounter) {\r\n      maxCounter = counter;\r\n    }\r\n  });\r\n  \r\n  return maxCounter;\r\n}\r\n\r\n/**\r\n * Get max counter from array of items (for business id)\r\n * Only counts auto-generated IDs (PREFIX + digits)\r\n * \r\n * @param items - Array of items with id\r\n * @param prefix - Prefix to match\r\n * @returns Maximum counter value\r\n */\r\nexport function getMaxBusinessIdCounter<T extends { id: string }>(\r\n  items: T[],\r\n  prefix: string\r\n): number {\r\n  if (!items || !Array.isArray(items)) return 0;\r\n  \r\n  let maxCounter = 0;\r\n  \r\n  items.forEach(item => {\r\n    if (!item || !item.id) return;\r\n    const counter = extractCounterFromBusinessId(item.id, prefix);\r\n    if (counter > maxCounter) {\r\n      maxCounter = counter;\r\n    }\r\n  });\r\n  \r\n  return maxCounter;\r\n}\r\n\r\n/**\r\n * Format ID for display\r\n * Adds spacing for readability\r\n * \r\n * @param id - ID to format\r\n * @returns Formatted ID (e.g., \"NV-000001\", \"KH-000123\")\r\n */\r\nexport function formatIdForDisplay(id: string): string {\r\n  // Match pattern: PREFIX followed by numbers\r\n  const match = id.match(/^([A-Z]+)(\\d+)$/);\r\n  if (!match) return id;\r\n  \r\n  const [, prefix, numbers] = match;\r\n  return `${prefix}-${numbers}`;\r\n}\r\n\r\n/**\r\n * Validate ID format\r\n * Check if ID follows valid pattern (letters + numbers only)\r\n * \r\n * @param id - ID to validate\r\n * @returns true if valid format\r\n */\r\nexport function isValidIdFormat(id: string): boolean {\r\n  if (!id || typeof id !== 'string') return false;\r\n  \r\n  // Only alphanumeric characters allowed\r\n  const regex = /^[A-Z0-9]+$/i;\r\n  return regex.test(id);\r\n}\r\n\r\n/**\r\n * Generate suggested IDs based on entity type\r\n * Useful for autocomplete or placeholder text\r\n * \r\n * @param entityType - Entity type\r\n * @param counter - Current counter\r\n * @param count - Number of suggestions\r\n * @returns Array of suggested IDs\r\n */\r\nexport function generateSuggestedIds(\r\n  entityType: EntityType,\r\n  counter: number,\r\n  count: number = 3\r\n): string[] {\r\n  const suggestions: string[] = [];\r\n  const prefix = getPrefix(entityType);\r\n  \r\n  for (let i = 0; i < count; i++) {\r\n    suggestions.push(`${prefix}${String(counter + i + 1).padStart(6, '0')}`);\r\n  }\r\n  \r\n  return suggestions;\r\n}\r\n\r\n/**\r\n * ✨ Find next available business ID\r\n * Checks existing IDs and increments counter until finding a unique ID\r\n * \r\n * @param prefix - ID prefix (e.g., 'PT', 'PC', 'NV')\r\n * @param existingIds - Array of existing business IDs\r\n * @param startCounter - Starting counter value\r\n * @param digitCount - Number of digits (default: 6)\r\n * @returns Object with nextId and updatedCounter\r\n */\r\nexport function findNextAvailableBusinessId(\r\n  prefix: string,\r\n  existingIds: string[],\r\n  startCounter: number,\r\n  digitCount: number = 6\r\n): { nextId: string; updatedCounter: number } {\r\n  let counter = startCounter;\r\n  let nextId: string;\r\n  \r\n  // Keep incrementing until we find a unique ID\r\n  do {\r\n    counter++;\r\n    nextId = `${prefix}${String(counter).padStart(digitCount, '0')}`;\r\n  } while (existingIds.some(id => id === nextId));\r\n  \r\n  return {\r\n    nextId,\r\n    updatedCounter: counter\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6429, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/cashbook/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { CashAccount } from './types';\r\nimport { findNextAvailableBusinessId, generateSystemId, getMaxBusinessIdCounter, getMaxSystemIdCounter, type EntityType } from '../../lib/id-utils';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '../../lib/id-types';\r\n\r\nconst CASH_ACCOUNT_ENTITY: EntityType = 'cash-accounts';\r\nconst SYSTEM_ID_PREFIX = 'ACCOUNT';\r\nconst BUSINESS_ID_PREFIX = 'TK';\r\nconst BUSINESS_ID_DIGITS = 6;\r\n\r\n// API sync helpers\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: any): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/cash-accounts' : `/api/cash-accounts/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Cashbook API] ${action} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Cashbook API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function fetchFromAPI(): Promise<CashAccount[]> {\r\n  try {\r\n    const response = await fetch('/api/cash-accounts?limit=50');\r\n    if (!response.ok) return [];\r\n    const json = await response.json();\r\n    return json.data || [];\r\n  } catch (error) {\r\n    console.error('[Cashbook API] fetch error:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\ninterface CashbookState {\r\n  accounts: CashAccount[];\r\n  initialized: boolean;\r\n  getAccountById: (id: BusinessId) => CashAccount | undefined;\r\n  add: (item: Omit<CashAccount, 'systemId'>) => void;\r\n  update: (systemId: SystemId, item: CashAccount) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  setDefault: (systemId: SystemId) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst getNextSystemId = (accounts: CashAccount[]): SystemId => {\r\n  const currentCounter = getMaxSystemIdCounter(accounts, SYSTEM_ID_PREFIX);\r\n  return asSystemId(generateSystemId(CASH_ACCOUNT_ENTITY, currentCounter + 1));\r\n};\r\n\r\nconst ensureBusinessId = (accounts: CashAccount[], provided?: BusinessId): BusinessId => {\r\n  if (provided && provided.trim()) {\r\n    return provided;\r\n  }\r\n\r\n  const existingIds = accounts.map(acc => acc.id as string);\r\n  const startCounter = getMaxBusinessIdCounter(accounts, BUSINESS_ID_PREFIX);\r\n  const { nextId } = findNextAvailableBusinessId(BUSINESS_ID_PREFIX, existingIds, startCounter, BUSINESS_ID_DIGITS);\r\n  return asBusinessId(nextId);\r\n};\r\n\r\nexport const useCashbookStore = create<CashbookState>()(\r\n  (set, get) => ({\r\n      accounts: [],\r\n      initialized: false,\r\n      getAccountById: (id) => get().accounts.find(a => a.id === id),\r\n      \r\n      add: (item) => {\r\n        const newAccount: CashAccount = {\r\n          ...item,\r\n          systemId: getNextSystemId(get().accounts),\r\n          id: ensureBusinessId(get().accounts, item.id),\r\n        };\r\n        set((state) => ({ accounts: [...state.accounts, newAccount] }));\r\n        // Sync to API\r\n        syncToAPI('create', newAccount).catch(console.error);\r\n      },\r\n      \r\n      update: (systemId, updatedItem) => {\r\n        set((state) => ({\r\n          accounts: state.accounts.map((acc) => (acc.systemId === systemId ? updatedItem : acc))\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('update', updatedItem).catch(console.error);\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set((state) => ({\r\n          accounts: state.accounts.filter(acc => acc.systemId !== systemId)\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n      },\r\n      \r\n      setDefault: (systemId) => {\r\n        set((state) => {\r\n          const targetAccount = state.accounts.find(acc => acc.systemId === systemId);\r\n          if (!targetAccount) return state;\r\n\r\n          const updated = state.accounts.map(acc => ({\r\n            ...acc,\r\n            isDefault: (acc.type === targetAccount.type ? acc.systemId === systemId : acc.isDefault) ?? false\r\n          }));\r\n          \r\n          // Sync updated accounts to API\r\n          updated.forEach(acc => {\r\n            if (acc.type === targetAccount.type) {\r\n              syncToAPI('update', acc).catch(console.error);\r\n            }\r\n          });\r\n          \r\n          return { accounts: updated };\r\n        });\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        const apiData = await fetchFromAPI();\r\n        if (apiData.length > 0) {\r\n          set({ accounts: apiData, initialized: true });\r\n        } else {\r\n          set({ initialized: true });\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6564, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/store-factory.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// persist, createJSONStorage removed - database is now source of truth\r\nimport { \r\n  generateSystemId, \r\n  generateBusinessId, \r\n  isBusinessIdUnique,\r\n  getMaxSystemIdCounter,\r\n  getMaxBusinessIdCounter,\r\n  findNextAvailableBusinessId,\r\n  type EntityType \r\n} from './id-utils';\r\nimport { getPrefix } from './smart-prefix';\r\nimport { ID_CONFIG, type SystemId, type BusinessId, createSystemId, createBusinessId as brandBusinessId } from './id-config';\r\n\r\nconst SYSTEM_FALLBACK_ID: SystemId = createSystemId('SYS000000');\r\n\r\nconst asSystemIdFallback = (): SystemId => SYSTEM_FALLBACK_ID;\r\n\r\n// ✅ API Sync helper for store-factory\r\nasync function syncToAPI<T>(\r\n  apiEndpoint: string,\r\n  action: 'create' | 'update' | 'delete' | 'restore',\r\n  data: T | { systemId: SystemId },\r\n  systemId?: SystemId\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' \r\n      ? apiEndpoint \r\n      : `${apiEndpoint}/${systemId || (data as any).systemId}`;\r\n    \r\n    const method = action === 'create' ? 'POST' \r\n      : action === 'update' ? 'PATCH' \r\n      : action === 'delete' ? 'DELETE'\r\n      : 'PATCH'; // restore uses PATCH\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'include',\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.warn(`[Store Factory API] ${action} failed for ${apiEndpoint}:`, response.status);\r\n    }\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Store Factory API] ${action} error for ${apiEndpoint}:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Item with SystemId (branded type)\r\nexport type ItemWithSystemId = { systemId: SystemId; [key: string]: any };\r\n\r\n// ✅ Counter state for ID generation\r\nexport type CounterState = {\r\n  systemId: number;\r\n  businessId: number;\r\n};\r\n\r\nexport type CrudState<T extends ItemWithSystemId> = {\r\n  data: T[];\r\n  _counters: CounterState; // ✅ Persisted counters\r\n  _initialized: boolean; // ✅ Track if loaded from API\r\n  add: (item: Omit<T, 'systemId'>) => T;\r\n  addMultiple: (items: Omit<T, 'systemId'>[]) => void;\r\n  update: (systemId: SystemId, item: Partial<T>) => void; // ✅ Accept partial updates\r\n  remove: (systemId: SystemId) => void; // ✅ Branded type\r\n  hardDelete: (systemId: SystemId) => void; // ✅ Branded type\r\n  restore: (systemId: SystemId) => void; // ✅ Branded type\r\n  findById: (systemId: SystemId | string) => T | undefined; // ✅ Branded type\r\n  getActive: () => T[];\r\n  getDeleted: () => T[];\r\n  loadFromAPI: () => Promise<void>; // ✅ Load data from database\r\n};\r\n\r\nexport const createCrudStore = <T extends ItemWithSystemId>(\r\n  _initialData: T[], // @deprecated - Kept for backward compatibility but NO LONGER USED\r\n  entityType: EntityType, // Changed from idPrefix to entityType\r\n  options?: {\r\n    businessIdField?: keyof T; // Field name for business ID (default: 'id')\r\n    persistKey?: string; // @deprecated - No longer used, kept for backward compatibility\r\n    getCurrentUser?: () => string | undefined; // Function to get current user systemId\r\n    apiEndpoint?: string; // ✅ API endpoint for database sync (e.g., '/api/employees')\r\n  }\r\n) => {\r\n  const businessPrefix = getPrefix(entityType); // Vietnamese prefix for Business ID (NV, KH, DH)\r\n  const config = ID_CONFIG[entityType];\r\n  const systemIdPrefix = config?.systemIdPrefix || entityType.toUpperCase(); // English prefix for SystemId (EMP, CUSTOMER, ORDER)\r\n  \r\n  const businessIdField = options?.businessIdField ?? 'id';\r\n  // const persistKey = options?.persistKey; // @deprecated - No longer used\r\n  const getCurrentUser = options?.getCurrentUser;\r\n  const apiEndpoint = options?.apiEndpoint;\r\n\r\n  // ✅ CHANGED: Start with empty array - database is source of truth\r\n  // Mock data files (data.ts) are NO LONGER USED for runtime\r\n  const normalizedInitialData: T[] = [];\r\n\r\n  const storeConfig = (set: any, get: any) => ({\r\n    data: normalizedInitialData, // ✅ Start empty - data loaded via React Query\r\n    // ✅ Counters start at 0 - will be initialized from API via loadFromAPI()\r\n    _counters: {\r\n      systemId: 0,\r\n      businessId: 0\r\n    },\r\n    _initialized: false, // ✅ Track API initialization\r\n    add: (item: Omit<T, 'systemId'>): T => {\r\n        // ✅ Get counters from state (persisted)\r\n        const currentCounters = get()._counters;\r\n        const newSystemIdCounter = currentCounters.systemId + 1;\r\n        const newSystemId = createSystemId(generateSystemId(entityType, newSystemIdCounter));\r\n        \r\n        // Generate or validate Business ID (if field exists)\r\n        let finalItem = { ...item } as any;\r\n        let newBusinessIdCounter = currentCounters.businessId;\r\n        \r\n        if (businessIdField in item) {\r\n          const customId = (item as any)[businessIdField];\r\n          const existingIds = get().data.map((d: any) => d[businessIdField]);\r\n          \r\n          // ✅ If customId provided, validate uniqueness\r\n          if (customId && customId.trim()) {\r\n            if (!isBusinessIdUnique(customId, existingIds)) {\r\n              throw new Error(`Mã \"${customId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n            }\r\n            finalItem[businessIdField] = customId.trim().toUpperCase();\r\n          } else {\r\n            // ✅ Auto-generate with findNextAvailableBusinessId\r\n            const digitCount = 6; // All entities use 6 digits\r\n            const result = findNextAvailableBusinessId(businessPrefix, existingIds, newBusinessIdCounter, digitCount);\r\n            finalItem[businessIdField] = result.nextId;\r\n            newBusinessIdCounter = result.updatedCounter;\r\n          }\r\n        }\r\n        \r\n        const now = new Date().toISOString();\r\n        const currentUser = getCurrentUser?.();\r\n        const newItem = { \r\n          ...finalItem, \r\n          systemId: newSystemId, // ✅ Branded SystemId\r\n          createdAt: finalItem.createdAt || now,\r\n          updatedAt: now,\r\n          createdBy: finalItem.createdBy || currentUser,\r\n          updatedBy: currentUser,\r\n        } as unknown as T;\r\n        \r\n        // ✅ Update both data and counters atomically\r\n        set((state: any) => ({ \r\n          data: [...state.data, newItem],\r\n          _counters: {\r\n            systemId: newSystemIdCounter,\r\n            businessId: newBusinessIdCounter\r\n          }\r\n        }));\r\n        \r\n        // ✅ Sync to API in background\r\n        if (apiEndpoint) {\r\n          syncToAPI(apiEndpoint, 'create', newItem).catch(console.error);\r\n        }\r\n        \r\n        return newItem;\r\n    },\r\n    addMultiple: (items: Omit<T, 'systemId'>[]) => \r\n        set((state: any) => {\r\n            const now = new Date().toISOString();\r\n            const currentUser = getCurrentUser?.();\r\n            const newItems: T[] = [];\r\n            const digitCount = 6; // All entities use 6 digits\r\n            \r\n            // ✅ Start from current counters\r\n            let currentSystemIdCounter = state._counters.systemId;\r\n            let currentBusinessIdCounter = state._counters.businessId;\r\n            \r\n            items.forEach(item => {\r\n                // ✅ Generate SystemId from current counter\r\n                currentSystemIdCounter++;\r\n                const newSystemId = createSystemId(generateSystemId(entityType, currentSystemIdCounter));\r\n                \r\n                // Generate or validate Business ID (if field exists)\r\n                let finalItem = { ...item } as any;\r\n                if (businessIdField in item) {\r\n                  const customId = (item as any)[businessIdField];\r\n                  \r\n                  // Collect existing IDs (from state + already added in this batch)\r\n                  const existingIds = [\r\n                    ...state.data.map((d: any) => d[businessIdField]),\r\n                    ...newItems.map((d: any) => d[businessIdField])\r\n                  ];\r\n                  \r\n                  // ✅ If customId provided, validate uniqueness\r\n                  if (customId && customId.trim()) {\r\n                    if (!isBusinessIdUnique(customId, existingIds)) {\r\n                      throw new Error(`Mã \"${customId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n                    }\r\n                    finalItem[businessIdField] = customId.trim().toUpperCase();\r\n                  } else {\r\n                    // ✅ Auto-generate with findNextAvailableBusinessId\r\n                    const result = findNextAvailableBusinessId(businessPrefix, existingIds, currentBusinessIdCounter, digitCount);\r\n                    finalItem[businessIdField] = result.nextId;\r\n                    currentBusinessIdCounter = result.updatedCounter;\r\n                  }\r\n                }\r\n                \r\n                newItems.push({ \r\n                  ...finalItem, \r\n                  systemId: newSystemId,\r\n                  createdAt: now,\r\n                  updatedAt: now,\r\n                  createdBy: currentUser,\r\n                  updatedBy: currentUser,\r\n                } as unknown as T);\r\n            });\r\n            \r\n            // ✅ Update both data and counters\r\n            const result = { \r\n              data: [...state.data, ...newItems],\r\n              _counters: {\r\n                systemId: currentSystemIdCounter,\r\n                businessId: currentBusinessIdCounter\r\n              }\r\n            };\r\n            \r\n            // ✅ Sync to API in background (batch)\r\n            if (apiEndpoint) {\r\n              newItems.forEach(item => {\r\n                syncToAPI(apiEndpoint, 'create', item).catch(console.error);\r\n              });\r\n            }\r\n            \r\n            return result;\r\n        }),\r\n    update: (systemId: SystemId, updatedItem: Partial<T>) => {\r\n      // Validate unique business ID (case-insensitive, skip self)\r\n      if (businessIdField in updatedItem) {\r\n        const businessId = (updatedItem as any)[businessIdField];\r\n        const existingIds = get().data\r\n          .filter((d: any) => d.systemId !== systemId)\r\n          .map((d: any) => d[businessIdField]);\r\n        \r\n        if (businessId && !isBusinessIdUnique(businessId, existingIds)) {\r\n          throw new Error(`Mã \"${businessId}\" đã tồn tại! Vui lòng sử dụng mã khác.`);\r\n        }\r\n      }\r\n\r\n      const now = new Date().toISOString();\r\n      const currentUser = getCurrentUser?.();\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId \r\n            ? { ...item, ...updatedItem, updatedAt: now, updatedBy: currentUser } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const fullItem = get().data.find((item: T) => item.systemId === systemId);\r\n        if (fullItem) {\r\n          syncToAPI(apiEndpoint, 'update', fullItem, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    remove: (systemId: SystemId) => {\r\n      // Soft delete - mark as deleted\r\n      const now = new Date().toISOString();\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: true, deletedAt: now } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const item = get().data.find((item: T) => item.systemId === systemId);\r\n        if (item) {\r\n          syncToAPI(apiEndpoint, 'update', { ...item, isDeleted: true, deletedAt: now }, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    hardDelete: (systemId: SystemId) => {\r\n      // Permanent delete - remove from array\r\n      set((state: any) => ({\r\n        data: state.data.filter((item: T) => item.systemId !== systemId),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        syncToAPI(apiEndpoint, 'delete', { systemId }, systemId).catch(console.error);\r\n      }\r\n    },\r\n    restore: (systemId: SystemId) => {\r\n      // Restore soft-deleted item\r\n      set((state: any) => ({\r\n        data: state.data.map((item: T) =>\r\n          item.systemId === systemId\r\n            ? { ...item, isDeleted: false, deletedAt: null } as T\r\n            : item\r\n        ),\r\n      }));\r\n      \r\n      // ✅ Sync to API in background\r\n      if (apiEndpoint) {\r\n        const item = get().data.find((item: T) => item.systemId === systemId);\r\n        if (item) {\r\n          syncToAPI(apiEndpoint, 'restore', { ...item, isDeleted: false, deletedAt: null }, systemId).catch(console.error);\r\n        }\r\n      }\r\n    },\r\n    getActive: () => get().data.filter((item: any) => !item.isDeleted),\r\n    getDeleted: () => get().data.filter((item: any) => item.isDeleted),\r\n    findById: (id: SystemId | string) => get().data.find((item: T) => item.systemId === id || (item as any).id === id),\r\n    \r\n    // ✅ Load data from database API - OPTIMIZED: No more limit=10000!\r\n    // This is now only used for counter initialization, NOT for loading all data\r\n    // Use React Query hooks for data fetching with proper pagination\r\n    loadFromAPI: async () => {\r\n      if (!apiEndpoint) return;\r\n      if (get()._initialized) return;\r\n      \r\n      try {\r\n        // Only fetch minimal data needed to initialize counters\r\n        // Actual data loading should be done via React Query hooks\r\n        const response = await fetch(`${apiEndpoint}?limit=1&sortBy=systemId&sortOrder=desc`, {\r\n          credentials: 'include',\r\n        });\r\n        if (response.ok) {\r\n          const json = await response.json();\r\n          const pagination = json.pagination || {};\r\n          const lastItem = json.data?.[0];\r\n          \r\n          // Initialize counters from the latest item (highest IDs)\r\n          const newCounters = {\r\n            systemId: lastItem ? getMaxSystemIdCounter([lastItem], systemIdPrefix) : 0,\r\n            businessId: (lastItem && options?.businessIdField)\r\n              ? getMaxBusinessIdCounter([lastItem] as any[], businessPrefix)\r\n              : 0\r\n          };\r\n          \r\n          set({ \r\n            data: [], // Don't store data in Zustand anymore - use React Query\r\n            _counters: newCounters,\r\n            _initialized: true \r\n          });\r\n          \r\n          console.log(`[Store Factory] ${apiEndpoint} initialized. Total records: ${pagination.total || 'unknown'}`);\r\n        }\r\n      } catch (error) {\r\n        console.error(`[Store Factory] loadFromAPI error for ${apiEndpoint}:`, error);\r\n        // Still mark as initialized to prevent infinite retry\r\n        set({ _initialized: true });\r\n      }\r\n    },\r\n  });\r\n\r\n  // ✅ SIMPLIFIED: No localStorage persistence, database is source of truth\r\n  // Data is loaded via ApiSyncProvider on app init\r\n  return create<CrudState<T>>(storeConfig);\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;AACA,uEAAuE;AACvE;AASA;AACA;;;;;AAEA,MAAM,qBAA+B,IAAA,wIAAc,EAAC;AAEpD,MAAM,qBAAqB,IAAgB;AAE3C,sCAAsC;AACtC,eAAe,UACb,WAAmB,EACnB,MAAkD,EAClD,IAAgC,EAChC,QAAmB;IAEnB,IAAI;QACF,MAAM,WAAW,WAAW,WACxB,cACA,GAAG,YAAY,CAAC,EAAE,YAAY,AAAC,KAAa,QAAQ,EAAE;QAE1D,MAAM,SAAS,WAAW,WAAW,SACjC,WAAW,WAAW,UACtB,WAAW,WAAW,WACtB,SAAS,qBAAqB;QAElC,MAAM,WAAW,MAAM,MAAM,UAAU;YACrC;YACA,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,aAAa;YACb,MAAM,WAAW,WAAW,KAAK,SAAS,CAAC,QAAQ;QACrD;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,IAAI,CAAC,CAAC,oBAAoB,EAAE,OAAO,YAAY,EAAE,YAAY,CAAC,CAAC,EAAE,SAAS,MAAM;QAC1F;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,oBAAoB,EAAE,OAAO,WAAW,EAAE,YAAY,CAAC,CAAC,EAAE;QACzE,OAAO;IACT;AACF;AA2BO,MAAM,kBAAkB,CAC7B,cACA,YACA;IAOA,MAAM,iBAAiB,IAAA,sIAAS,EAAC,aAAa,iDAAiD;IAC/F,MAAM,SAAS,mIAAS,CAAC,WAAW;IACpC,MAAM,iBAAiB,QAAQ,kBAAkB,WAAW,WAAW,IAAI,qDAAqD;IAEhI,MAAM,kBAAkB,SAAS,mBAAmB;IACpD,0EAA0E;IAC1E,MAAM,iBAAiB,SAAS;IAChC,MAAM,cAAc,SAAS;IAE7B,kEAAkE;IAClE,2DAA2D;IAC3D,MAAM,wBAA6B,EAAE;IAErC,MAAM,cAAc,CAAC,KAAU,MAAa,CAAC;YAC3C,MAAM;YACN,yEAAyE;YACzE,WAAW;gBACT,UAAU;gBACV,YAAY;YACd;YACA,cAAc;YACd,KAAK,CAAC;gBACF,wCAAwC;gBACxC,MAAM,kBAAkB,MAAM,SAAS;gBACvC,MAAM,qBAAqB,gBAAgB,QAAQ,GAAG;gBACtD,MAAM,cAAc,IAAA,wIAAc,EAAC,IAAA,yIAAgB,EAAC,YAAY;gBAEhE,qDAAqD;gBACrD,IAAI,YAAY;oBAAE,GAAG,IAAI;gBAAC;gBAC1B,IAAI,uBAAuB,gBAAgB,UAAU;gBAErD,IAAI,mBAAmB,MAAM;oBAC3B,MAAM,WAAW,AAAC,IAAY,CAAC,gBAAgB;oBAC/C,MAAM,cAAc,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,IAAW,CAAC,CAAC,gBAAgB;oBAEjE,8CAA8C;oBAC9C,IAAI,YAAY,SAAS,IAAI,IAAI;wBAC/B,IAAI,CAAC,IAAA,2IAAkB,EAAC,UAAU,cAAc;4BAC9C,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE,SAAS,uCAAuC,CAAC;wBAC1E;wBACA,SAAS,CAAC,gBAAgB,GAAG,SAAS,IAAI,GAAG,WAAW;oBAC1D,OAAO;wBACL,mDAAmD;wBACnD,MAAM,aAAa,GAAG,4BAA4B;wBAClD,MAAM,SAAS,IAAA,oJAA2B,EAAC,gBAAgB,aAAa,sBAAsB;wBAC9F,SAAS,CAAC,gBAAgB,GAAG,OAAO,MAAM;wBAC1C,uBAAuB,OAAO,cAAc;oBAC9C;gBACF;gBAEA,MAAM,MAAM,IAAI,OAAO,WAAW;gBAClC,MAAM,cAAc;gBACpB,MAAM,UAAU;oBACd,GAAG,SAAS;oBACZ,UAAU;oBACV,WAAW,UAAU,SAAS,IAAI;oBAClC,WAAW;oBACX,WAAW,UAAU,SAAS,IAAI;oBAClC,WAAW;gBACb;gBAEA,6CAA6C;gBAC7C,IAAI,CAAC,QAAe,CAAC;wBACnB,MAAM;+BAAI,MAAM,IAAI;4BAAE;yBAAQ;wBAC9B,WAAW;4BACT,UAAU;4BACV,YAAY;wBACd;oBACF,CAAC;gBAED,8BAA8B;gBAC9B,IAAI,aAAa;oBACf,UAAU,aAAa,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;gBAC/D;gBAEA,OAAO;YACX;YACA,aAAa,CAAC,QACV,IAAI,CAAC;oBACD,MAAM,MAAM,IAAI,OAAO,WAAW;oBAClC,MAAM,cAAc;oBACpB,MAAM,WAAgB,EAAE;oBACxB,MAAM,aAAa,GAAG,4BAA4B;oBAElD,gCAAgC;oBAChC,IAAI,yBAAyB,MAAM,SAAS,CAAC,QAAQ;oBACrD,IAAI,2BAA2B,MAAM,SAAS,CAAC,UAAU;oBAEzD,MAAM,OAAO,CAAC,CAAA;wBACV,2CAA2C;wBAC3C;wBACA,MAAM,cAAc,IAAA,wIAAc,EAAC,IAAA,yIAAgB,EAAC,YAAY;wBAEhE,qDAAqD;wBACrD,IAAI,YAAY;4BAAE,GAAG,IAAI;wBAAC;wBAC1B,IAAI,mBAAmB,MAAM;4BAC3B,MAAM,WAAW,AAAC,IAAY,CAAC,gBAAgB;4BAE/C,kEAAkE;4BAClE,MAAM,cAAc;mCACf,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,IAAW,CAAC,CAAC,gBAAgB;mCAC7C,SAAS,GAAG,CAAC,CAAC,IAAW,CAAC,CAAC,gBAAgB;6BAC/C;4BAED,8CAA8C;4BAC9C,IAAI,YAAY,SAAS,IAAI,IAAI;gCAC/B,IAAI,CAAC,IAAA,2IAAkB,EAAC,UAAU,cAAc;oCAC9C,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE,SAAS,uCAAuC,CAAC;gCAC1E;gCACA,SAAS,CAAC,gBAAgB,GAAG,SAAS,IAAI,GAAG,WAAW;4BAC1D,OAAO;gCACL,mDAAmD;gCACnD,MAAM,SAAS,IAAA,oJAA2B,EAAC,gBAAgB,aAAa,0BAA0B;gCAClG,SAAS,CAAC,gBAAgB,GAAG,OAAO,MAAM;gCAC1C,2BAA2B,OAAO,cAAc;4BAClD;wBACF;wBAEA,SAAS,IAAI,CAAC;4BACZ,GAAG,SAAS;4BACZ,UAAU;4BACV,WAAW;4BACX,WAAW;4BACX,WAAW;4BACX,WAAW;wBACb;oBACJ;oBAEA,kCAAkC;oBAClC,MAAM,SAAS;wBACb,MAAM;+BAAI,MAAM,IAAI;+BAAK;yBAAS;wBAClC,WAAW;4BACT,UAAU;4BACV,YAAY;wBACd;oBACF;oBAEA,sCAAsC;oBACtC,IAAI,aAAa;wBACf,SAAS,OAAO,CAAC,CAAA;4BACf,UAAU,aAAa,UAAU,MAAM,KAAK,CAAC,QAAQ,KAAK;wBAC5D;oBACF;oBAEA,OAAO;gBACX;YACJ,QAAQ,CAAC,UAAoB;gBAC3B,4DAA4D;gBAC5D,IAAI,mBAAmB,aAAa;oBAClC,MAAM,aAAa,AAAC,WAAmB,CAAC,gBAAgB;oBACxD,MAAM,cAAc,MAAM,IAAI,CAC3B,MAAM,CAAC,CAAC,IAAW,EAAE,QAAQ,KAAK,UAClC,GAAG,CAAC,CAAC,IAAW,CAAC,CAAC,gBAAgB;oBAErC,IAAI,cAAc,CAAC,IAAA,2IAAkB,EAAC,YAAY,cAAc;wBAC9D,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE,WAAW,uCAAuC,CAAC;oBAC5E;gBACF;gBAEA,MAAM,MAAM,IAAI,OAAO,WAAW;gBAClC,MAAM,cAAc;gBACpB,IAAI,CAAC,QAAe,CAAC;wBACnB,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,OACpB,KAAK,QAAQ,KAAK,WACd;gCAAE,GAAG,IAAI;gCAAE,GAAG,WAAW;gCAAE,WAAW;gCAAK,WAAW;4BAAY,IAClE;oBAER,CAAC;gBAED,8BAA8B;gBAC9B,IAAI,aAAa;oBACf,MAAM,WAAW,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,OAAY,KAAK,QAAQ,KAAK;oBAChE,IAAI,UAAU;wBACZ,UAAU,aAAa,UAAU,UAAU,UAAU,KAAK,CAAC,QAAQ,KAAK;oBAC1E;gBACF;YACF;YACA,QAAQ,CAAC;gBACP,gCAAgC;gBAChC,MAAM,MAAM,IAAI,OAAO,WAAW;gBAClC,IAAI,CAAC,QAAe,CAAC;wBACnB,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,OACpB,KAAK,QAAQ,KAAK,WACd;gCAAE,GAAG,IAAI;gCAAE,WAAW;gCAAM,WAAW;4BAAI,IAC3C;oBAER,CAAC;gBAED,8BAA8B;gBAC9B,IAAI,aAAa;oBACf,MAAM,OAAO,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,OAAY,KAAK,QAAQ,KAAK;oBAC5D,IAAI,MAAM;wBACR,UAAU,aAAa,UAAU;4BAAE,GAAG,IAAI;4BAAE,WAAW;4BAAM,WAAW;wBAAI,GAAG,UAAU,KAAK,CAAC,QAAQ,KAAK;oBAC9G;gBACF;YACF;YACA,YAAY,CAAC;gBACX,uCAAuC;gBACvC,IAAI,CAAC,QAAe,CAAC;wBACnB,MAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,OAAY,KAAK,QAAQ,KAAK;oBACzD,CAAC;gBAED,8BAA8B;gBAC9B,IAAI,aAAa;oBACf,UAAU,aAAa,UAAU;wBAAE;oBAAS,GAAG,UAAU,KAAK,CAAC,QAAQ,KAAK;gBAC9E;YACF;YACA,SAAS,CAAC;gBACR,4BAA4B;gBAC5B,IAAI,CAAC,QAAe,CAAC;wBACnB,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,OACpB,KAAK,QAAQ,KAAK,WACd;gCAAE,GAAG,IAAI;gCAAE,WAAW;gCAAO,WAAW;4BAAK,IAC7C;oBAER,CAAC;gBAED,8BAA8B;gBAC9B,IAAI,aAAa;oBACf,MAAM,OAAO,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,OAAY,KAAK,QAAQ,KAAK;oBAC5D,IAAI,MAAM;wBACR,UAAU,aAAa,WAAW;4BAAE,GAAG,IAAI;4BAAE,WAAW;4BAAO,WAAW;wBAAK,GAAG,UAAU,KAAK,CAAC,QAAQ,KAAK;oBACjH;gBACF;YACF;YACA,WAAW,IAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,OAAc,CAAC,KAAK,SAAS;YACjE,YAAY,IAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,OAAc,KAAK,SAAS;YACjE,UAAU,CAAC,KAA0B,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,OAAY,KAAK,QAAQ,KAAK,MAAM,AAAC,KAAa,EAAE,KAAK;YAE/G,kEAAkE;YAClE,6EAA6E;YAC7E,iEAAiE;YACjE,aAAa;gBACX,IAAI,CAAC,aAAa;gBAClB,IAAI,MAAM,YAAY,EAAE;gBAExB,IAAI;oBACF,wDAAwD;oBACxD,2DAA2D;oBAC3D,MAAM,WAAW,MAAM,MAAM,GAAG,YAAY,uCAAuC,CAAC,EAAE;wBACpF,aAAa;oBACf;oBACA,IAAI,SAAS,EAAE,EAAE;wBACf,MAAM,OAAO,MAAM,SAAS,IAAI;wBAChC,MAAM,aAAa,KAAK,UAAU,IAAI,CAAC;wBACvC,MAAM,WAAW,KAAK,IAAI,EAAE,CAAC,EAAE;wBAE/B,yDAAyD;wBACzD,MAAM,cAAc;4BAClB,UAAU,WAAW,IAAA,8IAAqB,EAAC;gCAAC;6BAAS,EAAE,kBAAkB;4BACzE,YAAY,AAAC,YAAY,SAAS,kBAC9B,IAAA,gJAAuB,EAAC;gCAAC;6BAAS,EAAW,kBAC7C;wBACN;wBAEA,IAAI;4BACF,MAAM,EAAE;4BACR,WAAW;4BACX,cAAc;wBAChB;wBAEA,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,YAAY,6BAA6B,EAAE,WAAW,KAAK,IAAI,WAAW;oBAC3G;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,CAAC,sCAAsC,EAAE,YAAY,CAAC,CAAC,EAAE;oBACvE,sDAAsD;oBACtD,IAAI;wBAAE,cAAc;oBAAK;gBAC3B;YACF;QACF,CAAC;IAED,yEAAyE;IACzE,iDAAiD;IACjD,OAAO,IAAA,qJAAM,EAAe;AAC9B"}},
    {"offset": {"line": 6875, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/target-groups/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { TargetGroup } from './types';\r\n\r\nexport const useTargetGroupStore = createCrudStore<TargetGroup>([], 'target-groups', {\r\n  apiEndpoint: '/api/settings/data?type=target-group',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,sBAAsB,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IACnF,aAAa;AACf"}},
    {"offset": {"line": 6891, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/methods/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentMethod } from './types';\r\nimport { asSystemId, type SystemId } from '@/lib/id-types';\r\n\r\n// API sync helper\r\nasync function syncToAPI(\r\n  action: 'create' | 'update' | 'delete',\r\n  data: Partial<PaymentMethod>\r\n): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create'\r\n      ? '/api/settings/payment-methods'\r\n      : `/api/settings/payment-methods/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error(`[Payment Methods API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\ninterface PaymentMethodState {\r\n  data: PaymentMethod[];\r\n  initialized: boolean;\r\n  add: (item: Omit<PaymentMethod, 'systemId' | 'isDefault'>) => void;\r\n  update: (systemId: SystemId, updatedPolicy: Omit<PaymentMethod, 'isDefault' | 'systemId'>) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  setDefault: (systemId: SystemId) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nexport const usePaymentMethodStore = create<PaymentMethodState>()(\r\n  (set, get) => ({\r\n      data: [],\r\n      initialized: false,\r\n      add: (item) => {\r\n        const newItem: PaymentMethod = { \r\n          ...item, \r\n          systemId: asSystemId(`PM_${Date.now()}`),\r\n          isDefault: get().data.length === 0,\r\n        };\r\n        set((state) => ({ data: [...state.data, newItem] }));\r\n        \r\n        // Sync to API\r\n        syncToAPI('create', newItem).catch(console.error);\r\n      },\r\n      update: (systemId, updatedFields) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => p.systemId === systemId ? { ...p, ...updatedFields } : p),\r\n        }));\r\n        \r\n        // Sync to API\r\n        const updated = get().data.find(p => p.systemId === systemId);\r\n        if (updated) {\r\n          syncToAPI('update', updated).catch(console.error);\r\n        }\r\n      },\r\n      remove: (systemId) => {\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n        set((state) => ({\r\n          data: state.data.filter((p) => p.systemId !== systemId),\r\n        }));\r\n      },\r\n      setDefault: (systemId) => {\r\n        set((state) => ({\r\n          data: state.data.map(p => ({ ...p, isDefault: p.systemId === systemId })),\r\n        }));\r\n        \r\n        // Sync all to API (update default status)\r\n        const data = get().data;\r\n        for (const item of data) {\r\n          syncToAPI('update', item).catch(console.error);\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        if (get().initialized) return;\r\n        \r\n        try {\r\n          // NOTE: Settings data is typically small, but using limit for consistency\r\n          const response = await fetch('/api/settings/payment-methods?limit=30');\r\n          if (response.ok) {\r\n            const json = await response.json();\r\n            const data = json.data || json.methods || [];\r\n            if (data.length > 0) {\r\n              set({ data, initialized: true });\r\n            } else {\r\n              set({ initialized: true });\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payment Methods Store] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,kBAAkB;AAClB,eAAe,UACb,MAAsC,EACtC,IAA4B;IAE5B,IAAI;QACF,MAAM,WAAW,WAAW,WACxB,kCACA,CAAC,8BAA8B,EAAE,KAAK,QAAQ,EAAE;QACpD,MAAM,SAAS,WAAW,WAAW,SAAS,WAAW,WAAW,UAAU;QAE9E,MAAM,WAAW,MAAM,MAAM,UAAU;YACrC;YACA,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,WAAW,WAAW,KAAK,SAAS,CAAC,QAAQ;QACrD;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,OAAO,OAAO,CAAC,EAAE;QACxD,OAAO;IACT;AACF;AAYO,MAAM,wBAAwB,IAAA,qJAAM,IACzC,CAAC,KAAK,MAAQ,CAAC;QACX,MAAM,EAAE;QACR,aAAa;QACb,KAAK,CAAC;YACJ,MAAM,UAAyB;gBAC7B,GAAG,IAAI;gBACP,UAAU,IAAA,mIAAU,EAAC,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;gBACvC,WAAW,MAAM,IAAI,CAAC,MAAM,KAAK;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBAAE,MAAM;2BAAI,MAAM,IAAI;wBAAE;qBAAQ;gBAAC,CAAC;YAElD,cAAc;YACd,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;QAClD;QACA,QAAQ,CAAC,UAAU;YACjB,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,WAAW;4BAAE,GAAG,CAAC;4BAAE,GAAG,aAAa;wBAAC,IAAI;gBACnF,CAAC;YAED,cAAc;YACd,MAAM,UAAU,MAAM,IAAI,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;YACpD,IAAI,SAAS;gBACX,UAAU,UAAU,SAAS,KAAK,CAAC,QAAQ,KAAK;YAClD;QACF;QACA,QAAQ,CAAC;YACP,UAAU,UAAU;gBAAE;YAAS,GAAG,KAAK,CAAC,QAAQ,KAAK;YACrD,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;gBAChD,CAAC;QACH;QACA,YAAY,CAAC;YACX,IAAI,CAAC,QAAU,CAAC;oBACd,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;4BAAE,GAAG,CAAC;4BAAE,WAAW,EAAE,QAAQ,KAAK;wBAAS,CAAC;gBACzE,CAAC;YAED,0CAA0C;YAC1C,MAAM,OAAO,MAAM,IAAI;YACvB,KAAK,MAAM,QAAQ,KAAM;gBACvB,UAAU,UAAU,MAAM,KAAK,CAAC,QAAQ,KAAK;YAC/C;QACF;QAEA,aAAa;YACX,IAAI,MAAM,WAAW,EAAE;YAEvB,IAAI;gBACF,0EAA0E;gBAC1E,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,MAAM,OAAO,KAAK,IAAI,IAAI,KAAK,OAAO,IAAI,EAAE;oBAC5C,IAAI,KAAK,MAAM,GAAG,GAAG;wBACnB,IAAI;4BAAE;4BAAM,aAAa;wBAAK;oBAChC,OAAO;wBACL,IAAI;4BAAE,aAAa;wBAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8CAA8C;YAC9D;QACF;IACF,CAAC"}},
    {"offset": {"line": 7000, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/receipt-types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { ReceiptType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<ReceiptType>([], 'receipt-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=receipt-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<ReceiptType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const useReceiptTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,oIAAS,EAAC,IAAA,yIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 7031, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payments/types/store.ts"],"sourcesContent":["import { createCrudStore } from '../../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { PaymentType } from './types';\r\nimport { toISODate, getCurrentDate } from '../../../../lib/date-utils';\r\n\r\nconst baseStore = createCrudStore<PaymentType>([], 'payment-types', {\r\n  businessIdField: 'id',\r\n  apiEndpoint: '/api/settings/data?type=payment-type',\r\n});\r\n\r\nconst originalAdd = baseStore.getState().add;\r\n\r\nbaseStore.setState((state) => ({\r\n  ...state,\r\n  add: (item) => {\r\n    const newItem = {\r\n      ...item,\r\n      createdAt: item.createdAt ?? toISODate(getCurrentDate()),\r\n    } satisfies Omit<PaymentType, 'systemId'>;\r\n    return originalAdd(newItem);\r\n  },\r\n}));\r\n\r\nexport const usePaymentTypeStore = baseStore;\r\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEA,MAAM,YAAY,IAAA,6IAAe,EAAc,EAAE,EAAE,iBAAiB;IAClE,iBAAiB;IACjB,aAAa;AACf;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAE5C,UAAU,QAAQ,CAAC,CAAC,QAAU,CAAC;QAC7B,GAAG,KAAK;QACR,KAAK,CAAC;YACJ,MAAM,UAAU;gBACd,GAAG,IAAI;gBACP,WAAW,KAAK,SAAS,IAAI,IAAA,oIAAS,EAAC,IAAA,yIAAc;YACvD;YACA,OAAO,YAAY;QACrB;IACF,CAAC;AAEM,MAAM,sBAAsB"}},
    {"offset": {"line": 7062, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/finance/document-lookups.ts"],"sourcesContent":["import { useTargetGroupStore } from '@/features/settings/target-groups/store';\r\nimport { usePaymentMethodStore } from '@/features/settings/payments/methods/store';\r\nimport { useCashbookStore } from '@/features/cashbook/store';\r\nimport { useReceiptTypeStore } from '@/features/settings/receipt-types/store';\r\nimport { usePaymentTypeStore } from '@/features/settings/payments/types/store';\r\nimport type { TargetGroup } from '@/features/settings/target-groups/types';\r\nimport type { PaymentMethod } from '@/features/settings/payments/methods/types';\r\nimport type { CashAccount } from '@/features/cashbook/types';\r\nimport type { ReceiptType } from '@/features/settings/receipt-types/types';\r\nimport type { PaymentType } from '@/features/settings/payments/types/types';\r\nimport type { SystemId } from '@/lib/id-types';\r\n\r\nconst normalizeName = (value?: string | null) => (value ?? '').trim().toLowerCase();\r\n\r\nexport const DEFAULT_CUSTOMER_GROUP = 'khách hàng';\r\n\r\nexport const pickTargetGroup = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n  fallbackName?: string | undefined;\r\n}): TargetGroup | null => {\r\n  const groups = useTargetGroupStore.getState().data ?? [];\r\n  if (groups.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = groups.find(group => group.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  const lookupNames = [options?.name, options?.fallbackName, DEFAULT_CUSTOMER_GROUP].filter(Boolean) as string[];\r\n  for (const candidate of lookupNames) {\r\n    const normalized = normalizeName(candidate);\r\n    const match = groups.find(group => normalizeName(group.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return groups[0] ?? null;\r\n};\r\n\r\nexport const pickPaymentMethod = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n}): PaymentMethod | null => {\r\n  const methods = usePaymentMethodStore.getState().data ?? [];\r\n  if (methods.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = methods.find(method => method.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  if (options?.name) {\r\n    const normalized = normalizeName(options.name);\r\n    const match = methods.find(method => normalizeName(method.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return methods.find(method => method.isDefault) ?? methods[0] ?? null;\r\n};\r\n\r\nexport const pickAccount = (options: {\r\n  accountSystemId?: SystemId | undefined;\r\n  preferredType?: 'cash' | 'bank' | undefined;\r\n  branchSystemId?: SystemId | undefined;\r\n  paymentMethodName?: string | undefined;\r\n}): CashAccount | null => {\r\n  const { accounts } = useCashbookStore.getState();\r\n  if (!accounts || accounts.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options.accountSystemId) {\r\n    const match = accounts.find(account => account.systemId === options.accountSystemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  let preferredType = options.preferredType;\r\n  if (!preferredType && options.paymentMethodName) {\r\n    const normalizedMethod = normalizeName(options.paymentMethodName);\r\n    preferredType = normalizedMethod === 'tiền mặt' ? 'cash' : normalizedMethod === 'chuyển khoản' ? 'bank' : undefined;\r\n  }\r\n\r\n  const candidates = preferredType ? accounts.filter(account => account.type === preferredType) : accounts;\r\n\r\n  if (candidates.length === 0) {\r\n    return accounts[0];\r\n  }\r\n\r\n  return (\r\n    candidates.find(account => account.branchSystemId && options.branchSystemId && account.branchSystemId === options.branchSystemId) ??\r\n    candidates.find(account => account.isDefault) ??\r\n    candidates[0]\r\n  );\r\n};\r\n\r\nexport const pickReceiptType = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n}): ReceiptType | null => {\r\n  const types = useReceiptTypeStore.getState().data ?? [];\r\n  if (types.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = types.find(type => type.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  if (options?.name) {\r\n    const normalized = normalizeName(options.name);\r\n    const match = types.find(type => normalizeName(type.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return types[0] ?? null;\r\n};\r\n\r\nexport const pickPaymentType = (options?: {\r\n  systemId?: SystemId | undefined;\r\n  name?: string | undefined;\r\n}): PaymentType | null => {\r\n  const types = usePaymentTypeStore.getState().data ?? [];\r\n  if (types.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  if (options?.systemId) {\r\n    const match = types.find(type => type.systemId === options.systemId);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  if (options?.name) {\r\n    const normalized = normalizeName(options.name);\r\n    const match = types.find(type => normalizeName(type.name) === normalized);\r\n    if (match) {\r\n      return match;\r\n    }\r\n  }\r\n\r\n  return types[0] ?? null;\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7202, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/repositories/in-memory-repository.ts"],"sourcesContent":["import type { SystemId } from '../lib/id-types';\r\nimport type { CrudState, ItemWithSystemId } from '../lib/store-factory';\r\nimport type { CrudRepository } from './types';\r\n\r\n/**\r\n * Adapter mặc định dùng trực tiếp Zustand store để giả lập tầng persistence.\r\n * Giữ cùng signature với repository interface để sau này thay bằng API/DB dễ dàng.\r\n */\r\nexport const createInMemoryRepository = <TEntity extends ItemWithSystemId>(\r\n  stateGetter: () => CrudState<TEntity>\r\n): CrudRepository<TEntity, Omit<TEntity, 'systemId'>, Partial<TEntity>> => {\r\n  const getStore = () => stateGetter();\r\n\r\n  const ensureEntity = (systemId: SystemId): TEntity => {\r\n    const entity = getStore().findById(systemId);\r\n    if (!entity) {\r\n      throw new Error(`Không tìm thấy entity với systemId=${systemId}`);\r\n    }\r\n    return entity;\r\n  };\r\n\r\n  return {\r\n    async list() {\r\n      return [...getStore().data];\r\n    },\r\n    async getById(systemId) {\r\n      return getStore().findById(systemId);\r\n    },\r\n    async create(payload) {\r\n      return getStore().add(payload as Omit<TEntity, 'systemId'>);\r\n    },\r\n    async update(systemId, payload) {\r\n      ensureEntity(systemId);\r\n      getStore().update(systemId, payload);\r\n      return ensureEntity(systemId);\r\n    },\r\n    async softDelete(systemId) {\r\n      ensureEntity(systemId);\r\n      getStore().remove(systemId);\r\n    },\r\n    async restore(systemId) {\r\n      ensureEntity(systemId);\r\n      getStore().restore(systemId);\r\n      return getStore().findById(systemId);\r\n    },\r\n    async hardDelete(systemId) {\r\n      ensureEntity(systemId);\r\n      getStore().hardDelete(systemId);\r\n    },\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;AAQO,MAAM,2BAA2B,CACtC;IAEA,MAAM,WAAW,IAAM;IAEvB,MAAM,eAAe,CAAC;QACpB,MAAM,SAAS,WAAW,QAAQ,CAAC;QACnC,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM,CAAC,mCAAmC,EAAE,UAAU;QAClE;QACA,OAAO;IACT;IAEA,OAAO;QACL,MAAM;YACJ,OAAO;mBAAI,WAAW,IAAI;aAAC;QAC7B;QACA,MAAM,SAAQ,QAAQ;YACpB,OAAO,WAAW,QAAQ,CAAC;QAC7B;QACA,MAAM,QAAO,OAAO;YAClB,OAAO,WAAW,GAAG,CAAC;QACxB;QACA,MAAM,QAAO,QAAQ,EAAE,OAAO;YAC5B,aAAa;YACb,WAAW,MAAM,CAAC,UAAU;YAC5B,OAAO,aAAa;QACtB;QACA,MAAM,YAAW,QAAQ;YACvB,aAAa;YACb,WAAW,MAAM,CAAC;QACpB;QACA,MAAM,SAAQ,QAAQ;YACpB,aAAa;YACb,WAAW,OAAO,CAAC;YACnB,OAAO,WAAW,QAAQ,CAAC;QAC7B;QACA,MAAM,YAAW,QAAQ;YACvB,aAAa;YACb,WAAW,UAAU,CAAC;QACxB;IACF;AACF"}},
    {"offset": {"line": 7254, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/lib/activity-history-helper.ts"],"sourcesContent":["/**\r\n * Activity History Helper\r\n * \r\n * Helper để tạo các entry lịch sử hoạt động một cách nhất quán\r\n * Dùng chung cho tất cả các modules trong hệ thống\r\n * \r\n * NOTE: Đã remove import useEmployeeStore để tránh circular dependency\r\n * và cải thiện compile time\r\n */\r\n\r\nimport type { HistoryEntry } from '../components/ActivityHistory';\r\nimport { getCurrentUserInfo as getAuthUserInfo } from '../contexts/auth-context';\r\nimport type { SystemId } from './id-types';\r\n\r\n// Re-export HistoryEntry type for convenience\r\nexport type { HistoryEntry } from '../components/ActivityHistory';\r\n\r\n/**\r\n * Lấy thông tin người dùng hiện tại từ auth context\r\n * NOTE: Avatar lookup từ employee store đã bị remove để tránh circular dependency\r\n */\r\nexport function getCurrentUserInfo(): { systemId: string; name: string; avatar?: string } {\r\n  const authInfo = getAuthUserInfo();\r\n  \r\n  return {\r\n    systemId: authInfo.systemId || 'SYSTEM',\r\n    name: authInfo.name || 'Hệ thống',\r\n    avatar: undefined, // Avatar will be fetched by component if needed\r\n  };\r\n}\r\n\r\n/**\r\n * Lấy thông tin nhân viên từ systemId\r\n * NOTE: This function now requires employee data to be passed in\r\n * to avoid circular dependency with employee store\r\n */\r\nexport function getEmployeeInfoFromData(\r\n  employeeSystemId: SystemId | string,\r\n  employees: Array<{ systemId: string; fullName: string; avatarUrl?: string }>\r\n): { systemId: string; name: string; avatar?: string } {\r\n  const employee = employees.find(e => e.systemId === employeeSystemId);\r\n  \r\n  if (employee) {\r\n    return {\r\n      systemId: employee.systemId,\r\n      name: employee.fullName,\r\n      avatar: employee.avatarUrl,\r\n    };\r\n  }\r\n  \r\n  // Fallback to system\r\n  return {\r\n    systemId: String(employeeSystemId) || 'SYSTEM',\r\n    name: 'Hệ thống',\r\n  };\r\n}\r\n\r\n/**\r\n * @deprecated Use getEmployeeInfoFromData instead\r\n */\r\nexport function getEmployeeInfo(employeeSystemId: SystemId | string): { systemId: string; name: string; avatar?: string } {\r\n  // Return minimal info without employee store lookup\r\n  return {\r\n    systemId: String(employeeSystemId) || 'SYSTEM',\r\n    name: 'Hệ thống',\r\n  };\r\n}\r\n\r\n/**\r\n * Tạo một history entry mới\r\n */\r\nexport function createHistoryEntry(\r\n  action: HistoryEntry['action'],\r\n  userOrDescription: { systemId: string; name: string; avatar?: string } | string,\r\n  descriptionOrMetadata?: string | HistoryEntry['metadata'],\r\n  metadata?: HistoryEntry['metadata']\r\n): HistoryEntry {\r\n  const hasUserObject = typeof userOrDescription === 'object' && userOrDescription !== null;\r\n  const user = hasUserObject ? userOrDescription : getCurrentUserInfo();\r\n  const description = (hasUserObject ? descriptionOrMetadata : userOrDescription) as string | undefined;\r\n  const meta = (hasUserObject ? metadata : descriptionOrMetadata) as HistoryEntry['metadata'] | undefined;\r\n\r\n  return {\r\n    id: `history-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n    action,\r\n    timestamp: new Date(),\r\n    user: {\r\n      systemId: user.systemId,\r\n      name: user.name,\r\n      avatar: user.avatar,\r\n    },\r\n    description: description ?? '',\r\n    metadata: meta,\r\n  };\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"created\"\r\n */\r\nexport function createCreatedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('created', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"updated\"\r\n */\r\nexport function createUpdatedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('updated', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"status_changed\"\r\n */\r\nexport function createStatusChangedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  oldStatus: string,\r\n  newStatus: string,\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry(\r\n    'status_changed',\r\n    user,\r\n    description,\r\n    { field: 'status', oldValue: oldStatus, newValue: newStatus }\r\n  );\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"deleted\"\r\n */\r\nexport function createDeletedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('deleted', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"assigned\"\r\n */\r\nexport function createAssignedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('assigned', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"payment_made\"\r\n */\r\nexport function createPaymentEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('payment_made', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"comment_added\"\r\n */\r\nexport function createCommentEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('comment_added', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"cancelled\"\r\n */\r\nexport function createCancelledEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('cancelled', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"verified\"\r\n */\r\nexport function createVerifiedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('verified', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"ended\"\r\n */\r\nexport function createEndedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('ended', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho action \"reopened\"\r\n */\r\nexport function createReopenedEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry('reopened', user, description);\r\n}\r\n\r\n/**\r\n * Tạo history entry cho product actions\r\n */\r\nexport function createProductEntry(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  action: 'product_added' | 'product_updated' | 'product_removed',\r\n  description: string\r\n): HistoryEntry {\r\n  return createHistoryEntry(action, user, description);\r\n}\r\n\r\n/**\r\n * Helper để append history entry vào existing array\r\n */\r\nexport function appendHistoryEntry(\r\n  existingHistory: HistoryEntry[] | undefined,\r\n  ...newEntries: HistoryEntry[]\r\n): HistoryEntry[] {\r\n  return [...(existingHistory || []), ...newEntries];\r\n}\r\n\r\n/**\r\n * Helper để tạo nhiều history entries cùng lúc\r\n */\r\nexport function createBulkUpdateEntries(\r\n  user: { systemId: string; name: string; avatar?: string },\r\n  changes: Array<{ field: string; description: string }>\r\n): HistoryEntry[] {\r\n  return changes.map(change => createHistoryEntry('updated', user, change.description));\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7406, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/employees/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Employee } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\nimport Fuse from 'fuse.js';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\nimport { registerBreadcrumbStore } from '../../lib/breadcrumb-generator'; // ✅ NEW\r\nimport { type SystemId } from '../../lib/id-types';\r\nimport { createInMemoryRepository } from '../../repositories/in-memory-repository';\r\nimport { \r\n  createHistoryEntry, \r\n  getCurrentUserInfo,\r\n  appendHistoryEntry \r\n} from '../../lib/activity-history-helper';\r\n\r\ntype EmployeePersistenceAdapter = {\r\n  create: (payload: Omit<Employee, 'systemId'>) => Promise<Employee>;\r\n  update: (systemId: SystemId, payload: Partial<Employee>) => Promise<Employee>;\r\n  softDelete: (systemId: SystemId) => Promise<void>;\r\n  restore: (systemId: SystemId) => Promise<Employee | undefined>;\r\n  hardDelete: (systemId: SystemId) => Promise<void>;\r\n};\r\n\r\nconst baseStore = createCrudStore<Employee>([], 'employees', {\r\n  businessIdField: 'id',\r\n  getCurrentUser: getCurrentUserSystemId, // ✅ Track who creates/updates\r\n  apiEndpoint: '/api/employees',\r\n});\r\n\r\n// ✅ Wrap add method to include activity history\r\nconst originalAdd = baseStore.getState().add;\r\nconst wrappedAdd = (item: Omit<Employee, 'systemId'>): Employee => {\r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntry = createHistoryEntry(\r\n    'created',\r\n    `${userInfo.name} đã tạo hồ sơ nhân viên ${item.fullName} (${item.id})`,\r\n    userInfo\r\n  );\r\n  \r\n  const newEmployee = originalAdd({\r\n    ...item,\r\n    activityHistory: [historyEntry],\r\n  });\r\n  \r\n  return newEmployee;\r\n};\r\n\r\n// ✅ Wrap update method to include activity history\r\nconst originalUpdate = baseStore.getState().update;\r\nconst wrappedUpdate = (systemId: SystemId, updates: Partial<Employee>): void => {\r\n  const currentEmployee = baseStore.getState().data.find(e => e.systemId === systemId);\r\n  if (!currentEmployee) return;\r\n  \r\n  const userInfo = getCurrentUserInfo();\r\n  const historyEntries: HistoryEntry[] = [];\r\n  \r\n  // Track important field changes\r\n  const trackedFields: { key: keyof Employee; label: string }[] = [\r\n    { key: 'fullName', label: 'họ tên' },\r\n    { key: 'jobTitle', label: 'chức danh' },\r\n    { key: 'department', label: 'phòng ban' },\r\n    { key: 'employmentStatus', label: 'trạng thái làm việc' },\r\n    { key: 'employeeType', label: 'loại nhân viên' },\r\n    { key: 'baseSalary', label: 'lương cơ bản' },\r\n    { key: 'phone', label: 'số điện thoại' },\r\n    { key: 'workEmail', label: 'email công việc' },\r\n    { key: 'role', label: 'vai trò' },\r\n  ];\r\n  \r\n  trackedFields.forEach(({ key, label }) => {\r\n    if (updates[key] !== undefined && updates[key] !== currentEmployee[key]) {\r\n      const oldValue = currentEmployee[key];\r\n      const newValue = updates[key];\r\n      \r\n      // Format values for display\r\n      let oldDisplay = oldValue;\r\n      let newDisplay = newValue;\r\n      \r\n      if (key === 'baseSalary') {\r\n        oldDisplay = new Intl.NumberFormat('vi-VN').format(oldValue as number) + 'đ';\r\n        newDisplay = new Intl.NumberFormat('vi-VN').format(newValue as number) + 'đ';\r\n      }\r\n      \r\n      historyEntries.push(createHistoryEntry(\r\n        'updated',\r\n        `${userInfo.name} đã cập nhật ${label}: \"${oldDisplay || '(trống)'}\" → \"${newDisplay}\"`,\r\n        userInfo,\r\n        { field: key, oldValue, newValue }\r\n      ));\r\n    }\r\n  });\r\n  \r\n  // If status changed specifically\r\n  if (updates.employmentStatus && updates.employmentStatus !== currentEmployee.employmentStatus) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'status_changed',\r\n      `${userInfo.name} đã thay đổi trạng thái làm việc từ \"${currentEmployee.employmentStatus}\" thành \"${updates.employmentStatus}\"`,\r\n      userInfo,\r\n      { field: 'employmentStatus', oldValue: currentEmployee.employmentStatus, newValue: updates.employmentStatus }\r\n    ));\r\n  }\r\n  \r\n  // If no specific changes tracked, add generic update entry\r\n  if (historyEntries.length === 0) {\r\n    historyEntries.push(createHistoryEntry(\r\n      'updated',\r\n      `${userInfo.name} đã cập nhật thông tin nhân viên`,\r\n      userInfo\r\n    ));\r\n  }\r\n  \r\n  const updatedHistory = appendHistoryEntry(currentEmployee.activityHistory, ...historyEntries);\r\n  \r\n  originalUpdate(systemId, {\r\n    ...updates,\r\n    activityHistory: updatedHistory,\r\n  });\r\n};\r\n\r\n// ✅ Override base store methods\r\nbaseStore.setState({\r\n  add: wrappedAdd,\r\n  update: wrappedUpdate,\r\n});\r\n\r\nexport const employeeRepository = createInMemoryRepository<Employee>(() => baseStore.getState());\r\n\r\n// ✅ API-backed persistence adapter - syncs to PostgreSQL\r\nconst API_ENDPOINT = '/api/employees';\r\n\r\nconst persistence: EmployeePersistenceAdapter = {\r\n  create: async (payload) => {\r\n    // First create locally for immediate UI update\r\n    const localResult = await employeeRepository.create(payload);\r\n    \r\n    // Then sync to API (background)\r\n    try {\r\n      const response = await fetch(API_ENDPOINT, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ ...payload, systemId: localResult.systemId }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Create sync failed, data saved locally');\r\n      } else {\r\n        console.log('[Employee API] Created:', localResult.systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Create sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  update: async (systemId, payload) => {\r\n    // First update locally\r\n    const localResult = await employeeRepository.update(systemId, payload);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'PATCH',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Update sync failed');\r\n      } else {\r\n        console.log('[Employee API] Updated:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Update sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  softDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.softDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: false }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Soft delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Soft deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Soft delete sync error:', e);\r\n    }\r\n  },\r\n  restore: async (systemId) => {\r\n    // First restore locally\r\n    const localResult = await employeeRepository.restore(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}/restore`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Restore sync failed');\r\n      } else {\r\n        console.log('[Employee API] Restored:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Restore sync error:', e);\r\n    }\r\n    \r\n    return localResult;\r\n  },\r\n  hardDelete: async (systemId) => {\r\n    // First delete locally\r\n    await employeeRepository.hardDelete(systemId);\r\n    \r\n    // Then sync to API\r\n    try {\r\n      const response = await fetch(`${API_ENDPOINT}/${systemId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ hard: true }),\r\n      });\r\n      if (!response.ok) {\r\n        console.warn('[Employee API] Hard delete sync failed');\r\n      } else {\r\n        console.log('[Employee API] Hard deleted:', systemId);\r\n      }\r\n    } catch (e) {\r\n      console.warn('[Employee API] Hard delete sync error:', e);\r\n    }\r\n  },\r\n};\r\n\r\n// ✅ Register for breadcrumb auto-generation\r\nregisterBreadcrumbStore('employees', () => baseStore.getState());\r\n\r\n// Define enhanced interface\r\ninterface EmployeeStoreState extends CrudState<Employee> {\r\n  searchEmployees: (query: string, page: number, limit?: number) => Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>;\r\n  permanentDelete: (systemId: SystemId) => Promise<void>;\r\n  persistence: EmployeePersistenceAdapter;\r\n}\r\n\r\ntype EmployeeStoreHook = (() => EmployeeStoreState) & {\r\n  getState: () => EmployeeStoreState;\r\n  persistence: EmployeePersistenceAdapter;\r\n};\r\n\r\n// Augmented methods\r\nconst augmentedMethods = {\r\n    // FIX: Changed `page: number = 1` to `page: number` to make it a required parameter, matching Combobox prop type.\r\n    // ✅ CRITICAL FIX: Create fresh Fuse instance on each search to avoid stale data\r\n    searchEmployees: async (query: string, page: number, limit: number = 20) => {\r\n        return new Promise<{ items: { value: string; label: string }[], hasNextPage: boolean }>(resolve => {\r\n            setTimeout(() => {\r\n                const allEmployees = baseStore.getState().data;\r\n                \r\n                // ✅ Create fresh Fuse instance with current data\r\n                const fuse = new Fuse(allEmployees, {\r\n                    keys: ['fullName', 'id', 'phone', 'personalEmail', 'workEmail'],\r\n                    threshold: 0.3,\r\n                });\r\n                \r\n                const results = query ? fuse.search(query).map(r => r.item) : allEmployees;\r\n                \r\n                const start = (page - 1) * limit;\r\n                const end = start + limit;\r\n                const paginatedItems = results.slice(start, end);\r\n\r\n                resolve({\r\n                    items: paginatedItems.map(e => ({ value: e.systemId, label: e.fullName })),\r\n                    hasNextPage: end < results.length,\r\n                });\r\n            }, 300);\r\n        });\r\n    },\r\n    permanentDelete: async (systemId: SystemId) => {\r\n        await persistence.hardDelete(systemId);\r\n    }\r\n};\r\n\r\nconst useEmployeeStoreHook = (): EmployeeStoreState => {\r\n  const state = baseStore();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods, // This includes permanentDelete\r\n    persistence,\r\n  };\r\n};\r\n\r\nexport const useEmployeeStore = useEmployeeStoreHook as EmployeeStoreHook;\r\n\r\n// Export getState for non-hook usage\r\nuseEmployeeStore.getState = (): EmployeeStoreState => {\r\n  const state = baseStore.getState();\r\n  return {\r\n    ...state,\r\n    ...augmentedMethods,\r\n    persistence,\r\n  };\r\n};\r\n\r\nuseEmployeeStore.persistence = persistence;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7718, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/receipts/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { subscribeWithSelector } from 'zustand/middleware';\r\nimport type { Receipt } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\nimport { \r\n  findNextAvailableBusinessId, \r\n  generateSystemId, \r\n  getMaxBusinessIdCounter, \r\n  getMaxSystemIdCounter,\r\n  extractCounterFromBusinessId,\r\n  type EntityType \r\n} from '@/lib/id-utils';\r\nimport { asSystemId, asBusinessId, type BusinessId, type SystemId } from '@/lib/id-types';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport { pickAccount, pickPaymentMethod, pickReceiptType, pickTargetGroup } from '@/features/finance/document-lookups';\r\nimport { useEmployeeStore } from '../employees/store';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\n\r\n// API sync helpers\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: any): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/receipts' : `/api/receipts/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Receipts API] ${action} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Receipts API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Helper to get current user info\r\nconst getCurrentUserInfo = () => {\r\n  const currentUserSystemId = getCurrentUserSystemId?.() || 'SYSTEM';\r\n  const employee = useEmployeeStore.getState().data.find(e => e.systemId === currentUserSystemId);\r\n  return {\r\n    systemId: currentUserSystemId,\r\n    name: employee?.fullName || 'Hệ thống',\r\n    avatar: employee?.avatarUrl,\r\n  };\r\n};\r\n\r\n// Helper to create history entry\r\nconst createHistoryEntry = (\r\n  action: HistoryEntry['action'],\r\n  description: string,\r\n  metadata?: HistoryEntry['metadata']\r\n): HistoryEntry => ({\r\n  id: crypto.randomUUID(),\r\n  action,\r\n  timestamp: new Date(),\r\n  user: getCurrentUserInfo(),\r\n  description,\r\n  metadata,\r\n});\r\n\r\nconst SYSTEM_AUTHOR = asSystemId('SYSTEM');\r\nconst getCurrentReceiptAuthor = (): SystemId => {\r\n  const userId = getCurrentUserSystemId?.();\r\n  return userId ? asSystemId(userId) : SYSTEM_AUTHOR;\r\n};\r\n\r\nexport type ReceiptInput = Omit<Receipt, 'systemId' | 'id'> & { id?: BusinessId };\r\n\r\ninterface ReceiptStore {\r\n  data: Receipt[];\r\n  businessIdCounter: number;\r\n  systemIdCounter: number;\r\n  initialized: boolean;\r\n  add: (item: ReceiptInput) => Receipt;\r\n  addMultiple: (items: ReceiptInput[]) => void;\r\n  update: (systemId: SystemId, item: Receipt) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => Receipt | undefined;\r\n  getActive: () => Receipt[];\r\n  cancel: (systemId: SystemId, reason?: string) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst RECEIPT_ENTITY: EntityType = 'receipts';\r\nconst SYSTEM_ID_PREFIX = 'RECEIPT';\r\nconst BUSINESS_ID_PREFIX = 'PT';\r\nconst BUSINESS_ID_DIGITS = 6;\r\n\r\nconst normalizeReceiptStatus = (status?: Receipt['status']): Receipt['status'] =>\r\n  status === 'cancelled' ? 'cancelled' : 'completed';\r\n\r\nconst ensureReceiptMetadata = (receipt: Receipt): Receipt => {\r\n  let mutated = false;\r\n  const updates: Partial<Receipt> = {};\r\n\r\n  const targetGroup = pickTargetGroup({\r\n    systemId: receipt.payerTypeSystemId,\r\n    name: receipt.payerTypeName,\r\n  });\r\n  if (targetGroup) {\r\n    if (receipt.payerTypeSystemId !== targetGroup.systemId) {\r\n      updates.payerTypeSystemId = targetGroup.systemId;\r\n      mutated = true;\r\n    }\r\n    if (receipt.payerTypeName !== targetGroup.name) {\r\n      updates.payerTypeName = targetGroup.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const paymentMethod = pickPaymentMethod({\r\n    systemId: receipt.paymentMethodSystemId,\r\n    name: receipt.paymentMethodName,\r\n  });\r\n  if (paymentMethod) {\r\n    if (receipt.paymentMethodSystemId !== paymentMethod.systemId) {\r\n      updates.paymentMethodSystemId = paymentMethod.systemId;\r\n      mutated = true;\r\n    }\r\n    if (receipt.paymentMethodName !== paymentMethod.name) {\r\n      updates.paymentMethodName = paymentMethod.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const account = pickAccount({\r\n    accountSystemId: receipt.accountSystemId,\r\n    branchSystemId: receipt.branchSystemId,\r\n    paymentMethodName: paymentMethod?.name ?? receipt.paymentMethodName,\r\n  });\r\n  if (account && receipt.accountSystemId !== account.systemId) {\r\n    updates.accountSystemId = account.systemId;\r\n    mutated = true;\r\n  }\r\n\r\n  const receiptType = pickReceiptType({\r\n    systemId: receipt.paymentReceiptTypeSystemId,\r\n    name: receipt.paymentReceiptTypeName,\r\n  });\r\n  if (receiptType) {\r\n    if (receipt.paymentReceiptTypeSystemId !== receiptType.systemId) {\r\n      updates.paymentReceiptTypeSystemId = receiptType.systemId;\r\n      mutated = true;\r\n    }\r\n    if (receipt.paymentReceiptTypeName !== receiptType.name) {\r\n      updates.paymentReceiptTypeName = receiptType.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  if (!receipt.customerName && receipt.payerName) {\r\n    updates.customerName = receipt.payerName;\r\n    mutated = true;\r\n  }\r\n\r\n  if (!receipt.customerSystemId && receipt.payerSystemId) {\r\n    updates.customerSystemId = receipt.payerSystemId;\r\n    mutated = true;\r\n  }\r\n\r\n  return mutated ? { ...receipt, ...updates } : receipt;\r\n};\r\n\r\nconst backfillReceiptMetadata = (receipts: Receipt[]): Receipt[] => {\r\n  let mutated = false;\r\n  const updated = receipts.map(receipt => {\r\n    const normalized = ensureReceiptMetadata(receipt);\r\n    if (normalized !== receipt) {\r\n      mutated = true;\r\n    }\r\n    return normalized;\r\n  });\r\n  return mutated ? updated : receipts;\r\n};\r\n\r\nconst initialReceipts: Receipt[] = []; // Database is source of truth\r\n\r\nlet systemIdCounter = getMaxSystemIdCounter(initialReceipts, SYSTEM_ID_PREFIX);\r\nlet businessIdCounter = getMaxBusinessIdCounter(initialReceipts, BUSINESS_ID_PREFIX);\r\n\r\nconst getNextSystemId = (): SystemId => {\r\n  systemIdCounter += 1;\r\n  return asSystemId(generateSystemId(RECEIPT_ENTITY, systemIdCounter));\r\n};\r\n\r\nconst ensureReceiptBusinessId = (receipts: Receipt[], provided?: BusinessId | string): BusinessId => {\r\n  if (provided && `${provided}`.trim().length > 0) {\r\n    const normalized = `${provided}`.trim().toUpperCase();\r\n    const parsedCounter = extractCounterFromBusinessId(normalized, BUSINESS_ID_PREFIX);\r\n    if (parsedCounter > businessIdCounter) {\r\n      businessIdCounter = parsedCounter;\r\n    }\r\n    return asBusinessId(normalized);\r\n  }\r\n\r\n  const existingIds = receipts.map(receipt => receipt.id as string).filter(Boolean);\r\n  const { nextId, updatedCounter } = findNextAvailableBusinessId(\r\n    BUSINESS_ID_PREFIX,\r\n    existingIds,\r\n    businessIdCounter,\r\n    BUSINESS_ID_DIGITS\r\n  );\r\n  businessIdCounter = updatedCounter;\r\n  return asBusinessId(nextId);\r\n};\r\n\r\nexport const useReceiptStore = create<ReceiptStore>()(\r\n  subscribeWithSelector(\r\n    (set, get) => ({\r\n      data: initialReceipts,\r\n      businessIdCounter,\r\n      systemIdCounter,\r\n      initialized: false,\r\n      \r\n      add: (item: ReceiptInput): Receipt => {\r\n        let createdReceipt: Receipt | null = null;\r\n        set(state => {\r\n          const systemId = getNextSystemId();\r\n          const id = ensureReceiptBusinessId(state.data, item.id);\r\n          const createdBy = item.createdBy ?? getCurrentReceiptAuthor();\r\n          \r\n          const newReceipt: Receipt = { \r\n            ...item, \r\n            systemId, \r\n            id,\r\n            createdBy,\r\n            createdAt: item.createdAt || new Date().toISOString(),\r\n            status: normalizeReceiptStatus(item.status),\r\n            orderAllocations: item.orderAllocations ?? [],\r\n          };\r\n\r\n          const normalizedReceipt = ensureReceiptMetadata(newReceipt);\r\n          createdReceipt = normalizedReceipt;\r\n\r\n          return { \r\n            data: [...state.data, normalizedReceipt],\r\n            businessIdCounter,\r\n            systemIdCounter\r\n          };\r\n        });\r\n        // Sync to API\r\n        if (createdReceipt) {\r\n          syncToAPI('create', createdReceipt).catch(console.error);\r\n        }\r\n        return createdReceipt!;\r\n      },\r\n      \r\n      addMultiple: (items: ReceiptInput[]) => {\r\n        const created: Receipt[] = [];\r\n        set(state => {\r\n          items.forEach(item => {\r\n            const context = [...state.data, ...created];\r\n            const systemId = getNextSystemId();\r\n            const id = ensureReceiptBusinessId(context, item.id);\r\n            const createdBy = item.createdBy ?? getCurrentReceiptAuthor();\r\n            \r\n            const newReceipt: Receipt = { \r\n              ...item, \r\n              systemId, \r\n              id,\r\n              createdBy,\r\n              createdAt: item.createdAt || new Date().toISOString(),\r\n              status: normalizeReceiptStatus(item.status),\r\n              orderAllocations: item.orderAllocations ?? [],\r\n            };\r\n            created.push(ensureReceiptMetadata(newReceipt));\r\n          });\r\n          \r\n          return { \r\n            data: [...state.data, ...created],\r\n            businessIdCounter,\r\n            systemIdCounter\r\n          };\r\n        });\r\n        // Sync all to API\r\n        created.forEach(receipt => {\r\n          syncToAPI('create', receipt).catch(console.error);\r\n        });\r\n      },\r\n      \r\n      update: (systemId: SystemId, item: Receipt) => {\r\n        const updated = { ...item, status: normalizeReceiptStatus(item.status), updatedAt: new Date().toISOString() };\r\n        set(state => ({\r\n          data: state.data.map(r => r.systemId === systemId ? updated : r),\r\n          businessIdCounter,\r\n          systemIdCounter\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('update', updated).catch(console.error);\r\n      },\r\n      \r\n      remove: (systemId: SystemId) => {\r\n        set(state => ({\r\n          data: state.data.filter(r => r.systemId !== systemId),\r\n          businessIdCounter,\r\n          systemIdCounter\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n      },\r\n      \r\n      findById: (systemId: SystemId) => {\r\n        return get().data.find(r => r.systemId === systemId);\r\n      },\r\n      \r\n      getActive: () => {\r\n        return get().data.filter(r => r.status !== 'cancelled');\r\n      },\r\n      \r\n      cancel: (systemId: SystemId, reason?: string) => {\r\n        const receipt = get().findById(systemId);\r\n        if (receipt && receipt.status !== 'cancelled') {\r\n          const historyEntry = createHistoryEntry(\r\n            'cancelled',\r\n            `Đã hủy phiếu thu${reason ? `: ${reason}` : ''}`,\r\n            { oldValue: 'Hoàn thành', newValue: 'Đã hủy', note: reason }\r\n          );\r\n          \r\n          get().update(systemId, {\r\n            ...receipt,\r\n            status: 'cancelled',\r\n            cancelledAt: new Date().toISOString(),\r\n            activityHistory: [...(receipt.activityHistory || []), historyEntry],\r\n          });\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        try {\r\n          // NOTE: Use React Query hooks for paginated data. This only loads initial batch.\r\n          const response = await fetch('/api/receipts?limit=30');\r\n          if (!response.ok) return;\r\n          const json = await response.json();\r\n          const apiData = json.data || [];\r\n          if (apiData.length > 0) {\r\n            const normalized = backfillReceiptMetadata(apiData.map((receipt: Receipt) => ({\r\n              ...receipt,\r\n              status: normalizeReceiptStatus(receipt.status),\r\n            })));\r\n            const nextSystemCounter = getMaxSystemIdCounter(normalized, SYSTEM_ID_PREFIX);\r\n            const nextBusinessCounter = getMaxBusinessIdCounter(normalized, BUSINESS_ID_PREFIX);\r\n            systemIdCounter = nextSystemCounter;\r\n            businessIdCounter = nextBusinessCounter;\r\n            set({ \r\n              data: normalized, \r\n              systemIdCounter, \r\n              businessIdCounter,\r\n              initialized: true \r\n            });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        } catch (error) {\r\n          console.error('[Receipts API] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n  )\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8049, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/payments/store.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { Payment } from './types';\r\nimport type { HistoryEntry } from '../../components/ActivityHistory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport {\r\n  extractCounterFromBusinessId,\r\n  findNextAvailableBusinessId,\r\n  generateSystemId,\r\n  getMaxBusinessIdCounter,\r\n  getMaxSystemIdCounter,\r\n  type EntityType,\r\n} from '../../lib/id-utils';\r\nimport { asBusinessId, asSystemId, type BusinessId, type SystemId } from '../../lib/id-types';\r\nimport { pickAccount, pickPaymentMethod, pickPaymentType, pickTargetGroup } from '@/features/finance/document-lookups';\r\nimport { useEmployeeStore } from '../employees/store';\r\nimport { getCurrentUserSystemId } from '../../contexts/auth-context';\r\n\r\n// API sync helpers\r\nasync function syncToAPI(action: 'create' | 'update' | 'delete', data: any): Promise<boolean> {\r\n  try {\r\n    const endpoint = action === 'create' ? '/api/payments' : `/api/payments/${data.systemId}`;\r\n    const method = action === 'create' ? 'POST' : action === 'update' ? 'PATCH' : 'DELETE';\r\n    \r\n    const response = await fetch(endpoint, {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: action !== 'delete' ? JSON.stringify(data) : undefined,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.error(`[Payments API] ${action} failed:`, await response.text());\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error(`[Payments API] ${action} error:`, error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Helper to get current user info\r\nconst getCurrentUserInfo = () => {\r\n  const currentUserSystemId = getCurrentUserSystemId?.() || 'SYSTEM';\r\n  const employee = useEmployeeStore.getState().data.find(e => e.systemId === currentUserSystemId);\r\n  return {\r\n    systemId: currentUserSystemId,\r\n    name: employee?.fullName || 'Hệ thống',\r\n    avatar: employee?.avatarUrl,\r\n  };\r\n};\r\n\r\n// Helper to create history entry\r\nconst createHistoryEntry = (\r\n  action: HistoryEntry['action'],\r\n  description: string,\r\n  metadata?: HistoryEntry['metadata']\r\n): HistoryEntry => ({\r\n  id: crypto.randomUUID(),\r\n  action,\r\n  timestamp: new Date(),\r\n  user: getCurrentUserInfo(),\r\n  description,\r\n  metadata,\r\n});\r\n\r\nexport type PaymentInput = Omit<Payment, 'systemId' | 'id'> & { id?: BusinessId | string };\r\n\r\ninterface PaymentStore {\r\n  data: Payment[];\r\n  businessIdCounter: number;\r\n  systemIdCounter: number;\r\n  initialized: boolean;\r\n  add: (item: PaymentInput) => Payment;\r\n  addMultiple: (items: PaymentInput[]) => void;\r\n  update: (systemId: SystemId, item: Payment) => void;\r\n  remove: (systemId: SystemId) => void;\r\n  findById: (systemId: SystemId) => Payment | undefined;\r\n  getActive: () => Payment[];\r\n  cancel: (systemId: SystemId, reason?: string) => void;\r\n  loadFromAPI: () => Promise<void>;\r\n}\r\n\r\nconst PAYMENT_ENTITY: EntityType = 'payments';\r\nconst SYSTEM_ID_PREFIX = 'PAYMENT';\r\nconst BUSINESS_ID_PREFIX = 'PC';\r\nconst BUSINESS_ID_DIGITS = 6;\r\nconst PURCHASE_ORDER_SYSTEM_PREFIX = 'PURCHASE';\r\nconst PURCHASE_ORDER_BUSINESS_PREFIX = 'PO';\r\n\r\nconst normalizePaymentStatus = (status?: Payment['status']): Payment['status'] =>\r\n  status === 'cancelled' ? 'cancelled' : 'completed';\r\n\r\nconst normalizePayment = (payment: Payment): Payment => ({\r\n  ...payment,\r\n  status: normalizePaymentStatus(payment.status),\r\n});\r\n\r\nconst ensurePaymentMetadata = (payment: Payment): Payment => {\r\n  let mutated = false;\r\n  const updates: Partial<Payment> = {};\r\n\r\n  const targetGroup = pickTargetGroup({\r\n    systemId: payment.recipientTypeSystemId,\r\n    name: payment.recipientTypeName,\r\n  });\r\n  if (targetGroup) {\r\n    if (payment.recipientTypeSystemId !== targetGroup.systemId) {\r\n      updates.recipientTypeSystemId = targetGroup.systemId;\r\n      mutated = true;\r\n    }\r\n    if (payment.recipientTypeName !== targetGroup.name) {\r\n      updates.recipientTypeName = targetGroup.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const paymentMethod = pickPaymentMethod({\r\n    systemId: payment.paymentMethodSystemId,\r\n    name: payment.paymentMethodName,\r\n  });\r\n  if (paymentMethod) {\r\n    if (payment.paymentMethodSystemId !== paymentMethod.systemId) {\r\n      updates.paymentMethodSystemId = paymentMethod.systemId;\r\n      mutated = true;\r\n    }\r\n    if (payment.paymentMethodName !== paymentMethod.name) {\r\n      updates.paymentMethodName = paymentMethod.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const account = pickAccount({\r\n    accountSystemId: payment.accountSystemId,\r\n    branchSystemId: payment.branchSystemId,\r\n    paymentMethodName: paymentMethod?.name ?? payment.paymentMethodName,\r\n  });\r\n  if (account && payment.accountSystemId !== account.systemId) {\r\n    updates.accountSystemId = account.systemId;\r\n    mutated = true;\r\n  }\r\n\r\n  const paymentType = pickPaymentType({\r\n    systemId: payment.paymentReceiptTypeSystemId,\r\n    name: payment.paymentReceiptTypeName,\r\n  });\r\n  if (paymentType) {\r\n    if (payment.paymentReceiptTypeSystemId !== paymentType.systemId) {\r\n      updates.paymentReceiptTypeSystemId = paymentType.systemId;\r\n      mutated = true;\r\n    }\r\n    if (payment.paymentReceiptTypeName !== paymentType.name) {\r\n      updates.paymentReceiptTypeName = paymentType.name;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  const normalizedGroupName = targetGroup?.name?.trim().toLowerCase();\r\n  if (normalizedGroupName === 'khách hàng') {\r\n    if (!payment.customerName && payment.recipientName) {\r\n      updates.customerName = payment.recipientName;\r\n      mutated = true;\r\n    }\r\n    if (!payment.customerSystemId && payment.recipientSystemId) {\r\n      updates.customerSystemId = payment.recipientSystemId;\r\n      mutated = true;\r\n    }\r\n  }\r\n\r\n  return mutated ? { ...payment, ...updates } : payment;\r\n};\r\n\r\nconst backfillPaymentMetadata = (payments: Payment[]): Payment[] => {\r\n  let mutated = false;\r\n  const updated = payments.map(payment => {\r\n    const normalized = ensurePaymentMetadata(payment);\r\n    if (normalized !== payment) {\r\n      mutated = true;\r\n    }\r\n    return normalized;\r\n  });\r\n  return mutated ? updated : payments;\r\n};\r\n\r\nconst initialPayments: Payment[] = []; // Database is source of truth\r\n\r\nlet systemIdCounter = getMaxSystemIdCounter(initialPayments, SYSTEM_ID_PREFIX);\r\nlet businessIdCounter = getMaxBusinessIdCounter(initialPayments, BUSINESS_ID_PREFIX);\r\n\r\nconst getNextSystemId = (): SystemId => {\r\n  systemIdCounter += 1;\r\n  return asSystemId(generateSystemId(PAYMENT_ENTITY, systemIdCounter));\r\n};\r\n\r\nconst ensurePaymentBusinessId = (payments: Payment[], provided?: BusinessId | string): BusinessId => {\r\n  if (provided && `${provided}`.trim().length > 0) {\r\n    const normalized = `${provided}`.trim().toUpperCase();\r\n    const parsedCounter = extractCounterFromBusinessId(normalized, BUSINESS_ID_PREFIX);\r\n    if (parsedCounter > businessIdCounter) {\r\n      businessIdCounter = parsedCounter;\r\n    }\r\n    return asBusinessId(normalized);\r\n  }\r\n\r\n  const existingIds = payments.map(payment => payment.id as string).filter(Boolean);\r\n  const { nextId, updatedCounter } = findNextAvailableBusinessId(\r\n    BUSINESS_ID_PREFIX,\r\n    existingIds,\r\n    businessIdCounter,\r\n    BUSINESS_ID_DIGITS\r\n  );\r\n  businessIdCounter = updatedCounter;\r\n  return asBusinessId(nextId);\r\n};\r\n\r\nconst reconcileLinkedDocuments = (payment: Payment): Payment => {\r\n  if (!payment.originalDocumentId) {\r\n    return payment;\r\n  }\r\n\r\n  const normalizedDocId = payment.originalDocumentId.toUpperCase();\r\n  const nextPayment = { ...payment };\r\n\r\n  if (!nextPayment.purchaseOrderSystemId && normalizedDocId.startsWith(PURCHASE_ORDER_SYSTEM_PREFIX)) {\r\n    nextPayment.purchaseOrderSystemId = asSystemId(payment.originalDocumentId);\r\n  }\r\n\r\n  if (!nextPayment.purchaseOrderId && normalizedDocId.startsWith(PURCHASE_ORDER_BUSINESS_PREFIX)) {\r\n    nextPayment.purchaseOrderId = asBusinessId(payment.originalDocumentId);\r\n  }\r\n\r\n  return nextPayment;\r\n};\r\n\r\nconst buildPayment = (input: PaymentInput, existingPayments: Payment[]): Payment => {\r\n  const systemId = getNextSystemId();\r\n  const id = ensurePaymentBusinessId(existingPayments, input.id);\r\n  const basePayment: Payment = {\r\n    ...input,\r\n    systemId,\r\n    id,\r\n    createdAt: input.createdAt || new Date().toISOString(),\r\n    status: normalizePaymentStatus(input.status),\r\n  };\r\n\r\n  return reconcileLinkedDocuments(basePayment);\r\n};\r\n\r\nexport const usePaymentStore = create<PaymentStore>()(\r\n  (set, get) => ({\r\n      data: initialPayments,\r\n      businessIdCounter,\r\n      systemIdCounter,\r\n      initialized: false,\r\n      \r\n      add: (item) => {\r\n        let createdPayment: Payment | null = null;\r\n        set(state => {\r\n          const newPayment = buildPayment(item, state.data);\r\n          createdPayment = newPayment;\r\n          return {\r\n            data: [...state.data, newPayment],\r\n            businessIdCounter,\r\n            systemIdCounter,\r\n          };\r\n        });\r\n        // Sync to API\r\n        if (createdPayment) {\r\n          syncToAPI('create', createdPayment).catch(console.error);\r\n        }\r\n        return createdPayment!;\r\n      },\r\n      \r\n      addMultiple: (items) => {\r\n        const created: Payment[] = [];\r\n        set(state => {\r\n          items.forEach(item => {\r\n            const context = [...state.data, ...created];\r\n            const payment = buildPayment(item, context);\r\n            created.push(payment);\r\n          });\r\n\r\n          return {\r\n            data: [...state.data, ...created],\r\n            businessIdCounter,\r\n            systemIdCounter,\r\n          };\r\n        });\r\n        // Sync all to API\r\n        created.forEach(payment => {\r\n          syncToAPI('create', payment).catch(console.error);\r\n        });\r\n      },\r\n      \r\n      update: (systemId, item) => {\r\n        const updated = reconcileLinkedDocuments({\r\n          ...item,\r\n          systemId,\r\n          status: normalizePaymentStatus(item.status),\r\n          updatedAt: new Date().toISOString(),\r\n        });\r\n        set(state => ({\r\n          data: state.data.map(payment =>\r\n            payment.systemId === systemId ? updated : payment\r\n          ),\r\n          businessIdCounter,\r\n          systemIdCounter,\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('update', updated).catch(console.error);\r\n      },\r\n      \r\n      remove: (systemId) => {\r\n        set(state => ({\r\n          data: state.data.filter(payment => payment.systemId !== systemId),\r\n          businessIdCounter,\r\n          systemIdCounter,\r\n        }));\r\n        // Sync to API\r\n        syncToAPI('delete', { systemId }).catch(console.error);\r\n      },\r\n      \r\n      findById: (systemId) => {\r\n        return get().data.find(payment => payment.systemId === systemId);\r\n      },\r\n      \r\n      getActive: () => {\r\n        return get().data.filter(payment => payment.status !== 'cancelled');\r\n      },\r\n      \r\n      cancel: (systemId: SystemId, reason?: string) => {\r\n        const payment = get().findById(systemId);\r\n        if (payment && payment.status !== 'cancelled') {\r\n          const historyEntry = createHistoryEntry(\r\n            'cancelled',\r\n            `Đã hủy phiếu chi${reason ? `: ${reason}` : ''}`,\r\n            { oldValue: 'Hoàn thành', newValue: 'Đã hủy', note: reason }\r\n          );\r\n          \r\n          get().update(systemId, {\r\n            ...payment,\r\n            status: 'cancelled',\r\n            cancelledAt: new Date().toISOString(),\r\n            activityHistory: [...(payment.activityHistory || []), historyEntry],\r\n          });\r\n        }\r\n      },\r\n      \r\n      loadFromAPI: async () => {\r\n        try {\r\n          // NOTE: Use React Query hooks for paginated data. This only loads initial batch.\r\n          const response = await fetch('/api/payments?limit=30');\r\n          if (!response.ok) return;\r\n          const json = await response.json();\r\n          const apiData = json.data || [];\r\n          if (apiData.length > 0) {\r\n            const normalized = backfillPaymentMetadata(apiData.map(normalizePayment));\r\n            const nextSystemCounter = getMaxSystemIdCounter(normalized, SYSTEM_ID_PREFIX);\r\n            const nextBusinessCounter = getMaxBusinessIdCounter(normalized, BUSINESS_ID_PREFIX);\r\n            systemIdCounter = nextSystemCounter;\r\n            businessIdCounter = nextBusinessCounter;\r\n            set({ \r\n              data: normalized, \r\n              systemIdCounter, \r\n              businessIdCounter,\r\n              initialized: true \r\n            });\r\n          } else {\r\n            set({ initialized: true });\r\n          }\r\n        } catch (error) {\r\n          console.error('[Payments API] loadFromAPI error:', error);\r\n        }\r\n      },\r\n    })\r\n);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8385, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/branches/store.ts"],"sourcesContent":["import { createCrudStore, CrudState } from '../../../lib/store-factory';\r\n// REMOVED: import { data as initialData } from './data'; // Mock data no longer used - database is source of truth\r\nimport type { Branch } from './types';\r\nimport { SystemId } from '../../../lib/id-types';\r\n\r\nexport interface BranchStoreState extends CrudState<Branch> {\r\n  setDefault: (systemId: SystemId) => void;\r\n}\r\n\r\nconst baseStore = createCrudStore<Branch>([], 'branches', {\r\n  apiEndpoint: '/api/branches',\r\n});\r\n\r\nconst setDefault = (systemId: SystemId) => {\r\n  baseStore.setState(state => ({\r\n    data: state.data.map(branch => ({\r\n      ...branch,\r\n      isDefault: branch.systemId === systemId,\r\n    })),\r\n  }));\r\n};\r\n\r\nconst originalAdd = baseStore.getState().add;\r\nconst originalUpdate = baseStore.getState().update;\r\n\r\nbaseStore.setState({\r\n  add: (item: Omit<Branch, 'systemId'>) => {\r\n    const result = originalAdd(item);\r\n    if ((item as Branch).isDefault) {\r\n      setDefault(result.systemId);\r\n    }\r\n    return result;\r\n  },\r\n  update: (systemId: SystemId, updatedItem: Branch) => {\r\n    originalUpdate(systemId, updatedItem);\r\n    if (updatedItem.isDefault) {\r\n      setDefault(systemId);\r\n    }\r\n  },\r\n} as Partial<BranchStoreState>);\r\n\r\nconst enhanceState = (state: CrudState<Branch>): BranchStoreState => ({\r\n  ...state,\r\n  setDefault,\r\n});\r\n\r\ntype BranchStoreHook = (() => BranchStoreState) & {\r\n  getState: () => BranchStoreState;\r\n};\r\n\r\nconst useBranchStoreBase = (() => enhanceState(baseStore())) as BranchStoreHook;\r\n\r\nuseBranchStoreBase.getState = () => enhanceState(baseStore.getState());\r\n\r\nexport const useBranchStore = useBranchStoreBase;\r\n"],"names":[],"mappings":";;;;AAAA;;AASA,MAAM,YAAY,IAAA,6IAAe,EAAS,EAAE,EAAE,YAAY;IACxD,aAAa;AACf;AAEA,MAAM,aAAa,CAAC;IAClB,UAAU,QAAQ,CAAC,CAAA,QAAS,CAAC;YAC3B,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,CAAA,SAAU,CAAC;oBAC9B,GAAG,MAAM;oBACT,WAAW,OAAO,QAAQ,KAAK;gBACjC,CAAC;QACH,CAAC;AACH;AAEA,MAAM,cAAc,UAAU,QAAQ,GAAG,GAAG;AAC5C,MAAM,iBAAiB,UAAU,QAAQ,GAAG,MAAM;AAElD,UAAU,QAAQ,CAAC;IACjB,KAAK,CAAC;QACJ,MAAM,SAAS,YAAY;QAC3B,IAAI,AAAC,KAAgB,SAAS,EAAE;YAC9B,WAAW,OAAO,QAAQ;QAC5B;QACA,OAAO;IACT;IACA,QAAQ,CAAC,UAAoB;QAC3B,eAAe,UAAU;QACzB,IAAI,YAAY,SAAS,EAAE;YACzB,WAAW;QACb;IACF;AACF;AAEA,MAAM,eAAe,CAAC,QAA+C,CAAC;QACpE,GAAG,KAAK;QACR;IACF,CAAC;AAMD,MAAM,qBAAsB,IAAM,aAAa;AAE/C,mBAAmB,QAAQ,GAAG,IAAM,aAAa,UAAU,QAAQ;AAE5D,MAAM,iBAAiB"}},
    {"offset": {"line": 8433, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/currency-input.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Input } from \"./input\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\nexport interface CurrencyInputProps\r\n  extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'onChange' | 'value'> {\r\n  value?: number | undefined;\r\n  onChange?: (value: number) => void;\r\n}\r\n\r\nconst CurrencyInput = React.forwardRef<HTMLInputElement, CurrencyInputProps>(\r\n  ({ className, value, onChange, ...props }, ref) => {\r\n    const [displayValue, setDisplayValue] = React.useState(\"\");\r\n\r\n    // Format number with thousand separators\r\n    const formatNumber = (num: number): string => {\r\n      return new Intl.NumberFormat('vi-VN').format(num);\r\n    };\r\n\r\n    // Parse formatted string back to number\r\n    const parseNumber = (str: string): number => {\r\n      const cleaned = str.replace(/\\./g, '').replace(/,/g, '');\r\n      const num = parseInt(cleaned, 10);\r\n      return isNaN(num) ? 0 : Math.max(0, num); // Không cho phép số âm\r\n    };\r\n\r\n    // Sync external value to display\r\n    React.useEffect(() => {\r\n      if (value !== undefined) {\r\n        setDisplayValue(value === 0 ? \"\" : formatNumber(value));\r\n      }\r\n    }, [value]);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      const inputValue = e.target.value;\r\n      \r\n      // Cho phép rỗng\r\n      if (inputValue === \"\") {\r\n        setDisplayValue(\"\");\r\n        onChange?.(0);\r\n        return;\r\n      }\r\n\r\n      // Chỉ cho phép số và dấu chấm, không cho phép dấu trừ\r\n      const cleaned = inputValue.replace(/[^\\d.]/g, '');\r\n      \r\n      // Không xử lý nếu có ký tự không hợp lệ (bao gồm dấu trừ)\r\n      if (inputValue.length > 0 && cleaned === \"\" && inputValue !== \"\") {\r\n        return;\r\n      }\r\n      \r\n      const num = parseNumber(cleaned);\r\n      \r\n      // Cập nhật display và gọi onChange\r\n      setDisplayValue(formatNumber(num));\r\n      onChange?.(num);\r\n    };\r\n\r\n    const handleBlur = (e: React.FocusEvent<HTMLInputElement>) => {\r\n      // Format lại khi blur\r\n      if (value !== undefined && value > 0) {\r\n        setDisplayValue(formatNumber(value));\r\n      }\r\n      props.onBlur?.(e);\r\n    };\r\n\r\n    return (\r\n      <div className=\"relative\">\r\n        <Input\r\n          ref={ref}\r\n          type=\"text\"\r\n          inputMode=\"numeric\"\r\n          value={displayValue}\r\n          onChange={handleChange}\r\n          onBlur={handleBlur}\r\n          className={cn(\"text-right pr-14 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\", className)}\r\n          {...props}\r\n        />\r\n        <span className={cn(\r\n          \"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-muted-foreground pointer-events-none\",\r\n          props.disabled && \"opacity-50\"\r\n        )}>\r\n          VND\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nCurrencyInput.displayName = \"CurrencyInput\";\r\n\r\nexport { CurrencyInput };\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;;AAQA,MAAM,8BAAgB,GAAA,2KAAgB,SACpC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;;IACzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,yKAAc,CAAC;IAEvD,yCAAyC;IACzC,MAAM,eAAe,CAAC;QACpB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;IAC/C;IAEA,wCAAwC;IACxC,MAAM,cAAc,CAAC;QACnB,MAAM,UAAU,IAAI,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM;QACrD,MAAM,MAAM,SAAS,SAAS;QAC9B,OAAO,MAAM,OAAO,IAAI,KAAK,GAAG,CAAC,GAAG,MAAM,uBAAuB;IACnE;IAEA,iCAAiC;IACjC,0KAAe;mCAAC;YACd,IAAI,UAAU,WAAW;gBACvB,gBAAgB,UAAU,IAAI,KAAK,aAAa;YAClD;QACF;kCAAG;QAAC;KAAM;IAEV,MAAM,eAAe,CAAC;QACpB,MAAM,aAAa,EAAE,MAAM,CAAC,KAAK;QAEjC,gBAAgB;QAChB,IAAI,eAAe,IAAI;YACrB,gBAAgB;YAChB,WAAW;YACX;QACF;QAEA,sDAAsD;QACtD,MAAM,UAAU,WAAW,OAAO,CAAC,WAAW;QAE9C,0DAA0D;QAC1D,IAAI,WAAW,MAAM,GAAG,KAAK,YAAY,MAAM,eAAe,IAAI;YAChE;QACF;QAEA,MAAM,MAAM,YAAY;QAExB,mCAAmC;QACnC,gBAAgB,aAAa;QAC7B,WAAW;IACb;IAEA,MAAM,aAAa,CAAC;QAClB,sBAAsB;QACtB,IAAI,UAAU,aAAa,QAAQ,GAAG;YACpC,gBAAgB,aAAa;QAC/B;QACA,MAAM,MAAM,GAAG;IACjB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,sIAAK;gBACJ,KAAK;gBACL,MAAK;gBACL,WAAU;gBACV,OAAO;gBACP,UAAU;gBACV,QAAQ;gBACR,WAAW,IAAA,qHAAE,EAAC,yIAAyI;gBACtJ,GAAG,KAAK;;;;;;0BAEX,6LAAC;gBAAK,WAAW,IAAA,qHAAE,EACjB,+FACA,MAAM,QAAQ,IAAI;0BACjB;;;;;;;;;;;;AAKT;;AAGF,cAAc,WAAW,GAAG"}},
    {"offset": {"line": 8540, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/radio-group.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cn } from \"../../lib/utils\"\r\n\r\n// --- Context ---\r\ntype RadioGroupContextType = {\r\n  value: string | number | undefined;\r\n  onValueChange: (value: string | number) => void;\r\n  name?: string | undefined;\r\n};\r\n\r\nconst RadioGroupContext = React.createContext<RadioGroupContextType | undefined>(undefined);\r\n\r\nconst useRadioGroup = () => {\r\n  const context = React.useContext(RadioGroupContext);\r\n  if (!context) {\r\n    throw new Error(\"useRadioGroup must be used within a RadioGroup\");\r\n  }\r\n  return context;\r\n};\r\n\r\n// --- RadioGroup ---\r\nconst RadioGroup = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement> & {\r\n    value?: string | number | undefined;\r\n    defaultValue?: string | number | undefined;\r\n    onValueChange?: ((value: string | number) => void) | undefined;\r\n    name?: string | undefined;\r\n  }\r\n>(({ className, children, value, defaultValue, onValueChange, name, ...props }, ref) => {\r\n  const [internalValue, setInternalValue] = React.useState(defaultValue);\r\n  const isControlled = value !== undefined;\r\n  const currentValue = isControlled ? value : internalValue;\r\n\r\n  const handleValueChange = (newValue: string | number) => {\r\n    if (!isControlled) {\r\n      setInternalValue(newValue);\r\n    }\r\n    if (onValueChange) {\r\n      onValueChange(newValue);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <RadioGroupContext.Provider value={{ value: currentValue, onValueChange: handleValueChange, name }}>\r\n      <div ref={ref} role=\"radiogroup\" className={cn(\"grid gap-2\", className)} {...props}>\r\n        {children}\r\n      </div>\r\n    </RadioGroupContext.Provider>\r\n  );\r\n});\r\nRadioGroup.displayName = \"RadioGroup\";\r\n\r\n// --- RadioGroupItem ---\r\nconst RadioGroupItem = React.forwardRef<\r\n  HTMLButtonElement,\r\n  React.ButtonHTMLAttributes<HTMLButtonElement> & { value: string | number }\r\n>(({ className, value, children, ...props }, ref) => {\r\n  const { value: selectedValue, onValueChange, name } = useRadioGroup();\r\n  const isChecked = selectedValue === value;\r\n  const id = React.useId();\r\n\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      id={id}\r\n      type=\"button\"\r\n      role=\"radio\"\r\n      aria-checked={isChecked}\r\n      data-state={isChecked ? \"checked\" : \"unchecked\"}\r\n      onClick={() => onValueChange(value)}\r\n      name={name}\r\n      value={value}\r\n      className={cn(\r\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      {isChecked && (\r\n        <div className=\"flex items-center justify-center\">\r\n          <div className=\"h-2.5 w-2.5 rounded-full bg-current text-current\" />\r\n        </div>\r\n      )}\r\n    </button>\r\n  );\r\n});\r\nRadioGroupItem.displayName = \"RadioGroupItem\";\r\n\r\n\r\nexport { RadioGroup, RadioGroupItem };\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;;AASA,MAAM,kCAAoB,8KAAmB,CAAoC;AAEjF,MAAM,gBAAgB;;IACpB,MAAM,UAAU,2KAAgB,CAAC;IACjC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;GANM;AAQN,qBAAqB;AACrB,MAAM,2BAAa,IAAA,2KAAgB,UAQjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,YAAY,EAAE,aAAa,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;;IAC9E,MAAM,CAAC,eAAe,iBAAiB,GAAG,yKAAc,CAAC;IACzD,MAAM,eAAe,UAAU;IAC/B,MAAM,eAAe,eAAe,QAAQ;IAE5C,MAAM,oBAAoB,CAAC;QACzB,IAAI,CAAC,cAAc;YACjB,iBAAiB;QACnB;QACA,IAAI,eAAe;YACjB,cAAc;QAChB;IACF;IAEA,qBACE,6LAAC,kBAAkB,QAAQ;QAAC,OAAO;YAAE,OAAO;YAAc,eAAe;YAAmB;QAAK;kBAC/F,cAAA,6LAAC;YAAI,KAAK;YAAK,MAAK;YAAa,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAa,GAAG,KAAK;sBAC/E;;;;;;;;;;;AAIT;;AACA,WAAW,WAAW,GAAG;AAEzB,yBAAyB;AACzB,MAAM,+BAAiB,IAAA,2KAAgB,WAGrC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;;IAC3C,MAAM,EAAE,OAAO,aAAa,EAAE,aAAa,EAAE,IAAI,EAAE,GAAG;IACtD,MAAM,YAAY,kBAAkB;IACpC,MAAM,KAAK,sKAAW;IAEtB,qBACE,6LAAC;QACC,KAAK;QACL,IAAI;QACJ,MAAK;QACL,MAAK;QACL,gBAAc;QACd,cAAY,YAAY,YAAY;QACpC,SAAS,IAAM,cAAc;QAC7B,MAAM;QACN,OAAO;QACP,WAAW,IAAA,qHAAE,EACX,4OACA;QAED,GAAG,KAAK;kBAER,2BACC,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;;;;;;AAKzB;;QA5BwD;;;;QAAA;;;;AA6BxD,eAAe,WAAW,GAAG"}},
    {"offset": {"line": 8663, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/ui/select.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\r\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\r\n\r\nimport { cn } from \"../../lib/utils\"\r\nimport { useModal } from \"../../contexts/modal-context\"\r\n\r\ntype BaseSelectProps = React.ComponentPropsWithoutRef<typeof SelectPrimitive.Root>\r\n\r\ntype SelectProps = Omit<BaseSelectProps, \"value\" | \"defaultValue\"> & {\r\n  value?: string | undefined\r\n  defaultValue?: string | undefined\r\n}\r\n\r\nconst Select = ({ value, defaultValue, ...props }: SelectProps) => {\r\n  const controlledProps: Partial<BaseSelectProps> = {}\r\n\r\n  if (value !== undefined) {\r\n    controlledProps.value = value\r\n  }\r\n\r\n  if (defaultValue !== undefined) {\r\n    controlledProps.defaultValue = defaultValue\r\n  }\r\n\r\n  return <SelectPrimitive.Root {...props} {...controlledProps} />\r\n}\r\nSelect.displayName = SelectPrimitive.Root.displayName\r\n\r\nconst SelectGroup = SelectPrimitive.Group\r\n\r\nconst SelectValue = SelectPrimitive.Value\r\n\r\nconst SelectTrigger = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\r\n>(({ className, children, ...props }, ref) => (\r\n  <SelectPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    {children}\r\n    <SelectPrimitive.Icon asChild>\r\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\r\n    </SelectPrimitive.Icon>\r\n  </SelectPrimitive.Trigger>\r\n))\r\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\r\n\r\nconst SelectScrollUpButton = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.ScrollUpButton\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default items-center justify-center py-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ChevronUp className=\"h-4 w-4\" />\r\n  </SelectPrimitive.ScrollUpButton>\r\n))\r\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\r\n\r\nconst SelectScrollDownButton = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.ScrollDownButton\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex cursor-default items-center justify-center py-1\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ChevronDown className=\"h-4 w-4\" />\r\n  </SelectPrimitive.ScrollDownButton>\r\n))\r\nSelectScrollDownButton.displayName =\r\n  SelectPrimitive.ScrollDownButton.displayName\r\n\r\nconst SelectContent = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\r\n>(({ className, children, position = \"popper\", ...props }, ref) => {\r\n  const modalId = React.useId();\r\n  const [isOpen, setIsOpen] = React.useState(false);\r\n  const { zIndex } = useModal(modalId, isOpen, 'select');\r\n\r\n  React.useEffect(() => {\r\n    const content = ref && 'current' in ref ? ref.current : null;\r\n    if (!content) return;\r\n\r\n    const observer = new MutationObserver((mutations) => {\r\n      mutations.forEach((mutation) => {\r\n        if (mutation.type === 'attributes' && mutation.attributeName === 'data-state') {\r\n          const target = mutation.target as HTMLElement;\r\n          const state = target.getAttribute('data-state');\r\n          setIsOpen(state === 'open');\r\n        }\r\n      });\r\n    });\r\n\r\n    observer.observe(content, { attributes: true, attributeFilter: ['data-state'] });\r\n\r\n    return () => observer.disconnect();\r\n  }, [ref]);\r\n\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        ref={ref}\r\n        className={cn(\r\n          \"relative max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\r\n          position === \"popper\" &&\r\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\r\n          className\r\n        )}\r\n        style={{ zIndex }}\r\n        position={position}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            \"p-1\",\r\n            position === \"popper\" &&\r\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  );\r\n})\r\nSelectContent.displayName = SelectPrimitive.Content.displayName\r\n\r\nconst SelectLabel = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Label>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.Label\r\n    ref={ref}\r\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSelectLabel.displayName = SelectPrimitive.Label.displayName\r\n\r\nconst SelectItem = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\r\n>(({ className, children, ...props }, ref) => (\r\n  <SelectPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\r\n      <SelectPrimitive.ItemIndicator>\r\n        <Check className=\"h-4 w-4\" />\r\n      </SelectPrimitive.ItemIndicator>\r\n    </span>\r\n\r\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n  </SelectPrimitive.Item>\r\n))\r\nSelectItem.displayName = SelectPrimitive.Item.displayName\r\n\r\nconst SelectSeparator = React.forwardRef<\r\n  React.ElementRef<typeof SelectPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <SelectPrimitive.Separator\r\n    ref={ref}\r\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\r\n\r\nexport {\r\n  Select,\r\n  SelectGroup,\r\n  SelectValue,\r\n  SelectTrigger,\r\n  SelectContent,\r\n  SelectLabel,\r\n  SelectItem,\r\n  SelectSeparator,\r\n  SelectScrollUpButton,\r\n  SelectScrollDownButton,\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8954, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/cash-accounts/form.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useForm, type ControllerProps, type FieldPath } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport type { CashAccount } from \"../../cashbook/types\";\r\nimport { useBranchStore } from \"../branches/store\";\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"../../../components/ui/form\";\r\nimport { Input } from \"../../../components/ui/input\";\r\nimport { CurrencyInput } from \"../../../components/ui/currency-input\";\r\nimport { RadioGroup, RadioGroupItem } from \"../../../components/ui/radio-group\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../../components/ui/select\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\n\r\nconst formSchema = z.object({\r\n  id: z.string().min(1, \"Mã tài khoản là bắt buộc\"),\r\n  name: z.string().min(1, \"Tên tài khoản là bắt buộc\").max(100, \"Tên không được vượt quá 100 ký tự\"),\r\n  initialBalance: z.number().min(0, \"Số dư không được âm\"),\r\n  type: z.enum(['cash', 'bank'] as const),\r\n  bankAccountNumber: z.string().optional(),\r\n  bankBranch: z.string().optional(),\r\n  branchSystemId: z.string().optional(),\r\n  isActive: z.boolean(),\r\n  isDefault: z.boolean().optional(),\r\n  bankName: z.string().optional(),\r\n  bankCode: z.string().optional(),\r\n  accountHolder: z.string().optional(),\r\n  minBalance: z.number().optional(),\r\n  maxBalance: z.number().optional(),\r\n  managedBy: z.string().optional(),\r\n});\r\n\r\nexport type CashAccountFormValues = z.infer<typeof formSchema>;\r\n\r\nconst CashAccountFormField = <TName extends FieldPath<CashAccountFormValues>>(props: ControllerProps<CashAccountFormValues, TName>) => (\r\n  <FormField<CashAccountFormValues, TName> {...props} />\r\n);\r\n\r\ntype FormProps = {\r\n  initialData?: CashAccount | null;\r\n  onSubmit: (values: CashAccountFormValues) => void;\r\n};\r\n\r\nexport function CashAccountForm({ initialData, onSubmit }: FormProps) {\r\n  const { data: branches } = useBranchStore();\r\n\r\n  const defaultBranchSystemId = React.useMemo(() => {\r\n    const branch = branches.find(b => b.isDefault);\r\n    return branch?.systemId ? String(branch.systemId) : undefined;\r\n  }, [branches]);\r\n\r\n  const buildFormValues = React.useCallback(\r\n    (account?: CashAccount | null): CashAccountFormValues => {\r\n      if (account) {\r\n        return {\r\n          id: String(account.id),\r\n          name: account.name,\r\n          initialBalance: account.initialBalance,\r\n          type: account.type,\r\n          bankAccountNumber: account.bankAccountNumber ?? undefined,\r\n          bankBranch: account.bankBranch ?? undefined,\r\n          branchSystemId: account.branchSystemId ? String(account.branchSystemId) : undefined,\r\n          isActive: account.isActive,\r\n          isDefault: account.isDefault ?? false,\r\n          bankName: account.bankName ?? undefined,\r\n          bankCode: account.bankCode ?? undefined,\r\n          accountHolder: account.accountHolder ?? undefined,\r\n          minBalance: account.minBalance ?? undefined,\r\n          maxBalance: account.maxBalance ?? undefined,\r\n          managedBy: account.managedBy ? String(account.managedBy) : undefined,\r\n        };\r\n      }\r\n\r\n      return {\r\n        id: \"\",\r\n        name: \"\",\r\n        initialBalance: 0,\r\n        type: 'cash',\r\n        bankAccountNumber: undefined,\r\n        bankBranch: undefined,\r\n        branchSystemId: defaultBranchSystemId,\r\n        isActive: true,\r\n        isDefault: false,\r\n        bankName: undefined,\r\n        bankCode: undefined,\r\n        accountHolder: undefined,\r\n        minBalance: undefined,\r\n        maxBalance: undefined,\r\n        managedBy: undefined,\r\n      };\r\n    },\r\n    [defaultBranchSystemId]\r\n  );\r\n\r\n  const form = useForm<CashAccountFormValues>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: buildFormValues(initialData),\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    form.reset(buildFormValues(initialData));\r\n  }, [initialData, buildFormValues, form]);\r\n\r\n  const accountType = form.watch('type');\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <form id=\"cash-account-form\" onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 pt-4 max-h-[70vh] overflow-y-auto px-1\">\r\n         <CashAccountFormField\r\n          control={form.control}\r\n          name=\"type\"\r\n          render={({ field }) => (\r\n            <FormItem className=\"space-y-3\">\r\n              <FormLabel>Loại tài khoản</FormLabel>\r\n              <FormControl>\r\n                <RadioGroup\r\n                  onValueChange={field.onChange}\r\n                  value={field.value}\r\n                  className=\"flex space-x-4\"\r\n                >\r\n                  <FormItem className=\"flex items-center space-x-2 space-y-0\">\r\n                    <FormControl>\r\n                      <RadioGroupItem value=\"cash\" />\r\n                    </FormControl>\r\n                    <FormLabel className=\"font-normal\">Tiền mặt</FormLabel>\r\n                  </FormItem>\r\n                  <FormItem className=\"flex items-center space-x-2 space-y-0\">\r\n                    <FormControl>\r\n                      <RadioGroupItem value=\"bank\" />\r\n                    </FormControl>\r\n                    <FormLabel className=\"font-normal\">Ngân hàng</FormLabel>\r\n                  </FormItem>\r\n                </RadioGroup>\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )}\r\n        />\r\n        <CashAccountFormField control={form.control} name=\"name\" render={({ field }) => (\r\n          <FormItem><FormLabel>Tên tài khoản <span className=\"text-destructive\">*</span></FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n        <CashAccountFormField control={form.control} name=\"id\" render={({ field }) => (\r\n          <FormItem><FormLabel>Mã tài khoản <span className=\"text-destructive\">*</span></FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n        <CashAccountFormField control={form.control} name=\"branchSystemId\" render={({ field }) => (\r\n            <FormItem>\r\n                <FormLabel>Thuộc chi nhánh</FormLabel>\r\n                <Select onValueChange={field.onChange} value={field.value ?? ''}>\r\n                    <FormControl><SelectTrigger><SelectValue placeholder=\"Chọn chi nhánh\" /></SelectTrigger></FormControl>\r\n                    <SelectContent>{branches.map(b => <SelectItem key={b.systemId} value={b.systemId}>{b.name}</SelectItem>)}</SelectContent>\r\n                </Select>\r\n                <FormMessage />\r\n            </FormItem>\r\n        )} />\r\n        {accountType === 'bank' && (\r\n          <>\r\n            <CashAccountFormField control={form.control} name=\"bankName\" render={({ field }) => (\r\n              <FormItem><FormLabel>Tên ngân hàng</FormLabel><FormControl><Input {...field} value={field.value ?? ''} placeholder=\"Vietcombank, ACB...\" /></FormControl><FormMessage /></FormItem>\r\n            )} />\r\n            <CashAccountFormField control={form.control} name=\"bankCode\" render={({ field }) => (\r\n              <FormItem><FormLabel>Mã ngân hàng</FormLabel><FormControl><Input {...field} value={field.value ?? ''} placeholder=\"VCB, ACB...\" /></FormControl><FormMessage /></FormItem>\r\n            )} />\r\n            <CashAccountFormField control={form.control} name=\"bankAccountNumber\" render={({ field }) => (\r\n              <FormItem><FormLabel>Số tài khoản ngân hàng</FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n            )} />\r\n            <CashAccountFormField control={form.control} name=\"accountHolder\" render={({ field }) => (\r\n              <FormItem><FormLabel>Chủ tài khoản</FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n            )} />\r\n            <CashAccountFormField control={form.control} name=\"bankBranch\" render={({ field }) => (\r\n              <FormItem><FormLabel>Chi nhánh ngân hàng</FormLabel><FormControl><Input {...field} value={field.value ?? ''} /></FormControl><FormMessage /></FormItem>\r\n            )} />\r\n          </>\r\n        )}\r\n        <CashAccountFormField control={form.control} name=\"initialBalance\" render={({ field }) => (\r\n          <FormItem><FormLabel>Số dư ban đầu</FormLabel><FormControl><CurrencyInput value={field.value ?? 0} onChange={field.onChange} disabled={!!initialData} /></FormControl><FormMessage /></FormItem>\r\n        )} />\r\n        \r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <CashAccountFormField control={form.control} name=\"minBalance\" render={({ field }) => (\r\n            <FormItem><FormLabel>Số dư tối thiểu</FormLabel><FormControl><CurrencyInput value={field.value ?? 0} onChange={field.onChange} placeholder=\"0\" /></FormControl><FormDescription>Cảnh báo khi dưới mức này</FormDescription><FormMessage /></FormItem>\r\n          )} />\r\n          <CashAccountFormField control={form.control} name=\"maxBalance\" render={({ field }) => (\r\n            <FormItem><FormLabel>Số dư tối đa</FormLabel><FormControl><CurrencyInput value={field.value ?? 0} onChange={field.onChange} placeholder=\"0\" /></FormControl><FormDescription>Cảnh báo khi vượt mức này</FormDescription><FormMessage /></FormItem>\r\n          )} />\r\n        </div>\r\n        \r\n        <CashAccountFormField control={form.control} name=\"isActive\" render={({ field }) => (\r\n          <FormItem className=\"flex flex-row items-center justify-between rounded-lg border border-border p-3\">\r\n            <div className=\"space-y-0.5\">\r\n              <FormLabel>Trạng thái hoạt động</FormLabel>\r\n              <FormDescription>Cho phép sử dụng tài khoản quỹ này</FormDescription>\r\n            </div>\r\n            <FormControl>\r\n              <Switch checked={field.value} onCheckedChange={field.onChange} />\r\n            </FormControl>\r\n          </FormItem>\r\n        )} />\r\n      </form>\r\n    </Form>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9819, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/cash-accounts/page-content.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Plus, MoreHorizontal } from \"lucide-react\";\r\nimport { useCashbookStore } from \"../../cashbook/store\";\r\nimport { useReceiptStore } from \"../../receipts/store\";\r\nimport { usePaymentStore } from \"../../payments/store\";\r\nimport { useBranchStore } from \"../branches/store\";\r\nimport type { CashAccount } from \"../../cashbook/types\";\r\nimport { CashAccountForm, type CashAccountFormValues } from \"./form\";\r\nimport { Button } from \"../../../components/ui/button\";\r\nimport { Switch } from \"../../../components/ui/switch\";\r\nimport { Dialog, DialogContent, DialogFooter, DialogHeader, DialogTitle } from \"../../../components/ui/dialog\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"../../../components/ui/alert-dialog\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../../components/ui/table\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuLabel, DropdownMenuSeparator, DropdownMenuTrigger } from \"../../../components/ui/dropdown-menu\";\r\nimport { Badge } from \"../../../components/ui/badge\";\r\nimport { toast } from \"sonner\";\r\nimport { asBusinessId, asSystemId, type SystemId } from \"../../../lib/id-types\";\r\nimport { SettingsActionButton } from \"../../../components/settings/SettingsActionButton\";\r\nimport type { RegisterTabActions } from \"../use-tab-action-registry\";\r\n\r\nconst formatCurrency = (value: number) => new Intl.NumberFormat('vi-VN').format(value);\r\n\r\ntype CashAccountsPageContentProps = {\r\n  isActive: boolean;\r\n  onRegisterActions: RegisterTabActions;\r\n};\r\n\r\nexport function CashAccountsPageContent({ isActive, onRegisterActions }: CashAccountsPageContentProps) {\r\n  const { accounts: data, add, update, remove, setDefault } = useCashbookStore();\r\n  const { data: receipts } = useReceiptStore();\r\n  const { data: payments } = usePaymentStore();\r\n  const { data: branches } = useBranchStore();\r\n  \r\n  // Tính số dư hiện tại cho mỗi tài khoản\r\n  const accountsWithBalance = React.useMemo(() => {\r\n    return data.map(account => {\r\n      const accountReceipts = receipts.filter(r => r.accountSystemId === account.systemId);\r\n      const accountPayments = payments.filter(p => p.accountSystemId === account.systemId);\r\n      \r\n      const totalIn = accountReceipts.reduce((sum, r) => sum + r.amount, 0);\r\n      const totalOut = accountPayments.reduce((sum, p) => sum + p.amount, 0);\r\n      const currentBalance = account.initialBalance + totalIn - totalOut;\r\n      \r\n      // Kiểm tra cảnh báo\r\n      const isLowBalance = account.minBalance && currentBalance < account.minBalance;\r\n      const isHighBalance = account.maxBalance && currentBalance > account.maxBalance;\r\n      \r\n      return { ...account, currentBalance, isLowBalance, isHighBalance };\r\n    });\r\n  }, [data, receipts, payments]);\r\n  \r\n  const [isFormOpen, setIsFormOpen] = React.useState(false);\r\n  const [editingItem, setEditingItem] = React.useState<CashAccount | null>(null);\r\n  const [isAlertOpen, setIsAlertOpen] = React.useState(false);\r\n  const [idToDelete, setIdToDelete] = React.useState<SystemId | null>(null);\r\n  \r\n  const handleAddNew = React.useCallback(() => {\r\n    setEditingItem(null);\r\n    setIsFormOpen(true);\r\n  }, []);\r\n\r\n  const handleEdit = React.useCallback((item: CashAccount) => { setEditingItem(item); setIsFormOpen(true); }, []);\r\n  const handleDeleteRequest = (systemId: SystemId) => { \r\n    setIdToDelete(systemId);\r\n    setIsAlertOpen(true);\r\n  };\r\n  \r\n  const handleToggleStatus = (item: CashAccount, isActive: boolean) => {\r\n    update(item.systemId, { ...item, isActive });\r\n    toast.success(isActive ? `Đã kích hoạt \"${item.name}\"` : `Đã tắt \"${item.name}\"`);\r\n  };\r\n  \r\n  const handleToggleDefault = React.useCallback((item: CashAccount, checked: boolean) => {\r\n    if (checked) {\r\n      setDefault(item.systemId);\r\n      toast.success(`Đã đặt \"${item.name}\" làm mặc định`);\r\n    } else {\r\n      const otherAccounts = data.filter(a => a.systemId !== item.systemId);\r\n      if (otherAccounts.length > 0) {\r\n        setDefault(otherAccounts[0].systemId);\r\n        toast.success(`Đã đặt \"${otherAccounts[0].name}\" làm mặc định`);\r\n      } else {\r\n        toast.error('Phải có ít nhất một tài khoản mặc định');\r\n      }\r\n    }\r\n  }, [data, setDefault]);\r\n  \r\n  const handleSetDefault = (item: CashAccount) => {\r\n    setDefault(item.systemId);\r\n    toast.success(`Đã đặt \"${item.name}\" làm mặc định`);\r\n  };\r\n  \r\n  const confirmDelete = () => {\r\n    if (idToDelete) {\r\n      const item = data.find(a => a.systemId === idToDelete);\r\n      remove(idToDelete);\r\n      toast.success(`Đã xóa \"${item?.name}\"`);\r\n    }\r\n    setIsAlertOpen(false);\r\n    setIdToDelete(null);\r\n  };\r\n  \r\n  const normalizeFormValues = (values: CashAccountFormValues): Omit<CashAccount, 'systemId'> => {\r\n    const sanitizedId = values.id.trim().toUpperCase();\r\n    const sanitizedName = values.name.trim();\r\n    const branchId = values.branchSystemId ? asSystemId(values.branchSystemId) : undefined;\r\n    const managerId = values.managedBy ? asSystemId(values.managedBy) : undefined;\r\n\r\n    const trimmed = (input?: string) => {\r\n      if (!input) return undefined;\r\n      const next = input.trim();\r\n      return next.length > 0 ? next : undefined;\r\n    };\r\n\r\n    const bankAccountNumber = trimmed(values.bankAccountNumber);\r\n    const bankBranch = trimmed(values.bankBranch);\r\n    const bankName = trimmed(values.bankName);\r\n    const bankCode = trimmed(values.bankCode);\r\n    const accountHolder = trimmed(values.accountHolder);\r\n\r\n    return {\r\n      id: asBusinessId(sanitizedId),\r\n      name: sanitizedName,\r\n      initialBalance: values.initialBalance,\r\n      type: values.type,\r\n      isActive: values.isActive,\r\n      ...(values.isDefault !== undefined ? { isDefault: values.isDefault } : {}),\r\n      ...(bankAccountNumber ? { bankAccountNumber } : {}),\r\n      ...(bankBranch ? { bankBranch } : {}),\r\n      ...(bankName ? { bankName } : {}),\r\n      ...(bankCode ? { bankCode } : {}),\r\n      ...(accountHolder ? { accountHolder } : {}),\r\n      ...(values.minBalance !== undefined ? { minBalance: values.minBalance } : {}),\r\n      ...(values.maxBalance !== undefined ? { maxBalance: values.maxBalance } : {}),\r\n      ...(branchId ? { branchSystemId: branchId } : {}),\r\n      ...(managerId ? { managedBy: managerId } : {}),\r\n    };\r\n  };\r\n\r\n  const handleFormSubmit = (values: CashAccountFormValues) => {\r\n    try {\r\n      const payload = normalizeFormValues(values);\r\n      if (editingItem) {\r\n        update(editingItem.systemId, { ...editingItem, ...payload });\r\n        toast.success(\"Cập nhật thành công\");\r\n      } else {\r\n        add(payload);\r\n        toast.success(\"Thêm mới thành công\");\r\n      }\r\n      setIsFormOpen(false);\r\n    } catch (error) {\r\n      toast.error(\"Có lỗi xảy ra\", {\r\n        description: error instanceof Error ? error.message : \"Lỗi không xác định\",\r\n      });\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (!isActive) {\r\n      return;\r\n    }\r\n\r\n    onRegisterActions([\r\n      <SettingsActionButton key=\"add-cash-account\" onClick={handleAddNew}>\r\n        <Plus className=\"mr-2 h-4 w-4\" /> Thêm tài khoản quỹ\r\n      </SettingsActionButton>,\r\n    ]);\r\n  }, [handleAddNew, isActive, onRegisterActions]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-md border\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>Mã tài khoản</TableHead>\r\n              <TableHead>Tên tài khoản</TableHead>\r\n              <TableHead>Loại</TableHead>\r\n              <TableHead>Ngân hàng</TableHead>\r\n              <TableHead>Chi nhánh</TableHead>\r\n              <TableHead className=\"text-right\">Số dư hiện tại</TableHead>\r\n              <TableHead>Mặc định</TableHead>\r\n              <TableHead>Trạng thái</TableHead>\r\n              <TableHead className=\"text-right\">Thao tác</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n          <TableBody>\r\n            {accountsWithBalance.length === 0 ? (\r\n              <TableRow>\r\n                <TableCell colSpan={9} className=\"h-24 text-center\">\r\n                  Chưa có dữ liệu\r\n                </TableCell>\r\n              </TableRow>\r\n            ) : (\r\n              accountsWithBalance.map((item) => {\r\n                const branch = branches.find(b => b.systemId === item.branchSystemId);\r\n                return (\r\n                  <TableRow key={item.systemId}>\r\n                    <TableCell className=\"font-medium\">{item.id}</TableCell>\r\n                    <TableCell className=\"font-medium\">{item.name}</TableCell>\r\n                    <TableCell>\r\n                      <Badge variant={item.type === 'cash' ? 'default' : 'secondary'}>\r\n                        {item.type === 'cash' ? 'Tiền mặt' : 'Ngân hàng'}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell className=\"text-sm\">\r\n                      {item.type === 'bank' && item.bankName ? (\r\n                        <div>\r\n                          <div className=\"font-medium\">{item.bankName}</div>\r\n                          {item.bankAccountNumber && (\r\n                            <div className=\"text-xs text-muted-foreground\">\r\n                              {item.bankAccountNumber}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ) : '—'}\r\n                    </TableCell>\r\n                    <TableCell className=\"text-sm text-muted-foreground\">\r\n                      {branch?.name || '—'}\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <div className=\"font-medium\">\r\n                        {formatCurrency(item.currentBalance)}\r\n                      </div>\r\n                      {(item.isLowBalance || item.isHighBalance) && (\r\n                        <div className=\"text-xs text-orange-600\">\r\n                          {item.isLowBalance && '⚠ Dưới mức tối thiểu'}\r\n                          {item.isHighBalance && '⚠ Vượt mức tối đa'}\r\n                        </div>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Switch \r\n                        checked={item.isDefault} \r\n                        onCheckedChange={(checked) => handleToggleDefault(item, checked)}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Switch \r\n                        checked={item.isActive} \r\n                        onCheckedChange={(checked) => handleToggleStatus(item, checked)}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                          <Button variant=\"ghost\" className=\"h-8 w-8 p-0\">\r\n                            <span className=\"sr-only\">Mở menu</span>\r\n                            <MoreHorizontal className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\">\r\n                          <DropdownMenuLabel>Thao tác</DropdownMenuLabel>\r\n                          <DropdownMenuSeparator />\r\n                          <DropdownMenuItem onClick={() => handleEdit(item)}>\r\n                            Chỉnh sửa\r\n                          </DropdownMenuItem>\r\n                          {!item.isDefault && (\r\n                            <DropdownMenuItem onClick={() => handleSetDefault(item)}>\r\n                              Đặt làm mặc định\r\n                            </DropdownMenuItem>\r\n                          )}\r\n                          <DropdownMenuItem\r\n                            onClick={() => handleDeleteRequest(item.systemId)}\r\n                            className=\"text-destructive\"\r\n                          >\r\n                            Xóa\r\n                          </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                      </DropdownMenu>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                );\r\n              })\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n      \r\n      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{editingItem ? 'Cập nhật tài khoản quỹ' : 'Thêm tài khoản quỹ'}</DialogTitle>\r\n          </DialogHeader>\r\n          <CashAccountForm initialData={editingItem} onSubmit={handleFormSubmit} />\r\n          <DialogFooter>\r\n            <Button type=\"button\" variant=\"outline\" onClick={() => setIsFormOpen(false)}>Hủy</Button>\r\n            <Button type=\"submit\" form=\"cash-account-form\">Lưu</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <AlertDialog open={isAlertOpen} onOpenChange={setIsAlertOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Xác nhận xóa?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Hành động này không thể hoàn tác. Tài khoản quỹ sẽ bị xóa vĩnh viễn.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Hủy</AlertDialogCancel>\r\n            <AlertDialogAction onClick={confirmDelete}>Xóa</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10563, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/use-tab-action-registry.ts"],"sourcesContent":["import * as React from 'react';\r\n\r\nexport type RegisterTabActions = (actions?: React.ReactNode[]) => void;\r\n\r\nexport type TabActionRegistry = {\r\n  headerActions: React.ReactNode[];\r\n  registerActions: (tabValue: string) => RegisterTabActions;\r\n  setHeaderActions: React.Dispatch<React.SetStateAction<React.ReactNode[]>>;\r\n};\r\n\r\nexport function useTabActionRegistry(activeTab: string): TabActionRegistry {\r\n  const [headerActions, setHeaderActions] = React.useState<React.ReactNode[]>([]);\r\n\r\n  const registerActions = React.useCallback(\r\n    (tabValue: string) => (actions?: React.ReactNode[]) => {\r\n      if (tabValue === activeTab) {\r\n        setHeaderActions(actions ?? []);\r\n      }\r\n    },\r\n    [activeTab],\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    setHeaderActions([]);\r\n  }, [activeTab]);\r\n\r\n  return {\r\n    headerActions,\r\n    registerActions,\r\n    setHeaderActions,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;AAUO,SAAS,qBAAqB,SAAiB;;IACpD,MAAM,CAAC,eAAe,iBAAiB,GAAG,yKAAc,CAAoB,EAAE;IAE9E,MAAM,kBAAkB,4KAAiB;6DACvC,CAAC;qEAAqB,CAAC;oBACrB,IAAI,aAAa,WAAW;wBAC1B,iBAAiB,WAAW,EAAE;oBAChC;gBACF;;4DACA;QAAC;KAAU;IAGb,0KAAe;0CAAC;YACd,iBAAiB,EAAE;QACrB;yCAAG;QAAC;KAAU;IAEd,OAAO;QACL;QACA;QACA;IACF;AACF;GArBgB"}},
    {"offset": {"line": 10605, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/components/settings/SettingsVerticalTabs.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Tabs, TabsList, TabsTrigger } from \"../ui/tabs\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\ntype SettingsVerticalTabsItem = {\r\n  value: string;\r\n  label: React.ReactNode;\r\n  disabled?: boolean;\r\n  className?: string;\r\n};\r\n\r\ntype SettingsVerticalTabsProps = {\r\n  value: string;\r\n  onValueChange: (value: string) => void;\r\n  tabs: SettingsVerticalTabsItem[];\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  listClassName?: string;\r\n  contentWrapperClassName?: string;\r\n};\r\n\r\n/**\r\n * Shared layout for Settings pages that need sticky vertical tabs.\r\n * Uses shadcn/ui Tabs component with custom styling for vertical layout on desktop.\r\n */\r\nexport function SettingsVerticalTabs({\r\n  value,\r\n  onValueChange,\r\n  tabs,\r\n  children,\r\n  className,\r\n  listClassName,\r\n  contentWrapperClassName,\r\n}: SettingsVerticalTabsProps) {\r\n  return (\r\n    <Tabs \r\n      value={value} \r\n      onValueChange={onValueChange} \r\n      className={cn(\"flex flex-col md:flex-row md:gap-8\", className)}\r\n    >\r\n      {/* Mobile: horizontal scrollable tabs, Desktop: vertical sidebar */}\r\n      <TabsList\r\n        className={cn(\r\n          // Base styles\r\n          \"h-auto w-full justify-start rounded-lg bg-muted p-1\",\r\n          // Mobile: horizontal with scroll\r\n          \"flex flex-row gap-1 overflow-x-auto\",\r\n          // Desktop: vertical sidebar\r\n          \"md:flex-col md:w-[200px] md:shrink-0 md:bg-transparent md:p-0\",\r\n          \"md:sticky md:top-6 md:self-start\",\r\n          listClassName,\r\n        )}\r\n      >\r\n        {tabs.map((tab) => (\r\n          <TabsTrigger\r\n            key={tab.value}\r\n            value={tab.value}\r\n            disabled={tab.disabled}\r\n            className={cn(\r\n              // Mobile: compact horizontal tabs\r\n              \"flex-shrink-0 px-3 py-1.5 text-sm text-foreground\",\r\n              // Desktop: full-width vertical tabs\r\n              \"md:w-full md:justify-start md:px-4 md:py-2\",\r\n              \"md:data-[state=active]:bg-muted md:data-[state=active]:shadow-none\",\r\n              tab.className\r\n            )}\r\n          >\r\n            {tab.label}\r\n          </TabsTrigger>\r\n        ))}\r\n      </TabsList>\r\n      \r\n      {/* Content area */}\r\n      <div className={cn(\r\n        \"flex-1 min-w-0 mt-4 md:mt-0\",\r\n        contentWrapperClassName\r\n      )}>\r\n        {children}\r\n      </div>\r\n    </Tabs>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAuBO,SAAS,qBAAqB,EACnC,KAAK,EACL,aAAa,EACb,IAAI,EACJ,QAAQ,EACR,SAAS,EACT,aAAa,EACb,uBAAuB,EACG;IAC1B,qBACE,6LAAC,oIAAI;QACH,OAAO;QACP,eAAe;QACf,WAAW,IAAA,qHAAE,EAAC,sCAAsC;;0BAGpD,6LAAC,wIAAQ;gBACP,WAAW,IAAA,qHAAE,EACX,cAAc;gBACd,uDACA,iCAAiC;gBACjC,uCACA,4BAA4B;gBAC5B,iEACA,oCACA;0BAGD,KAAK,GAAG,CAAC,CAAC,oBACT,6LAAC,2IAAW;wBAEV,OAAO,IAAI,KAAK;wBAChB,UAAU,IAAI,QAAQ;wBACtB,WAAW,IAAA,qHAAE,EACX,kCAAkC;wBAClC,qDACA,oCAAoC;wBACpC,8CACA,sEACA,IAAI,SAAS;kCAGd,IAAI,KAAK;uBAZL,IAAI,KAAK;;;;;;;;;;0BAkBpB,6LAAC;gBAAI,WAAW,IAAA,qHAAE,EAChB,+BACA;0BAEC;;;;;;;;;;;;AAIT;KAxDgB"}},
    {"offset": {"line": 10668, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/settings/payment-settings-page.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../../components/ui/card';\r\nimport { TabsContent } from '../../components/ui/tabs';\r\nimport { useSettingsPageHeader } from './use-settings-page-header';\r\nimport { ReceiptTypesPageContent } from './receipt-types/page-content';\r\nimport { PaymentTypesPageContent } from './payments/types/page-content';\r\nimport { PaymentMethodsPageContent } from './payments/methods/page-content';\r\nimport { TargetGroupsPageContent } from './target-groups/page-content';\r\nimport { CashAccountsPageContent } from './cash-accounts/page-content';\r\nimport { useTabActionRegistry } from './use-tab-action-registry';\r\nimport { SettingsVerticalTabs } from '../../components/settings/SettingsVerticalTabs';\r\n\r\nexport function PaymentSettingsPage() {\r\n  const [activeTab, setActiveTab] = React.useState('receipt-types');\r\n  const { headerActions, registerActions } = useTabActionRegistry(activeTab);\r\n  const registerReceiptTypesActions = React.useMemo(() => registerActions('receipt-types'), [registerActions]);\r\n  const registerPaymentTypesActions = React.useMemo(() => registerActions('payment-types'), [registerActions]);\r\n  const registerPaymentMethodsActions = React.useMemo(() => registerActions('payment-methods'), [registerActions]);\r\n  const registerCashAccountsActions = React.useMemo(() => registerActions('cash-accounts'), [registerActions]);\r\n  const registerTargetGroupsActions = React.useMemo(() => registerActions('target-groups'), [registerActions]);\r\n\r\n  useSettingsPageHeader({\r\n    title: 'Cài đặt thanh toán',\r\n    subtitle: 'Quản lý phiếu thu chi và hình thức thanh toán',\r\n    actions: headerActions,\r\n  });\r\n\r\n  const tabs = React.useMemo(\r\n    () => [\r\n      { value: 'receipt-types', label: 'Loại phiếu thu' },\r\n      { value: 'payment-types', label: 'Loại phiếu chi' },\r\n      { value: 'payment-methods', label: 'Hình thức thanh toán' },\r\n      { value: 'cash-accounts', label: 'Tài khoản quỹ' },\r\n      { value: 'target-groups', label: 'Nhóm đối tượng' },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  return (\r\n    <SettingsVerticalTabs value={activeTab} onValueChange={setActiveTab} tabs={tabs}>\r\n        <TabsContent value=\"receipt-types\" className=\"mt-0\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Loại phiếu thu</CardTitle>\r\n              <CardDescription>\r\n                Quản lý các loại phiếu thu: Thu từ khách hàng, Thu khác...\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <ReceiptTypesPageContent\r\n                isActive={activeTab === 'receipt-types'}\r\n                onRegisterActions={registerReceiptTypesActions}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"payment-types\" className=\"mt-0\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Loại phiếu chi</CardTitle>\r\n              <CardDescription>\r\n                Quản lý các loại phiếu chi: Chi cho nhà cung cấp, Chi lương, Chi khác...\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <PaymentTypesPageContent\r\n                isActive={activeTab === 'payment-types'}\r\n                onRegisterActions={registerPaymentTypesActions}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"payment-methods\" className=\"mt-0\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Hình thức thanh toán</CardTitle>\r\n              <CardDescription>\r\n                Quản lý các hình thức thanh toán: Tiền mặt, Chuyển khoản, Ví điện tử...\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <PaymentMethodsPageContent\r\n                isActive={activeTab === 'payment-methods'}\r\n                onRegisterActions={registerPaymentMethodsActions}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"cash-accounts\" className=\"mt-0\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Tài khoản quỹ</CardTitle>\r\n              <CardDescription>\r\n                Quản lý các tài khoản quỹ tiền mặt và ngân hàng của doanh nghiệp\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <CashAccountsPageContent\r\n                isActive={activeTab === 'cash-accounts'}\r\n                onRegisterActions={registerCashAccountsActions}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"target-groups\" className=\"mt-0\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Nhóm đối tượng</CardTitle>\r\n              <CardDescription>\r\n                Quản lý các nhóm đối tượng: Khách hàng, Nhà cung cấp, Nhân viên, Đối tác...\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <TargetGroupsPageContent\r\n                isActive={activeTab === 'target-groups'}\r\n                onRegisterActions={registerTargetGroupsActions}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n    </SettingsVerticalTabs>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}