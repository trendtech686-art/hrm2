{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/shipments/api/shipments-api.ts"],"sourcesContent":["/**\r\n * Shipments API Layer\r\n * Handles all shipment-related API calls\r\n */\r\n\r\nimport type { Shipment } from '../types';\r\n\r\nexport interface ShipmentFilters {\r\n  page?: number;\r\n  limit?: number;\r\n  search?: string;\r\n  status?: string;\r\n  orderId?: string;\r\n  carrier?: string;\r\n  reconciliationStatus?: string;\r\n  fromDate?: string;\r\n  toDate?: string;\r\n}\r\n\r\nexport interface ShipmentResponse {\r\n  data: Shipment[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n}\r\n\r\nexport interface ShipmentCreateInput {\r\n  systemId?: string;\r\n  id?: string;\r\n  packagingSystemId: string;\r\n  orderSystemId: string;\r\n  orderId: string;\r\n  trackingCode?: string;\r\n  carrier?: string;\r\n  service?: string;\r\n  deliveryStatus?: string;\r\n  printStatus?: string;\r\n  shippingFeeToPartner?: number;\r\n  codAmount?: number;\r\n  payer?: string;\r\n}\r\n\r\nexport interface ShipmentUpdateInput extends Partial<ShipmentCreateInput> {\r\n  reconciliationStatus?: string;\r\n  partnerStatus?: string;\r\n  dispatchedAt?: string;\r\n  deliveredAt?: string;\r\n}\r\n\r\nconst BASE_URL = '/api/shipments';\r\n\r\n/**\r\n * Fetch shipments with filters\r\n */\r\nexport async function fetchShipments(\r\n  filters: ShipmentFilters = {}\r\n): Promise<ShipmentResponse> {\r\n  const params = new URLSearchParams();\r\n  \r\n  if (filters.page) params.set('page', String(filters.page));\r\n  if (filters.limit) params.set('limit', String(filters.limit));\r\n  if (filters.search) params.set('search', filters.search);\r\n  if (filters.status) params.set('status', filters.status);\r\n  if (filters.orderId) params.set('orderId', filters.orderId);\r\n  if (filters.carrier) params.set('carrier', filters.carrier);\r\n  if (filters.reconciliationStatus) params.set('reconciliationStatus', filters.reconciliationStatus);\r\n  if (filters.fromDate) params.set('fromDate', filters.fromDate);\r\n  if (filters.toDate) params.set('toDate', filters.toDate);\r\n\r\n  const url = params.toString() ? `${BASE_URL}?${params}` : BASE_URL;\r\n  const response = await fetch(url);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch shipments');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Fetch single shipment by ID\r\n */\r\nexport async function fetchShipmentById(\r\n  systemId: string\r\n): Promise<Shipment> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`);\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch shipment');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Create new shipment\r\n */\r\nexport async function createShipment(\r\n  data: ShipmentCreateInput\r\n): Promise<Shipment> {\r\n  const response = await fetch(BASE_URL, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.error || 'Failed to create shipment');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Update shipment\r\n */\r\nexport async function updateShipment(\r\n  systemId: string,\r\n  data: ShipmentUpdateInput\r\n): Promise<Shipment> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'PATCH',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(data),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json().catch(() => ({}));\r\n    throw new Error(error.error || 'Failed to update shipment');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Delete shipment\r\n */\r\nexport async function deleteShipment(systemId: string): Promise<void> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}`, {\r\n    method: 'DELETE',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to delete shipment');\r\n  }\r\n}\r\n\r\n/**\r\n * Update delivery status\r\n */\r\nexport async function updateDeliveryStatus(\r\n  systemId: string,\r\n  status: string,\r\n  timestamp?: string\r\n): Promise<Shipment> {\r\n  return updateShipment(systemId, {\r\n    deliveryStatus: status,\r\n    ...(status === 'Đã giao hàng' && { deliveredAt: timestamp || new Date().toISOString() }),\r\n    ...(status === 'Đang giao hàng' && { dispatchedAt: timestamp || new Date().toISOString() }),\r\n  });\r\n}\r\n\r\n/**\r\n * Mark shipment as reconciled\r\n */\r\nexport async function reconcileShipment(\r\n  systemId: string\r\n): Promise<Shipment> {\r\n  return updateShipment(systemId, {\r\n    reconciliationStatus: 'Đã đối soát',\r\n  });\r\n}\r\n\r\n/**\r\n * Bulk reconcile shipments\r\n */\r\nexport async function bulkReconcileShipments(\r\n  systemIds: string[]\r\n): Promise<{ success: number; failed: number }> {\r\n  const response = await fetch(`${BASE_URL}/bulk-reconcile`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ systemIds }),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to bulk reconcile shipments');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Update tracking info from carrier\r\n */\r\nexport async function syncTrackingInfo(\r\n  systemId: string\r\n): Promise<Shipment> {\r\n  const response = await fetch(`${BASE_URL}/${systemId}/sync-tracking`, {\r\n    method: 'POST',\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to sync tracking info');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Print shipping label\r\n */\r\nexport async function printShippingLabel(\r\n  systemIds: string[]\r\n): Promise<{ url: string }> {\r\n  const response = await fetch(`${BASE_URL}/print-labels`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ systemIds }),\r\n  });\r\n  \r\n  if (!response.ok) {\r\n    throw new Error('Failed to generate shipping labels');\r\n  }\r\n  \r\n  return response.json();\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/shipments/hooks/use-shipments.ts"],"sourcesContent":["/**\r\n * Shipments React Query Hooks\r\n * Provides data fetching and mutations for shipment management\r\n */\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  fetchShipments,\r\n  fetchShipmentById,\r\n  createShipment,\r\n  updateShipment,\r\n  deleteShipment,\r\n  updateDeliveryStatus,\r\n  reconcileShipment,\r\n  bulkReconcileShipments,\r\n  syncTrackingInfo,\r\n  printShippingLabel,\r\n  type ShipmentFilters,\r\n  type ShipmentCreateInput,\r\n  type ShipmentUpdateInput,\r\n} from '../api/shipments-api';\r\n\r\n// Query keys factory\r\nexport const shipmentKeys = {\r\n  all: ['shipments'] as const,\r\n  lists: () => [...shipmentKeys.all, 'list'] as const,\r\n  list: (filters: ShipmentFilters) => [...shipmentKeys.lists(), filters] as const,\r\n  details: () => [...shipmentKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...shipmentKeys.details(), id] as const,\r\n  byOrder: (orderId: string) => [...shipmentKeys.all, 'order', orderId] as const,\r\n};\r\n\r\n/**\r\n * Hook to fetch shipments with filters\r\n */\r\nexport function useShipments(filters: ShipmentFilters = {}) {\r\n  return useQuery({\r\n    queryKey: shipmentKeys.list(filters),\r\n    queryFn: () => fetchShipments(filters),\r\n    staleTime: 1000 * 60, // 1 minute - shipments change frequently\r\n  });\r\n}\r\n\r\n/**\r\n * Hook to fetch single shipment\r\n */\r\nexport function useShipmentById(systemId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: shipmentKeys.detail(systemId!),\r\n    queryFn: () => fetchShipmentById(systemId!),\r\n    enabled: !!systemId,\r\n    staleTime: 1000 * 30, // 30 seconds\r\n  });\r\n}\r\n\r\n/**\r\n * Hook to fetch shipments for a specific order\r\n */\r\nexport function useShipmentsByOrder(orderId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: shipmentKeys.byOrder(orderId!),\r\n    queryFn: () => fetchShipments({ orderId: orderId!, limit: 50 }),\r\n    enabled: !!orderId,\r\n    staleTime: 1000 * 60,\r\n  });\r\n}\r\n\r\ninterface MutationCallbacks {\r\n  onSuccess?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\n/**\r\n * Hook providing shipment mutations\r\n */\r\nexport function useShipmentMutations(options: MutationCallbacks = {}) {\r\n  const queryClient = useQueryClient();\r\n\r\n  const invalidateShipments = () => {\r\n    queryClient.invalidateQueries({ queryKey: shipmentKeys.all });\r\n  };\r\n\r\n  const create = useMutation({\r\n    mutationFn: (data: ShipmentCreateInput) => createShipment(data),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const update = useMutation({\r\n    mutationFn: ({ systemId, data }: { systemId: string; data: ShipmentUpdateInput }) =>\r\n      updateShipment(systemId, data),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const remove = useMutation({\r\n    mutationFn: (systemId: string) => deleteShipment(systemId),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const updateStatus = useMutation({\r\n    mutationFn: ({ systemId, status, timestamp }: { \r\n      systemId: string; \r\n      status: string; \r\n      timestamp?: string;\r\n    }) => updateDeliveryStatus(systemId, status, timestamp),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const reconcile = useMutation({\r\n    mutationFn: (systemId: string) => reconcileShipment(systemId),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const bulkReconcile = useMutation({\r\n    mutationFn: (systemIds: string[]) => bulkReconcileShipments(systemIds),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const syncTracking = useMutation({\r\n    mutationFn: (systemId: string) => syncTrackingInfo(systemId),\r\n    onSuccess: () => {\r\n      invalidateShipments();\r\n      options.onSuccess?.();\r\n    },\r\n    onError: options.onError,\r\n  });\r\n\r\n  const printLabels = useMutation({\r\n    mutationFn: (systemIds: string[]) => printShippingLabel(systemIds),\r\n    onError: options.onError,\r\n  });\r\n\r\n  return {\r\n    create,\r\n    update,\r\n    remove,\r\n    updateStatus,\r\n    reconcile,\r\n    bulkReconcile,\r\n    syncTracking,\r\n    printLabels,\r\n    isLoading:\r\n      create.isPending ||\r\n      update.isPending ||\r\n      remove.isPending ||\r\n      updateStatus.isPending ||\r\n      reconcile.isPending ||\r\n      bulkReconcile.isPending ||\r\n      syncTracking.isPending,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook to fetch pending shipments (not reconciled)\r\n */\r\nexport function usePendingShipments() {\r\n  return useShipments({ reconciliationStatus: 'Chưa đối soát' });\r\n}\r\n\r\n/**\r\n * Hook to fetch shipments in transit\r\n */\r\nexport function useShipmentsInTransit() {\r\n  return useShipments({ status: 'Đang giao hàng' });\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 407, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/shipments/hooks/use-all-shipments.ts"],"sourcesContent":["/**\r\n * useAllShipments - Convenience hook for components needing all shipments as flat array\r\n */\r\n\r\nimport { useShipments } from './use-shipments';\r\n\r\nexport function useAllShipments() {\r\n  const query = useShipments({});\r\n  \r\n  return {\r\n    data: query.data?.data || [],\r\n    isLoading: query.isLoading,\r\n    isError: query.isError,\r\n    error: query.error,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;CAEC,GAED;;;AAEO,SAAS;;IACd,MAAM,QAAQ,IAAA,qKAAY,EAAC,CAAC;IAE5B,OAAO;QACL,MAAM,MAAM,IAAI,EAAE,QAAQ,EAAE;QAC5B,WAAW,MAAM,SAAS;QAC1B,SAAS,MAAM,OAAO;QACtB,OAAO,MAAM,KAAK;IACpB;AACF;GATgB;;QACA,qKAAY"}},
    {"offset": {"line": 438, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/shipments/columns.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport Link from 'next/link';\r\nimport { formatDate, formatDateTime, formatDateTimeSeconds, formatDateCustom, parseDate, getCurrentDate } from '@/lib/date-utils';\r\nimport type { ShipmentView } from './types';\r\nimport type { OrderDeliveryStatus, OrderPrintStatus } from '../orders/types';\r\nimport type { ColumnDef } from '../../components/data-table/types';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Button } from '../../components/ui/button';\r\nimport { Checkbox } from '../../components/ui/checkbox';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '../../components/ui/dropdown-menu';\r\nimport { MoreHorizontal, Printer, FileText } from 'lucide-react';\r\nconst formatCurrency = (value?: number) => {\r\n    if (typeof value !== 'number' || isNaN(value)) return '-';\r\n    return new Intl.NumberFormat('vi-VN').format(value);\r\n};\r\n\r\n\r\n\r\nconst deliveryStatusVariants: Record<OrderDeliveryStatus, \"success\" | \"warning\" | \"secondary\" | \"default\" | \"destructive\"> = {\r\n  'Chờ đóng gói': 'secondary',\r\n  'Đã đóng gói': 'default',\r\n  'Chờ lấy hàng': 'warning',\r\n  'Đang giao hàng': 'warning',\r\n  'Đã giao hàng': 'success',\r\n  'Chờ giao lại': 'destructive',\r\n  'Đã hủy': 'destructive',\r\n};\r\n\r\nconst printStatusVariants: Record<OrderPrintStatus, \"success\" | \"secondary\"> = {\r\n  'Đã in': 'success',\r\n  'Chưa in': 'secondary',\r\n};\r\n\r\nexport const getColumns = (\r\n  onPrintDelivery?: (shipmentId: string) => void,\r\n  onPrintHandover?: (shipmentId: string) => void,\r\n  navigate?: (path: string) => void,\r\n): ColumnDef<ShipmentView>[] => [\r\n    {\r\n      id: \"select\",\r\n      header: ({ isAllPageRowsSelected, isSomePageRowsSelected, onToggleAll }) => (\r\n        <div className=\"flex items-center justify-center\">\r\n          <Checkbox\r\n            checked={isAllPageRowsSelected ? true : isSomePageRowsSelected ? \"indeterminate\" : false}\r\n            onCheckedChange={(value) => onToggleAll?.(!!value)}\r\n            aria-label=\"Select all\"\r\n          />\r\n        </div>\r\n      ),\r\n      cell: ({ isSelected, onToggleSelect }) => (\r\n        <div className=\"flex items-center justify-center\">\r\n          <Checkbox\r\n            checked={isSelected}\r\n            onCheckedChange={onToggleSelect}\r\n            aria-label=\"Select row\"\r\n          />\r\n        </div>\r\n      ),\r\n      size: 48,\r\n      meta: {\r\n        displayName: \"Chọn\",\r\n        sticky: \"left\",\r\n      },\r\n    },\r\n    { id: 'trackingCode', accessorKey: 'trackingCode', header: 'Mã vận đơn', cell: ({ row }) => <span className=\"font-mono\">{row.trackingCode || '-'}</span>, meta: { displayName: 'Mã vận đơn' } },\r\n    { id: 'id', accessorKey: 'id', header: 'Mã vận chuyển', cell: ({ row }) => <span className=\"font-mono text-primary\">{row.id}</span>, meta: { displayName: 'Mã vận chuyển' } },\r\n    { id: 'packagingDate', accessorKey: 'packagingDate', header: 'Ngày đóng gói', cell: ({ row }) => formatDate(row.packagingDate), meta: { displayName: 'Ngày đóng gói' } },\r\n    { id: 'customerName', accessorKey: 'customerName', header: 'Người nhận', cell: ({ row }) => row.customerName, meta: { displayName: 'Người nhận' } },\r\n    { id: 'customerPhone', accessorKey: 'customerPhone', header: 'SĐT người nhận', cell: ({ row }) => row.customerPhone, meta: { displayName: 'SĐT người nhận' } },\r\n    { id: 'carrier', accessorKey: 'carrier', header: 'Đối tác vận chuyển', cell: ({ row }) => row.carrier || '-', meta: { displayName: 'Đối tác vận chuyển' } },\r\n    { id: 'deliveryStatus', accessorKey: 'deliveryStatus', header: 'Trạng thái giao hàng', cell: ({ row }) => row.deliveryStatus ? <Badge variant={deliveryStatusVariants[row.deliveryStatus]}>{row.deliveryStatus}</Badge> : '-', meta: { displayName: 'Trạng thái giao hàng' } },\r\n    { id: 'shippingFeeToPartner', accessorKey: 'shippingFeeToPartner', header: 'Phí trả ĐTVC', cell: ({ row }) => formatCurrency(row.shippingFeeToPartner), meta: { displayName: 'Phí trả ĐTVC' } },\r\n    { id: 'codAmount', accessorKey: 'codAmount', header: 'Cần thu hộ COD', cell: ({ row }) => formatCurrency(row.codAmount), meta: { displayName: 'Cần thu hộ COD' } },\r\n    { id: 'reconciliationStatus', accessorKey: 'reconciliationStatus', header: 'Trạng thái đối soát', cell: ({ row }) => row.reconciliationStatus || '-', meta: { displayName: 'Trạng thái đối soát' } },\r\n    { id: 'createdAt', accessorKey: 'createdAt', header: 'Ngày tạo', cell: ({ row }) => formatDate(row.createdAt), meta: { displayName: 'Ngày tạo' } },\r\n    { id: 'cancelledAt', accessorKey: 'cancelledAt', header: 'Ngày hủy giao', cell: ({ row }) => formatDate(row.cancelledAt), meta: { displayName: 'Ngày hủy giao' } },\r\n    { id: 'partnerStatus', accessorKey: 'partnerStatus', header: 'Trạng thái đối tác', cell: ({ row }) => row.partnerStatus || '-', meta: { displayName: 'Trạng thái đối tác' } },\r\n    { id: 'payer', accessorKey: 'payer', header: 'Người trả phí', cell: ({ row }) => row.payer || '-', meta: { displayName: 'Người trả phí' } },\r\n    { id: 'packagingSystemId', accessorKey: 'packagingSystemId', header: 'Mã đóng gói', cell: ({ row }) => <Link href={`/packaging/${row.packagingSystemId}`} className=\"font-mono text-primary hover:underline\">{row.packagingSystemId}</Link>, meta: { displayName: 'Mã đóng gói' } },\r\n    { id: 'orderId', accessorKey: 'orderId', header: 'Mã đơn hàng', cell: ({ row }) => <Link href={`/orders/${row.orderSystemId}`} className=\"text-primary hover:underline\">{row.orderId}</Link>, meta: { displayName: 'Mã đơn hàng' } },\r\n    { id: 'printStatus', accessorKey: 'printStatus', header: 'Trạng thái in', cell: ({ row }) => <Badge variant={printStatusVariants[row.printStatus]}>{row.printStatus}</Badge>, meta: { displayName: 'Trạng thái in' } },\r\n    { id: 'dispatchedAt', accessorKey: 'dispatchedAt', header: 'Ngày xuất kho', cell: ({ row }) => formatDate(row.dispatchedAt), meta: { displayName: 'Ngày xuất kho' } },\r\n    { id: 'totalProductQuantity', accessorKey: 'totalProductQuantity', header: 'Tổng SL SP', cell: ({ row }) => row.totalProductQuantity, meta: { displayName: 'Tổng số lượng sản phẩm' } },\r\n    { id: 'customerDue', accessorKey: 'customerDue', header: 'Khách phải trả', cell: ({ row }) => formatCurrency(row.customerDue), meta: { displayName: 'Khách phải trả' } },\r\n    { id: 'customerAddress', accessorKey: 'customerAddress', header: 'Địa chỉ người nhận', cell: ({ row }) => row.customerAddress, meta: { displayName: 'Địa chỉ người nhận' } },\r\n    { id: 'dispatchEmployeeName', accessorKey: 'dispatchEmployeeName', header: 'NV xuất kho', cell: ({ row }) => row.dispatchEmployeeName || '-', meta: { displayName: 'Nhân viên xuất kho' } },\r\n    { id: 'creatorEmployeeName', accessorKey: 'creatorEmployeeName', header: 'NV tạo phiếu', cell: ({ row }) => row.creatorEmployeeName, meta: { displayName: 'Nhân viên tạo phiếu' } },\r\n    { id: 'cancelingEmployeeName', accessorKey: 'cancelingEmployeeName', header: 'NV hủy phiếu', cell: ({ row }) => row.cancelingEmployeeName || '-', meta: { displayName: 'Nhân viên hủy phiếu' } },\r\n    { id: 'branchName', accessorKey: 'branchName', header: 'Chi nhánh', cell: ({ row }) => row.branchName, meta: { displayName: 'Chi nhánh' } },\r\n    { id: 'noteToShipper', accessorKey: 'noteToShipper', header: 'Ghi chú', cell: ({ row }) => row.noteToShipper || '-', meta: { displayName: 'Ghi chú' } },\r\n    {\r\n        id: 'actions',\r\n        header: () => <div className=\"text-right\">Hành động</div>,\r\n        cell: ({ row }) => (\r\n            <div className=\"text-right\">\r\n                <DropdownMenu>\r\n                    <DropdownMenuTrigger asChild>\r\n                        <Button variant=\"ghost\" className=\"h-8 w-8 p-0\">\r\n                            <span className=\"sr-only\">Mở menu</span>\r\n                            <MoreHorizontal className=\"h-4 w-4\" />\r\n                        </Button>\r\n                    </DropdownMenuTrigger>\r\n                    <DropdownMenuContent align=\"end\">\r\n                        <DropdownMenuItem onClick={() => navigate ? navigate(`/orders/${row.orderSystemId}`) : (window.location.href = `/orders/${row.orderSystemId}`)}>\r\n                            Xem đơn hàng\r\n                        </DropdownMenuItem>\r\n                        <DropdownMenuItem onClick={() => onPrintDelivery?.(row.systemId)}>\r\n                            <Printer className=\"mr-2 h-4 w-4\" />\r\n                            In Phiếu Giao Hàng\r\n                        </DropdownMenuItem>\r\n                        <DropdownMenuItem onClick={() => onPrintHandover?.(row.systemId)}>\r\n                            <FileText className=\"mr-2 h-4 w-4\" />\r\n                            In Phiếu Bàn Giao\r\n                        </DropdownMenuItem>\r\n                    </DropdownMenuContent>\r\n                </DropdownMenu>\r\n            </div>\r\n        ),\r\n        meta: { displayName: 'Hành động', sticky: 'right' },\r\n        size: 100,\r\n    },\r\n];\r\n\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;AACA,MAAM,iBAAiB,CAAC;IACpB,IAAI,OAAO,UAAU,YAAY,MAAM,QAAQ,OAAO;IACtD,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;AACjD;AAIA,MAAM,yBAAuH;IAC3H,gBAAgB;IAChB,eAAe;IACf,gBAAgB;IAChB,kBAAkB;IAClB,gBAAgB;IAChB,gBAAgB;IAChB,UAAU;AACZ;AAEA,MAAM,sBAAyE;IAC7E,SAAS;IACT,WAAW;AACb;AAEO,MAAM,aAAa,CACxB,iBACA,iBACA,WAC8B;QAC5B;YACE,IAAI;YACJ,QAAQ,CAAC,EAAE,qBAAqB,EAAE,sBAAsB,EAAE,WAAW,EAAE,iBACrE,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,4IAAQ;wBACP,SAAS,wBAAwB,OAAO,yBAAyB,kBAAkB;wBACnF,iBAAiB,CAAC,QAAU,cAAc,CAAC,CAAC;wBAC5C,cAAW;;;;;;;;;;;YAIjB,MAAM,CAAC,EAAE,UAAU,EAAE,cAAc,EAAE,iBACnC,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,4IAAQ;wBACP,SAAS;wBACT,iBAAiB;wBACjB,cAAW;;;;;;;;;;;YAIjB,MAAM;YACN,MAAM;gBACJ,aAAa;gBACb,QAAQ;YACV;QACF;QACA;YAAE,IAAI;YAAgB,aAAa;YAAgB,QAAQ;YAAc,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC;oBAAK,WAAU;8BAAa,IAAI,YAAY,IAAI;;;;;;YAAa,MAAM;gBAAE,aAAa;YAAa;QAAE;QAC9L;YAAE,IAAI;YAAM,aAAa;YAAM,QAAQ;YAAiB,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC;oBAAK,WAAU;8BAA0B,IAAI,EAAE;;;;;;YAAU,MAAM;gBAAE,aAAa;YAAgB;QAAE;QAC5K;YAAE,IAAI;YAAiB,aAAa;YAAiB,QAAQ;YAAiB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAA,qIAAU,EAAC,IAAI,aAAa;YAAG,MAAM;gBAAE,aAAa;YAAgB;QAAE;QACvK;YAAE,IAAI;YAAgB,aAAa;YAAgB,QAAQ;YAAc,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,YAAY;YAAE,MAAM;gBAAE,aAAa;YAAa;QAAE;QAClJ;YAAE,IAAI;YAAiB,aAAa;YAAiB,QAAQ;YAAkB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,aAAa;YAAE,MAAM;gBAAE,aAAa;YAAiB;QAAE;QAC7J;YAAE,IAAI;YAAW,aAAa;YAAW,QAAQ;YAAsB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,OAAO,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAqB;QAAE;QAC1J;YAAE,IAAI;YAAkB,aAAa;YAAkB,QAAQ;YAAwB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,cAAc,iBAAG,6LAAC,sIAAK;oBAAC,SAAS,sBAAsB,CAAC,IAAI,cAAc,CAAC;8BAAG,IAAI,cAAc;;;;;+DAAY;YAAK,MAAM;gBAAE,aAAa;YAAuB;QAAE;QAC7Q;YAAE,IAAI;YAAwB,aAAa;YAAwB,QAAQ;YAAgB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,eAAe,IAAI,oBAAoB;YAAG,MAAM;gBAAE,aAAa;YAAe;QAAE;QAC9L;YAAE,IAAI;YAAa,aAAa;YAAa,QAAQ;YAAkB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,eAAe,IAAI,SAAS;YAAG,MAAM;gBAAE,aAAa;YAAiB;QAAE;QACjK;YAAE,IAAI;YAAwB,aAAa;YAAwB,QAAQ;YAAuB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,oBAAoB,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAsB;QAAE;QACnM;YAAE,IAAI;YAAa,aAAa;YAAa,QAAQ;YAAY,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAA,qIAAU,EAAC,IAAI,SAAS;YAAG,MAAM;gBAAE,aAAa;YAAW;QAAE;QACjJ;YAAE,IAAI;YAAe,aAAa;YAAe,QAAQ;YAAiB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAA,qIAAU,EAAC,IAAI,WAAW;YAAG,MAAM;gBAAE,aAAa;YAAgB;QAAE;QACjK;YAAE,IAAI;YAAiB,aAAa;YAAiB,QAAQ;YAAsB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,aAAa,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAqB;QAAE;QAC5K;YAAE,IAAI;YAAS,aAAa;YAAS,QAAQ;YAAiB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,KAAK,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAgB;QAAE;QAC1I;YAAE,IAAI;YAAqB,aAAa;YAAqB,QAAQ;YAAe,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC,0KAAI;oBAAC,MAAM,CAAC,WAAW,EAAE,IAAI,iBAAiB,EAAE;oBAAE,WAAU;8BAA0C,IAAI,iBAAiB;;;;;;YAAU,MAAM;gBAAE,aAAa;YAAc;QAAE;QAClR;YAAE,IAAI;YAAW,aAAa;YAAW,QAAQ;YAAe,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC,0KAAI;oBAAC,MAAM,CAAC,QAAQ,EAAE,IAAI,aAAa,EAAE;oBAAE,WAAU;8BAAgC,IAAI,OAAO;;;;;;YAAU,MAAM;gBAAE,aAAa;YAAc;QAAE;QACnO;YAAE,IAAI;YAAe,aAAa;YAAe,QAAQ;YAAiB,MAAM,CAAC,EAAE,GAAG,EAAE,iBAAK,6LAAC,sIAAK;oBAAC,SAAS,mBAAmB,CAAC,IAAI,WAAW,CAAC;8BAAG,IAAI,WAAW;;;;;;YAAW,MAAM;gBAAE,aAAa;YAAgB;QAAE;QACrN;YAAE,IAAI;YAAgB,aAAa;YAAgB,QAAQ;YAAiB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAA,qIAAU,EAAC,IAAI,YAAY;YAAG,MAAM;gBAAE,aAAa;YAAgB;QAAE;QACpK;YAAE,IAAI;YAAwB,aAAa;YAAwB,QAAQ;YAAc,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,oBAAoB;YAAE,MAAM;gBAAE,aAAa;YAAyB;QAAE;QACtL;YAAE,IAAI;YAAe,aAAa;YAAe,QAAQ;YAAkB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,eAAe,IAAI,WAAW;YAAG,MAAM;gBAAE,aAAa;YAAiB;QAAE;QACvK;YAAE,IAAI;YAAmB,aAAa;YAAmB,QAAQ;YAAsB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,eAAe;YAAE,MAAM;gBAAE,aAAa;YAAqB;QAAE;QAC3K;YAAE,IAAI;YAAwB,aAAa;YAAwB,QAAQ;YAAe,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,oBAAoB,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAqB;QAAE;QAC1L;YAAE,IAAI;YAAuB,aAAa;YAAuB,QAAQ;YAAgB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,mBAAmB;YAAE,MAAM;gBAAE,aAAa;YAAsB;QAAE;QAClL;YAAE,IAAI;YAAyB,aAAa;YAAyB,QAAQ;YAAgB,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,qBAAqB,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAsB;QAAE;QAC/L;YAAE,IAAI;YAAc,aAAa;YAAc,QAAQ;YAAa,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,UAAU;YAAE,MAAM;gBAAE,aAAa;YAAY;QAAE;QAC1I;YAAE,IAAI;YAAiB,aAAa;YAAiB,QAAQ;YAAW,MAAM,CAAC,EAAE,GAAG,EAAE,GAAK,IAAI,aAAa,IAAI;YAAK,MAAM;gBAAE,aAAa;YAAU;QAAE;QACtJ;YACI,IAAI;YACJ,QAAQ,kBAAM,6LAAC;oBAAI,WAAU;8BAAa;;;;;;YAC1C,MAAM,CAAC,EAAE,GAAG,EAAE,iBACV,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC,wJAAY;;0CACT,6LAAC,+JAAmB;gCAAC,OAAO;0CACxB,cAAA,6LAAC,wIAAM;oCAAC,SAAQ;oCAAQ,WAAU;;sDAC9B,6LAAC;4CAAK,WAAU;sDAAU;;;;;;sDAC1B,6LAAC,qOAAc;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGlC,6LAAC,+JAAmB;gCAAC,OAAM;;kDACvB,6LAAC,4JAAgB;wCAAC,SAAS,IAAM,WAAW,SAAS,CAAC,QAAQ,EAAE,IAAI,aAAa,EAAE,IAAK,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,QAAQ,EAAE,IAAI,aAAa,EAAE;kDAAG;;;;;;kDAGhJ,6LAAC,4JAAgB;wCAAC,SAAS,IAAM,kBAAkB,IAAI,QAAQ;;0DAC3D,6LAAC,sNAAO;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;kDAGxC,6LAAC,4JAAgB;wCAAC,SAAS,IAAM,kBAAkB,IAAI,QAAQ;;0DAC3D,6LAAC,6NAAQ;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;;;;;;;;;;;;;;;;YAOzD,MAAM;gBAAE,aAAa;gBAAa,QAAQ;YAAQ;YAClD,MAAM;QACV;KACH"}},
    {"offset": {"line": 918, "column": 0}, "map": {"version":3,"sources":["file:///D:/hrm2/features/shipments/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { formatDate } from '@/lib/date-utils';\r\nimport { usePageHeader } from '../../contexts/page-header-context';\r\nimport { useAllShipments } from './hooks/use-all-shipments';\r\nimport { useAllOrders } from '../orders/hooks/use-all-orders';\r\nimport { useAllCustomers } from '../customers/hooks/use-all-customers';\r\nimport { useAllBranches } from '../settings/branches/hooks/use-all-branches';\r\nimport { useStoreInfo } from '../settings/store-info/hooks/use-store-info';\r\nimport { usePrint } from '../../lib/use-print';\r\nimport { \r\n  convertShipmentToDeliveryForPrint,\r\n  convertShipmentsToHandoverForPrint,\r\n  mapDeliveryToPrintData,\r\n  mapDeliveryLineItems,\r\n  mapHandoverToPrintData,\r\n  mapHandoverLineItems,\r\n  createStoreSettings,\r\n} from '../../lib/print/shipment-print-helper';\r\nimport type { Shipment, ShipmentView } from './types';\r\nimport { getColumns } from './columns';\r\nimport { ResponsiveDataTable, type BulkAction } from '../../components/data-table/responsive-data-table';\r\nimport { GenericExportDialogV2 } from '../../components/shared/generic-export-dialog-v2';\r\nimport { shipmentConfig } from '../../lib/import-export/configs/shipment.config';\r\nimport { DataTableColumnCustomizer } from '../../components/data-table/data-table-column-toggle';\r\nimport { PageToolbar } from '../../components/layout/page-toolbar';\r\nimport { PageFilters } from '../../components/layout/page-filters';\r\nimport { Card, CardContent, CardTitle } from '../../components/ui/card';\r\nimport { Button } from '../../components/ui/button';\r\nimport { Badge } from '../../components/ui/badge';\r\nimport { Avatar, AvatarFallback } from '../../components/ui/avatar';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../components/ui/select';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '../../components/ui/dropdown-menu';\r\nimport { Truck, MoreHorizontal, Calendar, User, MapPin, Package, Printer, FileText, Download } from 'lucide-react';\r\nimport { TouchButton } from '../../components/mobile/touch-button';\r\nimport { useMediaQuery } from '../../lib/use-media-query';\r\nimport { SimplePrintOptionsDialog, type SimplePrintOptionsResult } from '../../components/shared/simple-print-options-dialog';\r\nimport { toast } from 'sonner';\r\nimport Fuse from 'fuse.js';\r\nimport { useAuth } from '../../contexts/auth-context';\r\nimport { asSystemId } from '../../lib/id-types';\r\n\r\nexport function ShipmentsPage() {\r\n    const { data: shipmentsData = [] } = useAllShipments();\r\n    const { data: allOrders = [] } = useAllOrders();\r\n    const { data: allCustomers = [] } = useAllCustomers();\r\n    const { data: branches = [] } = useAllBranches();\r\n    const { data: storeInfo } = useStoreInfo();\r\n    const { employee: currentUser } = useAuth();\r\n    const router = useRouter();\r\n    const { print, printMultiple } = usePrint();\r\n\r\n    // Print dialog state\r\n    const [printDialogOpen, setPrintDialogOpen] = React.useState(false);\r\n    const [itemsToPrint, setItemsToPrint] = React.useState<ShipmentView[]>([]);\r\n    const [printType, setPrintType] = React.useState<'delivery' | 'handover'>('delivery');\r\n    \r\n    // Export dialog state\r\n    const [exportDialogOpen, setExportDialogOpen] = React.useState(false);\r\n\r\n    const [branchFilter, setBranchFilter] = React.useState('all');\r\n    const [statusFilter, setStatusFilter] = React.useState('all');\r\n    const [partnerFilter, setPartnerFilter] = React.useState('all');\r\n    const [globalFilter, setGlobalFilter] = React.useState('');\r\n    const [debouncedGlobalFilter, setDebouncedGlobalFilter] = React.useState('');\r\n    const [pagination, setPagination] = React.useState({ pageIndex: 0, pageSize: 40 });\r\n    const [sorting, setSorting] = React.useState<{ id: string, desc: boolean }>({ id: 'createdAt', desc: true });\r\n    const [rowSelection, setRowSelection] = React.useState({});\r\n    const [expanded, setExpanded] = React.useState<Record<string, boolean>>({});\r\n    const [columnVisibility, setColumnVisibility] = React.useState<Record<string, boolean>>(() => {\r\n        const cols = getColumns();\r\n        const initial: Record<string, boolean> = {};\r\n        cols.forEach(c => { if (c.id) initial[c.id] = true; });\r\n        return initial;\r\n    });\r\n    const [columnOrder, setColumnOrder] = React.useState<string[]>([]);\r\n    const [pinnedColumns, setPinnedColumns] = React.useState<string[]>([]);\r\n    const [mobileLoadedCount, setMobileLoadedCount] = React.useState(20);\r\n    const mobileScrollRef = React.useRef<HTMLDivElement>(null);\r\n    const isMobile = !useMediaQuery('(min-width: 768px)');\r\n\r\n    React.useEffect(() => {\r\n        const timer = setTimeout(() => setDebouncedGlobalFilter(globalFilter), 300);\r\n        return () => clearTimeout(timer);\r\n    }, [globalFilter]);\r\n\r\n    // Build ShipmentView from Shipment entity + Order/Customer data\r\n    const shipments = React.useMemo((): ShipmentView[] => {\r\n        return shipmentsData.map(shipment => {\r\n            const order = allOrders.find(o => o.systemId === shipment.orderSystemId);\r\n            const customer = order ? allCustomers.find(c => c.systemId === order.customerSystemId) : null;\r\n            const packaging = order?.packagings.find(p => p.systemId === shipment.packagingSystemId);\r\n            \r\n            const totalPaid = order?.payments.reduce((sum, p) => sum + p.amount, 0) || 0;\r\n            const shippingAddress = customer \r\n                ? [customer.shippingAddress_street, customer.shippingAddress_ward, customer.shippingAddress_province].filter(Boolean).join(', ') \r\n                : '';\r\n            \r\n            return {\r\n                // Shipment entity fields\r\n                ...shipment,\r\n                \r\n                // Denormalized from Order/Customer\r\n                customerName: order?.customerName || '-',\r\n                customerPhone: customer?.phone || '-',\r\n                customerAddress: shippingAddress,\r\n                customerEmail: customer?.email || '-',\r\n                branchName: order?.branchName || '-',\r\n                \r\n                // From Packaging\r\n                packagingDate: packaging?.confirmDate,\r\n                \r\n                // Calculated\r\n                totalProductQuantity: order?.lineItems.reduce((sum, item) => sum + item.quantity, 0) || 0,\r\n                customerDue: (order?.grandTotal || 0) - totalPaid,\r\n                \r\n                // Employee names from packaging\r\n                creatorEmployeeName: packaging?.requestingEmployeeName || '-',\r\n                dispatchEmployeeName: order?.dispatchedByEmployeeName,\r\n                cancelingEmployeeName: packaging?.cancelingEmployeeName,\r\n            };\r\n        });\r\n    }, [shipmentsData, allOrders, allCustomers]);\r\n\r\n    const handlePrintDelivery = React.useCallback((shipmentIds: string[]) => {\r\n        shipmentIds.forEach(id => {\r\n            const shipment = shipments.find(s => s.systemId === id);\r\n            if (!shipment) return;\r\n            \r\n            const order = allOrders.find(o => o.systemId === shipment.orderSystemId);\r\n            if (!order) return;\r\n            \r\n            const customer = allCustomers.find(c => c.systemId === order.customerSystemId);\r\n\r\n            // Use helper to prepare print data\r\n            const storeSettings = createStoreSettings(storeInfo);\r\n            const deliveryData = convertShipmentToDeliveryForPrint(shipment, order, { customer });\r\n            \r\n            print('delivery', {\r\n                data: mapDeliveryToPrintData(deliveryData, storeSettings),\r\n                lineItems: mapDeliveryLineItems(deliveryData.items),\r\n            });\r\n        });\r\n    }, [shipments, allOrders, allCustomers, storeInfo, print]);\r\n\r\n    const handlePrintHandover = React.useCallback((shipmentIds: string[]) => {\r\n        const selectedShipments = shipments.filter(s => shipmentIds.includes(s.systemId));\r\n        if (selectedShipments.length === 0) return;\r\n\r\n        // Use helper to prepare print data\r\n        const storeSettings = createStoreSettings(storeInfo);\r\n        const handoverData = convertShipmentsToHandoverForPrint(selectedShipments);\r\n        \r\n        print('handover', {\r\n            data: mapHandoverToPrintData(handoverData, storeSettings),\r\n            lineItems: mapHandoverLineItems(handoverData.orders),\r\n        });\r\n    }, [shipments, storeInfo, print]);\r\n\r\n    const handlePrintSingleDelivery = React.useCallback((shipmentId: string) => {\r\n        handlePrintDelivery([shipmentId]);\r\n    }, [handlePrintDelivery]);\r\n\r\n    const handlePrintSingleHandover = React.useCallback((shipmentId: string) => {\r\n        handlePrintHandover([shipmentId]);\r\n    }, [handlePrintHandover]);\r\n\r\n    // Bulk print handlers\r\n    const handleBulkPrintDelivery = React.useCallback((rows: ShipmentView[]) => {\r\n        setItemsToPrint(rows);\r\n        setPrintType('delivery');\r\n        setPrintDialogOpen(true);\r\n    }, []);\r\n\r\n    const handleBulkPrintHandover = React.useCallback((rows: ShipmentView[]) => {\r\n        setItemsToPrint(rows);\r\n        setPrintType('handover');\r\n        setPrintDialogOpen(true);\r\n    }, []);\r\n\r\n    const handlePrintConfirm = React.useCallback((options: SimplePrintOptionsResult) => {\r\n        if (itemsToPrint.length === 0) return;\r\n        \r\n        if (printType === 'delivery') {\r\n            const printItems = itemsToPrint.map(shipment => {\r\n                const order = allOrders.find(o => o.systemId === shipment.orderSystemId);\r\n                const customer = order ? allCustomers.find(c => c.systemId === order.customerSystemId) : null;\r\n                const selectedBranch = options.branchSystemId \r\n                    ? branches.find(b => b.systemId === options.branchSystemId)\r\n                    : null;\r\n                const storeSettings = selectedBranch \r\n                    ? createStoreSettings(selectedBranch as any)\r\n                    : createStoreSettings(storeInfo);\r\n                const deliveryData = convertShipmentToDeliveryForPrint(shipment, order!, { customer });\r\n                \r\n                return {\r\n                    data: mapDeliveryToPrintData(deliveryData, storeSettings),\r\n                    lineItems: mapDeliveryLineItems(deliveryData.items),\r\n                    paperSize: options.paperSize,\r\n                };\r\n            }).filter(item => item.data);\r\n            \r\n            printMultiple('delivery', printItems);\r\n            toast.success(`Đang in ${printItems.length} phiếu giao hàng`);\r\n        } else {\r\n            // Handover is a single document containing all selected shipments\r\n            const selectedBranch = options.branchSystemId \r\n                ? branches.find(b => b.systemId === options.branchSystemId)\r\n                : null;\r\n            const storeSettings = selectedBranch \r\n                ? createStoreSettings(selectedBranch as any)\r\n                : createStoreSettings(storeInfo);\r\n            const handoverData = convertShipmentsToHandoverForPrint(itemsToPrint);\r\n            \r\n            print('handover', {\r\n                data: mapHandoverToPrintData(handoverData, storeSettings),\r\n                lineItems: mapHandoverLineItems(handoverData.orders),\r\n            });\r\n            toast.success('Đang in phiếu bàn giao');\r\n        }\r\n        \r\n        setItemsToPrint([]);\r\n        setPrintDialogOpen(false);\r\n    }, [itemsToPrint, printType, allOrders, allCustomers, branches, storeInfo, print, printMultiple]);\r\n\r\n    // Bulk actions\r\n    const bulkActions: BulkAction<ShipmentView>[] = React.useMemo(() => [\r\n        {\r\n            label: 'In phiếu giao hàng',\r\n            icon: Printer,\r\n            onSelect: handleBulkPrintDelivery,\r\n        },\r\n        {\r\n            label: 'In phiếu bàn giao',\r\n            icon: FileText,\r\n            onSelect: handleBulkPrintHandover,\r\n        },\r\n    ], [handleBulkPrintDelivery, handleBulkPrintHandover]);\r\n    \r\n    const columns = React.useMemo(() => getColumns(handlePrintSingleDelivery, handlePrintSingleHandover, (path: string) => router.push(path)), [handlePrintSingleDelivery, handlePrintSingleHandover, router]);\r\n\r\n    // Initialize column visibility only once\r\n    const hasInitializedVisibility = React.useRef(false);\r\n    React.useEffect(() => {\r\n        if (hasInitializedVisibility.current || columns.length === 0) return;\r\n        \r\n        // Skip if visibility already has values (from initial state)\r\n        if (Object.keys(columnVisibility).length > 0) {\r\n            hasInitializedVisibility.current = true;\r\n            return;\r\n        }\r\n        \r\n        const defaultVisibleColumns = [\r\n            'select', 'trackingCode', 'packagingDate', 'recipientName', 'recipientPhone',\r\n            'shippingPartner', 'deliveryStatus', 'shippingFeeToPartner', 'codAmount',\r\n            'creationDate', 'packagingId', 'orderId', 'dispatchDate', 'branchName', 'actions'\r\n        ];\r\n        const initialVisibility: Record<string, boolean> = {};\r\n        columns.forEach(c => {\r\n            if (c.id) {\r\n                initialVisibility[c.id] = defaultVisibleColumns.includes(c.id);\r\n            }\r\n        });\r\n        setColumnVisibility(initialVisibility);\r\n        setColumnOrder(columns.map(c => c.id).filter(Boolean) as string[]);\r\n        hasInitializedVisibility.current = true;\r\n    }, [columns, columnVisibility]);\r\n    \r\n    const fuseInstance = React.useMemo(() => new Fuse(shipments, { \r\n        keys: ['trackingCode', 'customerName', 'customerPhone', 'carrier', 'id', 'orderId', 'customerAddress'], \r\n        threshold: 0.3,\r\n        ignoreLocation: true\r\n    }), [shipments]);\r\n\r\n    const shipmentStats = React.useMemo(() => {\r\n        return shipments.reduce((acc, shipment) => {\r\n            acc.total += 1;\r\n            const status = shipment.deliveryStatus;\r\n            if (status === 'Chờ lấy hàng') acc.pending += 1;\r\n            else if (status === 'Đang giao hàng') acc.shipping += 1;\r\n            else if (status === 'Đã giao hàng') acc.delivered += 1;\r\n            return acc;\r\n        }, { total: 0, pending: 0, shipping: 0, delivered: 0 });\r\n    }, [shipments]);\r\n\r\n    usePageHeader({});\r\n\r\n    // Get unique shipping partners from data\r\n    const shippingPartners = React.useMemo(() => {\r\n        const partners = new Set<string>();\r\n        shipments.forEach(s => {\r\n            if (s.carrier) partners.add(s.carrier);\r\n        });\r\n        return Array.from(partners).sort();\r\n    }, [shipments]);\r\n\r\n    const filteredData = React.useMemo(() => {\r\n        let data = shipments;\r\n        if (branchFilter !== 'all') data = data.filter(s => s.branchName === branches.find(b => b.systemId === branchFilter)?.name);\r\n        if (statusFilter !== 'all') data = data.filter(s => s.deliveryStatus === statusFilter);\r\n        if (partnerFilter !== 'all') data = data.filter(s => s.carrier === partnerFilter);\r\n        if (debouncedGlobalFilter && debouncedGlobalFilter.trim()) {\r\n            fuseInstance.setCollection(data);\r\n            data = fuseInstance.search(debouncedGlobalFilter.trim()).map(r => r.item);\r\n        }\r\n        return data;\r\n    }, [shipments, branchFilter, statusFilter, partnerFilter, debouncedGlobalFilter, fuseInstance, branches]);\r\n    \r\n    React.useEffect(() => { setPagination(p => ({ ...p, pageIndex: 0 })); }, [debouncedGlobalFilter, branchFilter, statusFilter, partnerFilter]);\r\n    \r\n    const sortedData = React.useMemo(() => {\r\n        const sorted = [...filteredData];\r\n        if (sorting.id) {\r\n          sorted.sort((a, b) => {\r\n            const aValue = (a as any)[sorting.id];\r\n            const bValue = (b as any)[sorting.id];\r\n            if (!aValue) return 1;\r\n            if (!bValue) return -1;\r\n            // Special handling for date columns\r\n            if (sorting.id === 'createdAt' || sorting.id === 'creationDate' || sorting.id === 'estimatedDeliveryDate') {\r\n              const aTime = aValue ? new Date(aValue).getTime() : 0;\r\n              const bTime = bValue ? new Date(bValue).getTime() : 0;\r\n              return sorting.desc ? bTime - aTime : aTime - bTime;\r\n            }\r\n            if (aValue < bValue) return sorting.desc ? 1 : -1;\r\n            if (aValue > bValue) return sorting.desc ? -1 : 1;\r\n            return 0;\r\n          });\r\n        }\r\n        return sorted;\r\n    }, [filteredData, sorting]);\r\n\r\n    const pageCount = Math.ceil(sortedData.length / pagination.pageSize);\r\n    const paginatedData = React.useMemo(() => {\r\n        const start = pagination.pageIndex * pagination.pageSize;\r\n        return sortedData.slice(start, start + pagination.pageSize);\r\n    }, [sortedData, pagination]);\r\n\r\n    const allSelectedRows = React.useMemo(() => shipments.filter(s => rowSelection[s.systemId]), [shipments, rowSelection]);\r\n\r\n    React.useEffect(() => {\r\n        if (!isMobile) return;\r\n        const handleScroll = () => {\r\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n            const scrollHeight = document.documentElement.scrollHeight;\r\n            const clientHeight = window.innerHeight;\r\n            if (scrollTop + clientHeight >= scrollHeight * 0.8 && mobileLoadedCount < sortedData.length) {\r\n                setMobileLoadedCount(prev => Math.min(prev + 20, sortedData.length));\r\n            }\r\n        };\r\n        window.addEventListener('scroll', handleScroll, { passive: true });\r\n        return () => window.removeEventListener('scroll', handleScroll);\r\n    }, [isMobile, mobileLoadedCount, sortedData.length]);\r\n    \r\n    React.useEffect(() => { setMobileLoadedCount(20); }, [debouncedGlobalFilter, branchFilter, statusFilter, partnerFilter]);\r\n\r\n    const handleRowClick = (row: ShipmentView) => router.push('/shipments/' + row.systemId);\r\n\r\n    const MobileShipmentCard = ({ shipment }: { shipment: ShipmentView }) => {\r\n        const getStatusVariant = (status?: string): 'default' | 'secondary' | 'destructive' => {\r\n            if (!status) return 'secondary';\r\n            const map: Record<string, 'default' | 'secondary' | 'destructive'> = {\r\n                'Đã giao hàng': 'default', \r\n                'Đang giao hàng': 'secondary',\r\n                'Đang vận chuyển': 'secondary', \r\n                'Chờ lấy hàng': 'secondary',\r\n                'Chờ giao lại': 'secondary',\r\n                'Chưa gửi': 'secondary', \r\n                'Hủy vận chuyển': 'destructive', \r\n                'Trả hàng': 'destructive'\r\n            };\r\n            return map[status] || 'secondary';\r\n        };\r\n\r\n        return (\r\n            <Card className='hover:shadow-md transition-shadow cursor-pointer' onClick={() => handleRowClick(shipment)}>\r\n                <CardContent className='p-4'>\r\n                    <div className='flex items-center justify-between mb-2'>\r\n                        <div className='flex items-center gap-2 flex-1 min-w-0'>\r\n                            <Avatar className='h-8 w-8 flex-shrink-0 bg-primary/10'>\r\n                                <AvatarFallback className='text-xs text-primary'><Truck className='h-4 w-4' /></AvatarFallback>\r\n                            </Avatar>\r\n                            <div className='flex items-center gap-1.5 min-w-0 flex-1'>\r\n                                <CardTitle className='font-semibold text-sm truncate'>{shipment.trackingCode || shipment.id}</CardTitle>\r\n                                <span className='text-xs text-muted-foreground'>•</span>\r\n                                <span className='text-xs text-muted-foreground font-mono'>{shipment.orderId}</span>\r\n                            </div>\r\n                        </div>\r\n                        <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                                <TouchButton variant='ghost' size='sm' className='h-8 w-8 p-0 flex-shrink-0' onClick={(e) => e.stopPropagation()}>\r\n                                    <MoreHorizontal className='h-4 w-4' />\r\n                                </TouchButton>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align='end'>\r\n                                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); router.push('/orders/' + shipment.orderSystemId); }}>Xem đơn hàng</DropdownMenuItem>\r\n                                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); handlePrintSingleDelivery(shipment.systemId); }}>In Phiếu Giao Hàng</DropdownMenuItem>\r\n                                <DropdownMenuItem onClick={(e) => { e.stopPropagation(); handlePrintSingleHandover(shipment.systemId); }}>In Phiếu Bàn Giao</DropdownMenuItem>\r\n                            </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                    </div>\r\n                    <div className='text-xs text-muted-foreground mb-3 flex items-center'>\r\n                        <User className='h-3 w-3 mr-1.5 flex-shrink-0' />\r\n                        <span className='truncate'>{shipment.customerName}</span>\r\n                    </div>\r\n                    <div className='border-t border-border mb-3' />\r\n                    <div className='space-y-2'>\r\n                        <div className='flex items-center text-xs text-muted-foreground'>\r\n                            <Calendar className='h-3 w-3 mr-1.5 flex-shrink-0' />\r\n                            <span>{formatDate(shipment.createdAt)}</span>\r\n                        </div>\r\n                        {shipment.customerAddress && (\r\n                            <div className='flex items-center text-xs text-muted-foreground'>\r\n                                <MapPin className='h-3 w-3 mr-1.5 flex-shrink-0' />\r\n                                <span className='truncate'>{shipment.customerAddress}</span>\r\n                            </div>\r\n                        )}\r\n                        {shipment.carrier && (\r\n                            <div className='flex items-center text-xs text-muted-foreground'>\r\n                                <Package className='h-3 w-3 mr-1.5 flex-shrink-0' />\r\n                                <span>{shipment.carrier}</span>\r\n                            </div>\r\n                        )}\r\n                        <div className='flex items-center justify-between text-xs pt-1'>\r\n                            <span className='text-muted-foreground'>{shipment.branchName}</span>\r\n                            <Badge variant={getStatusVariant(shipment.deliveryStatus)} className='text-xs'>\r\n                                {shipment.deliveryStatus || 'Chưa xác định'}\r\n                            </Badge>\r\n                        </div>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className='flex flex-col w-full h-full'>\r\n            {!isMobile && (\r\n                <PageToolbar\r\n                    leftActions={\r\n                        <Button variant=\"outline\" size=\"sm\" onClick={() => setExportDialogOpen(true)}>\r\n                            <Download className=\"h-4 w-4 mr-2\" />\r\n                            Xuất Excel\r\n                        </Button>\r\n                    }\r\n                    rightActions={<DataTableColumnCustomizer columns={columns} columnVisibility={columnVisibility} setColumnVisibility={setColumnVisibility} columnOrder={columnOrder} setColumnOrder={setColumnOrder} pinnedColumns={pinnedColumns} setPinnedColumns={setPinnedColumns} />}\r\n                />\r\n            )}\r\n            <PageFilters searchValue={globalFilter} onSearchChange={setGlobalFilter} searchPlaceholder='Tìm kiếm vận đơn (MVĐ, tên người nhận, SĐT, đối tác, mã phiếu, mã đơn)...'>\r\n                <Select value={branchFilter} onValueChange={setBranchFilter}>\r\n                    <SelectTrigger className='w-full sm:w-[180px]'><SelectValue placeholder='Tất cả chi nhánh' /></SelectTrigger>\r\n                    <SelectContent>\r\n                        <SelectItem value='all'>Tất cả chi nhánh</SelectItem>\r\n                        {branches.map(b => <SelectItem key={b.systemId} value={b.systemId}>{b.name}</SelectItem>)}\r\n                    </SelectContent>\r\n                </Select>\r\n                <Select value={partnerFilter} onValueChange={setPartnerFilter}>\r\n                    <SelectTrigger className='w-full sm:w-[180px]'><SelectValue placeholder='Tất cả đối tác' /></SelectTrigger>\r\n                    <SelectContent>\r\n                        <SelectItem value='all'>Tất cả đối tác</SelectItem>\r\n                        {shippingPartners.map(p => <SelectItem key={p} value={p}>{p}</SelectItem>)}\r\n                    </SelectContent>\r\n                </Select>\r\n                <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                    <SelectTrigger className='w-full sm:w-[180px]'><SelectValue placeholder='Tất cả trạng thái' /></SelectTrigger>\r\n                    <SelectContent>\r\n                        <SelectItem value='all'>Tất cả trạng thái</SelectItem>\r\n                        <SelectItem value='Chờ lấy hàng'>Chờ lấy hàng</SelectItem>\r\n                        <SelectItem value='Đang giao hàng'>Đang giao hàng</SelectItem>\r\n                        <SelectItem value='Đang vận chuyển'>Đang vận chuyển</SelectItem>\r\n                        <SelectItem value='Đã giao hàng'>Đã giao hàng</SelectItem>\r\n                        <SelectItem value='Chờ giao lại'>Chờ giao lại</SelectItem>\r\n                        <SelectItem value='Trả hàng'>Trả hàng</SelectItem>\r\n                        <SelectItem value='Hủy vận chuyển'>Hủy vận chuyển</SelectItem>\r\n                    </SelectContent>\r\n                </Select>\r\n            </PageFilters>\r\n            {isMobile ? (\r\n                <div ref={mobileScrollRef} className='space-y-3 pb-4'>\r\n                    {sortedData.length === 0 ? (\r\n                        <Card><CardContent className='py-12 text-center'><p className='text-muted-foreground'>Không tìm thấy vận đơn</p></CardContent></Card>\r\n                    ) : (\r\n                        <>\r\n                            {sortedData.slice(0, mobileLoadedCount).map(shipment => <MobileShipmentCard key={shipment.systemId} shipment={shipment} />)}\r\n                            {mobileLoadedCount < sortedData.length && (\r\n                                <Card className='border-dashed'><CardContent className='py-6 text-center'><div className='flex items-center justify-center gap-2'><div className='h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent' /><span className='text-sm text-muted-foreground'>Đang tải thêm...</span></div></CardContent></Card>\r\n                            )}\r\n                            {mobileLoadedCount >= sortedData.length && sortedData.length > 20 && (\r\n                                <Card className='border-dashed'><CardContent className='py-4 text-center'><span className='text-sm text-muted-foreground'>Đã hiển thị tất cả {sortedData.length} vận đơn</span></CardContent></Card>\r\n                            )}\r\n                        </>\r\n                    )}\r\n                </div>\r\n            ) : (\r\n                <div className='w-full py-4'>\r\n                    <ResponsiveDataTable \r\n                        columns={columns} \r\n                        data={paginatedData} \r\n                        renderMobileCard={(shipment) => <MobileShipmentCard shipment={shipment} />} \r\n                        pageCount={pageCount} \r\n                        pagination={pagination} \r\n                        setPagination={setPagination} \r\n                        rowCount={filteredData.length} \r\n                        rowSelection={rowSelection} \r\n                        setRowSelection={setRowSelection} \r\n                        allSelectedRows={allSelectedRows}\r\n                        bulkActions={bulkActions}\r\n                        expanded={expanded} \r\n                        setExpanded={setExpanded} \r\n                        sorting={sorting} \r\n                        setSorting={setSorting as React.Dispatch<React.SetStateAction<{ id: string; desc: boolean; }>>} \r\n                        columnVisibility={columnVisibility} \r\n                        setColumnVisibility={setColumnVisibility} \r\n                        columnOrder={columnOrder} \r\n                        setColumnOrder={setColumnOrder} \r\n                        pinnedColumns={pinnedColumns} \r\n                        setPinnedColumns={setPinnedColumns} \r\n                        onRowClick={handleRowClick} \r\n                    />\r\n                </div>\r\n            )}\r\n\r\n            {/* Print Options Dialog */}\r\n            <SimplePrintOptionsDialog\r\n                open={printDialogOpen}\r\n                onOpenChange={setPrintDialogOpen}\r\n                onConfirm={handlePrintConfirm}\r\n                selectedCount={itemsToPrint.length}\r\n                title={printType === 'delivery' ? 'In phiếu giao hàng' : 'In phiếu bàn giao'}\r\n            />\r\n\r\n            {/* Export Dialog */}\r\n            <GenericExportDialogV2<ShipmentView>\r\n                open={exportDialogOpen}\r\n                onOpenChange={setExportDialogOpen}\r\n                config={shipmentConfig}\r\n                allData={shipments}\r\n                filteredData={sortedData}\r\n                currentPageData={paginatedData}\r\n                selectedData={allSelectedRows}\r\n                currentUser={{\r\n                    name: currentUser?.fullName || 'Hệ thống',\r\n                    systemId: currentUser?.systemId || asSystemId('SYSTEM'),\r\n                }}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}